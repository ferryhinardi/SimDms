this.j$=this.jStat=function(n){function s(t,i){var r=t>i?t:i;return n.pow(10,17-~~(n.log(r>0?r:-r)*n.LOG10E))}function f(n){return o.call(n)==="[object Function]"}function u(n){return typeof n=="number"&&n===n}function l(n){return c.apply([],n)}function t(){return new t._init(arguments)}function h(){return 0}function a(){return 1}function v(n,t){return n===t?1:0}var c=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString,r=Array.isArray||function(n){return o.call(n)==="[object Array]"},i;return t.fn=t.prototype,t._init=function(n){var i;if(r(n[0]))if(r(n[0][0])){for(f(n[1])&&(n[0]=t.map(n[0],n[1])),i=0;i<n[0].length;i++)this[i]=n[0][i];this.length=n[0].length}else this[0]=f(n[1])?t.map(n[0],n[1]):n[0],this.length=1;else if(u(n[0]))this[0]=t.seq.apply(null,n),this.length=1;else{if(n[0]instanceof t)return t(n[0].toArray());this[0]=[];this.length=1}return this},t._init.prototype=t.prototype,t._init.constructor=t,t.utils={calcRdx:s,isArray:r,isFunction:f,isNumber:u,toVector:l},t.extend=function(n){var r,i;if(arguments.length===1){for(i in n)t[i]=n[i];return this}for(r=1;r<arguments.length;r++)for(i in arguments[r])n[i]=arguments[r][i];return n},t.rows=function(n){return n.length||1},t.cols=function(n){return n[0].length||1},t.dimensions=function(n){return{rows:t.rows(n),cols:t.cols(n)}},t.row=function(n,t){return n[t]},t.col=function(n,t){for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=[n[i][t]];return r},t.diag=function(n){for(var r=t.rows(n),u=new Array(r),i=0;i<r;i++)u[i]=[n[i][i]];return u},t.antidiag=function(n){for(var i=t.rows(n)-1,u=new Array(i),r=0;i>=0;i--,r++)u[r]=[n[r][i]];return u},t.transpose=function(n){var i=[],f,e,o,t,u;for(r(n[0])||(n=[n]),e=n.length,o=n[0].length,u=0;u<o;u++){for(f=new Array(e),t=0;t<e;t++)f[t]=n[t][u];i.push(f)}return i.length===1?i[0]:i},t.map=function(n,t,i){var u,o,s,f,e;for(r(n[0])||(n=[n]),o=n.length,s=n[0].length,f=i?n:new Array(o),u=0;u<o;u++)for(f[u]||(f[u]=new Array(s)),e=0;e<s;e++)f[u][e]=t(n[u][e],u,e);return f.length===1?f[0]:f},t.alter=function(n,i){return t.map(n,i,!0)},t.create=function(n,t,i){var e=new Array(n),r,u;for(f(t)&&(i=t,t=n),r=0;r<n;r++)for(e[r]=new Array(t),u=0;u<t;u++)e[r][u]=i(r,u);return e},t.zeros=function(n,i){return u(i)||(i=n),t.create(n,i,h)},t.ones=function(n,i){return u(i)||(i=n),t.create(n,i,a)},t.rand=function(i,r){return u(r)||(r=i),t.create(i,r,n.random)},t.identity=function(n,i){return u(i)||(i=n),t.create(n,i,v)},t.symmetric=function(n){var r=n.length,t,i;if(n.length!==n[0].length)return!1;for(t=0;t<r;t++)for(i=0;i<r;i++)if(n[i][t]!==n[t][i])return!1;return!0},t.clear=function(n){return t.alter(n,h)},t.seq=function(n,t,i,r){f(r)||(r=!1);for(var h=[],u=s(n,t),c=(t*u-n*u)/((i-1)*u),e=n,o=0;e<=t;o++,e=(n*u+c*u*o)/u)h.push(r?r(e,o):e);return h},i=t.prototype,i.length=0,i.push=Array.prototype.push,i.sort=Array.prototype.sort,i.splice=Array.prototype.splice,i.slice=Array.prototype.slice,i.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},i.map=function(n,i){return t(t.map(this,n,i))},i.alter=function(n){return t.alter(this,n),this},function(n){for(var u=0;u<n.length;u++)(function(n){i[n]=function(u){var e=this,f;return u?(setTimeout(function(){u.call(e,i[n].call(e))}),this):(f=t[n](this),r(f)?t(f):f)}})(n[u])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){i[n]=function(r,u){var f=this;return u?(setTimeout(function(){u.call(f,i[n].call(f,r))}),this):t(t[n](this,r))}})(n[r])}("row col".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){i[n]=new Function("return jStat(jStat."+n+".apply(null, arguments));")})(n[t])}("create zeros ones rand identity".split(" ")),t}(Math),function(n,t){function r(n,t){return n-t}function f(n,i,r){return t.max(i,t.min(n,r))}var u=n.utils.isFunction,i;n.sum=function(n){for(var t=0,i=n.length;--i>=0;)t+=n[i];return t};n.sumsqrd=function(n){for(var i=0,t=n.length;--t>=0;)i+=n[t]*n[t];return i};n.sumsqerr=function(t){for(var f=n.mean(t),r=0,u=t.length,i;--u>=0;)i=t[u]-f,r+=i*i;return r};n.product=function(n){for(var t=1,i=n.length;--i>=0;)t*=n[i];return t};n.min=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]<t&&(t=n[i]);return t};n.max=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]>t&&(t=n[i]);return t};n.mean=function(t){return n.sum(t)/t.length};n.meansqerr=function(t){return n.sumsqerr(t)/t.length};n.geomean=function(i){return t.pow(n.product(i),1/i.length)};n.median=function(n){var t=n.length,i=n.slice().sort(r);return(t&1)?i[t/2|0]:(i[t/2-1]+i[t/2])/2};n.cumsum=function(n){var r=n.length,i=new Array(r),t;for(i[0]=n[0],t=1;t<r;t++)i[t]=i[t-1]+n[t];return i};n.diff=function(n){for(var i=[],r=n.length,t=1;t<r;t++)i.push(n[t]-n[t-1]);return i};n.mode=function(n){for(var s=n.length,u=n.slice().sort(r),i=1,e=0,o=0,f=[],t=0;t<s;t++)u[t]===u[t+1]?i++:(i>e?(f=[u[t]],e=i,o=0):i===e&&(f.push(u[t]),o++),i=1);return o===0?f[0]:f};n.range=function(t){return n.max(t)-n.min(t)};n.variance=function(t,i){return n.sumsqerr(t)/(t.length-(i?1:0))};n.stdev=function(i,r){return t.sqrt(n.variance(i,r))};n.meandev=function(i){for(var u=0,f=n.mean(i),r=i.length-1;r>=0;r--)u+=t.abs(i[r]-f);return u/i.length};n.meddev=function(i){for(var u=0,f=n.median(i),r=i.length-1;r>=0;r--)u+=t.abs(i[r]-f);return u/i.length};n.coeffvar=function(t){return n.stdev(t)/n.mean(t)};n.quartiles=function(n){var i=n.length,u=n.slice().sort(r);return[u[t.round(i/4)-1],u[t.round(i/2)-1],u[t.round(i*3/4)-1]]};n.quantiles=function(n,i,u,e){var a=n.slice().sort(r),v=[i.length],y=n.length,o,h,p,c,s,l;for(typeof u=="undefined"&&(u=3/8),typeof e=="undefined"&&(e=3/8),o=0;o<i.length;o++)h=i[o],p=u+h*(1-u-e),c=y*h+p,s=t.floor(f(c,1,y-1)),l=f(c-s,0,1),v[o]=(1-l)*a[s-1]+l*a[s];return v};n.percentileOfScore=function(n,t,i){var e=0,o=n.length,u=!1,f,r;for(i==="strict"&&(u=!0),r=0;r<o;r++)f=n[r],(u&&f<t||!u&&f<=t)&&e++;return e/o};n.covariance=function(t,i){for(var e=n.mean(t),o=n.mean(i),u=t.length,f=new Array(u),r=0;r<u;r++)f[r]=(t[r]-e)*(i[r]-o);return n.sum(f)/(u-1)};n.corrcoeff=function(t,i){return n.covariance(t,i)/n.stdev(t,1)/n.stdev(i,1)};i=n.prototype;i.cumsum=function(t,r){var o=[],e=0,f=this;if(u(t)&&(r=t,t=!1),r)return setTimeout(function(){r.call(f,i.cumsum.call(f,t))}),this;if(this.length>1){for(f=t===!0?this:this.transpose();e<f.length;e++)o[e]=n.cumsum(f[e]);return o}return n.cumsum(this[0],t)},function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(r,f){var s=[],o=0,e=this;if(u(r)&&(f=r,r=!1),f)return setTimeout(function(){f.call(e,i[t].call(e,r))}),this;if(this.length>1){for(e=r===!0?this:this.transpose();o<e.length;o++)s[o]=n[t](e[o]);return r===!0?n[t](n.utils.toVector(s)):s}return n[t](this[0],r)}})(t[r])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(){var h=[],e=0,r=this,f=Array.prototype.slice.call(arguments),c,o,s;if(u(f[f.length-1]))return o=f[f.length-1],c=f.slice(0,f.length-1),setTimeout(function(){o.call(r,i[t].apply(r,c))}),this;if(o=undefined,s=function(i){return n[t].apply(r,[i].concat(f))},this.length>1){for(r=r.transpose();e<r.length;e++)h[e]=s(r[e]);return h}return s(this[0])}})(t[r])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(n,t){n.gammaln=function(n){var r=0,o=[76.180091729471457,-86.505320329416776,24.014098240830911,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.0000000001900149,u,e,i;for(i=(e=u=n)+5.5,i-=(u+.5)*t.log(i);r<6;r++)f+=o[r]/++e;return t.log(2.5066282746310007*f/u)-i};n.gammafn=function(n){var l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.96620279041326,-31451.272968848367,-36144.413418691176,66456.143820240541],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.7716715723109,22538.11842098015,4755.8462775278813,-134659.95986496931,-115132.25967555351],e=!1,c=0,o=0,s=0,i=n,u,h,f,r;if(i<=0)if(r=i%1+36e-17,r)e=((i&1)?-1:1)*t.PI/t.sin(t.PI*r),i=1-i;else return Infinity;for(f=i,h=i<1?i++:(i-=c=(i|0)-1)-1,u=0;u<8;++u)s=(s+l[u])*h,o=o*h+a[u];if(r=s/o+1,f<i)r/=f;else if(f>i)for(u=0;u<c;++u)r*=i,i++;return e&&(r=e/r),r};n.gammap=function(i,r){var c=n.gammaln(i),v=i,o=1/i,y=o,e=r+1-i,s=1/1e-30,u=1/e,l=u,f=1,a=-~(t.log(i>=1?i:1/i)*8.5+i*.4+17),h;if(r<0||i<=0)return NaN;if(r<i+1){for(;f<=a;f++)o+=y*=r/++v;return o*t.exp(-r+i*t.log(r)-c)}for(;f<=a;f++)h=-f*(f-i),e+=2,u=h*u+e,s=e+h/s,u=1/u,l*=u*s;return 1-l*t.exp(-r+i*t.log(r)-c)};n.factorialln=function(t){return t<0?NaN:n.gammaln(t+1)};n.factorial=function(t){return t<0?NaN:n.gammafn(t+1)};n.combination=function(i,r){return i>170||r>170?t.exp(n.combinationln(i,r)):n.factorial(i)/n.factorial(r)/n.factorial(i-r)};n.combinationln=function(t,i){return n.factorialln(t)-n.factorialln(i)-n.factorialln(t-i)};n.permutation=function(t,i){return n.factorial(t)/n.factorial(t-i)};n.betafn=function(i,r){return i<=0||r<=0?undefined:i+r>170?t.exp(n.betaln(i,r)):n.gammafn(i)*n.gammafn(r)/n.gammafn(i+r)};n.betaln=function(t,i){return n.gammaln(t)+n.gammaln(i)-n.gammaln(t+i)};n.betacf=function(n,i,r){var f=1e-30,o=1,a=i+r,v=i+1,y=i-1,e=1,u=1-a*n/v,h,s,l,c;for(t.abs(u)<f&&(u=f),u=1/u,c=u;o<=100;o++)if(h=2*o,s=o*(r-o)*n/((y+h)*(i+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,c*=u*e,s=-(i+o)*(a+o)*n/((i+h)*(v+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,l=u*e,c*=l,t.abs(l-1)<3e-7)break;return c};n.gammapinv=function(i,r){var h=0,e=r-1,c=n.gammaln(r),u,l,f,o,a,s,v;if(i>=1)return t.max(100,r+100*t.sqrt(r));if(i<=0)return 0;for(r>1?(s=t.log(e),v=t.exp(e*(s-1)-c),a=i<.5?i:1-i,f=t.sqrt(-2*t.log(a)),u=(2.30753+f*.27061)/(1+f*(.99229+f*.04481))-f,i<.5&&(u=-u),u=t.max(.001,r*t.pow(1-1/(9*r)-u/(3*t.sqrt(r)),3))):(f=1-r*(.253+r*.12),u=i<f?t.pow(i/f,1/r):1-t.log(1-(i-f)/(1-f)));h<12;h++){if(u<=0)return 0;if(l=n.gammap(r,u)-i,f=r>1?v*t.exp(-(u-e)+e*(t.log(u)-s)):t.exp(-u+e*t.log(u)-c),o=l/f,u-=f=o/(1-.5*t.min(1,o*((r-1)/u-1))),u<=0&&(u=.5*(u+f)),t.abs(f)<1e-8*u)break}return u};n.erf=function(n){var r=[-1.3026537197817094,.64196979235649021,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=r.length-1,h=!1,i=0,f=0,e,o,c,s;for(n<0&&(n=-n,h=!0),e=2/(2+n),o=4*e-2;u>0;u--)c=i,i=o*i-f+r[u],f=c;return s=e*t.exp(-n*n+.5*(r[0]+o*i)-f),h?s-1:1-s};n.erfc=function(t){return 1-n.erf(t)};n.erfcinv=function(i){var o=0,r,f,u,e;if(i>=2)return-100;if(i<=0)return 100;for(e=i<1?i:2-i,u=t.sqrt(-2*t.log(e/2)),r=-.70711*((2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u);o<2;o++)f=n.erfc(r)-e,r+=f/(1.1283791670955126*t.exp(-r*r)-r*f);return i<1?r:-r};n.ibetainv=function(i,r,u){var a=r-1,v=u-1,c=0,y,p,w,e,s,b,f,l,h,o,k;if(i<=0)return 0;if(i>=1)return 1;for(r>=1&&u>=1?(w=i<.5?i:1-i,e=t.sqrt(-2*t.log(w)),f=(2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e,i<.5&&(f=-f),l=(f*f-3)/6,h=2/(1/(2*r-1)+1/(2*u-1)),o=f*t.sqrt(l+h)/h-(1/(2*u-1)-1/(2*r-1))*(l+5/6-2/(3*h)),f=r/(r+u*t.exp(2*o))):(y=t.log(r/(r+u)),p=t.log(u/(r+u)),e=t.exp(r*y)/r,s=t.exp(u*p)/u,o=e+s,f=i<e/o?t.pow(r*o*i,1/r):1-t.pow(u*o*(1-i),1/u)),k=-n.gammaln(r)-n.gammaln(u)+n.gammaln(r+u);c<10;c++){if(f===0||f===1)return f;if(b=n.ibeta(f,r,u)-i,e=t.exp(a*t.log(f)+v*t.log(1-f)+k),s=b/e,f-=e=s/(1-.5*t.min(1,s*(a/f-v/(1-f)))),f<=0&&(f=.5*(f+e)),f>=1&&(f=.5*(f+e+1)),t.abs(e)<1e-8*f&&c>0)break}return f};n.ibeta=function(i,r,u){var f=i===0||i===1?0:t.exp(n.gammaln(r+u)-n.gammaln(r)-n.gammaln(u)+r*t.log(i)+u*t.log(1-i));return i<0||i>1?!1:i<(r+1)/(r+u+2)?f*n.betacf(i,r,u)/r:1-f*n.betacf(1-i,u,r)/u};n.randn=function(i,r){var u,f,e,o,s;if(r||(r=i),i)return n.create(i,r,function(){return n.randn()});do u=t.random(),f=1.7156*(t.random()-.5),e=u-.449871,o=t.abs(f)+.386595,s=e*e+o*(.196*o-.25472*e);while(s>.27597&&(s>.27846||f*f>-4*t.log(u)*u*u));return f/u};n.randg=function(i,r,u){var c=i,o,l,e,f,s,h;if(u||(u=r),i||(i=1),r)return h=n.zeros(r,u),h.alter(function(){return n.randg(i)}),h;i<1&&(i+=1);o=i-1/3;l=1/t.sqrt(9*o);do{do s=n.randn(),f=1+l*s;while(f<=0);f=f*f*f;e=t.random()}while(e>1-.331*t.pow(s,4)&&t.log(e)>.5*s*s+o*(1-f+t.log(f)));if(i==c)return o*f;do e=t.random();while(e===0);return t.pow(e,1/c)*o*f},function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n.map(this,function(i){return n[t](i)}))}})(t[i])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}})(t[i])}("randn".split(" "))}(this.jStat,Math),function(n,t){(function(t){for(var i=0;i<t.length;i++)(function(t){n[t]=function(n,t,i){return(this instanceof arguments.callee)?(this._a=n,this._b=t,this._c=i,this):new arguments.callee(n,t,i)};n.fn[t]=function(i,r,u){var f=n[t](i,r,u);return f.data=this,f};n[t].prototype.sample=function(i){var r=this._a,u=this._b,f=this._c;return i?n.alter(i,function(){return n[t].sample(r,u,f)}):n[t].sample(r,u,f)},function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(r){var u=this._a,f=this._b,e=this._c;return(r||r===0||(r=this.data),typeof r!="number")?n.fn.map.call(r,function(r){return n[t][i](r,u,f,e)}):n[t][i](r,u,f,e)}})(i[r])}("pdf cdf inv".split(" ")),function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(){return n[t][i](this._a,this._b,this._c)}})(i[r])}("mean median mode variance".split(" "))})(t[i])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));n.extend(n.beta,{pdf:function(i,r,u){return i>1||i<0?0:r==1&&u==1?1:r<512||u<512?t.pow(i,r-1)*t.pow(1-i,u-1)/n.betafn(r,u):t.exp((r-1)*t.log(i)+(u-1)*t.log(1-i)-n.betaln(r,u))},cdf:function(t,i,r){return t>1||t<0?(t>1)*1:n.ibeta(t,i,r)},inv:function(t,i,r){return n.ibetainv(t,i,r)},mean:function(n,t){return n/(n+t)},median:function(){throw new Error("median not yet implemented");},mode:function(n,i){return n*i/(t.pow(n+i,2)*(n+i+1))},sample:function(t,i){var r=n.randg(t);return r/(r+n.randg(i))},variance:function(n,i){return n*i/(t.pow(n+i,2)*(n+i+1))}});n.extend(n.centralF,{pdf:function(i,r,u){return i<0?undefined:t.sqrt(t.pow(r*i,r)*t.pow(u,u)/t.pow(r*i+u,r+u))/(i*n.betafn(r/2,u/2))},cdf:function(t,i,r){return n.ibeta(i*t/(i*t+r),i/2,r/2)},inv:function(t,i,r){return r/(i*(1/n.ibetainv(t,i/2,r/2)-1))},mean:function(n,t){return t>2?t/(t-2):undefined},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):undefined},sample:function(t,i){var r=n.randg(t/2)*2,u=n.randg(i/2)*2;return r/t/(u/i)},variance:function(n,t){return t<=4?undefined:2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}});n.extend(n.cauchy,{pdf:function(n,i,r){return r/(t.pow(n-i,2)+t.pow(r,2))/t.PI},cdf:function(n,i,r){return t.atan((n-i)/r)/t.PI+.5},inv:function(n,i,r){return i+r*t.tan(t.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(i,r){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*r+i}});n.extend(n.chisquare,{pdf:function(i,r){return t.exp((r/2-1)*t.log(i)-i/2-r/2*t.log(2)-n.gammaln(r/2))},cdf:function(t,i){return n.gammap(i/2,t/2)},inv:function(t,i){return 2*n.gammapinv(t,.5*i)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return n.randg(t/2)*2},variance:function(n){return 2*n}});n.extend(n.exponential,{pdf:function(n,i){return n<0?0:i*t.exp(-i*n)},cdf:function(n,i){return n<0?0:1-t.exp(-i*n)},inv:function(n,i){return-t.log(1-n)/i},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}});n.extend(n.gamma,{pdf:function(i,r,u){return t.exp((r-1)*t.log(i)-i/u-n.gammaln(r)-r*t.log(u))},cdf:function(t,i,r){return n.gammap(i,t/r)},inv:function(t,i,r){return n.gammapinv(t,i)*r},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:undefined},sample:function(t,i){return n.randg(t)*i},variance:function(n,t){return n*t*t}});n.extend(n.invgamma,{pdf:function(i,r,u){return t.exp(-(r+1)*t.log(i)-u/i-n.gammaln(r)+r*t.log(u))},cdf:function(t,i,r){return 1-n.gammap(i,r/t)},inv:function(t,i,r){return r/n.gammapinv(1-t,i)},mean:function(n,t){return n>1?t/(n-1):undefined},mode:function(n,t){return t/(n+1)},sample:function(t,i){return i/n.randg(t)},variance:function(n,t){return n<=2?undefined:t*t/((n-1)*(n-1)*(n-2))}});n.extend(n.kumaraswamy,{pdf:function(n,i,r){return t.exp(t.log(i)+t.log(r)+(i-1)*t.log(n)+(r-1)*t.log(1-t.pow(n,i)))},cdf:function(n,i,r){return 1-t.pow(1-t.pow(n,i),r)},mean:function(t,i){return i*n.gammafn(1+1/t)*n.gammafn(i)/n.gammafn(1+1/t+i)},median:function(n,i){return t.pow(1-t.pow(2,-1/i),1/n)},mode:function(n,i){return(n>=1&&i>=1&&n!==1&&i!==1)?t.pow((n-1)/(n*i-1),1/n):undefined},variance:function(){throw new Error("variance not yet implemented");}});n.extend(n.lognormal,{pdf:function(n,i,r){return t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(n)-i,2)/(2*r*r))},cdf:function(i,r,u){return.5+.5*n.erf((t.log(i)-r)/t.sqrt(2*u*u))},inv:function(i,r,u){return t.exp(-1.4142135623730952*u*n.erfcinv(2*i)+r)},mean:function(n,i){return t.exp(n+i*i/2)},median:function(n){return t.exp(n)},mode:function(n,i){return t.exp(n-i*i)},sample:function(i,r){return t.exp(n.randn()*r+i)},variance:function(n,i){return(t.exp(i*i)-1)*t.exp(2*n+i*i)}});n.extend(n.normal,{pdf:function(n,i,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(n-i,2)/(2*r*r))},cdf:function(i,r,u){return.5*(1+n.erf((i-r)/t.sqrt(2*u*u)))},inv:function(t,i,r){return-1.4142135623730952*r*n.erfcinv(2*t)+i},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(t,i){return n.randn()*i+t},variance:function(n,t){return t*t}});n.extend(n.pareto,{pdf:function(n,i,r){return n<=i?undefined:r*t.pow(i,r)/t.pow(n,r+1)},cdf:function(n,i,r){return 1-t.pow(i/n,r)},mean:function(n,i){return i<=1?undefined:i*t.pow(n,i)/(i-1)},median:function(n,i){return n*i*t.SQRT2},mode:function(n){return n},variance:function(n,i){return i<=2?undefined:n*n*i/(t.pow(i-1,2)*(i-2))}});n.extend(n.studentt,{pdf:function(i,r){return n.gammafn((r+1)/2)/(t.sqrt(r*t.PI)*n.gammafn(r/2))*t.pow(1+i*i/r,-((r+1)/2))},cdf:function(i,r){var u=r/2;return n.ibeta((i+t.sqrt(i*i+r))/(2*t.sqrt(i*i+r)),u,u)},inv:function(i,r){var u=n.ibetainv(2*t.min(i,1-i),.5*r,.5);return u=t.sqrt(r*(1-u)/u),i>0?u:-u},mean:function(n){return n>1?0:undefined},median:function(){return 0},mode:function(){return 0},sample:function(i){return n.randn()*t.sqrt(i/(2*n.randg(i/2)))},variance:function(n){return n>2?n/(n-2):n>1?Infinity:undefined}});n.extend(n.weibull,{pdf:function(n,i,r){return n<0?0:r/i*t.pow(n/i,r-1)*t.exp(-t.pow(n/i,r))},cdf:function(n,i,r){return n<0?0:1-t.exp(-t.pow(n/i,r))},inv:function(n,i,r){return i*t.pow(-t.log(1-n),1/r)},mean:function(t,i){return t*n.gammafn(1+1/i)},median:function(n,i){return n*t.pow(t.log(2),1/i)},mode:function(n,i){return i<=1?undefined:n*t.pow((i-1)/i,1/i)},sample:function(n,i){return n*t.pow(-t.log(t.random()),1/i)},variance:function(i,r){return i*i*n.gammafn(1+2/r)-t.pow(this.mean(i,r),2)}});n.extend(n.uniform,{pdf:function(n,t,i){return n<t||n>i?0:1/(i-t)},cdf:function(n,t,i){return n<t?0:n<i?(n-t)/(i-t):1},mean:function(n,t){return.5*(n+t)},median:function(t,i){return n.mean(t,i)},mode:function(){throw new Error("mode is not yet implemented");},sample:function(n,i){return n/2+i/2+(i/2-n/2)*(2*t.random()-1)},variance:function(n,i){return t.pow(i-n,2)/12}});n.extend(n.binomial,{pdf:function(i,r,u){return u===0||u===1?r*u===i?1:0:n.combination(r,i)*t.pow(u,i)*t.pow(1-u,r-i)},cdf:function(t,i,r){var f=[],u=0;if(t<0)return 0;if(t<i){for(;u<=t;u++)f[u]=n.binomial.pdf(u,i,r);return n.sum(f)}return 1}});n.extend(n.negbin,{pdf:function(i,r,u){return i!==i|0?!1:i<0?0:n.combination(i+r-1,r-1)*t.pow(1-u,i)*t.pow(u,r)},cdf:function(t,i,r){var f=0,u=0;if(t<0)return 0;for(;u<=t;u++)f+=n.negbin.pdf(u,i,r);return f}});n.extend(n.hypgeom,{pdf:function(i,r,u,f){var s,e,o;if(i!==i|0)return!1;if(i<0||i<u-(r-f)||i>f||i>u)return 0;if(u*2>r)return f*2>r?n.hypgeom.pdf(r-u-f+i,r,r-u,r-f):n.hypgeom.pdf(f-i,r,r-u,f);if(f*2>r)return n.hypgeom.pdf(u-i,r,u,r-f);if(u<f)return n.hypgeom.pdf(i,r,f,u);for(s=1,e=0,o=0;o<i;o++){while(s>1&&e<f)s*=1-u/(r-e),e++;s*=(f-o)*(u-o)/((o+1)*(r-u-f+o+1))}for(;e<f;e++)s*=1-u/(r-e);return t.min(1,t.max(0,s))},cdf:function(i,r,u,f){var e,c;if(i<0||i<u-(r-f))return 0;if(i>=f||i>=u)return 1;if(u*2>r)return f*2>r?n.hypgeom.cdf(r-u-f+i,r,r-u,r-f):1-n.hypgeom.cdf(f-i-1,r,r-u,f);if(f*2>r)return 1-n.hypgeom.cdf(u-i-1,r,u,r-f);if(u<f)return n.hypgeom.cdf(i,r,f,u);var s=1,h=1,o=0;for(e=0;e<i;e++){while(s>1&&o<f)c=1-u/(r-o),h*=c,s*=c,o++;h*=(f-e)*(u-e)/((e+1)*(r-u-f+e+1));s+=h}for(;o<f;o++)s*=1-u/(r-o);return t.min(1,t.max(0,s))}});n.extend(n.poisson,{pdf:function(i,r){return t.pow(r,i)*t.exp(-r)/n.factorial(i)},cdf:function(t,i){var u=[],r=0;if(t<0)return 0;for(;r<=t;r++)u.push(n.poisson.pdf(r,i));return n.sum(u)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var i=1,r=0,u=t.exp(-n);do r++,i*=t.random();while(i>u);return r-1}});n.extend(n.triangular,{pdf:function(n,t,i,r){return i<=t||r<t||r>i?undefined:n<t||n>i?0:n<=r?2*(n-t)/((i-t)*(r-t)):2*(i-n)/((i-t)*(i-r))},cdf:function(n,i,r,u){return r<=i||u<i||u>r?undefined:n<i?0:n<=u?t.pow(n-i,2)/((r-i)*(u-i)):1-t.pow(r-n,2)/((r-i)*(r-u))},mean:function(n,t,i){return(n+t+i)/3},median:function(n,i,r){return r<=(n+i)/2?i-t.sqrt((i-n)*(i-r))/t.sqrt(2):r>(n+i)/2?n+t.sqrt((i-n)*(r-n))/t.sqrt(2):void 0},mode:function(n,t,i){return i},sample:function(n,i,r){var u=t.random();return u<(r-n)/(i-n)?n+t.sqrt(u*(i-n)*(r-n)):i-t.sqrt((1-u)*(i-n)*(i-r))},variance:function(n,t,i){return(n*n+t*t+i*i-n*t-n*i-t*i)/18}})}(this.jStat,Math),function(n,t){var r=Array.prototype.push,i=n.utils.isArray;n.extend({add:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.map(t,function(n,t,i){return n+r[t][i]})):n.map(t,function(n){return n+r})},subtract:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.map(t,function(n,t,i){return n-r[t][i]||0})):n.map(t,function(n){return n-r})},divide:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.multiply(t,n.inv(r))):n.map(t,function(n){return n/r})},multiply:function(t,r){var u,f,c,o,s=t.length,l=t[0].length,h=n.zeros(s,c=i(r)?r[0].length:l),e=0;if(i(r)){for(;e<c;e++)for(u=0;u<s;u++){for(o=0,f=0;f<l;f++)o+=t[u][f]*r[f][e];h[u][e]=o}return s===1&&e===1?h[0][0]:h}return n.map(t,function(n){return n*r})},dot:function(t,r){i(t[0])||(t=[t]);i(r[0])||(r=[r]);for(var o=t[0].length===1&&t.length!==1?n.transpose(t):t,h=r[0].length===1&&r.length!==1?n.transpose(r):r,f=[],u=0,c=o.length,l=o[0].length,s,e;u<c;u++){for(f[u]=[],s=0,e=0;e<l;e++)s+=o[u][e]*h[u][e];f[u]=s}return f.length===1?f[0]:f},pow:function(i,r){return n.map(i,function(n){return t.pow(n,r)})},abs:function(i){return n.map(i,function(n){return t.abs(n)})},norm:function(n,r){var f=0,u=0;for(isNaN(r)&&(r=2),i(n[0])&&(n=n[0]);u<n.length;u++)f+=t.pow(t.abs(n[u]),r);return t.pow(f,1/r)},angle:function(i,r){return t.acos(n.dot(i,r)/(n.norm(i)*n.norm(r)))},aug:function(n,t){for(var u=n.slice(),i=0;i<u.length;i++)r.apply(u[i],t[i]);return u},inv:function(t){for(var e=t.length,u=t[0].length,s=n.identity(e,u),o=n.gauss_jordan(t,s),f=[],i=0,r;i<e;i++)for(f[i]=[],r=u-1;r<o[0].length;r++)f[i][r-u]=o[i][r];return f},det:function(n){var i=n.length,o=i*2,r=new Array(o),h=i-1,c=o-1,u=h-i+1,f=c,t=0,s=0,e;if(i===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;t<o;t++)r[t]=1;for(t=0;t<i;t++){for(e=0;e<i;e++)r[u<0?u+i:u]*=n[t][e],r[f<i?f+i:f]*=n[t][e],u++,f--;u=--h-i+1;f=--c}for(t=0;t<i;t++)s+=r[t];for(;t<o;t++)s-=r[t];return s},gauss_elimination:function(i,r){var u=0,e=0,o=i.length,y=i[0].length,a=1,h=0,c=[],s,l,v,f;for(i=n.aug(i,r),s=i[0].length;u<o;u++){for(l=i[u][u],e=u,f=u+1;f<y;f++)l<t.abs(i[f][u])&&(l=i[f][u],e=f);if(e!=u)for(f=0;f<s;f++)v=i[u][f],i[u][f]=i[e][f],i[e][f]=v;for(e=u+1;e<o;e++)for(a=i[e][u]/i[u][u],f=u;f<s;f++)i[e][f]=i[e][f]-a*i[u][f]}for(u=o-1;u>=0;u--){for(h=0,e=u+1;e<=o-1;e++)h=c[e]*i[u][e];c[u]=(i[u][s-1]-h)/i[u][u]}return c},gauss_jordan:function(i,r){for(var h,a,e,o,f=n.aug(i,r),s=f.length,l=f[0].length,u=0;u<s;u++){for(h=u,e=u+1;e<s;e++)t.abs(f[e][u])>t.abs(f[h][u])&&(h=e);for(a=f[u],f[u]=f[h],f[h]=a,e=u+1;e<s;e++)for(c=f[e][u]/f[u][u],o=u;o<l;o++)f[e][o]-=f[u][o]*c}for(u=s-1;u>=0;u--){for(c=f[u][u],e=0;e<u;e++)for(o=l-1;o>u-1;o--)f[e][o]-=f[u][o]*f[e][u]/c;for(f[u][u]/=c,o=s;o<l;o++)f[u][o]/=c}return f},lu:function(){throw new Error("lu not yet implemented");},cholesky:function(){throw new Error("cholesky not yet implemented");},gauss_jacobi:function(i,r,u,f){for(var e=0,o=0,p=i.length,h=[],c=[],s=[],a,v,y,l;e<p;e++)for(h[e]=[],c[e]=[],s[e]=[],o=0;o<p;o++)e>o?(h[e][o]=i[e][o],c[e][o]=s[e][o]=0):e<o?(c[e][o]=i[e][o],h[e][o]=s[e][o]=0):(s[e][o]=i[e][o],h[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(s),n.add(h,c)),-1),v=n.multiply(n.inv(s),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e++;return l},gauss_seidel:function(i,r,u,f){for(var e=0,p=i.length,s=[],c=[],h=[],o,a,v,y,l;e<p;e++)for(s[e]=[],c[e]=[],h[e]=[],o=0;o<p;o++)e>o?(s[e][o]=i[e][o],c[e][o]=h[e][o]=0):e<o?(c[e][o]=i[e][o],s[e][o]=h[e][o]=0):(h[e][o]=i[e][o],s[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(n.add(h,s)),c),-1),v=n.multiply(n.inv(n.add(h,s)),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e=e+1;return l},SOR:function(i,r,u,f,e){for(var o=0,w=i.length,c=[],l=[],h=[],s,v,y,p,a;o<w;o++)for(c[o]=[],l[o]=[],h[o]=[],s=0;s<w;s++)o>s?(c[o][s]=i[o][s],l[o][s]=h[o][s]=0):o<s?(l[o][s]=i[o][s],c[o][s]=h[o][s]=0):(h[o][s]=i[o][s],c[o][s]=l[o][s]=0);for(p=n.multiply(n.inv(n.add(h,n.multiply(c,e))),n.subtract(n.multiply(h,1-e),n.multiply(l,e))),y=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(c,e))),r),e),v=u,a=n.add(n.multiply(p,u),y),o=2;t.abs(n.norm(n.subtract(a,v)))>f;)v=a,a=n.add(n.multiply(p,v),y),o++;return a},householder:function(i){for(var s=i.length,l=i[0].length,r=0,f=[],h=[],u,c,e,o,a;r<s-1;r++){for(u=0,o=r+1;o<l;o++)u+=i[o][r]*i[o][r];for(a=i[r+1][r]>0?-1:1,u=a*t.sqrt(u),c=t.sqrt((u*u-i[r+1][r]*u)/2),f=n.zeros(s,1),f[r+1][0]=(i[r+1][r]-u)/(2*c),e=r+2;e<s;e++)f[e][0]=i[e][r]/(2*c);h=n.subtract(n.identity(s,l),n.multiply(n.multiply(f,n.transpose(f)),2));i=n.multiply(h,n.multiply(i,h))}return i},QR:function(i,r){for(var o=i.length,c=i[0].length,u=0,s=[],l=[],a=[],f,e,v,h,y,p;u<o-1;u++){for(e=0,f=u+1;f<c;f++)e+=i[f][u]*i[f][u];for(y=i[u+1][u]>0?-1:1,e=y*t.sqrt(e),v=t.sqrt((e*e-i[u+1][u]*e)/2),s=n.zeros(o,1),s[u+1][0]=(i[u+1][u]-e)/(2*v),h=u+2;h<o;h++)s[h][0]=i[h][u]/(2*v);l=n.subtract(n.identity(o,c),n.multiply(n.multiply(s,n.transpose(s)),2));i=n.multiply(l,i);r=n.multiply(l,r)}for(u=o-1;u>=0;u--){for(p=0,f=u+1;f<=c-1;f++)p=a[f]*i[u][f];a[u]=r[u][0]/i[u][u]}return a},jacobi:function(i){for(var c=1,p=0,o=i.length,l=n.identity(o,o),v=[],y,r,u,f,e,a,h,s;c===1;){for(p++,a=i[0][1],f=0,e=1,r=0;r<o;r++)for(u=0;u<o;u++)r!=u&&a<t.abs(i[r][u])&&(a=t.abs(i[r][u]),f=r,e=u);for(h=i[f][f]===i[e][e]?i[f][e]>0?t.PI/4:-t.PI/4:t.atan(2*i[f][e]/(i[f][f]-i[e][e]))/2,s=n.identity(o,o),s[f][f]=t.cos(h),s[f][e]=-t.sin(h),s[e][f]=t.sin(h),s[e][e]=t.cos(h),l=n.multiply(l,s),y=n.multiply(n.multiply(n.inv(s),i),s),i=y,c=0,r=1;r<o;r++)for(u=1;u<o;u++)r!=u&&t.abs(i[r][u])>.001&&(c=1)}for(r=0;r<o;r++)v.push(i[r][r]);return[l,v]},rungekutta:function(n,t,i,r,u,f){var e,o,s,h,c;if(f===2)while(r<=i)e=t*n(r,u),o=t*n(r+t,u+e),s=u+(e+o)/2,u=s,r=r+t;if(f===4)while(r<=i)e=t*n(r,u),o=t*n(r+t/2,u+e/2),h=t*n(r+t/2,u+o/2),c=t*n(r+t,u+h),s=u+(e+2*o+2*h+c)/6,u=s,r=r+t;return u},romberg:function(n,i,r,u){for(var l=0,a=(r-i)/2,v=[],h=[],e=[],o,c,f,y,s;l<u/2;){for(s=n(i),f=i,y=0;f<=r;f=f+a,y++)v[y]=f;for(o=v.length,f=1;f<o-1;f++)s+=(f%2!=0?4:2)*n(v[f]);s=a/3*(s+n(r));e[l]=s;a/=2;l++}for(c=e.length,o=1;c!==1;){for(f=0;f<c-1;f++)h[f]=(t.pow(4,o)*e[f+1]-e[f])/(t.pow(4,o)-1);c=h.length;e=h;h=[];o++}return e},richardson:function(n,i,r,u){function c(n,t){for(var i=0,u=n.length,r;i<u;i++)n[i]===t&&(r=i);return r}for(var p=n.length,y=t.abs(r-n[c(n,r)+1]),v=0,f=[],o=[],l,a,s,h,e;u>=y;)l=c(n,r+u),a=c(n,r),f[v]=(i[l]-2*i[a]+i[2*a-l])/(u*u),u/=2,v++;for(h=f.length,s=1;h!=1;){for(e=0;e<h-1;e++)o[e]=(t.pow(4,s)*f[e+1]-f[e])/(t.pow(4,s)-1);h=o.length;f=o;o=[];s++}return f},simpson:function(n,t,i,r){for(var o=(i-t)/r,s=n(t),e=[],u=t,h=0,f=1,c;u<=i;u=u+o,h++)e[h]=u;for(c=e.length;f<c-1;f++)s+=(f%2!=0?4:2)*n(e[f]);return o/3*(s+n(i))},hermite:function(n,t,i,r){for(var o=n.length,h=0,u=0,e=[],s=[],c=[],l=[],f;u<o;u++){for(e[u]=1,f=0;f<o;f++)u!=f&&(e[u]*=(r-n[f])/(n[u]-n[f]));for(s[u]=0,f=0;f<o;f++)u!=f&&(s[u]+=1/(n[u]-n[f]));c[u]=(1-2*(r-n[u])*s[u])*e[u]*e[u];l[u]=(r-n[u])*e[u]*e[u];h+=c[u]*t[u]+l[u]*i[u]}return h},lagrange:function(n,t,i){for(var e=0,u=0,r,f,o=n.length;u<o;u++){for(f=t[u],r=0;r<o;r++)u!=r&&(f*=(i-n[r])/(n[u]-n[r]));e+=f}return e},cubic_spline:function(t,i,r){for(var s=t.length,u=0,f,h=[],c=[],l=[],o=[],e=[],a=[],v=[];u<s-1;u++)e[u]=t[u+1]-t[u];for(l[0]=0,u=1;u<s-1;u++)l[u]=3/e[u]*(i[u+1]-i[u])-3/e[u-1]*(i[u]-i[u-1]);for(u=1;u<s-1;u++)h[u]=[],c[u]=[],h[u][u-1]=e[u-1],h[u][u]=2*(e[u-1]+e[u]),h[u][u+1]=e[u],c[u][0]=l[u];for(o=n.multiply(n.inv(h),c),f=0;f<s-1;f++)a[f]=(i[f+1]-i[f])/e[f]-e[f]*(o[f+1][0]+2*o[f][0])/3,v[f]=(o[f+1][0]-o[f][0])/(3*e[f]);for(f=0;f<s;f++)if(t[f]>r)break;return f-=1,i[f]+(r-t[f])*a[f]+n.sq(r-t[f])*o[f]+(r-t[f])*n.sq(r-t[f])*v[f]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented");},PCA:function(t){for(var o=t.length,s=t[0].length,i=0,r,v,y=[],u=[],h=[],p=[],c=[],l=[],f=[],a=[],w=[],e=[],i=0;i<o;i++)y[i]=n.sum(t[i])/s;for(i=0;i<s;i++)for(f[i]=[],r=0;r<o;r++)f[i][r]=t[r][i]-y[r];for(f=n.transpose(f),i=0;i<o;i++)for(a[i]=[],r=0;r<o;r++)a[i][r]=n.dot([f[i]],[f[r]])/(s-1);for(h=n.jacobi(a),w=h[0],u=h[1],e=n.transpose(w),i=0;i<u.length;i++)for(r=i;r<u.length;r++)u[i]<u[r]&&(v=u[i],u[i]=u[r],u[r]=v,p=e[i],e[i]=e[r],e[r]=p);for(l=n.transpose(f),i=0;i<o;i++)for(c[i]=[],r=0;r<l.length;r++)c[i][r]=n.dot([e[i]],[l[r]]);return[t,u,e,c]}}),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(i,r){var u=this;return r?(setTimeout(function(){r.call(u,n.fn[t].call(u,i))},15),this):n(n[t](this,i))}})(t[i])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(n,t){var i=[].slice,r=n.utils.isNumber;n.extend({zscore:function(){var t=i.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var u=i.call(arguments),f;return u.length===4?r(u[1])?(f=n.zscore(u[0],u[1],u[2]),u[3]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2):(f=u[0],u[2]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2):(f=n.zscore(u[0],u[1],u[3]),u[1]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2)}});n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(i,r,u){var f=t.abs(this.zscore(i,u));return r===1?n.normal.cdf(-f,0,1):n.normal.cdf(-f,0,1)*2}});n.extend({tscore:function(){var r=i.call(arguments);return r.length===4?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-n.mean(r[1]))/(n.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var u=i.call(arguments),f;return u.length===5?(f=t.abs(n.tscore(u[0],u[1],u[2],u[3])),u[4]===1?n.studentt.cdf(-f,u[3]-1):n.studentt.cdf(-f,u[3]-1)*2):r(u[1])?(f=t.abs(u[0]),u[2]==1?n.studentt.cdf(-f,u[1]-1):n.studentt.cdf(-f,u[1]-1)*2):(f=t.abs(n.tscore(u[0],u[1])),u[2]==1?n.studentt.cdf(-f,u[1].length-1):n.studentt.cdf(-f,u[1].length-1)*2)}});n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(i,r){return r===1?1-n.studentt.cdf(t.abs(this.tscore(i)),this.cols()-1):n.studentt.cdf(-t.abs(this.tscore(i)),this.cols()-1)*2}});n.extend({anovafscore:function(){var u=i.call(arguments),f,e,c,l,h,o,r,s;if(u.length===1){for(h=new Array(u[0].length),r=0;r<u[0].length;r++)h[r]=u[0][r];u=h}if(u.length===2)return n.variance(u[0])/n.variance(u[1]);for(e=[],r=0;r<u.length;r++)e=e.concat(u[r]);for(c=n.mean(e),f=0,r=0;r<u.length;r++)f=f+u[r].length*t.pow(n.mean(u[r])-c,2);for(f/=u.length-1,o=0,r=0;r<u.length;r++)for(l=n.mean(u[r]),s=0;s<u[r].length;s++)o+=t.pow(u[r][s]-l,2);return o/=e.length-u.length,f/o},anovaftest:function(){var t=i.call(arguments),e,o,u,f;if(r(t[0]))return 1-n.centralF.cdf(t[0],t[1],t[2]);for(anovafscore=n.anovafscore(t),e=t.length-1,u=0,f=0;f<t.length;f++)u=u+t[f].length;return o=u-e-1,1-n.centralF.cdf(anovafscore,e,o)},ftest:function(t,i,r){return 1-n.centralF.cdf(t,i,r)}});n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){for(var i=0,t=0;t<this.length;t++)i=i+this[t].length;return n.ftest(this.anovafscore(),this.length-1,i-this.length)}});n.extend({normalci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.normal.inv(r[1]/2,0,1)*r[2]/t.sqrt(r[3])):t.abs(n.normal.inv(r[1]/2,0,1)*n.stdev(r[2])/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},tci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.studentt.inv(r[1]/2,r[3]-1)*r[2]/t.sqrt(r[3])):t.abs(n.studentt.inv(r[1]/2,r[2].length-1)*n.stdev(r[2],!0)/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},significant:function(n,t){return n<t}});n.extend(n.fn,{normalci:function(t,i){return n.normalci(t,i,this.toArray())},tci:function(t,i){return n.tci(t,i,this.toArray())}})}(this.jStat,Math);