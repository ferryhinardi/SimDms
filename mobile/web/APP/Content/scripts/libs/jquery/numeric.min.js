"use strict";var numeric=typeof exports=="undefined"?function(){}:exports;typeof global!="undefined"&&(global.numeric=numeric);numeric.version="1.2.6";numeric.bench=function(n,t){var f,u,r,i;for(typeof t=="undefined"&&(t=15),r=.5,f=new Date;;){for(r*=2,i=r;i>3;i-=4)n(),n(),n(),n();while(i>0)n(),i--;if(u=new Date,u-f>t)break}for(i=r;i>3;i-=4)n(),n(),n(),n();while(i>0)n(),i--;return u=new Date,1e3*(3*r-1)/(u-f)};numeric._myIndexOf=function(n){for(var i=this.length,t=0;t<i;++t)if(this[t]===n)return t;return-1};numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf;numeric.Function=Function;numeric.precision=4;numeric.largeArray=50;numeric.prettyPrint=function(n){function r(n){if(n===0)return"0";if(isNaN(n))return"NaN";if(n<0)return"-"+r(-n);if(isFinite(n)){var t=Math.floor(Math.log(n)/Math.log(10)),i=n/Math.pow(10,t),u=i.toPrecision(numeric.precision);return parseFloat(u)===10&&(t++,i=1,u=i.toPrecision(numeric.precision)),parseFloat(u).toString()+"e"+t.toString()}return"Infinity"}function i(n){var u,f;if(typeof n=="undefined")return t.push(Array(numeric.precision+8).join(" ")),!1;if(typeof n=="string")return t.push('"'+n+'"'),!1;if(typeof n=="boolean")return t.push(n.toString()),!1;if(typeof n=="number"){var e=r(n),s=n.toPrecision(numeric.precision),h=parseFloat(n.toString()).toString(),o=[e,s,h,parseFloat(s).toString(),parseFloat(h).toString()];for(u=1;u<o.length;u++)o[u].length<e.length&&(e=o[u]);return t.push(Array(numeric.precision+8-e.length).join(" ")+e),!1}if(n===null)return t.push("null"),!1;if(typeof n=="function"){t.push(n.toString());f=!1;for(u in n)n.hasOwnProperty(u)&&(f?t.push(",\n"):t.push("\n{"),f=!0,t.push(u),t.push(": \n"),i(n[u]));return f&&t.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return t.push("...Large Array..."),!0;for(f=!1,t.push("["),u=0;u<n.length;u++)u>0&&(t.push(","),f&&t.push("\n ")),f=i(n[u]);return t.push("]"),!0}t.push("{");f=!1;for(u in n)n.hasOwnProperty(u)&&(f&&t.push(",\n"),f=!0,t.push(u),t.push(": \n"),i(n[u]));return t.push("}"),!0}var t=[];return i(n),t.join("")};numeric.parseDate=function(n){function t(n){if(typeof n=="string")return Date.parse(n.replace(/-/g,"/"));if(!(n instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");for(var r=[],i=0;i<n.length;i++)r[i]=t(n[i]);return r}return t(n)};numeric.parseFloat=function(n){function t(n){if(typeof n=="string")return parseFloat(n);if(!(n instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");for(var r=[],i=0;i<n.length;i++)r[i]=t(n[i]);return r}return t(n)};numeric.parseCSV=function(n){for(var o=n.split("\n"),t,f=[],s=/(([^'",]*)|('[^']*')|("[^"]*")),/g,h=function(n){return n.substr(0,n.length-1)},e=0,r,u,i=0;i<o.length;i++)if(r=(o[i]+",").match(s),r.length>0){for(f[e]=[],t=0;t<r.length;t++)u=h(r[t]),f[e][t]=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/.test(u)?parseFloat(u):u;e++}return f};numeric.toCSV=function(n){var e=numeric.dim(n),t,i,r,o,u,f;for(r=e[0],o=e[1],f=[],t=0;t<r;t++){for(u=[],i=0;i<r;i++)u[i]=n[t][i].toString();f[t]=u.join(", ")}return f.join("\n")+"\n"};numeric.getURL=function(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.send(),t};numeric.imageURL=function(n){function p(n){for(var u=n.length,f,e,o,h,c,s,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",t=0;t<u;t+=3)f=n[t],e=n[t+1],o=n[t+2],h=f>>2,c=((f&3)<<4)+(e>>4),s=((e&15)<<2)+(o>>6),i=o&63,t+1>=u?s=i=64:t+2>=u&&(i=64),l+=r.charAt(h)+r.charAt(c)+r.charAt(s)+r.charAt(i);return l}function y(n,t,i){typeof t=="undefined"&&(t=0);typeof i=="undefined"&&(i=n.length);for(var e=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],r=-1,f=0,o=n.length,u=t;u<i;u++)f=(r^n[u])&255,r=r>>>8^e[f];return r^-1}var e=n[0].length,f=n[0][0].length,o,c,l,s,i,v,u,a,h,r,t=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,f&255,e>>24&255,e>>16&255,e>>8&255,e&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(r=y(t,12,29),t[29]=r>>24&255,t[30]=r>>16&255,t[31]=r>>8&255,t[32]=r&255,o=1,c=0,u=0;u<e;u++){for(u<e-1?t.push(0):t.push(1),i=3*f+1+(u===0)&255,v=3*f+1+(u===0)>>8&255,t.push(i),t.push(v),t.push(~i&255),t.push(~v&255),u===0&&t.push(0),a=0;a<f;a++)for(l=0;l<3;l++)i=n[l][u][a],i=i>255?255:i<0?0:Math.round(i),o=(o+i)%65521,c=(c+o)%65521,t.push(i);t.push(0)}return h=(c<<16)+o,t.push(h>>24&255),t.push(h>>16&255),t.push(h>>8&255),t.push(h&255),s=t.length-41,t[33]=s>>24&255,t[34]=s>>16&255,t[35]=s>>8&255,t[36]=s&255,r=y(t,37),t.push(r>>24&255),t.push(r>>16&255),t.push(r>>8&255),t.push(r&255),t.push(0),t.push(0),t.push(0),t.push(0),t.push(73),t.push(69),t.push(78),t.push(68),t.push(174),t.push(66),t.push(96),t.push(130),"data:image/png;base64,"+p(t)};numeric._dim=function(n){for(var t=[];typeof n=="object";)t.push(n.length),n=n[0];return t};numeric.dim=function(n){var t,i;return typeof n=="object"?(t=n[0],typeof t=="object")?(i=t[0],typeof i=="object")?numeric._dim(n):[n.length,t.length]:[n.length]:[]};numeric.mapreduce=function(n,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+n+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+n+";\n    xi = x[i-1];\n    "+n+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+n+"\n}\nreturn accum;")};numeric.mapreduce2=function(n,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+n+";\n}\nreturn accum;")};numeric.same=function same(n,t){var i,r;if(!(n instanceof Array)||!(t instanceof Array)||(r=n.length,r!==t.length))return!1;for(i=0;i<r;i++)if(n[i]!==t[i])if(typeof n[i]=="object"){if(!same(n[i],t[i]))return!1}else return!1;return!0};numeric.rep=function(n,t,i){typeof i=="undefined"&&(i=0);var f=n[i],u=Array(f),r;if(i===n.length-1){for(r=f-2;r>=0;r-=2)u[r+1]=t,u[r]=t;return r===-1&&(u[0]=t),u}for(r=f-1;r>=0;r--)u[r]=numeric.rep(n,t,i+1);return u};numeric.dotMMsmall=function(n,t){var u,r,i,s,e,h,c,l,f,o,a;for(s=n.length,e=t.length,h=t[0].length,c=Array(s),u=s-1;u>=0;u--){for(l=Array(h),f=n[u],i=h-1;i>=0;i--){for(o=f[e-1]*t[e-1][i],r=e-2;r>=1;r-=2)a=r-1,o+=f[r]*t[r][i]+f[a]*t[a][i];r===0&&(o+=f[0]*t[0][i]);l[i]=o}c[u]=l}return c};numeric._getCol=function(n,t,i){for(var u=n.length,r=u-1;r>0;--r)i[r]=n[r][t],--r,i[r]=n[r][t];r===0&&(i[0]=n[0][t])};numeric.dotMMbig=function(n,t){var c=numeric._getCol,o=t.length,s=Array(o),u=n.length,f=t[0].length,e=new Array(u),h,l=numeric.dotVV,i,r,a;for(--o,--u,i=u;i!==-1;--i)e[i]=Array(f);for(--f,i=f;i!==-1;--i)for(c(t,i,s),r=u;r!==-1;--r)a=0,h=n[r],e[r][i]=l(h,s);return e};numeric.dotMV=function(n,t){for(var r=n.length,e=t.length,u=Array(r),f=numeric.dotVV,i=r-1;i>=0;i--)u[i]=f(n[i],t);return u};numeric.dotVM=function(n,t){var r,i,u,e,o,f,s;for(u=n.length,e=t[0].length,o=Array(e),i=e-1;i>=0;i--){for(f=n[u-1]*t[u-1][i],r=u-2;r>=1;r-=2)s=r-1,f+=n[r]*t[r][i]+n[s]*t[s][i];r===0&&(f+=n[0]*t[0][i]);o[i]=f}return o};numeric.dotVV=function(n,t){for(var r=n.length,u,f=n[r-1]*t[r-1],i=r-2;i>=1;i-=2)u=i-1,f+=n[i]*t[i]+n[u]*t[u];return i===0&&(f+=n[0]*t[0]),f};numeric.dot=function(n,t){var i=numeric.dim;switch(i(n).length*1e3+i(t).length){case 2002:return t.length<10?numeric.dotMMsmall(n,t):numeric.dotMMbig(n,t);case 2001:return numeric.dotMV(n,t);case 1002:return numeric.dotVM(n,t);case 1001:return numeric.dotVV(n,t);case 1e3:return numeric.mulVS(n,t);case 1:return numeric.mulSV(n,t);case 0:return n*t;default:throw new Error("numeric.dot only works on vectors and matrices");}};numeric.diag=function(n){for(var f,t,u=n.length,e=Array(u),r,i=u-1;i>=0;i--){for(r=Array(u),f=i+2,t=u-1;t>=f;t-=2)r[t]=0,r[t-1]=0;for(t>i&&(r[t]=0),r[i]=n[i],t=i-1;t>=1;t-=2)r[t]=0,r[t-1]=0;t===0&&(r[0]=0);e[i]=r}return e};numeric.getDiag=function(n){for(var r=Math.min(n.length,n[0].length),i=Array(r),t=r-1;t>=1;--t)i[t]=n[t][t],--t,i[t]=n[t][t];return t===0&&(i[0]=n[0][0]),i};numeric.identity=function(n){return numeric.diag(numeric.rep([n],1))};numeric.pointwise=function(n,t,i){typeof i=="undefined"&&(i="");for(var u=[],f,e="",o=!1,r=0;r<n.length;r++)/\[i\]$/.test(n[r])?(f=n[r].substring(0,n[r].length-3),e=f):f=n[r],f==="ret"&&(o=!0),u.push(f);return u[n.length]="_s",u[n.length+1]="_k",u[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+e+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(o?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+n.join(",")+",_s,_k+1);\n    return ret;\n}\n"+i+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,u)};numeric.pointwise2=function(n,t,i){typeof i=="undefined"&&(i="");for(var f=[],u,e="",o=!1,r=0;r<n.length;r++)/\[i\]$/.test(n[r])?(u=n[r].substring(0,n[r].length-3),e=u):u=n[r],u==="ret"&&(o=!0),f.push(u);return f[n.length]="var _n = "+e+".length;\nvar i"+(o?"":", ret = Array(_n)")+";\n"+i+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,f)};numeric._biforeach=function _biforeach(n,t,i,r,u){if(r===i.length-1){u(n,t);return}for(var e=i[r],f=e-1;f>=0;f--)_biforeach(typeof n=="object"?n[f]:n,typeof t=="object"?t[f]:t,i,r+1,u)};numeric._biforeach2=function _biforeach2(n,t,i,r,u){if(r===i.length-1)return u(n,t);for(var e=i[r],o=Array(e),f=e-1;f>=0;--f)o[f]=_biforeach2(typeof n=="object"?n[f]:n,typeof t=="object"?t[f]:t,i,r+1,u);return o};numeric._foreach=function _foreach(n,t,i,r){if(i===t.length-1){r(n);return}for(var f=t[i],u=f-1;u>=0;u--)_foreach(n[u],t,i+1,r)};numeric._foreach2=function _foreach2(n,t,i,r){if(i===t.length-1)return r(n);for(var f=t[i],e=Array(f),u=f-1;u>=0;u--)e[u]=_foreach2(n[u],t,i+1,r);return e};numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];numeric.mathfuns2=["atan2","pow","max","min"];numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""};numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){for(var t,r,u,i,n=0;n<numeric.mathfuns2.length;++n)t=numeric.mathfuns2[n],numeric.ops2[t]=t;for(n in numeric.ops2)numeric.ops2.hasOwnProperty(n)&&(t=numeric.ops2[n],i="",numeric.myIndexOf.call(numeric.mathfuns2,n)!==-1?(i="var "+t+" = Math."+t+";\n",r=function(n,i,r){return n+" = "+t+"("+i+","+r+")"},u=function(n,i){return n+" = "+t+"("+n+","+i+")"}):(r=function(n,i,r){return n+" = "+i+" "+t+" "+r},u=numeric.opseq.hasOwnProperty(n+"eq")?function(n,i){return n+" "+t+"= "+i}:function(n,i){return n+" = "+n+" "+t+" "+i}),numeric[n+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),numeric[n+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),numeric[n+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),numeric[n]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+n+"VV, VS = numeric."+n+"VS, SV = numeric."+n+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+u("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[n],numeric[n+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],u("ret[i]","x[i]"),i),numeric[n+"eqS"]=numeric.pointwise2(["ret[i]","x"],u("ret[i]","x"),i),numeric[n+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+n+"eqV, S = numeric."+n+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n'));for(n=0;n<numeric.mathfuns2.length;++n)t=numeric.mathfuns2[n],delete numeric.ops2[t];for(n=0;n<numeric.mathfuns.length;++n)t=numeric.mathfuns[n],numeric.ops1[t]=t;for(n in numeric.ops1)numeric.ops1.hasOwnProperty(n)&&(i="",t=numeric.ops1[n],numeric.myIndexOf.call(numeric.mathfuns,n)!==-1&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[n+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[n+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+n+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[n+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[n]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+n+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(n=0;n<numeric.mathfuns.length;++n)t=numeric.mathfuns[n],delete numeric.ops1[t];for(n in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(n)&&(t=numeric.mapreducers[n],numeric[n+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[n]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+n+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}();numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;");numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;");numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;");numeric.trunc=function(n,t){return typeof n=="object"?typeof t=="object"?numeric.truncVV(n,t):numeric.truncVS(n,t):typeof t=="object"?numeric.truncSV(n,t):Math.round(n/t)*t};numeric.inv=function(n){for(var y=numeric.dim(n),p=Math.abs,l=y[0],s=y[1],u=numeric.clone(n),a,h,f=numeric.identity(l),c,e,r,t,n,o,v,i=0;i<s;++i){for(o=-1,v=-1,r=i;r!==l;++r)t=p(u[r][i]),t>v&&(o=r,v=t);for(h=u[o],u[o]=u[i],u[i]=h,e=f[o],f[o]=f[i],f[i]=e,n=h[i],t=i;t!==s;++t)h[t]/=n;for(t=s-1;t!==-1;--t)e[t]/=n;for(r=l-1;r!==-1;--r)if(r!==i){for(a=u[r],c=f[r],n=a[i],t=i+1;t!==s;++t)a[t]-=h[t]*n;for(t=s-1;t>0;--t)c[t]-=e[t]*n,--t,c[t]-=e[t]*n;t===0&&(c[0]-=e[0]*n)}}return f};numeric.det=function(n){var s=numeric.dim(n);if(s.length!==2||s[0]!==s[1])throw new Error("numeric: det() only works on square matrices");for(var e=s[0],c=1,r,i,u=numeric.clone(n),f,o,h,a,l,t=0;t<e-1;t++){for(i=t,r=t+1;r<e;r++)Math.abs(u[r][t])>Math.abs(u[i][t])&&(i=r);for(i!==t&&(a=u[i],u[i]=u[t],u[t]=a,c*=-1),f=u[t],r=t+1;r<e;r++){for(o=u[r],h=o[t]/f[t],i=t+1;i<e-1;i+=2)l=i+1,o[i]-=f[i]*h,o[l]-=f[l]*h;i!==e&&(o[i]-=f[i]*h)}if(f[t]===0)return 0;c*=f[t]}return c*u[t][t]};numeric.transpose=function(n){for(var i,s=n.length,e=n[0].length,u=Array(e),f,o,r,t=0;t<e;t++)u[t]=Array(s);for(i=s-1;i>=1;i-=2){for(o=n[i],f=n[i-1],t=e-1;t>=1;--t)r=u[t],r[i]=o[t],r[i-1]=f[t],--t,r=u[t],r[i]=o[t],r[i-1]=f[t];t===0&&(r=u[0],r[i]=o[0],r[i-1]=f[0])}if(i===0){for(f=n[0],t=e-1;t>=1;--t)u[t][0]=f[t],--t,u[t][0]=f[t];t===0&&(u[0][0]=f[0])}return u};numeric.negtranspose=function(n){for(var i,s=n.length,e=n[0].length,u=Array(e),f,o,r,t=0;t<e;t++)u[t]=Array(s);for(i=s-1;i>=1;i-=2){for(o=n[i],f=n[i-1],t=e-1;t>=1;--t)r=u[t],r[i]=-o[t],r[i-1]=-f[t],--t,r=u[t],r[i]=-o[t],r[i-1]=-f[t];t===0&&(r=u[0],r[i]=-o[0],r[i-1]=-f[0])}if(i===0){for(f=n[0],t=e-1;t>=1;--t)u[t][0]=-f[t],--t,u[t][0]=-f[t];t===0&&(u[0][0]=-f[0])}return u};numeric._random=function _random(n,t){var i,f=n[t],r=Array(f),u;if(t===n.length-1){for(u=Math.random,i=f-1;i>=1;i-=2)r[i]=u(),r[i-1]=u();return i===0&&(r[0]=u()),r}for(i=f-1;i>=0;i--)r[i]=_random(n,t+1);return r};numeric.random=function(n){return numeric._random(n,0)};numeric.norm2=function(n){return Math.sqrt(numeric.norm2Squared(n))};numeric.linspace=function(n,t,i){if(typeof i=="undefined"&&(i=Math.max(Math.round(t-n)+1,1)),i<2)return i===1?[n]:[];var r,u=Array(i);for(i--,r=i;r>=0;r--)u[r]=(r*t+(i-r)*n)/i;return u};numeric.getBlock=function(n,t,i){function r(n,f){var e,s=t[f],h=i[f]-s,o=Array(h);if(f===u.length-1){for(e=h;e>=0;e--)o[e]=n[e+s];return o}for(e=h;e>=0;e--)o[e]=r(n[e+s],f+1);return o}var u=numeric.dim(n);return r(n,0)};numeric.setBlock=function(n,t,i,r){function u(n,r,e){var o,s=t[e],h=i[e]-s;if(e===f.length-1)for(o=h;o>=0;o--)n[o+s]=r[o];for(o=h;o>=0;o--)u(n[o+s],r[o],e+1)}var f=numeric.dim(n);return u(n,r,0),n};numeric.getRange=function(n,t,i){for(var e=t.length,o=i.length,u,f=Array(e),s,h,r=e-1;r!==-1;--r)for(f[r]=Array(o),s=f[r],h=n[t[r]],u=o-1;u!==-1;--u)s[u]=h[i[u]];return f};numeric.blockMatrix=function(n){var h=numeric.dim(n),c,l,f,e,t,i,o,s,a,v,p,r,u,y;if(h.length<4)return numeric.blockMatrix([n]);for(c=h[0],l=h[1],f=0,e=0,t=0;t<c;++t)f+=n[t][0].length;for(i=0;i<l;++i)e+=n[0][i][0].length;for(s=Array(f),t=0;t<f;++t)s[t]=Array(e);for(a=0,t=0;t<c;++t){for(v=e,i=l-1;i!==-1;--i)for(o=n[t][i],v-=o[0].length,r=o.length-1;r!==-1;--r)for(y=o[r],p=s[a+r],u=y.length-1;u!==-1;--u)p[v+u]=y[u];a+=n[t][0].length}return s};numeric.tensor=function(n,t){var e,o;if(typeof n=="number"||typeof t=="number")return numeric.mul(n,t);if(e=numeric.dim(n),o=numeric.dim(t),e.length!==1||o.length!==1)throw new Error("numeric: tensor product is only defined for vectors");for(var s=e[0],h=o[0],c=Array(s),r,i,u,f=s-1;f>=0;f--){for(r=Array(h),u=n[f],i=h-1;i>=3;--i)r[i]=u*t[i],--i,r[i]=u*t[i],--i,r[i]=u*t[i],--i,r[i]=u*t[i];while(i>=0)r[i]=u*t[i],--i;c[f]=r}return c};numeric.T=function(n,t){this.x=n;this.y=t};numeric.t=function(n,t){return new numeric.T(n,t)};numeric.Tbinop=function(n,t,i,r,u){var e=numeric.indexOf,f;if(typeof u!="string"){u="";for(f in numeric)numeric.hasOwnProperty(f)&&(n.indexOf(f)>=0||t.indexOf(f)>=0||i.indexOf(f)>=0||r.indexOf(f)>=0)&&f.length>1&&(u+="var "+f+" = numeric."+f+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+u+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+i+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+n+");\n")};numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)");numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)");numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))");numeric.T.prototype.reciprocal=function(){var i=numeric.mul,n=numeric.div,t;return this.y?(t=numeric.add(i(this.x,this.x),i(this.y,this.y)),new numeric.T(n(this.x,t),n(numeric.neg(this.y),t))):new T(n(1,this.x))};numeric.T.prototype.div=function(n){if(n instanceof numeric.T||(n=new numeric.T(n)),n.y)return this.mul(n.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,n.x),t(this.y,n.x)):new numeric.T(t(this.x,n.x))};numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))");numeric.T.prototype.transpose=function(){var n=numeric.transpose,t=this.x,i=this.y;return i?new numeric.T(n(t),n(i)):new numeric.T(n(t))};numeric.T.prototype.transjugate=function(){var n=numeric.transpose,t=this.x,i=this.y;return i?new numeric.T(n(t),numeric.negtranspose(i)):new numeric.T(n(t))};numeric.Tunop=function(n,t,i){return typeof i!="string"&&(i=""),Function("var x = this;\n"+i+"\nif(x.y) {  "+t+";\n}\n"+n+";\n")};numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;");numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));");numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;");numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));");numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);");numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;");numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);");numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));");numeric.T.prototype.inv=function(){var w=this;if(typeof w.y=="undefined")return new numeric.T(numeric.inv(w.x));for(var o=w.x.length,s=numeric.identity(o),h=numeric.rep([o,o],0),c=numeric.clone(w.x),l=numeric.clone(w.y),b,k,nt,tt,y,p,d,g,t,i,v,it,r,u,f,e,a,n=0;n<o;n++){for(r=c[n][n],u=l[n][n],v=r*r+u*u,i=n,t=n+1;t<o;t++)r=c[t][n],u=l[t][n],it=r*r+u*u,it>v&&(i=t,v=it);for(i!==n&&(a=c[n],c[n]=c[i],c[i]=a,a=l[n],l[n]=l[i],l[i]=a,a=s[n],s[n]=s[i],s[i]=a,a=h[n],h[n]=h[i],h[i]=a),b=c[n],k=l[n],y=s[n],p=h[n],r=b[n],u=k[n],t=n+1;t<o;t++)f=b[t],e=k[t],b[t]=(f*r+e*u)/v,k[t]=(e*r-f*u)/v;for(t=0;t<o;t++)f=y[t],e=p[t],y[t]=(f*r+e*u)/v,p[t]=(e*r-f*u)/v;for(t=n+1;t<o;t++){for(nt=c[t],tt=l[t],d=s[t],g=h[t],r=nt[n],u=tt[n],i=n+1;i<o;i++)f=b[i],e=k[i],nt[i]-=f*r-e*u,tt[i]-=e*r+f*u;for(i=0;i<o;i++)f=y[i],e=p[i],d[i]-=f*r-e*u,g[i]-=e*r+f*u}}for(n=o-1;n>0;n--)for(y=s[n],p=h[n],t=n-1;t>=0;t--)for(d=s[t],g=h[t],r=c[t][n],u=l[t][n],i=o-1;i>=0;i--)f=y[i],e=p[i],d[i]-=r*f-u*e,g[i]-=r*e+u*f;return new numeric.T(s,h)};numeric.T.prototype.get=function(n){var t=this.x,u=this.y,i=0,r,f=n.length;if(u){while(i<f)r=n[i],t=t[r],u=u[r],i++;return new numeric.T(t,u)}while(i<f)r=n[i],t=t[r],i++;return new numeric.T(t)};numeric.T.prototype.set=function(n,t){var u=this.x,f=this.y,r=0,i,o=n.length,e=t.x,s=t.y;if(o===0)return s?this.y=s:f&&(this.y=undefined),this.x=u,this;if(s){for(f||(f=numeric.rep(numeric.dim(u),0),this.y=f);r<o-1;)i=n[r],u=u[i],f=f[i],r++;return i=n[r],u[i]=e,f[i]=s,this}if(f){while(r<o-1)i=n[r],u=u[i],f=f[i],r++;return i=n[r],u[i]=e,f[i]=e instanceof Array?numeric.rep(numeric.dim(e),0):0,this}while(r<o-1)i=n[r],u=u[i],r++;return i=n[r],u[i]=e,this};numeric.T.prototype.getRows=function(n,t){for(var f=t-n+1,r=Array(f),u,o=this.x,e=this.y,i=n;i<=t;i++)r[i-n]=o[i];if(e){for(u=Array(f),i=n;i<=t;i++)u[i-n]=e[i];return new numeric.T(r,u)}return new numeric.T(r)};numeric.T.prototype.setRows=function(n,t,i){for(var f=this.x,u=this.y,e=i.x,o=i.y,r=n;r<=t;r++)f[r]=e[r-n];if(o)for(u||(u=numeric.rep(numeric.dim(f),0),this.y=u),r=n;r<=t;r++)u[r]=o[r-n];else if(u)for(r=n;r<=t;r++)u[r]=numeric.rep([e[r-n].length],0);return this};numeric.T.prototype.getRow=function(n){var t=this.x,i=this.y;return i?new numeric.T(t[n],i[n]):new numeric.T(t[n])};numeric.T.prototype.setRow=function(n,t){var r=this.x,i=this.y,u=t.x,f=t.y;return r[n]=u,f?(i||(i=numeric.rep(numeric.dim(r),0),this.y=i),i[n]=f):i&&(i=numeric.rep([u.length],0)),this};numeric.T.prototype.getBlock=function(n,t){var r=this.x,u=this.y,i=numeric.getBlock;return u?new numeric.T(i(r,n,t),i(u,n,t)):new numeric.T(i(r,n,t))};numeric.T.prototype.setBlock=function(n,t,i){i instanceof numeric.T||(i=new numeric.T(i));var e=this.x,r=this.y,u=numeric.setBlock,f=i.x,o=i.y;if(o)return r||(this.y=numeric.rep(numeric.dim(this),0),r=this.y),u(e,n,t,f),u(r,n,t,o),this;u(e,n,t,f);r&&u(r,n,t,numeric.rep(numeric.dim(f),0))};numeric.T.rep=function(n,t){var i=numeric.T;t instanceof i||(t=new i(t));var u=t.x,f=t.y,r=numeric.rep;return f?new i(r(n,u),r(n,f)):new i(r(n,u))};numeric.T.diag=function(n){n instanceof numeric.T||(n=new numeric.T(n));var i=n.x,r=n.y,t=numeric.diag;return r?new numeric.T(t(i),t(r)):new numeric.T(t(i))};numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)};numeric.T.identity=function(n){return new numeric.T(numeric.identity(n))};numeric.T.prototype.getDiag=function(){var n=numeric,t=this.x,i=this.y;return i?new n.T(n.getDiag(t),n.getDiag(i)):new n.T(n.getDiag(t))};numeric.house=function(n){var t=numeric.clone(n),r=n[0]>=0?1:-1,u=r*numeric.norm2(n),i;if(t[0]+=u,i=numeric.norm2(t),i===0)throw new Error("eig: internal error");return numeric.div(t,i)};numeric.toUpperHessenberg=function(n){var c=numeric.dim(n);if(c.length!==2||c[0]!==c[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");for(var r=c[0],t,u,l,f,o=numeric.clone(n),e,s,a,h,v=numeric.identity(r),y,i=0;i<r-2;i++){for(l=Array(r-i-1),t=i+1;t<r;t++)l[t-i-1]=o[t][i];if(numeric.norm2(l)>0){for(f=numeric.house(l),e=numeric.getBlock(o,[i+1,i],[r-1,r-1]),s=numeric.tensor(f,numeric.dot(f,e)),t=i+1;t<r;t++)for(a=o[t],h=s[t-i-1],u=i;u<r;u++)a[u]-=2*h[u-i];for(e=numeric.getBlock(o,[0,i+1],[r-1,r-1]),s=numeric.tensor(numeric.dot(e,f),f),t=0;t<r;t++)for(a=o[t],h=s[t],u=i+1;u<r;u++)a[u]-=2*h[u-i-1];for(e=Array(r-i-1),t=i+1;t<r;t++)e[t-i-1]=v[t];for(s=numeric.tensor(f,numeric.dot(f,e)),t=i+1;t<r;t++)for(y=v[t],h=s[t-i-1],u=0;u<r;u++)y[u]-=2*h[u]}}return{H:o,Q:v}};numeric.epsilon=22204460492503131e-32;numeric.QRFrancis=function(n,t){var it,rt,ut,v,p,w;typeof t=="undefined"&&(t=1e4);n=numeric.clone(n);var st=numeric.clone(n),ot=numeric.dim(n),f=ot[0],b,h,g,ft,et,nt,k,a,c,s=numeric.identity(f),d,y,e,o,l,i,u,r,tt;if(f<3)return{Q:s,B:[[0,f-1]]};for(it=numeric.epsilon,tt=0;tt<t;tt++){for(u=0;u<f-1;u++)if(Math.abs(n[u+1][u])<it*(Math.abs(n[u][u])+Math.abs(n[u+1][u+1]))){for(p=numeric.QRFrancis(numeric.getBlock(n,[0,0],[u,u]),t),w=numeric.QRFrancis(numeric.getBlock(n,[u+1,u+1],[f-1,f-1]),t),e=Array(u+1),i=0;i<=u;i++)e[i]=s[i];for(o=numeric.dot(p.Q,e),i=0;i<=u;i++)s[i]=o[i];for(e=Array(f-u-1),i=u+1;i<f;i++)e[i-u-1]=s[i];for(o=numeric.dot(w.Q,e),i=u+1;i<f;i++)s[i]=o[i-u-1];return{Q:s,B:p.B.concat(numeric.add(w.B,u+1))}}for(g=n[f-2][f-2],ft=n[f-2][f-1],et=n[f-1][f-2],nt=n[f-1][f-1],a=g+nt,k=g*nt-ft*et,c=numeric.getBlock(n,[0,0],[2,2]),a*a>=4*k?(rt=.5*(a+Math.sqrt(a*a-4*k)),ut=.5*(a-Math.sqrt(a*a-4*k)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,rt+ut)),numeric.diag(numeric.rep([3],rt*ut)))):c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,a)),numeric.diag(numeric.rep([3],k))),b=[c[0][0],c[1][0],c[2][0]],h=numeric.house(b),e=[n[0],n[1],n[2]],o=numeric.tensor(h,numeric.dot(h,e)),i=0;i<3;i++)for(y=n[i],l=o[i],r=0;r<f;r++)y[r]-=2*l[r];for(e=numeric.getBlock(n,[0,0],[f-1,2]),o=numeric.tensor(numeric.dot(e,h),h),i=0;i<f;i++)for(y=n[i],l=o[i],r=0;r<3;r++)y[r]-=2*l[r];for(e=[s[0],s[1],s[2]],o=numeric.tensor(h,numeric.dot(h,e)),i=0;i<3;i++)for(d=s[i],l=o[i],r=0;r<f;r++)d[r]-=2*l[r];for(u=0;u<f-2;u++){for(r=u;r<=u+1;r++)if(Math.abs(n[r+1][r])<it*(Math.abs(n[r][r])+Math.abs(n[r+1][r+1]))){for(p=numeric.QRFrancis(numeric.getBlock(n,[0,0],[r,r]),t),w=numeric.QRFrancis(numeric.getBlock(n,[r+1,r+1],[f-1,f-1]),t),e=Array(r+1),i=0;i<=r;i++)e[i]=s[i];for(o=numeric.dot(p.Q,e),i=0;i<=r;i++)s[i]=o[i];for(e=Array(f-r-1),i=r+1;i<f;i++)e[i-r-1]=s[i];for(o=numeric.dot(w.Q,e),i=r+1;i<f;i++)s[i]=o[i-r-1];return{Q:s,B:p.B.concat(numeric.add(w.B,r+1))}}for(v=Math.min(f-1,u+3),b=Array(v-u),i=u+1;i<=v;i++)b[i-u-1]=n[i][u];for(h=numeric.house(b),e=numeric.getBlock(n,[u+1,u],[v,f-1]),o=numeric.tensor(h,numeric.dot(h,e)),i=u+1;i<=v;i++)for(y=n[i],l=o[i-u-1],r=u;r<f;r++)y[r]-=2*l[r-u];for(e=numeric.getBlock(n,[0,u+1],[f-1,v]),o=numeric.tensor(numeric.dot(e,h),h),i=0;i<f;i++)for(y=n[i],l=o[i],r=u+1;r<=v;r++)y[r]-=2*l[r-u-1];for(e=Array(v-u),i=u+1;i<=v;i++)e[i-u-1]=s[i];for(o=numeric.tensor(h,numeric.dot(h,e)),i=u+1;i<=v;i++)for(d=s[i],l=o[i-u-1],r=0;r<f;r++)d[r]-=2*l[r]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?");};numeric.eig=function(n,t){for(var ft=numeric.toUpperHessenberg(n),nt=numeric.QRFrancis(ft.H,t),et=numeric.T,ot=n.length,s,st=nt.B,tt=numeric.dot(nt.Q,numeric.dot(ft.H,numeric.transpose(nt.Q))),w=new et(numeric.dot(nt.Q,ft.Q)),it,ct=st.length,i,c,l,a,v,b,ht,d,r,o,y,p,f,e,k=Math.sqrt,rt,ut,u=0;u<ct;u++)if(s=st[u][0],s!==st[u][1]){if(i=s+1,c=tt[s][s],l=tt[s][i],a=tt[i][s],v=tt[i][i],l===0&&a===0)continue;b=-c-v;ht=c*v-l*a;d=b*b-4*ht;d>=0?(r=b<0?-.5*(b-k(d)):-.5*(b+k(d)),f=(c-r)*(c-r)+l*l,e=a*a+(v-r)*(v-r),f>e?(f=k(f),y=(c-r)/f,p=l/f):(e=k(e),y=a/e,p=(v-r)/e),it=new et([[p,-y],[y,p]]),w.setRows(s,i,it.dot(w.getRows(s,i)))):(r=-.5*b,o=.5*k(-d),f=(c-r)*(c-r)+l*l,e=a*a+(v-r)*(v-r),f>e?(f=k(f+o*o),y=(c-r)/f,p=l/f,r=0,o/=f):(e=k(e+o*o),y=a/e,p=(v-r)/e,r=o/e,o=0),it=new et([[p,-y],[y,p]],[[r,o],[o,-r]]),w.setRows(s,i,it.dot(w.getRows(s,i))))}var g=w.dot(n).dot(w.transjugate()),ot=n.length,h=numeric.T.identity(ot);for(i=0;i<ot;i++)if(i>0)for(u=i-1;u>=0;u--)if(rt=g.get([u,u]),ut=g.get([i,i]),numeric.neq(rt.x,ut.x)||numeric.neq(rt.y,ut.y))r=g.getRow(u).getBlock([u],[i-1]),o=h.getRow(i).getBlock([u],[i-1]),h.set([i,u],g.get([u,i]).neg().sub(r.dot(o)).div(rt.sub(ut)));else{h.setRow(i,h.getRow(u));continue}for(i=0;i<ot;i++)r=h.getRow(i),h.setRow(i,r.div(r.norm2()));return h=h.transpose(),h=w.transjugate().dot(h),{lambda:g.getDiag(),E:h}};numeric.ccsSparse=function(n){for(var h=n.length,f,i,r=[],e,u,o,s,t=h-1;t!==-1;--t){f=n[t];for(i in f){for(i=parseInt(i);i>=r.length;)r[r.length]=0;f[i]!==0&&r[i]++}}for(e=r.length,u=Array(e+1),u[0]=0,t=0;t<e;++t)u[t+1]=u[t]+r[t];for(o=Array(u[e]),s=Array(u[e]),t=h-1;t!==-1;--t){f=n[t];for(i in f)f[i]!==0&&(r[i]--,o[u[i]+r[i]]=t,s[u[i]+r[i]]=f[i])}return[u,o,s]};numeric.ccsFull=function(n){for(var r=n[0],h=n[1],c=n[2],u=numeric.ccsDim(n),l=u[0],f=u[1],i,e,o,s=numeric.rep([l,f],0),t=0;t<f;t++)for(e=r[t],o=r[t+1],i=e;i<o;++i)s[h[i]][t]=c[i];return s};numeric.ccsTSolve=function(n,t,i,r,u){function p(n){var t;if(i[n]===0){for(i[n]=1,t=s[n];t<s[n+1];++t)p(c[t]);u[l]=n;++l}}var s=n[0],c=n[1],y=n[2],b=s.length-1,k=Math.max,l=0,f,e,h,a,o,v,w;for(typeof r=="undefined"&&(i=numeric.rep([b],0)),typeof r=="undefined"&&(r=numeric.linspace(0,i.length-1)),typeof u=="undefined"&&(u=[]),f=r.length-1;f!==-1;--f)p(r[f]);for(u.length=l,f=u.length-1;f!==-1;--f)i[u[f]]=0;for(f=r.length-1;f!==-1;--f)e=r[f],i[e]=t[e];for(f=u.length-1;f!==-1;--f){for(e=u[f],h=s[e],a=k(s[e+1],h),o=h;o!==a;++o)if(c[o]===e){i[e]/=y[o];break}for(w=i[e],o=h;o!==a;++o)v=c[o],v!==e&&(i[v]-=w*y[o])}return i};numeric.ccsDFS=function(n){this.k=Array(n);this.k1=Array(n);this.j=Array(n)};numeric.ccsDFS.prototype.dfs=function(n,t,i,r,u,f){var e=0,s,v=u.length,c=this.k,l=this.k1,a=this.j,o,h;if(r[n]===0)for(r[n]=1,a[0]=n,c[0]=o=t[n],l[0]=h=t[n+1];;)if(o>=h){if(u[v]=a[e],e===0)return;++v;--e;o=c[e];h=l[e]}else s=f[i[o]],r[s]===0?(r[s]=1,c[e]=o,++e,a[e]=s,o=t[s],l[e]=h=t[s+1]):++o};numeric.ccsLPSolve=function(n,t,i,r,u,f,e){var c=n[0],l=n[1],b=n[2],tt=c.length-1,k=t[0],d=t[1],nt=t[2],o,a,v,h,y,p,s,w,g;for(a=k[u],v=k[u+1],r.length=0,o=a;o<v;++o)e.dfs(f[d[o]],c,l,i,r,f);for(o=r.length-1;o!==-1;--o)i[r[o]]=0;for(o=a;o!==v;++o)h=f[d[o]],i[h]=nt[o];for(o=r.length-1;o!==-1;--o){for(h=r[o],y=c[h],p=c[h+1],s=y;s<p;++s)if(f[l[s]]===h){i[h]/=b[s];break}for(g=i[h],s=y;s<p;++s)w=f[l[s]],w!==h&&(i[w]-=g*b[s])}return i};numeric.ccsLUP1=function(n,t){var s=n[0].length-1,a=[numeric.rep([s+1],0),[],[]],p=[numeric.rep([s+1],0),[],[]],w=a[0],v=a[1],b=a[2],k=p[0],nt=p[1],tt=p[2],e=numeric.rep([s],0),c=numeric.rep([s],0),i,r,o,u,f,l,d,it=numeric.ccsLPSolve,ut=Math.max,g=Math.abs,h=numeric.linspace(0,s-1),y=numeric.linspace(0,s-1),rt=new numeric.ccsDFS(s);for(typeof t=="undefined"&&(t=1),i=0;i<s;++i){for(it(a,n,e,c,i,y,rt),u=-1,f=-1,r=c.length-1;r!==-1;--r)(o=c[r],o<=i)||(l=g(e[o]),l>u&&(f=o,u=l));for(g(e[i])<t*u&&(r=h[i],u=h[f],h[i]=u,y[u]=i,h[f]=r,y[r]=f,u=e[i],e[i]=e[f],e[f]=u),u=w[i],f=k[i],d=e[i],v[u]=h[i],b[u]=1,++u,r=c.length-1;r!==-1;--r)o=c[r],l=e[o],c[r]=0,e[o]=0,o<=i?(nt[f]=o,tt[f]=l,++f):(v[u]=h[o],b[u]=l/d,++u);w[i+1]=u;k[i+1]=f}for(r=v.length-1;r!==-1;--r)v[r]=y[v[r]];return{L:a,U:p,P:h,Pinv:y}};numeric.ccsDFS0=function(n){this.k=Array(n);this.k1=Array(n);this.j=Array(n)};numeric.ccsDFS0.prototype.dfs=function(n,t,i,r,u,f){var e=0,o,v=u.length,c=this.k,l=this.k1,a=this.j,s,h;if(r[n]===0)for(r[n]=1,a[0]=n,c[0]=s=t[f[n]],l[0]=h=t[f[n]+1];;){if(isNaN(s))throw new Error("Ow!");if(s>=h){if(u[v]=f[a[e]],e===0)return;++v;--e;s=c[e];h=l[e]}else o=i[s],r[o]===0?(r[o]=1,c[e]=s,++e,a[e]=o,o=f[o],s=t[o],l[e]=h=t[o+1]):++s}};numeric.ccsLPSolve0=function(n,t,i,r,u,f,e,o){var a=n[0],v=n[1],d=n[2],it=a.length-1,g=t[0],nt=t[1],tt=t[2],s,y,p,c,w,b,h,l,k;for(y=g[u],p=g[u+1],r.length=0,s=y;s<p;++s)o.dfs(nt[s],a,v,i,r,f,e);for(s=r.length-1;s!==-1;--s)c=r[s],i[e[c]]=0;for(s=y;s!==p;++s)c=nt[s],i[c]=tt[s];for(s=r.length-1;s!==-1;--s){for(c=r[s],l=e[c],w=a[c],b=a[c+1],h=w;h<b;++h)if(v[h]===l){i[l]/=d[h];break}for(k=i[l],h=w;h<b;++h)i[v[h]]-=k*d[h];i[l]=k}};numeric.ccsLUP0=function(n,t){var s=n[0].length-1,a=[numeric.rep([s+1],0),[],[]],p=[numeric.rep([s+1],0),[],[]],w=a[0],v=a[1],b=a[2],k=p[0],nt=p[1],tt=p[2],h=numeric.rep([s],0),c=numeric.rep([s],0),r,i,e,u,o,l,d,it=numeric.ccsLPSolve0,ut=Math.max,g=Math.abs,f=numeric.linspace(0,s-1),y=numeric.linspace(0,s-1),rt=new numeric.ccsDFS0(s);for(typeof t=="undefined"&&(t=1),r=0;r<s;++r){for(it(a,n,h,c,r,y,f,rt),u=-1,o=-1,i=c.length-1;i!==-1;--i)(e=c[i],e<=r)||(l=g(h[f[e]]),l>u&&(o=e,u=l));for(g(h[f[r]])<t*u&&(i=f[r],u=f[o],f[r]=u,y[u]=r,f[o]=i,y[i]=o),u=w[r],o=k[r],d=h[f[r]],v[u]=f[r],b[u]=1,++u,i=c.length-1;i!==-1;--i)e=c[i],l=h[f[e]],c[i]=0,h[f[e]]=0,e<=r?(nt[o]=e,tt[o]=l,++o):(v[u]=f[e],b[u]=l/d,++u);w[r+1]=u;k[r+1]=o}for(i=v.length-1;i!==-1;--i)v[i]=y[v[i]];return{L:a,U:p,P:f,Pinv:y}};numeric.ccsLUP=numeric.ccsLUP0;numeric.ccsDim=function(n){return[numeric.sup(n[1])+1,n[0].length-1]};numeric.ccsGetBlock=function(n,t,i){var a=numeric.ccsDim(n),o=a[0],v=a[1],c,l;typeof t=="undefined"?t=numeric.linspace(0,o-1):typeof t=="number"&&(t=[t]);typeof i=="undefined"?i=numeric.linspace(0,v-1):typeof i=="number"&&(i=[i]);for(var r,nt=t.length,tt=i.length,f,s,y,p=numeric.rep([v],0),w=[],b=[],it=[p,w,b],k=n[0],d=n[1],rt=n[2],g=numeric.rep([o],0),e=0,h=numeric.rep([o],0),u=0;u<tt;++u){for(s=i[u],c=k[s],l=k[s+1],r=c;r<l;++r)f=d[r],h[f]=1,g[f]=rt[r];for(r=0;r<nt;++r)y=t[r],h[y]&&(w[e]=r,b[e]=g[t[r]],++e);for(r=c;r<l;++r)f=d[r],h[f]=0;p[u+1]=e}return it};numeric.ccsDot=function(n,t){for(var p=n[0],rt=n[1],ut=n[2],w=t[0],ft=t[1],et=t[2],b=numeric.ccsDim(n),ot=numeric.ccsDim(t),a=b[0],ht=b[1],k=ot[1],c=numeric.rep([a],0),v=numeric.rep([a],0),d=Array(a),o=numeric.rep([k],0),g=[],nt=[],st=[o,g,nt],i,r,s,l,tt,it,e,f,y,h,u=0;u!==k;++u){for(s=w[u],l=w[u+1],f=0,r=s;r<l;++r)for(y=ft[r],h=et[r],tt=p[y],it=p[y+1],i=tt;i<it;++i)e=rt[i],v[e]===0&&(d[f]=e,v[e]=1,f=f+1),c[e]=c[e]+ut[i]*h;for(s=o[u],l=s+f,o[u+1]=l,r=f-1;r!==-1;--r)h=s+r,i=d[r],g[h]=i,nt[h]=c[i],v[i]=0,c[i]=0;o[u+1]=o[u]+f}return st};numeric.ccsLUPSolve=function(n,t){var v=n.L,tt=n.U,ut=n.P,o=t[0],y=!1;typeof o!="object"&&(t=[[0,t.length],numeric.linspace(0,t.length-1),t],o=t[0],y=!0);for(var it=t[1],rt=t[2],s=v[0].length-1,p=o.length-1,a=numeric.rep([s],0),h=Array(s),u=numeric.rep([s],0),r=Array(s),w=numeric.rep([p+1],0),b=[],k=[],d=numeric.ccsTSolve,i,g,nt,c,f,l=0,e=0;e<p;++e){for(c=0,g=o[e],nt=o[e+1],i=g;i<nt;++i)f=n.Pinv[it[i]],r[c]=f,u[f]=rt[i],++c;for(r.length=c,d(v,u,a,r,h),i=r.length-1;i!==-1;--i)u[r[i]]=0;if(d(tt,a,u,h,r),y)return u;for(i=h.length-1;i!==-1;--i)a[h[i]]=0;for(i=r.length-1;i!==-1;--i)f=r[i],b[l]=f,k[l]=u[f],u[f]=0,++l;w[e+1]=l}return[w,b,k]};numeric.ccsbinop=function(n,t){return typeof t=="undefined"&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+n+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}();numeric.ccsScatter=function(n){for(var h=n[0],e=n[1],v=n[2],o=numeric.sup(e)+1,i=h.length,r=numeric.rep([o],0),c=Array(i),l=Array(i),a=numeric.rep([o],0),u,s,f,t=0;t<i;++t)a[e[t]]++;for(t=0;t<o;++t)r[t+1]=r[t]+a[t];for(u=r.slice(0),t=0;t<i;++t)f=e[t],s=u[f],c[s]=h[t],l[s]=v[t],u[f]=u[f]+1;return[r,c,l]};numeric.ccsGather=function(n){for(var u=n[0],e=n[1],a=n[2],v=u.length-1,f=e.length,o=Array(f),s=Array(f),h=Array(f),i,c,l,r=0,t=0;t<v;++t)for(c=u[t],l=u[t+1],i=c;i!==l;++i)s[r]=t,o[r]=e[i],h[r]=a[i],++r;return[o,s,h]};numeric.sdim=function dim(n,t,i){if(typeof t=="undefined"&&(t=[]),typeof n!="object")return t;typeof i=="undefined"&&(i=0);i in t||(t[i]=0);n.length>t[i]&&(t[i]=n.length);for(var r in n)n.hasOwnProperty(r)&&dim(n[r],t,i+1);return t};numeric.sclone=function clone(n,t,i){typeof t=="undefined"&&(t=0);typeof i=="undefined"&&(i=numeric.sdim(n).length);var r,u=Array(n.length);if(t===i-1){for(r in n)n.hasOwnProperty(r)&&(u[r]=n[r]);return u}for(r in n)n.hasOwnProperty(r)&&(u[r]=clone(n[r],t+1,i));return u};numeric.sdiag=function(n){for(var u=n.length,i=Array(u),r,t=u-1;t>=1;t-=2)r=t-1,i[t]=[],i[t][t]=n[t],i[r]=[],i[r][r]=n[r];return t===0&&(i[0]=[],i[0][0]=n[t]),i};numeric.sidentity=function(n){return numeric.sdiag(numeric.rep([n],1))};numeric.stranspose=function(n){var i=[],f=n.length,r,t,u;for(r in n)if(n.hasOwnProperty(r)){u=n[r];for(t in u)u.hasOwnProperty(t)&&(typeof i[t]!="object"&&(i[t]=[]),i[t][r]=u[t])}return i};numeric.sLUP=function(){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.");};numeric.sdotMM=function(n,t){for(var h=n.length,v=t.length,c=numeric.stranspose(t),a=c.length,f,o,r,u,e,l=Array(h),s,i=h-1;i>=0;i--){for(s=[],f=n[i],u=a-1;u>=0;u--){e=0;o=c[u];for(r in f)f.hasOwnProperty(r)&&r in o&&(e+=f[r]*o[r]);e&&(s[u]=e)}l[i]=s}return l};numeric.sdotMV=function(n,t){for(var e=n.length,u,r,o=Array(e),f,i=e-1;i>=0;i--){u=n[i];f=0;for(r in u)u.hasOwnProperty(r)&&t[r]&&(f+=u[r]*t[r]);f&&(o[i]=f)}return o};numeric.sdotVM=function(n,t){var r,i,u,e,f=[];for(r in n)if(n.hasOwnProperty(r)){u=t[r];e=n[r];for(i in u)u.hasOwnProperty(i)&&(f[i]||(f[i]=0),f[i]+=e*u[i])}return f};numeric.sdotVV=function(n,t){var i,r=0;for(i in n)n[i]&&t[i]&&(r+=n[i]*t[i]);return r};numeric.sdot=function(n,t){var i=numeric.sdim(n).length,r=numeric.sdim(t).length,u=i*1e3+r;switch(u){case 0:return n*t;case 1001:return numeric.sdotVV(n,t);case 2001:return numeric.sdotMV(n,t);case 1002:return numeric.sdotVM(n,t);case 2002:return numeric.sdotMM(n,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+i+" and "+r);}};numeric.sscatter=function(n){for(var o=n[0].length,u,i,f=n.length,e=[],r,t=o-1;t>=0;--t)if(n[f-1][t]){for(r=e,i=0;i<f-2;i++)u=n[i][t],r[u]||(r[u]=[]),r=r[u];r[n[i][t]]=n[i+1][t]}return e};numeric.sgather=function gather(n,t,i){typeof t=="undefined"&&(t=[]);typeof i=="undefined"&&(i=[]);var u,r,f;u=i.length;for(r in n)if(n.hasOwnProperty(r))if(i[u]=parseInt(r),f=n[r],typeof f=="number"){if(f){if(t.length===0)for(r=u+1;r>=0;--r)t[r]=[];for(r=u;r>=0;--r)t[r].push(i[r]);t[u+1].push(f)}}else gather(f,t,i);return i.length>u&&i.pop(),t};numeric.cLU=function(n){for(var l=n[0],nt=n[1],ft=n[2],h=l.length,f=0,i,r,o,a,tt,it,rt,t=0;t<h;t++)l[t]>f&&(f=l[t]);f++;var b=Array(f),v=Array(f),u=numeric.rep([f],Infinity),e=numeric.rep([f],-Infinity),y,p,w;for(r=0;r<h;r++)t=l[r],i=nt[r],i<u[t]&&(u[t]=i),i>e[t]&&(e[t]=i);for(t=0;t<f-1;t++)e[t]>e[t+1]&&(e[t+1]=e[t]);for(t=f-1;t>=1;t--)u[t]<u[t-1]&&(u[t-1]=u[t]);for(it=0,rt=0,t=0;t<f;t++)v[t]=numeric.rep([e[t]-u[t]+1],0),b[t]=numeric.rep([t-u[t]],0),it+=t-u[t]+1,rt+=e[t]-t+1;for(r=0;r<h;r++)t=l[r],v[t][nt[r]-u[t]]=ft[r];for(t=0;t<f-1;t++)for(o=t-u[t],y=v[t],i=t+1;u[i]<=t&&i<f;i++)if(a=t-u[i],tt=e[t]-t,p=v[i],w=p[a]/y[o],w){for(r=1;r<=tt;r++)p[r+a]-=w*y[r+o];b[i][t-u[i]]=w}var y=[],p=[],ut=[],k=[],d=[],g=[],h,s,c;for(h=0,s=0,t=0;t<f;t++){for(o=u[t],a=e[t],c=v[t],i=t;i<=a;i++)c[i-o]&&(y[h]=t,p[h]=i,ut[h]=c[i-o],h++);for(c=b[t],i=o;i<t;i++)c[i-o]&&(k[s]=t,d[s]=i,g[s]=c[i-o],s++);k[s]=t;d[s]=t;g[s]=1;s++}return{U:[y,p,ut],L:[k,d,g]}};numeric.cLUsolve=function(n,t){for(var f=n.L,e=n.U,u=numeric.clone(t),l=f[0],o=f[1],a=f[2],v=e[0],s=e[1],h=e[2],y=v.length,p=l.length,c=u.length,i=0,r=0;r<c;r++){while(o[i]<r)u[r]-=a[i]*u[o[i]],i++;i++}for(i=y-1,r=c-1;r>=0;r--){while(s[i]>r)u[r]-=h[i]*u[s[i]],i--;u[r]/=h[i];i--}return u};numeric.cgrid=function(n,t){typeof n=="number"&&(n=[n,n]);var f=numeric.rep(n,-1),i,r,u;if(typeof t!="function")switch(t){case"L":t=function(t,i){return t>=n[0]/2||i<n[1]/2};break;default:t=function(){return!0}}for(u=0,i=1;i<n[0]-1;i++)for(r=1;r<n[1]-1;r++)t(i,r)&&(f[i][r]=u,u++);return f};numeric.cdelsq=function(n){for(var h=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(n),l=c[0],a=c[1],i,r,u,f,e=[],o=[],s=[],t=1;t<l-1;t++)for(i=1;i<a-1;i++)if(!(n[t][i]<0)){for(r=0;r<4;r++)(u=t+h[r][0],f=i+h[r][1],n[u][f]<0)||(e.push(n[t][i]),o.push(n[u][f]),s.push(-1));e.push(n[t][i]);o.push(n[t][i]);s.push(4)}return[e,o,s]};numeric.cdotMV=function(n,t){for(var f,u=n[0],o=n[1],s=n[2],e=u.length,r=0,i=0;i<e;i++)u[i]>r&&(r=u[i]);for(r++,f=numeric.rep([r],0),i=0;i<e;i++)f[u[i]]+=s[i]*t[o[i]];return f};numeric.Spline=function(n,t,i,r,u){this.x=n;this.yl=t;this.yr=i;this.kl=r;this.kr=u};numeric.Spline.prototype._at=function(n,t){var i=this.x,e=this.yl,o=this.yr,a=this.kl,v=this.kr,n,c,l,r,f=numeric.add,s=numeric.sub,u=numeric.mul,h;return c=s(u(a[t],i[t+1]-i[t]),s(o[t+1],e[t])),l=f(u(v[t+1],i[t]-i[t+1]),s(o[t+1],e[t])),r=(n-i[t])/(i[t+1]-i[t]),h=r*(1-r),f(f(f(u(1-r,e[t]),u(r,o[t+1])),u(c,h*(1-r))),u(l,h*r))};numeric.Spline.prototype.at=function(n){var r,i,e;if(typeof n=="number"){for(var o=this.x,r=o.length,f,s=Math.floor,t=0,u=r-1;u-t>1;)f=s((t+u)/2),o[f]<=n?t=f:u=f;return this._at(n,t)}for(r=n.length,e=Array(r),i=r-1;i!==-1;--i)e[i]=this.at(n[i]);return e};numeric.Spline.prototype.diff=function(){for(var r=this.x,s=this.yl,v=this.yr,u=this.kl,f=this.kr,e=s.length,t,o,y=u,p=f,h=Array(e),c=Array(e),l=numeric.add,i=numeric.mul,a=numeric.div,w=numeric.sub,n=e-1;n!==-1;--n)t=r[n+1]-r[n],o=w(v[n+1],s[n]),h[n]=a(l(i(o,6),i(u[n],-4*t),i(f[n+1],-2*t)),t*t),c[n+1]=a(l(i(o,-6),i(u[n],2*t),i(f[n+1],4*t)),t*t);return new numeric.Spline(r,y,p,h,c)};numeric.Spline.prototype.roots=function(){function lt(n){return n*n}var nt=[],i=this.x,c=this.yl,tt=this.yr,it=this.kl,rt=this.kr,p;typeof c[0]=="number"&&(c=[c],tt=[tt],it=[it],rt=[rt]);for(var ot=c.length,at=i.length-1,n,l,ut,ft,st,ht,nt=Array(ot),h,w,a,v,b,k,d,g,et,vt,f,t,r,y,u,o,s,ct=Math.sqrt,e=0;e!==ot;++e){for(ut=c[e],ft=tt[e],st=it[e],ht=rt[e],h=[],n=0;n!==at;n++){for(n>0&&ft[n]*ut[n]<0&&h.push(i[n]),et=i[n+1]-i[n],vt=i[n],v=ut[n],b=ft[n+1],w=st[n]/et,a=ht[n+1]/et,g=lt(w-a+3*(v-b))+12*a*v,k=a+3*v+2*w-3*b,d=3*(a+w+2*(v-b)),g<=0?(t=k/d,f=t>i[n]&&t<i[n+1]?[i[n],t,i[n+1]]:[i[n],i[n+1]]):(t=(k-ct(g))/d,r=(k+ct(g))/d,f=[i[n]],t>i[n]&&t<i[n+1]&&f.push(t),r>i[n]&&r<i[n+1]&&f.push(r),f.push(i[n+1])),u=f[0],t=this._at(u,n),l=0;l<f.length-1;l++){if(o=f[l+1],r=this._at(o,n),t===0){h.push(u);u=o;t=r;continue}if(r===0||t*r>0){u=o;t=r;continue}for(p=0;;){if(s=(t*o-r*u)/(t-r),s<=u||s>=o)break;if(y=this._at(s,n),y*r>0)o=s,r=y,p===-1&&(t*=.5),p=-1;else if(y*t>0)u=s,t=y,p===1&&(r*=.5),p=1;else break}h.push(s);u=f[l+1];t=this._at(u,n)}r===0&&h.push(o)}nt[e]=h}return typeof this.yl[0]=="number"?nt[0]:nt};numeric.spline=function(n,t,i,r){for(var o=n.length,s=[],f=[],c=[],v=numeric.sub,l=numeric.mul,a=numeric.add,e,h,u=o-2;u>=0;u--)f[u]=n[u+1]-n[u],c[u]=v(t[u+1],t[u]);(typeof i=="string"||typeof r=="string")&&(i=r="periodic");e=[[],[],[]];switch(typeof i){case"undefined":s[0]=l(3/(f[0]*f[0]),c[0]);e[0].push(0,0);e[1].push(0,1);e[2].push(2/f[0],1/f[0]);break;case"string":s[0]=a(l(3/(f[o-2]*f[o-2]),c[o-2]),l(3/(f[0]*f[0]),c[0]));e[0].push(0,0,0);e[1].push(o-2,0,1);e[2].push(1/f[o-2],2/f[o-2]+2/f[0],1/f[0]);break;default:s[0]=i;e[0].push(0);e[1].push(0);e[2].push(1)}for(u=1;u<o-1;u++)s[u]=a(l(3/(f[u-1]*f[u-1]),c[u-1]),l(3/(f[u]*f[u]),c[u])),e[0].push(u,u,u),e[1].push(u-1,u,u+1),e[2].push(1/f[u-1],2/f[u-1]+2/f[u],1/f[u]);switch(typeof r){case"undefined":s[o-1]=l(3/(f[o-2]*f[o-2]),c[o-2]);e[0].push(o-1,o-1);e[1].push(o-2,o-1);e[2].push(1/f[o-2],2/f[o-2]);break;case"string":e[1][e[1].length-1]=0;break;default:s[o-1]=r;e[0].push(o-1);e[1].push(o-1);e[2].push(1)}if(s=typeof s[0]!="number"?numeric.transpose(s):[s],h=Array(s.length),typeof i=="string")for(u=h.length-1;u!==-1;--u)h[u]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(e)),s[u]),h[u][o-1]=h[u][0];else for(u=h.length-1;u!==-1;--u)h[u]=numeric.cLUsolve(numeric.cLU(e),s[u]);return h=typeof t[0]=="number"?h[0]:numeric.transpose(h),new numeric.Spline(n,t,t,h,h)};numeric.fftpow2=function fftpow2(n,t){var u=n.length,h,a,c,l;if(u!==1){for(var v=Math.cos,y=Math.sin,o=Array(u/2),s=Array(u/2),f=Array(u/2),e=Array(u/2),i=u/2,r=u-1;r!==-1;--r)--i,f[i]=n[r],e[i]=t[r],--r,o[i]=n[r],s[i]=t[r];for(fftpow2(o,s),fftpow2(f,e),i=u/2,a=-6.2831853071795862/u,r=u-1;r!==-1;--r)--i,i===-1&&(i=u/2-1),h=a*r,c=v(h),l=y(h),n[r]=o[i]+c*f[i]-l*e[i],t[r]=s[i]+c*e[i]+l*f[i]}};numeric._ifftpow2=function _ifftpow2(n,t){var u=n.length,h,a,c,l;if(u!==1){for(var v=Math.cos,y=Math.sin,o=Array(u/2),s=Array(u/2),f=Array(u/2),e=Array(u/2),i=u/2,r=u-1;r!==-1;--r)--i,f[i]=n[r],e[i]=t[r],--r,o[i]=n[r],s[i]=t[r];for(_ifftpow2(o,s),_ifftpow2(f,e),i=u/2,a=6.2831853071795862/u,r=u-1;r!==-1;--r)--i,i===-1&&(i=u/2-1),h=a*r,c=v(h),l=y(h),n[r]=o[i]+c*f[i]-l*e[i],t[r]=s[i]+c*e[i]+l*f[i]}};numeric.ifftpow2=function(n,t){numeric._ifftpow2(n,t);numeric.diveq(n,n.length);numeric.diveq(t,t.length)};numeric.convpow2=function(n,t,i,r){numeric.fftpow2(n,t);numeric.fftpow2(i,r);for(var h=n.length,f,e,o,s,u=h-1;u!==-1;--u)f=n[u],o=t[u],e=i[u],s=r[u],n[u]=f*e-o*s,t[u]=f*s+o*e;numeric.ifftpow2(n,t)};numeric.T.prototype.fft=function(){for(var s=this.x,h=this.y,i=s.length,c=Math.log,p=c(2),w=Math.ceil(c(2*i-1)/p),r=Math.pow(2,w),e=numeric.rep([r],0),o=numeric.rep([r],0),l=Math.cos,a=Math.sin,b=-3.1415926535897931/i,u,v=numeric.rep([r],0),y=numeric.rep([r],0),k=Math.floor(i/2),t,f,n=0;n<i;n++)v[n]=s[n];if(typeof h!="undefined")for(n=0;n<i;n++)y[n]=h[n];for(e[0]=1,n=1;n<=r/2;n++)u=b*n*n,e[n]=l(u),o[n]=a(u),e[r-n]=l(u),o[r-n]=a(u);return t=new numeric.T(v,y),f=new numeric.T(e,o),t=t.mul(f),numeric.convpow2(t.x,t.y,numeric.clone(f.x),numeric.neg(f.y)),t=t.mul(f),t.x.length=i,t.y.length=i,t};numeric.T.prototype.ifft=function(){for(var s=this.x,h=this.y,i=s.length,c=Math.log,p=c(2),w=Math.ceil(c(2*i-1)/p),r=Math.pow(2,w),e=numeric.rep([r],0),o=numeric.rep([r],0),l=Math.cos,a=Math.sin,b=3.1415926535897931/i,u,v=numeric.rep([r],0),y=numeric.rep([r],0),k=Math.floor(i/2),t,f,n=0;n<i;n++)v[n]=s[n];if(typeof h!="undefined")for(n=0;n<i;n++)y[n]=h[n];for(e[0]=1,n=1;n<=r/2;n++)u=b*n*n,e[n]=l(u),o[n]=a(u),e[r-n]=l(u),o[r-n]=a(u);return t=new numeric.T(v,y),f=new numeric.T(e,o),t=t.mul(f),numeric.convpow2(t.x,t.y,numeric.clone(f.x),numeric.neg(f.y)),t=t.mul(f),t.x.length=i,t.y.length=i,t.div(i)};numeric.gradient=function(n,t){var y=t.length,f=n(t),r;if(isNaN(f))throw new Error("gradient: f(x) is a NaN!");for(var c=Math.max,e=numeric.clone(t),o,s,h=Array(y),nt=numeric.div,tt=numeric.sub,p,c=Math.max,u=Math.abs,g=Math.min,w,b,k,d=0,l,a,v,i=0;i<y;i++)for(r=c(1e-6*f,1e-8);;){if(++d,d>20)throw new Error("Numerical gradient fails");if(e[i]=t[i]+r,o=n(e),e[i]=t[i]-r,s=n(e),e[i]=t[i],isNaN(o)||isNaN(s)){r/=16;continue}if(h[i]=(o-s)/(2*r),w=t[i]-r,b=t[i],k=t[i]+r,l=(o-f)/r,a=(f-s)/r,v=c(u(h[i]),u(f),u(o),u(s),u(w),u(b),u(k),1e-8),p=g(c(u(l-h[i]),u(a-h[i]),u(l-a))/v,r/v),p>.001)r/=16;else break}return h};numeric.uncmin=function(n,t,i,r,u,f,e){var at=numeric.gradient,ut,l,k,ft,et,ot;if(typeof e=="undefined"&&(e={}),typeof i=="undefined"&&(i=1e-8),typeof r=="undefined"&&(r=function(t){return at(n,t)}),typeof u=="undefined"&&(u=1e3),t=numeric.clone(t),ut=t.length,l=n(t),isNaN(l))throw new Error("uncmin: f(x0) is a NaN!");et=Math.max;ot=numeric.norm2;i=et(i,numeric.epsilon);for(var y,tt,a=e.Hinv||numeric.identity(ut),p=numeric.dot,pt=numeric.inv,st=numeric.sub,it=numeric.add,rt=numeric.tensor,vt=numeric.div,ht=numeric.mul,ct=numeric.all,lt=numeric.isFinite,yt=numeric.neg,s=0,h,w,d,g,b,v,nt,c="",o=r(t);s<u;){if(typeof f=="function"&&f(s,t,l,o,a)){c="Callback returned true";break}if(!ct(lt(o))){c="Gradient has Infinity or NaN";break}if(y=yt(p(a,o)),!ct(lt(y))){c="Search direction has Infinity or NaN";break}if(nt=ot(y),nt<i){c="Newton step smaller than tol";break}for(v=1,ft=p(o,y),w=t;s<u;){if(v*nt<i)break;if(h=ht(y,v),w=it(t,h),k=n(w),k-l>=.1*v*ft||isNaN(k)){v*=.5;++s;continue}break}if(v*nt<i){c="Line search step size smaller than tol";break}if(s===u){c="maxit reached during line search";break}tt=r(w);d=st(tt,o);b=p(d,h);g=p(a,d);a=st(it(a,ht((b+p(d,g))/(b*b),rt(h,h))),vt(it(rt(g,h),rt(h,g)),b));t=w;l=k;o=tt;++s}return{solution:t,f:l,gradient:o,invHessian:a,iterations:s,message:c}};numeric.Dopri=function(n,t,i,r,u,f,e){this.x=n;this.y=t;this.f=i;this.ymid=r;this.iterations=u;this.events=e;this.message=f};numeric.Dopri.prototype._at=function(n,t){function f(n){return n*n}var s=this,c=s.x,v=s.y,y=s.f,g=s.ymid,nt=c.length,i,r,u,l,a,p,n,tt=Math.floor,w,h=numeric.add,e=numeric.mul,b=numeric.sub,k,d,o;return i=c[t],r=c[t+1],l=v[t],a=v[t+1],w=r-i,u=i+.5*w,p=g[t],k=b(y[t],e(l,1/(i-u)+2/(i-r))),d=b(y[t+1],e(a,1/(r-u)+2/(r-i))),o=[f(n-r)*(n-u)/f(i-r)/(i-u),f(n-i)*f(n-r)/f(i-u)/f(r-u),f(n-i)*(n-u)/f(r-i)/(r-u),(n-i)*f(n-r)*(n-u)/f(i-r)/(i-u),(n-r)*f(n-i)*(n-u)/f(i-r)/(r-u)],h(h(h(h(e(l,o[0]),e(p,o[1])),e(a,o[2])),e(k,o[3])),e(d,o[4]))};numeric.Dopri.prototype.at=function(n){var t,i,r,o=Math.floor,u,f,e;if(typeof n!="number"){for(u=n.length,f=Array(u),t=u-1;t!==-1;--t)f[t]=this.at(n[t]);return f}for(e=this.x,t=0,i=e.length-1;i-t>1;)r=o(.5*(t+i)),e[r]<=n?t=r:i=r;return this._at(n,t)};numeric.dopri=function(n,t,i,r,u,f,e){var kt,et,w,a;typeof u=="undefined"&&(u=1e-6);typeof f=="undefined"&&(f=1e3);var fi=[n],ei=[i],p=[r(n,i)],ot,k,tt,st,at,vt,ni=[],oi=[3/40,9/40],ti=[44/45,-56/15,32/9],yt=[19372/6561,-25360/2187,64448/6561,-212/729],ht=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],ct=[35/384,0,500/1113,125/192,-2187/6784,11/84],it=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384],lt=[1/5,3/10,4/5,8/9,1,1],rt=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],c=0,pt,b,o=(t-n)/10,wt=0,h=numeric.add,s=numeric.mul,d,bt,ai=Math.max,si=Math.min,ci=Math.abs,li=numeric.norminf,hi=Math.pow,ii=numeric.any,ut=numeric.lt,ri=numeric.and,vi=numeric.sub,l,v,ft,y=new numeric.Dopri(fi,ei,p,ni,-1,"");for(typeof e=="function"&&(l=e(n,i));n<t&&wt<f;){if(++wt,n+o>t&&(o=t-n),ot=r(n+lt[0]*o,h(i,s(1/5*o,p[c]))),k=r(n+lt[1]*o,h(h(i,s(oi[0]*o,p[c])),s(oi[1]*o,ot))),tt=r(n+lt[2]*o,h(h(h(i,s(ti[0]*o,p[c])),s(ti[1]*o,ot)),s(ti[2]*o,k))),st=r(n+lt[3]*o,h(h(h(h(i,s(yt[0]*o,p[c])),s(yt[1]*o,ot)),s(yt[2]*o,k)),s(yt[3]*o,tt))),at=r(n+lt[4]*o,h(h(h(h(h(i,s(ht[0]*o,p[c])),s(ht[1]*o,ot)),s(ht[2]*o,k)),s(ht[3]*o,tt)),s(ht[4]*o,st))),d=h(h(h(h(h(i,s(p[c],o*ct[0])),s(k,o*ct[2])),s(tt,o*ct[3])),s(st,o*ct[4])),s(at,o*ct[5])),vt=r(n+o,d),pt=h(h(h(h(h(s(p[c],o*rt[0]),s(k,o*rt[2])),s(tt,o*rt[3])),s(st,o*rt[4])),s(at,o*rt[5])),s(vt,o*rt[6])),bt=typeof pt=="number"?ci(pt):li(pt),bt>u){if(o=.2*o*hi(u/bt,.25),n+o===n){y.msg="Step size became too small";break}continue}if(ni[c]=h(h(h(h(h(h(i,s(p[c],o*it[0])),s(k,o*it[2])),s(tt,o*it[3])),s(st,o*it[4])),s(at,o*it[5])),s(vt,o*it[6])),++c,fi[c]=n+o,ei[c]=d,p[c]=vt,typeof e=="function"&&(et=n,w=n+.5*o,v=e(w,ni[c-1]),ft=ri(ut(l,0),ut(0,v)),ii(ft)||(et=w,w=n+o,l=v,v=e(w,d),ft=ri(ut(l,0),ut(0,v))),ii(ft))){for(var ui,dt,gt=0,g=1,nt=1;;){if(typeof l=="number")a=(nt*v*et-g*l*w)/(nt*v-g*l);else for(a=w,b=l.length-1;b!==-1;--b)l[b]<0&&v[b]>0&&(a=si(a,(nt*v[b]*et-g*l[b]*w)/(nt*v[b]-g*l[b])));if(a<=et||a>=w)break;kt=y._at(a,c-1);dt=e(a,kt);ui=ri(ut(l,0),ut(0,dt));ii(ui)?(w=a,v=dt,ft=ui,nt=1,gt===-1?g*=.5:g=1,gt=-1):(et=a,l=dt,g=1,gt===1?nt*=.5:nt=1,gt=1)}return d=y._at(.5*(n+a),c-1),y.f[c]=r(a,kt),y.x[c]=a,y.y[c]=kt,y.ymid[c-1]=d,y.events=ft,y.iterations=wt,y}n+=o;i=d;l=v;o=si(.8*o*hi(u/bt,.25),4*o)}return y.iterations=wt,y};numeric.LU=function(n,t){t=t||!1;var l=Math.abs,u,r,i,h,a,f,o,e,c,s=n.length,v=s-1,y=new Array(s);for(t||(n=numeric.clone(n)),i=0;i<s;++i){for(o=i,f=n[i],c=l(f[i]),r=i+1;r<s;++r)h=l(n[r][i]),c<h&&(c=h,o=r);for(y[i]=o,o!=i&&(n[i]=n[o],n[o]=f,f=n[i]),a=f[i],u=i+1;u<s;++u)n[u][i]/=a;for(u=i+1;u<s;++u){for(e=n[u],r=i+1;r<v;++r)e[r]-=e[i]*f[r],++r,e[r]-=e[i]*f[r];r===v&&(e[r]-=e[i]*f[r])}}return{LU:n,P:y}};numeric.LUsolve=function(n,t){for(var u,o=n.LU,e=o.length,r=numeric.clone(t),h=n.P,s,f,c,i=e-1;i!==-1;--i)r[i]=t[i];for(i=0;i<e;++i)for(s=h[i],h[i]!==i&&(c=r[i],r[i]=r[s],r[s]=c),f=o[i],u=0;u<i;++u)r[i]-=r[u]*f[u];for(i=e-1;i>=0;--i){for(f=o[i],u=i+1;u<e;++u)r[i]-=r[u]*f[u];r[i]/=f[i]}return r};numeric.solve=function(n,t,i){return numeric.LUsolve(numeric.LU(n,i),t)};numeric.echelonize=function(n){var l=numeric.dim(n),e=l[0],a=l[1],s=numeric.identity(e),v=Array(e),r,t,u,i,f,h,o,c,y=Math.abs,p=numeric.diveq;for(n=numeric.clone(n),r=0;r<e;++r){for(u=0,f=n[r],h=s[r],t=1;t<a;++t)y(f[u])<y(f[t])&&(u=t);for(v[r]=u,p(h,f[u]),p(f,f[u]),t=0;t<e;++t)if(t!==r){for(o=n[t],c=o[u],i=a-1;i!==-1;--i)o[i]-=f[i]*c;for(o=s[t],i=e-1;i!==-1;--i)o[i]-=h[i]*c}}return{I:s,A:n,P:v}};numeric.__solveLP=function(n,t,i,r,u,f,e){for(var ct=numeric.sum,dt=numeric.log,et=numeric.mul,d=numeric.sub,s=numeric.dot,g=numeric.div,lt=numeric.add,y=n.length,l=i.length,a,p=!1,h=1,gt=numeric.transpose(t),ni=numeric.svd,at=numeric.transpose,ti=numeric.leq,vt=Math.sqrt,yt=Math.abs,ii=numeric.muleq,ri=numeric.norminf,ui=numeric.any,pt=Math.min,wt=numeric.all,bt=numeric.gt,v=Array(y),nt=Array(l),fi=numeric.rep([l],1),tt,kt=numeric.solve,w=d(i,s(t,f)),ot=s(n,n),b,o,it,rt,ut,ft,k,st,ht,c=0;c<u;++c){for(o=l-1;o!==-1;--o)nt[o]=g(t[o],w[o]);for(rt=at(nt),o=y-1;o!==-1;--o)v[o]=ct(rt[o]);for(h=.25*yt(ot/s(n,v)),ut=100*vt(ot/s(v,v)),(!isFinite(h)||h>ut)&&(h=ut),b=lt(n,et(h,v)),tt=s(rt,nt),o=y-1;o!==-1;--o)tt[o][o]+=1;for(it=kt(tt,g(b,h),!0),ft=g(w,s(t,it)),k=1,o=l-1;o!==-1;--o)ft[o]<0&&(k=pt(k,-.999*ft[o]));if(a=d(f,et(it,k)),w=d(i,s(t,a)),!wt(bt(w,0)))return{solution:f,message:"",iterations:c};if(f=a,h<r)return{solution:a,message:"",iterations:c};if(e){for(st=s(n,b),ht=s(t,b),p=!0,o=l-1;o!==-1;--o)if(st*ht[o]<0){p=!1;break}}else p=f[y-1]>=0?!1:!0;if(p)return{solution:a,message:"Unbounded",iterations:c}}return{solution:f,message:"maximum iteration count exceeded",iterations:c}};numeric._solveLP=function(n,t,i,r,u){var e=n.length,c=i.length,k=numeric.sum,d=numeric.log,g=numeric.mul,a=numeric.sub,v=numeric.dot,nt=numeric.div,tt=numeric.add,y=numeric.rep([e],0).concat([1]),p=numeric.rep([c,1],-1),w=numeric.blockMatrix([[t,p]]),b=i,l=numeric.rep([e],0).concat(Math.max(0,numeric.sup(numeric.neg(i)))+1),f=numeric.__solveLP(y,w,b,r,u,l,!1),o=numeric.clone(f.solution),h,s;return(o.length=e,h=numeric.inf(a(i,v(t,o))),h<0)?{solution:NaN,message:"Infeasible",iterations:f.iterations}:(s=numeric.__solveLP(n,t,i,r,u-f.iterations,o,!0),s.iterations+=f.iterations,s)};numeric.solveLP=function(n,t,i,r,u,f,e){var rt,p;if(typeof e=="undefined"&&(e=1e3),typeof f=="undefined"&&(f=numeric.epsilon),typeof r=="undefined")return numeric._solveLP(n,t,i,f,e);for(var ut=r.length,k=r[0].length,ft=t.length,l=numeric.echelonize(r),d=numeric.rep([k],0),s=l.P,h=[],o=s.length-1;o!==-1;--o)d[s[o]]=1;for(o=k-1;o!==-1;--o)d[o]===0&&h.push(o);var w=numeric.getRange,et=numeric.linspace(0,ut-1),g=numeric.linspace(0,ft-1),b=w(r,et,h),ot=w(t,g,s),st=w(t,g,h),c=numeric.dot,a=numeric.sub,nt=c(ot,l.I),ht=a(st,c(nt,b)),ct=a(i,c(nt,u)),tt=Array(s.length),it=Array(h.length);for(o=s.length-1;o!==-1;--o)tt[o]=n[s[o]];for(o=h.length-1;o!==-1;--o)it[o]=n[h[o]];var lt=a(it,c(tt,c(l.I,b))),v=numeric._solveLP(lt,ht,ct,f,e),y=v.solution;if(y!==y)return v;for(rt=c(l.I,a(u,c(b,y))),p=Array(n.length),o=s.length-1;o!==-1;--o)p[s[o]]=rt[o];for(o=h.length-1;o!==-1;--o)p[h[o]]=y[o];return{solution:p,message:v.message,iterations:v.iterations}};numeric.MPStoLP=function(n){function h(t){throw new Error("MPStoLP: "+t+"\nLine "+f+": "+n[f]+"\nCurrent state: "+e[v]+"\n");}var a,i,k,d;n instanceof String&&n.split("\n");for(var v=0,e=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],nt=n.length,t,y,p=0,u={},o=[],r=0,c={},l=0,g,w=[],b=[],s=[],f=0;f<nt;++f){for(y=n[f],a=y.match(/\S*/g),i=[],t=0;t<a.length;++t)a[t]!==""&&i.push(a[t]);if(i.length!==0){for(t=0;t<e.length;++t)if(y.substr(0,e[t].length)===e[t])break;if(t<e.length){if(v=t,t===1&&(g=i[1]),t===6)return{name:g,c:w,A:numeric.transpose(b),b:s,rows:u,vars:c};continue}switch(v){case 0:case 1:h("Unexpected line");case 2:switch(i[0]){case"N":p===0?p=i[1]:h("Two or more N rows");break;case"L":u[i[1]]=r;o[r]=1;s[r]=0;++r;break;case"G":u[i[1]]=r;o[r]=-1;s[r]=0;++r;break;case"E":u[i[1]]=r;o[r]=0;s[r]=0;++r;break;default:h("Parse error "+numeric.prettyPrint(i))}break;case 3:for(c.hasOwnProperty(i[0])||(c[i[0]]=l,w[l]=0,b[l]=numeric.rep([r],0),++l),k=c[i[0]],t=1;t<i.length;t+=2){if(i[t]===p){w[k]=parseFloat(i[t+1]);continue}d=u[i[t]];b[k][d]=(o[d]<0?-1:1)*parseFloat(i[t+1])}break;case 4:for(t=1;t<i.length;t+=2)s[u[i[t]]]=(o[u[i[t]]]<0?-1:1)*parseFloat(i[t+1]);break;case 6:h("Internal error")}}}h("Reached end of file without ENDATA")};