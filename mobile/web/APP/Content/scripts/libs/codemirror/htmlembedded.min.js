(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("htmlembedded",function(t,i){function f(n,t){return n.match(o,!1)?(t.token=e,r.token(n,t.scriptState)):u.token(n,t.htmlState)}function e(n,t){return n.match(s,!1)?(t.token=f,u.token(n,t.htmlState)):r.token(n,t.scriptState)}var o=i.scriptStartRegex||/^<%/i,s=i.scriptEndRegex||/^%>/i,r,u;return{startState:function(){return r=r||n.getMode(t,i.scriptingModeSpec),u=u||n.getMode(t,"htmlmixed"),{token:i.startOpen?e:f,htmlState:n.startState(u),scriptState:n.startState(r)}},token:function(n,t){return t.token(n,t)},indent:function(n,t){return n.token==f?u.indent(n.htmlState,t):r.indent?r.indent(n.scriptState,t):void 0},copyState:function(t){return{token:t.token,htmlState:n.copyState(u,t.htmlState),scriptState:n.copyState(r,t.scriptState)}},innerMode:function(n){return n.token==e?{state:n.scriptState,mode:r}:{state:n.htmlState,mode:u}}}},"htmlmixed");n.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});n.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});n.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});n.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})});