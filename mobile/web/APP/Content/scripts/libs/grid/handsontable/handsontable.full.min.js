/*!
 * Handsontable 0.15.1
 * Handsontable is a JavaScript library for editable tables with basic copy-paste compatibility with Excel and Google Docs
 *
 * Copyright (c) 2012-2014 Marcin Warpechowski
 * Copyright 2015 Handsoncode sp. z o.o. <hello@handsontable.com>
 * Licensed under the MIT license.
 * http://handsontable.com/
 *
 * Date: Thu Jun 25 2015 14:04:28 GMT+0200 (CEST)
 */
window.Handsontable={version:"0.15.1",buildDate:"Thu Jun 25 2015 14:04:28 GMT+0200 (CEST)"},function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.Handsontable=n()}}(function(){var n;return function(n,t,i){return function r(n,t,i){function f(e,s){var c,l,h;if(!t[e]){if(!n[e]){if(c=typeof require=="function"&&require,!s&&c)return c(e,!0);if(o)return o(e,!0);if(u[e]&&typeof window[u[e]]!="undefined")return window[u[e]];l=new Error("Cannot find module '"+e+"'");l.code="MODULE_NOT_FOUND";throw l;}h=t[e]={exports:{}};n[e][0].call(h.exports,function(t){var i=n[e][1][t];return f(i?i:t)},h,h.exports,r,n,t,i)}return t[e].exports}for(var o=typeof require=="function"&&require,u=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","pikaday":"Pikaday"}')||{},e=0;e<i.length;e++)f(i[e]);return f}(n,t,i),function(){return Handsontable}}({1:[function(){"use strict";window.jQuery&&function(n,t,i){t.fn.handsontable=function(n){var u,o,f,s,e,r=this.first(),t=r.data("handsontable");if(typeof n!="string")return e=n||{},t?t.updateSettings(e):(t=new i.Core(r[0],e),r.data("handsontable",t),t.init()),r;if(f=[],arguments.length>1)for(u=1,o=arguments.length;u<o;u++)f.push(arguments[u]);if(t)if(typeof t[n]!="undefined")s=t[n].apply(t,f),n==="destroy"&&r.removeData();else throw new Error("Handsontable do not provide action: "+n);return s}}(window,jQuery,Handsontable)},{}],2:[function(n,t,i){"use strict";function o(n,t){var r,a=function(){var r,u,t,i,n;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};r=10;u=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};t={position:"absolute",height:u+"px",width:u+"px","border-radius":parseInt(u/1.5,10)+"px"};for(n in t)t.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=t[n],this.selectionHandles.styles.topLeftHitArea[n]=t[n]);i={position:"absolute",height:r+"px",width:r+"px","border-radius":parseInt(r/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(n in i)i.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRight[n]=i[n],this.selectionHandles.styles.topLeft[n]=i[n]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)},u,c,e,i,f,o,s,l;if(t){for(u=h(n),this.instance=n,this.settings=t,this.main=document.createElement("div"),r=this.main.style,r.position="absolute",r.top=0,r.left=0,c=["top","left","bottom","right","corner"],e=0;e<5;e++)i=c[e],f=document.createElement("DIV"),f.className="wtBorder "+(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(f.className+=" hidden"),r=f.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:t.border.color,r.height=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",r.width=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":t.border.width+"px",this.main.appendChild(f);for(this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Handsontable.mobileBrowser&&a.call(this),this.disappear(),n.wtTable.bordersHolder||(n.wtTable.bordersHolder=document.createElement("div"),n.wtTable.bordersHolder.className="htBorders",n.wtTable.spreader.appendChild(n.wtTable.bordersHolder)),n.wtTable.bordersHolder.insertBefore(this.main,n.wtTable.bordersHolder.firstChild),o=!1,u.addEventListener(document.body,"mousedown",function(){o=!0}),u.addEventListener(document.body,"mouseup",function(){o=!1}),s=0,l=this.main.childNodes.length;s<l;s++)u.addEventListener(this.main.childNodes[s],"mouseenter",function(t){var i,f,r;o&&n.getSetting("hideBorderOnMouseDownOver")&&(t.preventDefault(),t.stopImmediatePropagation(),i=this.getBoundingClientRect(),this.style.display="none",f=function(n){return n.clientY<Math.floor(i.top)?!0:n.clientY>Math.ceil(i.top+i.height)?!0:n.clientX<Math.floor(i.left)?!0:n.clientX>Math.ceil(i.left+i.width)?!0:void 0},r=function(n){f(n)&&(u.removeEventListener(document.body,"mousemove",r),this.style.display="block")},u.addEventListener(document.body,"mousemove",r))})}}Object.defineProperties(i,{WalkontableBorder:{get:function(){return o}},__esModule:{value:!0}});var u,f,e,r=(u=n("./../../../dom.js"),u&&u.__esModule&&u||{"default":u}),h=(f=n("./../../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,s=(e=n("./cell/coords.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords;o.prototype.appear=function(n){var it,rt,ft,et;if(!this.disabled){for(var u=this.instance,k,p,c,w,d,g,h,nt,e,tt,o,f,a,v,b,y,i,ut=function(){return this.instance.selections.area.cellRange&&(b!=this.instance.selections.area.cellRange.to.row||y!=this.instance.selections.area.cellRange.to.col)?!0:!1},ot=function(n,t,i,r){var f=parseInt(this.selectionHandles.styles.topLeft.width,10),u=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-f,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(t-f,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-u/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-u/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(n+r,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(t+i,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+r-u/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+i-u/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",ut.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");a==this.instance.wtSettings.getSetting("fixedRowsTop")||v==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},l=u.cloneOverlay instanceof WalkontableTopOverlay||u.cloneOverlay instanceof WalkontableCornerOverlay?u.getSetting("fixedRowsTop"):u.wtTable.getRenderedRowsCount(),t=0;t<l;t++)if(i=u.wtTable.rowFilter.renderedToSource(t),i>=n[0]&&i<=n[2]){a=i;break}for(t=l-1;t>=0;t--)if(i=u.wtTable.rowFilter.renderedToSource(t),i>=n[0]&&i<=n[2]){b=i;break}for(l=u.wtTable.getRenderedColumnsCount(),t=0;t<l;t++)if(i=u.wtTable.columnFilter.renderedToSource(t),i>=n[1]&&i<=n[3]){v=i;break}for(t=l-1;t>=0;t--)if(i=u.wtTable.columnFilter.renderedToSource(t),i>=n[1]&&i<=n[3]){y=i;break}if(a!==void 0&&v!==void 0)k=a!==b||v!==y,p=u.wtTable.getCell(new s(a,v)),c=k?u.wtTable.getCell(new s(b,y)):p,w=r.offset(p),d=k?r.offset(c):w,g=r.offset(u.wtTable.TABLE),nt=w.top,o=d.top+r.outerHeight(c)-nt,tt=w.left,f=d.left+r.outerWidth(c)-tt,h=nt-g.top-1,e=tt-g.left-1,it=r.getComputedStyle(p),parseInt(it.borderTopWidth,10)>0&&(h+=1,o=o>0?o-1:0),parseInt(it.borderLeftWidth,10)>0&&(e+=1,f=f>0?f-1:0);else{this.disappear();return}this.topStyle.top=h+"px";this.topStyle.left=e+"px";this.topStyle.width=f+"px";this.topStyle.display="block";this.leftStyle.top=h+"px";this.leftStyle.left=e+"px";this.leftStyle.height=o+"px";this.leftStyle.display="block";rt=Math.floor(this.settings.border.width/2);this.bottomStyle.top=h+o-rt+"px";this.bottomStyle.left=e+"px";this.bottomStyle.width=f+"px";this.bottomStyle.display="block";this.rightStyle.top=h+"px";this.rightStyle.left=e+f-rt+"px";this.rightStyle.height=o+1+"px";this.rightStyle.display="block";Handsontable.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||ut.call(this)?this.cornerStyle.display="none":(this.cornerStyle.top=h+o-4+"px",this.cornerStyle.left=e+f-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",y===this.instance.getSetting("totalColumns")-1&&(ft=r.getTrimmingContainer(u.wtTable.TABLE),et=c.offsetLeft+r.outerWidth(c)>=r.innerWidth(ft),et&&(this.cornerStyle.left=Math.floor(e+f-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)));Handsontable.mobileBrowser&&ot.call(this,h,e,f,o)}};o.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";Handsontable.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")};o.prototype.hasSetting=function(n){return typeof n=="function"?n():!!n};window.WalkontableBorder=o},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./cell/coords.js":5}],3:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewportColumnsCalculator:{get:function(){return u}},__esModule:{value:!0}});var r=new WeakMap,u=function(n,t,i,u,f,e,o){r.set(this,{viewportWidth:n,scrollOffset:t,totalColumns:i,columnWidthFn:u,overrideFn:f,onlyFullyVisible:e});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=o;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()},f=u;$traceurRuntime.createClass(u,{calculate:function(){for(var h,t=0,c=!0,u=[],f,i=r.get(this),s=i.onlyFullyVisible,l=i.overrideFn,e=i.scrollOffset,a=i.totalColumns,o=i.viewportWidth,n=0;n<a;n++)if(f=this._getColumnWidth(n),t<=e&&!s&&(this.startColumn=n),t>=e&&t+f<=e+o&&(this.startColumn==null&&(this.startColumn=n),this.endColumn=n),u.push(t),t+=f,s||(this.endColumn=n),t>=e+o){c=!1;break}if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;)if(h=u[this.endColumn]+f-u[this.startColumn-1],(h<=o||!s)&&this.startColumn--,h>o)break;this.startColumn!==null&&l&&l(this);this.startPosition=u[this.startColumn];this.startPosition==void 0&&(this.startPosition=null);this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(n){var t;if(this.stretch!=="none"){var i=0,f,u,o=r.get(this),e=o.totalColumns;for(t=0;t<e;t++)f=this._getColumnWidth(t),i+=f;this.totalTargetWidth=n;u=i-n;this.stretch==="all"&&u<0?(this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):this.stretch==="last"&&n!==Infinity&&(this.stretchLastWidth=-u+this._getColumnWidth(e-1))}},getStretchedColumnWidth:function(n,t){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(n,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(n)),i},_getStretchedAllColumnWidth:function(n,t){var u=0,f=r.get(this),e=f.totalColumns,i;if(this.stretchAllColumnsWidth[n]||(this.stretchAllColumnsWidth[n]=Math.round(t*this.stretchAllRatio)),this.stretchAllColumnsWidth.length===e&&this.needVerifyLastColumnWidth){for(this.needVerifyLastColumnWidth=!1,i=0;i<this.stretchAllColumnsWidth.length;i++)u+=this.stretchAllColumnsWidth[i];u!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-u)}return this.stretchAllColumnsWidth[n]},_getStretchedLastColumnWidth:function(n){var t=r.get(this),i=t.totalColumns;return n===i-1?this.stretchLastWidth:null},_getColumnWidth:function(n){var t=r.get(this).columnWidthFn(n);return t===undefined&&(t=f.DEFAULT_WIDTH),t}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=u},{}],4:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewportRowsCalculator:{get:function(){return r}},__esModule:{value:!0}});var u=new WeakMap,r=function(n,t,i,r,f,e){u.set(this,{viewportHeight:n,scrollOffset:t,totalRows:i,rowHeightFn:r,overrideFn:f,onlyFullyVisible:e});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()},f=r;$traceurRuntime.createClass(r,{calculate:function(){for(var r,c,t=0,l=!0,e=[],i=u.get(this),h=i.onlyFullyVisible,a=i.overrideFn,y=i.rowHeightFn,o=i.scrollOffset,v=i.totalRows,s=i.viewportHeight,n=0;n<v;n++)if(r=y(n),r===undefined&&(r=f.DEFAULT_HEIGHT),t<=o&&!h&&(this.startRow=n),t>=o&&t+r<=o+s&&(this.startRow===null&&(this.startRow=n),this.endRow=n),e.push(t),t+=r,h||(this.endRow=n),t>=o+s){l=!1;break}if(this.endRow===v-1&&l)for(this.startRow=this.endRow;this.startRow>0;)if(c=e[this.endRow]+r-e[this.startRow-1],(c<=s||!h)&&this.startRow--,c>=s)break;this.startRow!==null&&a&&a(this);this.startPosition=e[this.startRow];this.startPosition==void 0&&(this.startPosition=null);this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}});window.WalkontableViewportRowsCalculator=r},{}],5:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableCellCoords:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t){typeof n!="undefined"&&typeof t!="undefined"?(this.row=n,this.col=t):(this.row=null,this.col=null)};$traceurRuntime.createClass(r,{isValid:function(n){return this.row<0||this.col<0?!1:this.row>=n.getSetting("totalRows")||this.col>=n.getSetting("totalColumns")?!1:!0},isEqual:function(n){return n===this?!0:this.row===n.row&&this.col===n.col},isSouthEastOf:function(n){return this.row>=n.row&&this.col>=n.col},isNorthWestOf:function(n){return this.row<=n.row&&this.col<=n.col},isSouthWestOf:function(n){return this.row>=n.row&&this.col<=n.col},isNorthEastOf:function(n){return this.row<=n.row&&this.col>=n.col}},{});window.WalkontableCellCoords=r},{}],6:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableCellRange:{get:function(){return f}},__esModule:{value:!0}});var u,r=(u=n("./../cell/coords.js"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords,f=function(n,t,i){this.highlight=n;this.from=t;this.to=i},e=f;$traceurRuntime.createClass(f,{isValid:function(n){return this.from.isValid(n)&&this.to.isValid(n)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<0&&(n.row=0),n.col<0&&(n.col=0),t.row<=n.row&&i.row>=n.row&&t.col<=n.col&&i.col>=n.col},includesRange:function(n){return this.includes(n.getTopLeftCorner())&&this.includes(n.getBottomRightCorner())},isEqual:function(n){return Math.min(this.from.row,this.to.row)==Math.min(n.from.row,n.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(n.from.row,n.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(n.from.col,n.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(n.from.col,n.to.col)},overlaps:function(n){return n.isSouthEastOf(this.getTopLeftCorner())&&n.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(n){return this.getTopLeftCorner().isSouthEastOf(n)||this.getBottomRightCorner().isSouthEastOf(n)},isNorthWestOf:function(n){return this.getTopLeftCorner().isNorthWestOf(n)||this.getBottomRightCorner().isNorthWestOf(n)},expand:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<t.row||n.col<t.col||n.row>i.row||n.col>i.col?(this.from=new r(Math.min(t.row,n.row),Math.min(t.col,n.col)),this.to=new r(Math.max(i.row,n.row),Math.max(i.col,n.col)),!0):!1},expandByRange:function(n){if(this.includesRange(n)||!this.overlaps(n))return!1;var u=this.getTopLeftCorner(),f=this.getBottomRightCorner(),p=this.getTopRightCorner(),w=this.getBottomLeftCorner(),o=n.getTopLeftCorner(),s=n.getBottomRightCorner(),h=Math.min(u.row,o.row),c=Math.min(u.col,o.col),l=Math.max(f.row,s.row),a=Math.max(f.col,s.col),t=new r(h,c),i=new r(l,a),v=new e(t,t,i).isCorner(this.from,n),y=n.isEqual(new e(t,t,i));return v&&!y&&(this.from.col>t.col&&(t.col=a,i.col=c),this.from.row>t.row&&(t.row=l,i.row=h)),this.from=t,this.to=i,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(n){switch(n){case"NW-SE":this.from=this.getTopLeftCorner();this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner();this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner();this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner();this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(n,t){return t&&t.includes(n)&&(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))?!0:n.isEqual(this.getTopLeftCorner())||n.isEqual(this.getTopRightCorner())||n.isEqual(this.getBottomLeftCorner())||n.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(n,t){if(!(n instanceof r))return!1;if(t&&t.includes(n)){if(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))return this.getTopLeftCorner()}return n.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():n.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():n.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():n.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(n){if(!this.includesRange(n))return[];var i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(n.from.row,n.to.row),bottom:Math.max(n.from.row,n.to.row),left:Math.min(n.from.col,n.to.col),right:Math.max(n.from.col,n.to.col)},t=[];return i.top==r.top&&t.push("top"),i.right==r.right&&t.push("right"),i.bottom==r.bottom&&t.push("bottom"),i.left==r.left&&t.push("left"),t},getInner:function(){for(var n,i=this.getTopLeftCorner(),u=this.getBottomRightCorner(),f=[],t=i.row;t<=u.row;t++)for(n=i.col;n<=u.col;n++)this.from.row===t&&this.from.col===n||this.to.row===t&&this.to.col===n||f.push(new r(t,n));return f},getAll:function(){for(var n,t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),f=[],u=t.row;u<=i.row;u++)for(n=t.col;n<=i.col;n++)t.row===u&&t.col===n?f.push(t):i.row===u&&i.col===n?f.push(i):f.push(new r(u,n));return f},forAll:function(n){for(var t,f,r=this.getTopLeftCorner(),u=this.getBottomRightCorner(),i=r.row;i<=u.row;i++)for(t=r.col;t<=u.col;t++)if(f=n(i,t),f===!1)return}},{});window.WalkontableCellRange=f},{"./../cell/coords.js":5}],7:[function(n,t,i){"use strict";Object.defineProperties(i,{Walkontable:{get:function(){return l}},__esModule:{value:!0}});var r,u,f,e,o,s,h,c,a=(r=n("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),w=(u=n("./../../../helpers.js"),u&&u.__esModule&&u||{"default":u}).randomString,v=(f=n("./event.js"),f&&f.__esModule&&f||{"default":f}).WalkontableEvent,b=(e=n("./overlays.js"),e&&e.__esModule&&e||{"default":e}).WalkontableOverlays,y=(o=n("./scroll.js"),o&&o.__esModule&&o||{"default":o}).WalkontableScroll,k=(s=n("./settings.js"),s&&s.__esModule&&s||{"default":s}).WalkontableSettings,p=(h=n("./table.js"),h&&h.__esModule&&h||{"default":h}).WalkontableTable,d=(c=n("./viewport.js"),c&&c.__esModule&&c||{"default":c}).WalkontableViewport,l=function(n){var i=[],t,r;if(this.guid="wt_"+w(),n.cloneSource?(this.cloneSource=n.cloneSource,this.cloneOverlay=n.cloneOverlay,this.wtSettings=n.cloneSource.wtSettings,this.wtTable=new p(this,n.table,n.wtRootElement),this.wtScroll=new y(this),this.wtViewport=n.cloneSource.wtViewport,this.wtEvent=new v(this),this.selections=this.cloneSource.selections):(this.wtSettings=new k(this,n),this.wtTable=new p(this,n.table),this.wtScroll=new y(this),this.wtViewport=new d(this),this.wtEvent=new v(this),this.selections=this.getSetting("selections"),this.wtOverlays=new b(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)i.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(n,t){a.fastInnerText(t,i[n])}])}this.drawn=!1;this.drawInterrupted=!1};$traceurRuntime.createClass(l,{draw:function(){var n=arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,n||a.isVisible(this.wtTable.TABLE)?this.wtTable.draw(n):this.drawInterrupted=!0,this},getCell:function(n){var r=arguments[1]!==void 0?arguments[1]:!1,t,i;return r?(t=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedColumnsLeft"),n.row<t&&n.col<i)?this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(n):n.row<t?this.wtOverlays.topOverlay.clone.wtTable.getCell(n):n.col<i?this.wtOverlays.leftOverlay.clone.wtTable.getCell(n):this.wtTable.getCell(n):this.wtTable.getCell(n)},update:function(n,t){return this.wtSettings.update(n,t)},scrollVertical:function(n){return this.wtOverlays.topOverlay.scrollTo(n),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(n){return this.wtOverlays.leftOverlay.scrollTo(n),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(n){return this.wtScroll.scrollViewport(n),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},getSetting:function(n,t,i,r,u){return this.wtSettings.getSetting(n,t,i,r,u)},hasSetting:function(n){return this.wtSettings.has(n)},destroy:function(){this.wtOverlays.destroy();this.wtEvent&&this.wtEvent.destroy()}},{});window.Walkontable=l},{"./../../../dom.js":27,"./../../../helpers.js":42,"./event.js":8,"./overlays.js":16,"./scroll.js":17,"./settings.js":19,"./table.js":20,"./viewport.js":22}],8:[function(n,t,i){"use strict";function e(n){var t=this,i=o(n),u,f;this.instance=n;u=[null,null];this.dblClickTimeout=[null,null];var e=function(n){var i=t.parentCell(n.realTarget);r.hasClass(n.realTarget,"corner")?t.instance.getSetting("onCellCornerMouseDown",n,n.realTarget):i.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",n,i.coords,i.TD,t.instance);n.button!==2&&i.TD&&(u[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){u[0]=null},1e3))},s=function(){t.instance.touchMoving=!0},l,a=function(n){var r=this;i.addEventListener(this,"touchmove",s);t.checkIfTouchMove=setTimeout(function(){if(t.instance.touchMoving===!0){t.instance.touchMoving=void 0;i.removeEventListener("touchmove",s,!1);return}e(n)},30)},h,v=function(n){var u,i;t.instance.hasSetting("onCellMouseOver")&&(u=t.instance.wtTable.TABLE,i=r.closest(n.realTarget,["TD","TH"],u),i&&i!==h&&r.isChildOf(i,u)&&(h=i,t.instance.getSetting("onCellMouseOver",n,t.instance.wtTable.getCoords(i),i,t.instance)))},c=function(n){if(n.button!==2){var i=t.parentCell(n.realTarget);i.TD===u[0]&&i.TD===u[1]?(r.hasClass(n.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",n,i.coords,i.TD,t.instance):t.instance.getSetting("onCellDblClick",n,i.coords,i.TD,t.instance),u[0]=null,u[1]=null):i.TD===u[0]&&(u[1]=i.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){u[1]=null},500))}},y=function(n){clearTimeout(l);n.preventDefault();c(n)};i.addEventListener(this.instance.wtTable.holder,"mousedown",e);i.addEventListener(this.instance.wtTable.TABLE,"mouseover",v);i.addEventListener(this.instance.wtTable.holder,"mouseup",c);this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!t.instance.wtTable.isWorkingOnClone()&&(f="."+this.instance.wtTable.holder.parentNode.className.split(" ").join("."),i.addEventListener(this.instance.wtTable.holder,"touchstart",function(n){t.instance.touchApplied=!0;r.isChildOf(n.target,f)&&a.call(n.target,n)}),i.addEventListener(this.instance.wtTable.holder,"touchend",function(n){t.instance.touchApplied=!1;r.isChildOf(n.target,f)&&y.call(n.target,n)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout);t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll");t.instance.momentumScrolling.ongoing=!0;t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)}));i.addEventListener(window,"resize",function(){t.instance.getSetting("stretchH")!=="none"&&t.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);i.clear()}}Object.defineProperties(i,{WalkontableEvent:{get:function(){return e}},__esModule:{value:!0}});var u,f,r=(u=n("./../../../dom.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./../../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager;e.prototype.parentCell=function(n){var t={},u=this.instance.wtTable.TABLE,i=r.closest(n,["TD","TH"],u);return i&&r.isChildOf(i,u)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):r.hasClass(n,"wtBorder")&&r.hasClass(n,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):r.hasClass(n,"wtBorder")&&r.hasClass(n,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t};window.WalkontableEvent=e},{"./../../../dom.js":27,"./../../../eventManager.js":41}],9:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableColumnFilter:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t,i){this.offset=n;this.total=t;this.countTH=i};$traceurRuntime.createClass(r,{offsetted:function(n){return n+this.offset},unOffsetted:function(n){return n-this.offset},renderedToSource:function(n){return this.offsetted(n)},sourceToRendered:function(n){return this.unOffsetted(n)},offsettedTH:function(n){return n-this.countTH},unOffsettedTH:function(n){return n+this.countTH},visibleRowHeadedColumnToSourceColumn:function(n){return this.renderedToSource(this.offsettedTH(n))},sourceColumnToVisibleRowHeadedColumn:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}},{});window.WalkontableColumnFilter=r},{}],10:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableRowFilter:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t,i){this.offset=n;this.total=t;this.countTH=i};$traceurRuntime.createClass(r,{offsetted:function(n){return n+this.offset},unOffsetted:function(n){return n-this.offset},renderedToSource:function(n){return this.offsetted(n)},sourceToRendered:function(n){return this.unOffsetted(n)},offsettedTH:function(n){return n-this.countTH},unOffsettedTH:function(n){return n+this.countTH},visibleColHeadedRowToSourceRow:function(n){return this.renderedToSource(this.offsettedTH(n))},sourceRowToVisibleColHeadedRow:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}},{});window.WalkontableRowFilter=r},{}],11:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableOverlay:{get:function(){return o}},__esModule:{value:!0}});var r,u,f,s=(r=n("./../../../../dom.js"),r&&r.__esModule&&r||{"default":r}),h=(u=n("./../../../../helpers.js"),u&&u.__esModule&&u||{"default":u}).defineGetter,c=(f=n("./../../../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,o=function(n){h(this,"wot",n,{writable:!1});this.instance=this.wot;this.type="";this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=s.getTrimmingContainer(this.hider.parentNode.parentNode);this.mainTableScrollableElement=s.getScrollableElement(this.wot.wtTable.TABLE);this.needFullRender=this.shouldBeRendered();this.isElementSizesAdjusted=!1},e=o;$traceurRuntime.createClass(o,{shouldBeRendered:function(){return!0},makeClone:function(n){if(e.CLONE_TYPES.indexOf(n)===-1)throw new Error('Clone type "'+n+'" is not supported.');var t=document.createElement("DIV"),i=document.createElement("TABLE");return t.className="ht_clone_"+n+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden",i.className=this.wot.wtTable.TABLE.className,t.appendChild(i),this.type=n,this.wot.wtTable.wtRootElement.parentNode.appendChild(t),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:i})},refresh:function(){var t=arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(t);this.needFullRender=n},destroy:function(){c(this.clone).clear()}},{get CLONE_TOP(){return"top"},get CLONE_LEFT(){return"left"},get CLONE_CORNER(){return"corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[e.CLONE_TOP,e.CLONE_LEFT,e.CLONE_CORNER,e.CLONE_DEBUG]}});window.WalkontableOverlay=o},{"./../../../../dom.js":27,"./../../../../eventManager.js":41,"./../../../../helpers.js":42}],12:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableCornerOverlay:{get:function(){return f}},__esModule:{value:!0}});var r,u,e=(r=n("./../../../../dom.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./_base.js"),u&&u.__esModule&&u||{"default":u}).WalkontableOverlay,f=function(n){$traceurRuntime.superConstructor(s).call(this,n);this.clone=this.makeClone(o.CLONE_CORNER)},s=f;$traceurRuntime.createClass(f,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},resetFixedPosition:function(){if(this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,i=e.outerHeight(this.clone.wtTable.TABLE),r=e.outerWidth(this.clone.wtTable.TABLE);if(this.trimmingContainer===window){var t=this.wot.wtTable.hider.getBoundingClientRect(),u=Math.ceil(t.top),f=Math.ceil(t.left),h=Math.ceil(t.bottom),c=Math.ceil(t.right),o,s;o=f<0&&c-n.offsetWidth>0?-f+"px":"0";s=u<0&&h-n.offsetHeight>0?-u+"px":"0";e.setOverlayPosition(n,o,s)}n.style.height=(i===0?i:i+4)+"px";n.style.width=(r===0?r:r+4)+"px"}}},{},o);window.WalkontableCornerOverlay=f},{"./../../../../dom.js":27,"./_base.js":11}],13:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableDebugOverlay:{get:function(){return f}},__esModule:{value:!0}});var r,u,o=(r=n("./../../../../dom.js"),r&&r.__esModule&&r||{"default":r}),e=(u=n("./_base.js"),u&&u.__esModule&&u||{"default":u}).WalkontableOverlay,f=function(n){$traceurRuntime.superConstructor(s).call(this,n);this.clone=this.makeClone(e.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";o.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},s=f;$traceurRuntime.createClass(f,{},{},e);window.WalkontableDebugOverlay=f},{"./../../../../dom.js":27,"./_base.js":11}],14:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableLeftOverlay:{get:function(){return e}},__esModule:{value:!0}});var u,f,r=(u=n("./../../../../dom.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./_base.js"),f&&f.__esModule&&f||{"default":f}).WalkontableOverlay,e=function(n){$traceurRuntime.superConstructor(s).call(this,n);this.clone=this.makeClone(o.CLONE_LEFT)},s=e;$traceurRuntime.createClass(e,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?!0:!1},resetFixedPosition:function(){var u,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(u=this.clone.wtTable.holder.parentNode,i=0,this.trimmingContainer===window){var f=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(f.left),o=Math.ceil(f.right),n,t;t=this.wot.wtTable.hider.style.top;t=t===""?0:t;n=e<0&&o-u.offsetWidth>0?-e:0;i=n;n=n+"px";r.setOverlayPosition(u,n,t)}else i=this.getScrollPosition();this.adjustHeaderBordersPosition(i)}},setScrollPosition:function(n){this.mainTableScrollableElement===window?window.scrollTo(n,r.getWindowScrollTop()):this.mainTableScrollableElement.scrollLeft=n},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(n,t){for(var i=0,r=this.wot.wtSettings.defaultColumnWidth;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n++;return i},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1;(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),n||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var i=this.wot.wtTable.holder,u=i.clientHeight!==i.offsetHeight?r.getScrollbarWidth():0,f=this.clone.wtTable.holder.parentNode,t=f.style,n;this.trimmingContainer!==window&&(t.height=this.wot.wtViewport.getWorkspaceHeight()-u+"px");this.clone.wtTable.holder.style.height=t.height;n=r.outerWidth(this.clone.wtTable.TABLE);t.width=(n===0?n:n+4)+"px"},adjustRootChildsSize:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;n===0&&(n=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+n+"px"},applyToDOM:function(){var n=this.wot.getSetting("totalColumns");if(this.isElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.top=typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""},scrollTo:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetWidth!==u.clientWidth&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),n);i+=f;this.setScrollPosition(i)},getTableParentOffset:function(){return this.trimmingContainer===window?this.wot.wtTable.holderOffset.left:0},getScrollPosition:function(){return r.getScrollLeft(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(n){if(this.wot.getSetting("fixedColumnsLeft")===0&&this.wot.getSetting("rowHeaders").length>0){var t=this.wot.wtTable.holder.parentNode,i=r.hasClass(t,"innerBorderLeft");n?r.addClass(t,"innerBorderLeft"):r.removeClass(t,"innerBorderLeft");(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize()}}},{},o);window.WalkontableLeftOverlay=e},{"./../../../../dom.js":27,"./_base.js":11}],15:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableTopOverlay:{get:function(){return e}},__esModule:{value:!0}});var u,f,r=(u=n("./../../../../dom.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./_base.js"),f&&f.__esModule&&f||{"default":f}).WalkontableOverlay,e=function(n){$traceurRuntime.superConstructor(s).call(this,n);this.clone=this.makeClone(o.CLONE_TOP)},s=e;$traceurRuntime.createClass(e,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?!0:!1},resetFixedPosition:function(){var u,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(u=this.clone.wtTable.holder.parentNode,i=0,this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var f=this.wot.wtTable.hider.getBoundingClientRect(),e=Math.ceil(f.top),o=Math.ceil(f.bottom),n,t;n=this.wot.wtTable.hider.style.left;n=n===""?0:n;t=e<0&&o-u.offsetHeight>0?-e:0;i=t;t=t+"px";r.setOverlayPosition(u,n,t)}else i=this.getScrollPosition();this.adjustHeaderBordersPosition(i)}},setScrollPosition:function(n){this.mainTableScrollableElement===window?window.scrollTo(r.getWindowScrollLeft(),n):this.mainTableScrollableElement.scrollTop=n},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(n,t){for(var i=0,r=this.wot.wtSettings.settings.defaultRowHeight;n<t;)i+=this.wot.wtTable.getRowHeight(n)||r,n++;return i},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1;(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildsSize(),n||(this.isElementSizesAdjusted=!0))},adjustRootElementSize:function(){var i=this.wot.wtTable.holder,u=i.clientWidth!==i.offsetWidth?r.getScrollbarWidth():0,f=this.clone.wtTable.holder.parentNode,t=f.style,n;this.trimmingContainer!==window&&(t.width=this.wot.wtViewport.getWorkspaceWidth()-u+"px");this.clone.wtTable.holder.style.width=t.width;n=r.outerHeight(this.clone.wtTable.TABLE);t.height=(n===0?n:n+4)+"px"},adjustRootChildsSize:function(){var n=r.getScrollbarWidth();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"},applyToDOM:function(){var n=this.wot.getSetting("totalRows");if(this.isElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""},scrollTo:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,f=0;t&&u.offsetHeight!==u.clientHeight&&(f=r.getScrollbarWidth());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),n);i+=f;this.setScrollPosition(i)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return r.getScrollTop(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(n){var t,i,u;this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0&&(t=this.wot.wtTable.holder.parentNode,i=r.hasClass(t,"innerBorderTop"),n?r.addClass(t,"innerBorderTop"):r.removeClass(t,"innerBorderTop"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize());this.wot.getSetting("rowHeaders").length===0&&(u=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)"),u&&(u.style["border-left-width"]=0))}},{},o);window.WalkontableTopOverlay=e},{"./../../../../dom.js":27,"./_base.js":11}],16:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableOverlays:{get:function(){return c}},__esModule:{value:!0}});var u,f,e,o,s,h,r=(u=n("./../../../dom.js"),u&&u.__esModule&&u||{"default":u}),l=(f=n("./../../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).EventManager,a=(e=n("./overlay/corner.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCornerOverlay,v=(o=n("./overlay/debug.js"),o&&o.__esModule&&o||{"default":o}).WalkontableDebugOverlay,y=(s=n("./overlay/left.js"),s&&s.__esModule&&s||{"default":s}).WalkontableLeftOverlay,p=(h=n("./overlay/top.js"),h&&h.__esModule&&h||{"default":h}).WalkontableTopOverlay,c=function(n){this.wot=n;this.instance=this.wot;this.eventManager=new l(this.wot);this.wot.update("scrollbarWidth",r.getScrollbarWidth());this.wot.update("scrollbarHeight",r.getScrollbarWidth());this.mainTableScrollableElement=r.getScrollableElement(this.wot.wtTable.TABLE);this.topOverlay=new p(this.wot);this.leftOverlay=new y(this.wot);this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=new a(this.wot));this.wot.getSetting("debug")&&(this.debug=new v(this.wot));this.destroyed=!1;this.keyPressed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},left:{top:0,left:null}};this.registerListeners()};$traceurRuntime.createClass(c,{refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0);this.topOverlay.onScroll();this.leftOverlay.onScroll()}},registerListeners:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(){return n.onKeyDown()});this.eventManager.addEventListener(document.documentElement,"keyup",function(){return n.onKeyUp()});this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(t){return n.onTableScroll(t)});this.topOverlay.needFullRender&&(this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}),this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}));this.leftOverlay.needFullRender&&(this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}),this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}));this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&this.eventManager.addEventListener(window,"wheel",function(t){var i,r=t.wheelDeltaY||t.deltaY,u=t.wheelDeltaX||t.deltaX;n.topOverlay.clone.wtTable.holder.contains(t.target)?i="top":n.leftOverlay.clone.wtTable.holder.contains(t.target)&&(i="left");i=="top"&&r!==0?t.preventDefault():i=="left"&&u!==0&&t.preventDefault()})},onTableScroll:function(n){Handsontable.mobileBrowser||(!this.keyPressed||this.mainTableScrollableElement===window||n.target.contains(this.mainTableScrollableElement))&&(n.type==="scroll"?this.syncScrollPositions(n):this.translateMouseWheelToScroll(n))},onKeyDown:function(){this.keyPressed=!0},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(n){for(var u=this.topOverlay.clone.wtTable.holder,f=this.leftOverlay.clone.wtTable.holder,r={type:"wheel"},t=n.target,e=n.wheelDeltaY||-1*n.deltaY,o=n.wheelDeltaX||-1*n.deltaX,i;t!=document&&t!=null;){if(t.className.indexOf("wtHolder")>-1){i=t;break}t=t.parentNode}return r.target=i,i==u?this.syncScrollPositions(r,-.2*e):i==f&&this.syncScrollPositions(r,-.2*o),!1},syncScrollPositions:function(n){var e=arguments[1]!==void 0?arguments[1]:null;if(!this.destroyed){if(arguments.length===0){this.syncScrollWithMaster();return}var f=this.mainTableScrollableElement,i=n.target,t=0,u=!1,o,s;this.topOverlay.needFullRender&&(o=this.topOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(s=this.leftOverlay.clone.wtTable.holder);i===document&&(i=window);i===f?(t=r.getScrollLeft(i),this.overlayScrollPositions.master.left!==t&&(this.overlayScrollPositions.master.left=t,u=!0,o&&(o.scrollLeft=t)),t=r.getScrollTop(i),this.overlayScrollPositions.master.top!==t&&(this.overlayScrollPositions.master.top=t,u=!0,s&&(s.scrollTop=t))):i===o?(t=r.getScrollLeft(i),this.overlayScrollPositions.top.left!==t&&(this.overlayScrollPositions.top.left=t,u=!0,f.scrollLeft=t),e!==null&&(u=!0,f.scrollTop+=e)):i===s&&(t=r.getScrollTop(i),this.overlayScrollPositions.left.top!==t&&(this.overlayScrollPositions.left.top=t,u=!0,f.scrollTop=t),e!==null&&(u=!0,f.scrollLeft+=e));!this.keyPressed&&u&&n.type==="scroll"&&this.refreshAll()}},syncScrollWithMaster:function(){var n=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n.scrollLeft);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n.scrollTop)},destroy:function(){this.eventManager.clear();this.topOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0},refresh:function(){var n=arguments[0]!==void 0?arguments[0]:!1;if(this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,i=t.clientWidth,r=t.clientHeight;(i!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.leftOverlay.refresh(n);this.topOverlay.refresh(n);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(n);this.debug&&this.debug.refresh(n)},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1,i=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),u=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),t=this.wot.wtTable.hider.style;t.width=u+this.leftOverlay.sumCellSizes(0,i)+"px";t.height=f+this.topOverlay.sumCellSizes(0,r)+1+"px";this.topOverlay.adjustElementsSize(n);this.leftOverlay.adjustElementsSize(n)},applyToDOM:function(){this.topOverlay.isElementSizesAdjusted&&this.leftOverlay.isElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},{});window.WalkontableOverlays=c},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15}],17:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableScroll:{get:function(){return r}},__esModule:{value:!0}});var r=function(n){this.wot=n;this.instance=n};$traceurRuntime.createClass(r,{scrollViewport:function(n){if(this.wot.drawn){var t=this.wot.getSetting("totalRows"),i=this.wot.getSetting("totalColumns");if(n.row<0||n.row>t-1)throw new Error("row "+n.row+" does not exist");if(n.col<0||n.col>i-1)throw new Error("column "+n.col+" does not exist");n.row>this.instance.wtTable.getLastVisibleRow()?this.wot.wtOverlays.topOverlay.scrollTo(n.row,!0):n.row>=this.instance.getSetting("fixedRowsTop")&&n.row<this.instance.wtTable.getFirstVisibleRow()&&this.wot.wtOverlays.topOverlay.scrollTo(n.row);n.col>this.instance.wtTable.getLastVisibleColumn()?this.wot.wtOverlays.leftOverlay.scrollTo(n.col,!0):n.col>=this.instance.getSetting("fixedColumnsLeft")&&n.col<this.instance.wtTable.getFirstVisibleColumn()&&this.wot.wtOverlays.leftOverlay.scrollTo(n.col)}}},{});window.WalkontableScroll=r},{}],18:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableSelection:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e,o=(r=n("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),h=(u=n("./border.js"),u&&u.__esModule&&u||{"default":u}).WalkontableBorder,c=(f=n("./cell/coords.js"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords,l=(e=n("./cell/range.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCellRange,s=function(n,t){this.settings=n;this.cellRange=t||null;this.instanceBorders={}};$traceurRuntime.createClass(s,{getBorder:function(n){if(this.instanceBorders[n.guid])return this.instanceBorders[n.guid];this.instanceBorders[n.guid]=new h(n,this.settings)},isEmpty:function(){return this.cellRange===null},add:function(n){this.isEmpty()?this.cellRange=new l(n,n,n):this.cellRange.expand(n)},replace:function(n,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(n))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(n))return this.cellRange.to=t,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var n=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[n.row,n.col,t.row,t.col]},addClassAtCoords:function(n,t,i,r){var u=n.wtTable.getCell(new c(t,i));typeof u=="object"&&o.addClass(u,r)},draw:function(n){var h,f,e,s,c;if(this.isEmpty()){this.settings.border&&(h=this.getBorder(n),h&&h.disappear());return}var a=n.wtTable.getRenderedRowsCount(),l=n.wtTable.getRenderedColumnsCount(),t=this.getCorners(),r,i,u;for(f=0;f<l;f++)i=n.wtTable.columnFilter.renderedToSource(f),i>=t[1]&&i<=t[3]&&(u=n.wtTable.getColumnHeader(i),u&&this.settings.highlightColumnClassName&&o.addClass(u,this.settings.highlightColumnClassName));for(e=0;e<a;e++)for(r=n.wtTable.rowFilter.renderedToSource(e),r>=t[0]&&r<=t[2]&&(u=n.wtTable.getRowHeader(r),u&&this.settings.highlightRowClassName&&o.addClass(u,this.settings.highlightRowClassName)),s=0;s<l;s++)i=n.wtTable.columnFilter.renderedToSource(s),r>=t[0]&&r<=t[2]&&i>=t[1]&&i<=t[3]?this.settings.className&&this.addClassAtCoords(n,r,i,this.settings.className):r>=t[0]&&r<=t[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(n,r,i,this.settings.highlightRowClassName):i>=t[1]&&i<=t[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(n,r,i,this.settings.highlightColumnClassName);n.getSetting("onBeforeDrawBorders",t,this.settings.className);this.settings.border&&(c=this.getBorder(n),c&&c.appear(t))}},{});window.WalkontableSelection=s},{"./../../../dom.js":27,"./border.js":2,"./cell/coords.js":5,"./cell/range.js":6}],19:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableSettings:{get:function(){return u}},__esModule:{value:!0}});var r,f=(r=n("./../../../dom.js"),r&&r.__esModule&&r||{"default":r}),u=function(n,t){var r=this,i;this.wot=n;this.instance=n;this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(n,t,i){var u=r.getSetting("data",n,t);f.fastInnerText(i,u===void 0||u===null?"":u)},columnWidth:function(){return},rowHeight:function(){return},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1};this.settings={};for(i in this.defaults)if(this.defaults.hasOwnProperty(i))if(t[i]!==void 0)this.settings[i]=t[i];else if(this.defaults[i]===void 0)throw new Error('A required setting "'+i+'" was not provided');else this.settings[i]=this.defaults[i]};$traceurRuntime.createClass(u,{update:function(n,t){if(t===void 0)for(var i in n)n.hasOwnProperty(i)&&(this.settings[i]=n[i]);else this.settings[n]=t;return this.wot},getSetting:function(n,t,i,r,u){return typeof this.settings[n]=="function"?this.settings[n](t,i,r,u):t!==void 0&&Array.isArray(this.settings[n])?this.settings[n][t]:this.settings[n]},has:function(n){return!!this.settings[n]}},{});window.WalkontableSettings=u},{"./../../../dom.js":27}],20:[function(n,t,i){"use strict";function r(n,t){var i,f,e,r,o;this.instance=n;this.TABLE=t;u.removeTextNodes(this.TABLE);i=this.TABLE.parentNode;i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(f=document.createElement("DIV"),f.className="wtSpreader",i&&i.insertBefore(f,this.TABLE),f.appendChild(this.TABLE));this.spreader=this.TABLE.parentNode;this.spreader.style.position="relative";i=this.spreader.parentNode;i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(e=document.createElement("DIV"),e.className="wtHider",i&&i.insertBefore(e,this.spreader),e.appendChild(this.spreader));this.hider=this.spreader.parentNode;i=this.hider.parentNode;i&&i.nodeType===1&&u.hasClass(i,"wtHolder")||(r=document.createElement("DIV"),r.style.position="relative",r.className="wtHolder",i&&i.insertBefore(r,this.hider),n.cloneSource||(r.parentNode.className+="ht_master handsontable"),r.appendChild(this.hider));this.holder=this.hider.parentNode;this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.instance.getSetting("columnHeaders").length&&(this.THEAD.childNodes.length||(o=document.createElement("TR"),this.THEAD.appendChild(o)));this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null}Object.defineProperties(i,{WalkontableTable:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,s,h,c,l,a,v,y,u=(f=n("./../../../dom.js"),f&&f.__esModule&&f||{"default":f}),d=(e=n("./cell/coords.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords,it=(o=n("./cell/range.js"),o&&o.__esModule&&o||{"default":o}).WalkontableCellRange,g=(s=n("./filter/column.js"),s&&s.__esModule&&s||{"default":s}).WalkontableColumnFilter,p=(h=n("./overlay/corner.js"),h&&h.__esModule&&h||{"default":h}).WalkontableCornerOverlay,w=(c=n("./overlay/debug.js"),c&&c.__esModule&&c||{"default":c}).WalkontableDebugOverlay,b=(l=n("./overlay/left.js"),l&&l.__esModule&&l||{"default":l}).WalkontableLeftOverlay,nt=(a=n("./filter/row.js"),a&&a.__esModule&&a||{"default":a}).WalkontableRowFilter,tt=(v=n("./tableRenderer.js"),v&&v.__esModule&&v||{"default":v}).WalkontableTableRenderer,k=(y=n("./overlay/top.js"),y&&y.__esModule&&y||{"default":y}).WalkontableTopOverlay;r.prototype.alignOverlaysWithTrimmingContainer=function(){var n=u.getTrimmingContainer(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",n!==window?(this.holder.style.width=u.getStyle(n,"width"),this.holder.style.height=u.getStyle(n,"height"),this.holder.style.overflow=""):(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"))};r.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource};r.prototype.draw=function(n){var t,i;return this.isWorkingOnClone()||(this.holderOffset=u.offset(this.holder),n=this.instance.wtViewport.createRenderCalculators(n)),n?(this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtOverlays&&this.instance.wtOverlays.refresh(!0)):(this.tableOffset=this.isWorkingOnClone()?this.instance.cloneSource.wtTable.tableOffset:u.offset(this.TABLE),t=this.instance.cloneOverlay instanceof w||this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof p?0:this.instance.wtViewport.rowsRenderCalculator.startRow,i=this.instance.cloneOverlay instanceof w||this.instance.cloneOverlay instanceof b||this.instance.cloneOverlay instanceof p?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new nt(t,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new g(i,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw(),this.alignOverlaysWithTrimmingContainer()),this.refreshSelections(n),this.isWorkingOnClone()||(this.instance.wtOverlays.topOverlay.resetFixedPosition(),this.instance.wtOverlays.leftOverlay.resetFixedPosition(),this.instance.wtOverlays.topLeftCornerOverlay&&this.instance.wtOverlays.topLeftCornerOverlay.resetFixedPosition()),this.instance.drawn=!0,this};r.prototype._doDraw=function(){var n=new tt(this);n.render()};r.prototype.removeClassFromCells=function(n){for(var i=this.TABLE.querySelectorAll("."+n),t=0,r=i.length;t<r;t++)u.removeClass(i[t],n)};r.prototype.refreshSelections=function(n){var t,i;if(this.instance.selections){if(i=this.instance.selections.length,n)for(t=0;t<i;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;t<i;t++)this.instance.selections[t].draw(this.instance,n)}};r.prototype.getCell=function(n){if(this.isRowBeforeRenderedRows(n.row))return-1;if(this.isRowAfterRenderedRows(n.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n.row)];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n.col)]};r.prototype.getColumnHeader=function(n,t){t||(t=0);var i=this.THEAD.childNodes[t];if(i)return i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]};r.prototype.getRowHeader=function(n){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)];if(t)return t.childNodes[0]};r.prototype.getCoords=function(n){var i=n.parentNode,t=u.index(i);return t=i.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(t):this.rowFilter.renderedToSource(t),new d(t,this.columnFilter.visibleRowHeadedColumnToSourceColumn(n.cellIndex))};r.prototype.getTrForRow=function(n){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)]};r.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow};r.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow};r.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn};r.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn};r.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow};r.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow};r.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn};r.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn};r.prototype.isRowBeforeRenderedRows=function(n){return this.rowFilter.sourceToRendered(n)<0&&n>=0};r.prototype.isRowAfterViewport=function(n){return n>this.getLastVisibleRow()};r.prototype.isRowAfterRenderedRows=function(n){return n>this.getLastRenderedRow()};r.prototype.isColumnBeforeViewport=function(n){return this.columnFilter.sourceToRendered(n)<0&&n>=0};r.prototype.isColumnAfterViewport=function(n){return n>this.getLastVisibleColumn()};r.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()};r.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn};r.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof w?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof b||this.instance.cloneOverlay instanceof p?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count};r.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof w?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof k||this.instance.cloneOverlay instanceof p?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count};r.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count};r.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()};r.prototype.getRowHeight=function(n){var t=this.instance.wtSettings.settings.rowHeight(n),i=this.instance.wtViewport.oversizedRows[n];return i!==void 0&&(t=t?Math.max(t,i):i),t};r.prototype.getColumnHeaderHeight=function(n){var t=this.instance.wtSettings.settings.defaultRowHeight,i=this.instance.wtViewport.oversizedColumnHeaders[n];return i!==void 0&&(t=t?Math.max(t,i):i),t};r.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count};r.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()};r.prototype.getColumnWidth=function(n){var t=this.instance.wtSettings.settings.columnWidth,i;return typeof t=="function"?t=t(n):typeof t=="object"&&(t=t[n]),i=this.instance.wtViewport.oversizedCols[n],i!==void 0&&(t=t?Math.max(t,i):i),t};r.prototype.getStretchedColumnWidth=function(n){var t=this.getColumnWidth(n)||this.instance.wtSettings.settings.defaultColumnWidth,r=this.instance.wtViewport.columnsRenderCalculator,i;return r&&(i=r.getStretchedColumnWidth(n,t),i&&(t=i)),t};window.WalkontableTable=r},{"./../../../dom.js":27,"./cell/coords.js":5,"./cell/range.js":6,"./filter/column.js":9,"./filter/row.js":10,"./overlay/corner.js":12,"./overlay/debug.js":13,"./overlay/left.js":14,"./overlay/top.js":15,"./tableRenderer.js":21}],21:[function(n,t,i){"use strict";function o(n,t){var i=document.createElement("TH");return t.insertBefore(i,n),t.removeChild(n),i}function s(n,t){var i=document.createElement("TD");return t.insertBefore(i,n),t.removeChild(n),i}Object.defineProperties(i,{WalkontableTableRenderer:{get:function(){return f}},__esModule:{value:!0}});var u,r=(u=n("./../../../dom.js"),u&&u.__esModule&&u||{"default":u}),e={},f=function(n){this.wtTable=n;this.wot=n.instance;this.instance=n.instance;this.rowFilter=n.rowFilter;this.columnFilter=n.columnFilter;this.TABLE=n.TABLE;this.THEAD=n.THEAD;this.TBODY=n.TBODY;this.COLGROUP=n.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0};$traceurRuntime.createClass(f,{render:function(){var f,e,n,o,s;this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0);this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var t=this.wtTable.getRenderedColumnsCount(),i=this.wtTable.getRenderedRowsCount(),h=this.wot.getSetting("totalColumns"),c=this.wot.getSetting("totalRows"),r,u=!1;if(h>0&&(this.adjustAvailableNodes(),u=!0,this.renderColGroups(),this.renderColumnHeaders(),this.renderRows(c,i,t),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(r=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(t)),u||this.adjustAvailableNodes(),this.removeRedundantRows(i),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),r!==this.wot.wtViewport.getWorkspaceWidth())for(this.wot.wtViewport.containerWidth=null,f=this.wtTable.getFirstRenderedColumn(),e=this.wtTable.getLastRenderedColumn(),n=f;n<e;n++)o=this.wtTable.getStretchedColumnWidth(n),s=this.columnFilter.sourceToRendered(n),this.COLGROUP.childNodes[s+this.rowHeaderCount].style.width=o+"px";this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(n,t,i){for(var o,r,f=0,u=this.rowFilter.renderedToSource(f),s=this.wtTable.isWorkingOnClone(),e;u<n&&u>=0;){if(f>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(t!==void 0&&f===t)break;r=this.getOrCreateTrForRow(f,r);this.renderRowHeaders(u,r);this.adjustColumns(r,i+this.rowHeaderCount);o=this.renderCells(u,r,i);s||this.resetOversizedRow(u);r.firstChild&&(e=this.wot.wtTable.getRowHeight(u),r.firstChild.style.height=e?e+"px":"");f++;u=this.rowFilter.renderedToSource(f)}},resetOversizedRow:function(n){this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[n]&&(this.wot.wtViewport.oversizedRows[n]=void 0)},markOversizedRows:function(){var n=this.instance.wtTable.TBODY.childNodes.length,o=n*this.instance.wtSettings.settings.defaultRowHeight,s=r.innerHeight(this.instance.wtTable.TBODY)-1,u,t,i,f,e;if(o!==s)while(n)n--,i=this.instance.wtTable.rowFilter.renderedToSource(n),u=this.instance.wtTable.getRowHeight(i),f=this.instance.wtTable.getTrForRow(i),e=f.querySelector("th"),t=e?r.innerHeight(e):r.innerHeight(f)-1,(!u&&this.instance.wtSettings.settings.defaultRowHeight<t||u<t)&&(this.instance.wtViewport.oversizedRows[i]=t)},adjustColumnHeaderHeights:function(){for(var r=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,n=0,u=r.length;n<u;n++)if(i[n]){if(t[n].childNodes.length===0)return;t[n].childNodes[0].style.height=i[n]+"px"}},markIfOversizedColumnHeader:function(n){for(var t=this.wot.getSetting("columnHeaders").length,o=this.wot.wtSettings.settings.defaultRowHeight,u,f,i,e=this.wot.wtTable.columnFilter.renderedToSource(n);t;)(t--,u=this.wot.wtTable.getColumnHeaderHeight(t),f=this.wot.wtTable.getColumnHeader(e,t),f)&&(i=r.innerHeight(f),(!u&&o<i||u<i)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i))},renderCells:function(n,t,i){for(var u,e,f=0;f<i;f++)e=this.columnFilter.renderedToSource(f),u=f===0?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:u.nextSibling,u.nodeName=="TH"&&(u=s(u,t)),r.hasClass(u,"hide")||(u.className=""),u.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(n,e,u);return u},adjustColumnWidths:function(n){var i=0,e=this.wot.cloneSource?this.wot.cloneSource:this.wot,u=e.wtTable.holder,t,f;for(u.offsetHeight<u.scrollHeight&&(i=r.getScrollbarWidth()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-i),t=0;t<n;t++)f=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(t)),this.COLGROUP.childNodes[t+this.rowHeaderCount].style.width=f+"px"},appendToTbody:function(n){this.TBODY.appendChild(n);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(n,t){var i;return n>=this.wtTable.tbodyChildrenLength?(i=this.createRow(),this.appendToTbody(i)):i=n===0?this.TBODY.firstChild:t.nextSibling,i},createRow:function(){for(var n=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)n.appendChild(document.createElement("TH"));return n},renderRowHeader:function(n,t,i){i.className="";i.removeAttribute("style");this.rowHeaders[t](n,i,t)},renderRowHeaders:function(n,t){for(var i=t.firstChild,r=0;r<this.rowHeaderCount;r++)i?i.nodeName=="TD"&&(i=o(i,t)):(i=document.createElement("TH"),t.appendChild(i)),this.renderRowHeader(n,r,i),i=i.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function(){var i=this.wot.getOverlayName(),r,t,u,n,f;if(this.columnHeaderCount){for(r=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(u=this.getTrForColumnHeaders(t),n=-1*this.rowHeaderCount;n<r;n++)f=this.columnFilter.renderedToSource(n),this.renderColumnHeader(t,f,u.childNodes[n+this.rowHeaderCount]),e[i]||this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(n);e[i]=!0}},adjustColGroups:function(){for(var n=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<n+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;while(this.wtTable.colgroupChildrenLength>n+this.rowHeaderCount)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},adjustThead:function(){var f=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild,t,e,i,u;if(this.columnHeaders.length){for(t=0,e=this.columnHeaders.length;t<e;t++){for(n=this.THEAD.childNodes[t],n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<f+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;while(this.theadChildrenLength>f+this.rowHeaderCount)n.removeChild(n.lastChild),this.theadChildrenLength--}if(i=this.THEAD.childNodes.length,i>this.columnHeaders.length)for(u=this.columnHeaders.length;u<i;u++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&r.empty(n)},getTrForColumnHeaders:function(n){return this.THEAD.childNodes[n]},renderColumnHeader:function(n,t,i){return i.className="",i.removeAttribute("style"),this.columnHeaders[n](t,i,n)},renderColGroups:function(){for(var n=0;n<this.wtTable.colgroupChildrenLength;n++)n<this.rowHeaderCount?r.addClass(this.COLGROUP.childNodes[n],"rowHeader"):r.removeClass(this.COLGROUP.childNodes[n],"rowHeader")},adjustColumns:function(n,t){for(var i=n.childNodes.length,r;i<t;)r=document.createElement("TD"),n.appendChild(r),i++;while(i>t)n.removeChild(n.lastChild),i--},removeRedundantColumns:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{});window.WalkontableTableRenderer=f},{"./../../../dom.js":27}],22:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewport:{get:function(){return s}},__esModule:{value:!0}});var u,f,e,o,r=(u=n("./../../../dom.js"),u&&u.__esModule&&u||{"default":u}),h=(f=n("./../../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,c=(e=n("./calculator/viewportColumns.js"),e&&e.__esModule&&e||{"default":e}).WalkontableViewportColumnsCalculator,l=(o=n("./calculator/viewportRows.js"),o&&o.__esModule&&o||{"default":o}).WalkontableViewportRowsCalculator,s=function(n){var t=this,i;this.wot=n;this.instance=this.wot;this.oversizedRows=[];this.oversizedCols=[];this.oversizedColumnHeaders=[];this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;i=h(n);i.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(s,{getWorkspaceHeight:function(){var n=this.instance.wtOverlays.topOverlay.trimmingContainer,i,t=0;return n===window?t=document.documentElement.clientHeight:(i=r.outerHeight(n),t=i>0&&n.clientHeight>0?n.clientHeight:Infinity),t},getWorkspaceWidth:function(){var n,f=this.instance.getSetting("totalColumns"),u=this.instance.wtOverlays.leftOverlay.trimmingContainer,t,e=this.instance.getSetting("stretchH"),i=document.documentElement.offsetWidth;return(n=Handsontable.freezeOverlays?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),u===window&&f>0&&this.sumColumnWidths(0,f-1)>n)?document.documentElement.clientWidth:u!==window&&(t=r.getStyle(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),t=="scroll"||t=="hidden"||t=="auto")?Math.max(n,u.clientWidth):e!=="none"&&e?n:Math.max(n,r.outerWidth(this.instance.wtTable.TABLE))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(n,t){for(var i=0,r=this.instance.wtSettings.defaultColumnWidth;n<t;)i+=this.wot.wtTable.getColumnWidth(n)||r,n++;return i},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var i=this.instance.wtTable.holder,t,n;return n=document.createElement("DIV"),n.style.width="100%",n.style.height="1px",i.appendChild(n),t=n.offsetWidth,this.containerWidth=t,i.removeChild(n),t},getWorkspaceOffset:function(){return r.offset(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return r.outerHeight(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return r.outerWidth(this.wot.wtTable.TABLE)||r.outerWidth(this.wot.wtTable.TBODY)||r.outerWidth(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=r.outerHeight(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var n=this.getWorkspaceHeight(),t;return n===Infinity?n:(t=this.getColumnHeaderHeight(),t>0&&(n-=t),n)},getRowHeaderWidth:function(){var t,n,i,u;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t=this.instance.getSetting("rowHeaders"),t.length)for(n=this.instance.wtTable.TABLE.querySelector("TH"),this.rowHeaderWidth=0,i=0,u=t.length;i<u;i++)n?(this.rowHeaderWidth+=r.outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth},getViewportWidth:function(){var n=this.getWorkspaceWidth(),t;return n===Infinity?n:(t=this.getRowHeaderWidth(),t>0)?n-t:n},createRowsCalculator:function(){var f=arguments[0]!==void 0?arguments[0]:!1,e=this,t,n,i,u;return this.rowHeaderWidth=NaN,t=this.wot.wtSettings.settings.renderAllRows?Infinity:this.getViewportHeight(),n=r.getScrollTop(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset(),n<0&&(n=0),i=this.wot.getSetting("fixedRowsTop"),i&&(u=this.wot.wtOverlays.topOverlay.sumCellSizes(0,i),n+=u,t-=u),new l(t,n,this.wot.getSetting("totalRows"),function(n){return e.wot.wtTable.getRowHeight(n)},f?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,f)},createColumnsCalculator:function(){var f=arguments[0]!==void 0?arguments[0]:!1,e=this,t=this.getViewportWidth(),n,i,u;return this.columnHeaderHeight=NaN,n=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),n<0&&(n=0),i=this.wot.getSetting("fixedColumnsLeft"),i&&(u=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i),n+=u,t-=u),this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(t-=r.getScrollbarWidth()),new c(t,n,this.wot.getSetting("totalColumns"),function(n){return e.wot.wtTable.getColumnWidth(n)},f?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,f,this.wot.getSetting("stretchH"))},createRenderCalculators:function(){var n=arguments[0]!==void 0?arguments[0]:!1,t,i;return n&&(t=this.createRowsCalculator(!0),i=this.createColumnsCalculator(!0),this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(n){return this.rowsVisibleCalculator?n.startRow<this.rowsRenderCalculator.startRow||n.startRow===this.rowsRenderCalculator.startRow&&n.startRow>0?!1:n.endRow>this.rowsRenderCalculator.endRow||n.endRow===this.rowsRenderCalculator.endRow&&n.endRow<this.wot.getSetting("totalRows")-1?!1:!0:!1},areAllProposedVisibleColumnsAlreadyRendered:function(n){return this.columnsVisibleCalculator?n.startColumn<this.columnsRenderCalculator.startColumn||n.startColumn===this.columnsRenderCalculator.startColumn&&n.startColumn>0?!1:n.endColumn>this.columnsRenderCalculator.endColumn||n.endColumn===this.columnsRenderCalculator.endColumn&&n.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0:!1}},{});window.WalkontableViewport=s},{"./../../../dom.js":27,"./../../../eventManager.js":41,"./calculator/viewportColumns.js":3,"./calculator/viewportRows.js":4}],23:[function(n){"use strict";var t,i,r,u,f,e,o,s,h,c,l,a,y=Handsontable.version,p=Handsontable.buildDate,v;window.Handsontable=function Handsontable(n,t){var i=new Handsontable.Core(n,t||{});return i.init(),i};Handsontable.version=y;Handsontable.buildDate=p;t=n("./shims/array.filter.js");t&&t.__esModule&&t||{"default":t};i=n("./shims/array.indexOf.js");i&&i.__esModule&&i||{"default":i};r=n("./shims/array.isArray.js");r&&r.__esModule&&r||{"default":r};u=n("./shims/classes.js");u&&u.__esModule&&u||{"default":u};f=n("./shims/object.keys.js");f&&f.__esModule&&f||{"default":f};e=n("./shims/string.trim.js");e&&e.__esModule&&e||{"default":e};o=n("./shims/weakmap.js");o&&o.__esModule&&o||{"default":o};Handsontable.plugins={};v=(s=n("./pluginHooks.js"),s&&s.__esModule&&s||{"default":s}).Hooks;Handsontable.hooks||(Handsontable.hooks=new v);h=n("./core.js");h&&h.__esModule&&h||{"default":h};c=n("./renderers/_cellDecorator.js");c&&c.__esModule&&c||{"default":c};l=n("./cellTypes.js");l&&l.__esModule&&l||{"default":l};a=n("./../plugins/jqueryHandsontable.js");a&&a.__esModule&&a||{"default":a}},{"./../plugins/jqueryHandsontable.js":1,"./cellTypes.js":24,"./core.js":25,"./pluginHooks.js":44,"./renderers/_cellDecorator.js":71,"./shims/array.filter.js":78,"./shims/array.indexOf.js":79,"./shims/array.isArray.js":80,"./shims/classes.js":81,"./shims/object.keys.js":82,"./shims/string.trim.js":83,"./shims/weakmap.js":84}],24:[function(n){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut=(r=n("./helpers.js"),r&&r.__esModule&&r||{"default":r}),t=(u=n("./editors.js"),u&&u.__esModule&&u||{"default":u}).getEditorConstructor,i=(f=n("./renderers.js"),f&&f.__esModule&&f||{"default":f}).getRenderer,ft=(e=n("./editors/autocompleteEditor.js"),e&&e.__esModule&&e||{"default":e}).AutocompleteEditor,et=(o=n("./editors/checkboxEditor.js"),o&&o.__esModule&&o||{"default":o}).CheckboxEditor,ot=(s=n("./editors/dateEditor.js"),s&&s.__esModule&&s||{"default":s}).DateEditor,st=(h=n("./editors/dropdownEditor.js"),h&&h.__esModule&&h||{"default":h}).DropdownEditor,ht=(c=n("./editors/handsontableEditor.js"),c&&c.__esModule&&c||{"default":c}).HandsontableEditor,ct=(l=n("./editors/mobileTextEditor.js"),l&&l.__esModule&&l||{"default":l}).MobileTextEditor,lt=(a=n("./editors/numericEditor.js"),a&&a.__esModule&&a||{"default":a}).NumericEditor,at=(v=n("./editors/passwordEditor.js"),v&&v.__esModule&&v||{"default":v}).PasswordEditor,vt=(y=n("./editors/selectEditor.js"),y&&y.__esModule&&y||{"default":y}).SelectEditor,yt=(p=n("./editors/textEditor.js"),p&&p.__esModule&&p||{"default":p}).TextEditor,pt=(w=n("./renderers/autocompleteRenderer.js"),w&&w.__esModule&&w||{"default":w}).AutocompleteRenderer,wt=(b=n("./renderers/checkboxRenderer.js"),b&&b.__esModule&&b||{"default":b}).CheckboxRenderer,bt=(k=n("./renderers/htmlRenderer.js"),k&&k.__esModule&&k||{"default":k}).HtmlRenderer,kt=(d=n("./renderers/numericRenderer.js"),d&&d.__esModule&&d||{"default":d}).NumericRenderer,dt=(g=n("./renderers/passwordRenderer.js"),g&&g.__esModule&&g||{"default":g}).PasswordRenderer,gt=(nt=n("./renderers/textRenderer.js"),nt&&nt.__esModule&&nt||{"default":nt}).TextRenderer,ni=(tt=n("./validators/autocompleteValidator.js"),tt&&tt.__esModule&&tt||{"default":tt}).AutocompleteValidator,ti=(it=n("./validators/dateValidator.js"),it&&it.__esModule&&it||{"default":it}).DateValidator,ii=(rt=n("./validators/numericValidator.js"),rt&&rt.__esModule&&rt||{"default":rt}).NumericValidator;Handsontable.mobileBrowser=ut.isMobileBrowser();Handsontable.AutocompleteCell={editor:t("autocomplete"),renderer:i("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:t("checkbox"),renderer:i("checkbox")};Handsontable.TextCell={editor:Handsontable.mobileBrowser?t("mobile"):t("text"),renderer:i("text")};Handsontable.NumericCell={editor:t("numeric"),renderer:i("numeric"),validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:t("date"),validator:Handsontable.DateValidator,renderer:i("autocomplete")};Handsontable.HandsontableCell={editor:t("handsontable"),renderer:i("autocomplete")};Handsontable.PasswordCell={editor:t("password"),renderer:i("password"),copyable:!1};Handsontable.DropdownCell={editor:t("dropdown"),renderer:i("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{"./editors.js":29,"./editors/autocompleteEditor.js":31,"./editors/checkboxEditor.js":32,"./editors/dateEditor.js":33,"./editors/dropdownEditor.js":34,"./editors/handsontableEditor.js":35,"./editors/mobileTextEditor.js":36,"./editors/numericEditor.js":37,"./editors/passwordEditor.js":38,"./editors/selectEditor.js":39,"./editors/textEditor.js":40,"./helpers.js":42,"./renderers.js":70,"./renderers/autocompleteRenderer.js":72,"./renderers/checkboxRenderer.js":73,"./renderers/htmlRenderer.js":74,"./renderers/numericRenderer.js":75,"./renderers/passwordRenderer.js":76,"./renderers/textRenderer.js":77,"./validators/autocompleteValidator.js":86,"./validators/dateValidator.js":87,"./validators/numericValidator.js":88}],25:[function(n){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p=(r=n("./dom.js"),r&&r.__esModule&&r||{"default":r}),i=(u=n("./helpers.js"),u&&u.__esModule&&u||{"default":u}),w=(f=n("numeral"),f&&f.__esModule&&f||{"default":f}).default,d=(e=n("./dataMap.js"),e&&e.__esModule&&e||{"default":e}).DataMap,g=(o=n("./editorManager.js"),o&&o.__esModule&&o||{"default":o}).EditorManager,nt=(s=n("./eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager,tt=(h=n("./plugins.js"),h&&h.__esModule&&h||{"default":h}).getPlugin,it=(c=n("./renderers.js"),c&&c.__esModule&&c||{"default":c}).getRenderer,rt=(l=n("./tableView.js"),l&&l.__esModule&&l||{"default":l}).TableView,t=(a=n("./3rdparty/walkontable/src/cell/coords.js"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords,k=(v=n("./3rdparty/walkontable/src/cell/range.js"),v&&v.__esModule&&v||{"default":v}).WalkontableCellRange,ut=(y=n("./3rdparty/walkontable/src/selection.js"),y&&y.__esModule&&y||{"default":y}).WalkontableSelection,b;Handsontable.activeGuid=null;Handsontable.Core=function(n,r){function a(){var n=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;n=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue==0&&n==!1&&(n=!0,this.onQueueEmpty())}}}function v(n,t,i){function v(){var r;n.length&&(r=Handsontable.hooks.run(u,"beforeChange",n,t),typeof r=="function"?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):r===!1&&n.splice(0,n.length));i()}var o=new a,r,s;for(o.onQueueEmpty=v,r=n.length-1;r>=0;r--)if(n[r]===null)n.splice(r,1);else{var h=n[r][0],c=e.propToCol(n[r][1]),l=u.runHooks("modifyCol",c),f=u.getCellMeta(h,l);f.type==="numeric"&&typeof n[r][3]=="string"&&n[r][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(n[r][3])||f.format)&&(s=n[r][3].length,typeof f.language=="undefined"?w.language("en"):n[r][3].indexOf(".")===s-3&&n[r][3].indexOf(",")===-1?w.language("en"):w.language(f.language),w.validate(n[r][3])&&(n[r][3]=w().unformat(n[r][3])));u.getCellValidator(f)&&(o.addValidatorToQueue(),u.validateCell(n[r][3],f,function(t,i){return function(r){if(typeof r!="boolean")throw new Error("Validation error: result is not boolean");r===!1&&i.allowInvalid===!1&&(n.splice(t,1),i.valid=!0,--t);o.removeValidatorFormQueue()}}(r,f),t))}o.checkIfQueueIsEmpty()}function y(n,t){var i=n.length-1;if(!(i<0)){for(;0<=i;i--){if(n[i]===null){n.splice(i,1);continue}if(n[i][2]!=null||n[i][3]!=null){if(f.settings.allowInsertRow)while(n[i][0]>u.countRows()-1)e.createRow();if(u.dataType==="array"&&f.settings.allowInsertColumn)while(e.propToCol(n[i][1])>u.countCols()-1)e.createCol();e.set(n[i][0],n[i][1],n[i][3])}}u.forceFullRender=!0;h.adjustRowsAndCols();Handsontable.hooks.run(u,"beforeChangeRender",n,t);o.refreshBorders(null,!0);Handsontable.hooks.run(u,"afterChange",n,t||"edit")}}function ut(n,t,i){return typeof n=="object"?n:[[n,t,i]]}function l(n){var t,r,i;if(n.hasOwnProperty("type")){if(r={},typeof n.type=="object")t=n.type;else if(typeof n.type=="string"&&(t=Handsontable.cellTypes[n.type],t===void 0))throw new Error('You declared cell type "'+n.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(i in t)t.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(r[i]=t[i]);return r}}function ot(n){return Handsontable.hooks.run(u,"modifyRow",n)}function st(n){return Handsontable.hooks.run(u,"modifyCol",n)}function ht(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed");}var f,e,h,o,c,u=this,s=function(){},et=nt(u),ft;i.extend(s.prototype,b.prototype);i.extend(s.prototype,r);i.extend(s.prototype,l(r));this.rootElement=n;this.isHotTableEnv=p.isChildOfWebComponentTable(this.rootElement);Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");n.insertBefore(this.container,n.firstChild);this.guid="ht_"+i.randomString();this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new s,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};h={alter:function(n,t,i,r,s){var c,a,v,l,p,y;i=i||1;switch(n){case"insert_row":if(u.getSettings().maxRows===u.countRows())return;c=e.createRow(t,i);c&&(o.isSelected()&&f.selRange.from.row>=t?(f.selRange.from.row=f.selRange.from.row+c,o.transformEnd(c,0)):o.refreshBorders());break;case"insert_col":c=e.createCol(t,i);c&&(Array.isArray(u.getSettings().colHeaders)&&(a=[t,0],a.length+=c,Array.prototype.splice.apply(u.getSettings().colHeaders,a)),o.isSelected()&&f.selRange.from.col>=t?(f.selRange.from.col=f.selRange.from.col+c,o.transformEnd(0,c)):o.refreshBorders());break;case"remove_row":t=u.runHooks("modifyCol",t);e.removeRow(t,i);f.cellSettings.splice(t,i);v=u.getSettings().fixedRowsTop;v>=t+1&&(u.getSettings().fixedRowsTop-=Math.min(i,v-t));h.adjustRowsAndCols();o.refreshBorders();break;case"remove_col":for(e.removeCol(t,i),l=0,p=e.getAll().length;l<p;l++)l in f.cellSettings&&f.cellSettings[l].splice(t,i);y=u.getSettings().fixedColumnsLeft;y>=t+1&&(u.getSettings().fixedColumnsLeft-=Math.min(i,y-t));Array.isArray(u.getSettings().colHeaders)&&(typeof t=="undefined"&&(t=-1),u.getSettings().colHeaders.splice(t,i));h.adjustRowsAndCols();o.refreshBorders();break;default:throw new Error('There is no such action "'+n+'"');}s||h.adjustRowsAndCols()},adjustRowsAndCols:function(){var v,y,p,a,c,s,h;if(f.settings.minRows&&(v=u.countRows(),v<f.settings.minRows))for(y=0,p=f.settings.minRows;y<p-v;y++)e.createRow(u.countRows(),1,!0);if(f.settings.minSpareRows&&(a=u.countEmptyRows(!0),a<f.settings.minSpareRows))for(;a<f.settings.minSpareRows&&u.countRows()<f.settings.maxRows;a++)e.createRow(u.countRows(),1,!0);if((f.settings.minCols||f.settings.minSpareCols)&&(c=u.countEmptyCols(!0)),f.settings.minCols&&!f.settings.columns&&u.countCols()<f.settings.minCols)for(;u.countCols()<f.settings.minCols;c++)e.createCol(u.countCols(),1,!0);if(f.settings.minSpareCols&&!f.settings.columns&&u.dataType==="array"&&c<f.settings.minSpareCols)for(;c<f.settings.minSpareCols&&u.countCols()<f.settings.maxCols;c++)e.createCol(u.countCols(),1,!0);if(s=u.countRows(),h=u.countCols(),(s===0||h===0)&&o.deselect(),o.isSelected()){var l=!1,n=f.selRange.from.row,t=f.selRange.from.col,i=f.selRange.to.row,r=f.selRange.to.col;n>s-1?(n=s-1,l=!0,i>n&&(i=n)):i>s-1&&(i=s-1,l=!0,n>i&&(n=i));t>h-1?(t=h-1,l=!0,r>t&&(r=t)):r>h-1&&(r=h-1,l=!0,t>r&&(t=r));l&&u.selectCell(n,t,i,r)}u.view&&u.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(n,t,r,e,o,s,h){var c,v,l,p,it=[],a={},g,nt,rt,ut;if(v=t.length,v===0)return!1;switch(o){case"shift_down":for(g=r?r.col-n.col+1:0,nt=r?r.row-n.row+1:0,t=i.translateRowsToColumns(t),l=0,p=t.length,rt=Math.max(p,g);l<rt;l++)if(l<p){for(c=0,v=t[l].length;c<nt-v;c++)t[l].push(t[l][c%v]);t[l].unshift(n.col+l,n.row,0);u.spliceCol.apply(u,t[l])}else t[l%p][0]=n.col+l,u.spliceCol.apply(u,t[l%p]);break;case"shift_right":for(g=r?r.col-n.col+1:0,nt=r?r.row-n.row+1:0,c=0,v=t.length,ut=Math.max(v,nt);c<ut;c++)if(c<v){for(l=0,p=t[c].length;l<g-p;l++)t[c].push(t[c][l%p]);t[c].unshift(n.row+c,n.col,0);u.spliceRow.apply(u,t[c])}else t[c%v][0]=n.row+c,u.spliceRow.apply(u,t[c%v]);break;case"overwrite":default:a.row=n.row;a.col=n.col;var y={row:0,col:0},tt={row:r&&n?r.row-n.row+1:1,col:r&&n?r.col-n.col+1:1},d=!0;for(["up","left"].indexOf(s)!==-1?y={row:Math.ceil(tt.row/v)||1,col:Math.ceil(tt.col/t[0].length)||1}:["down","right"].indexOf(s)!==-1&&(y={row:1,col:1}),c=0;c<v;c++){if(r&&a.row>r.row||!f.settings.allowInsertRow&&a.row>u.countRows()-1||a.row>=f.settings.maxRows)break;for(a.col=n.col,p=t[c]?t[c].length:0,l=0;l<p;l++){if(r&&a.col>r.col||!f.settings.allowInsertColumn&&a.col>u.countCols()-1||a.col>=f.settings.maxCols)break;if(!u.getCellMeta(a.row,a.col).readOnly){var b,w=t[c][l],k=u.getDataAtCell(a.row,a.col),ot={row:c,col:l},ft,et;e==="autofill"&&(b=u.runHooks("beforeAutofillInsidePopulate",ot,s,t,h,y,tt),b&&(y=typeof b.iterators!="undefined"?b.iterators:y,w=typeof b.value!="undefined"?b.value:w));w!==null&&typeof w=="object"?k===null||typeof k!="object"?d=!1:(et=Handsontable.helper.duckSchema(k[0]||k),ft=Handsontable.helper.duckSchema(w[0]||w),Handsontable.helper.isObjectEquals(et,ft)?w=Handsontable.helper.deepClone(w):d=!1):k!==null&&typeof k=="object"&&(d=!1);d&&it.push([a.row,a.col,w]);d=!0}a.col++;r&&l===p-1&&(l=-1,["down","right"].indexOf(s)!==-1?y.col++:["up","left"].indexOf(s)!==-1&&y.col>1&&y.col--)}a.row++;y.col=1;r&&c===v-1&&(c=-1,["down","right"].indexOf(s)!==-1?y.row++:["up","left"].indexOf(s)!==-1&&y.row>1&&y.row--)}u.setDataAtCell(it,null,null,e||"populateFromArray")}}};this.selection=o={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(n,t){u.selection.selectedHeader.rows=n;u.selection.selectedHeader.cols=t},begin:function(){u.selection.inProgress=!0},finish:function(){var n=u.getSelected();Handsontable.hooks.run(u,"afterSelectionEnd",n[0],n[1],n[2],n[3]);Handsontable.hooks.run(u,"afterSelectionEndByProp",n[0],u.colToProp(n[1]),n[2],u.colToProp(n[3]));u.selection.inProgress=!1},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(n,t){Handsontable.hooks.run(u,"beforeSetRangeStart",n);f.selRange=new k(n,n,n);o.setRangeEnd(n,null,t)},setRangeEnd:function(n,i,r){if(f.selRange!==null){var s;Handsontable.hooks.run(u,"beforeSetRangeEnd",n);u.selection.begin();f.selRange.to=new t(n.row,n.col);f.settings.multiSelect||(f.selRange.from=n);u.view.wt.selections.current.clear();s=u.getCellMeta(f.selRange.highlight.row,f.selRange.highlight.col).disableVisualSelection;typeof s=="string"&&(s=[s]);(s===!1||Array.isArray(s)&&s.indexOf("current")===-1)&&u.view.wt.selections.current.add(f.selRange.highlight);u.view.wt.selections.area.clear();(s===!1||Array.isArray(s)&&s.indexOf("area")===-1)&&o.isMultiple()&&(u.view.wt.selections.area.add(f.selRange.from),u.view.wt.selections.area.add(f.selRange.to));(f.settings.currentRowClassName||f.settings.currentColClassName)&&(u.view.wt.selections.highlight.clear(),u.view.wt.selections.highlight.add(f.selRange.from),u.view.wt.selections.highlight.add(f.selRange.to));Handsontable.hooks.run(u,"afterSelection",f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col);Handsontable.hooks.run(u,"afterSelectionByProp",f.selRange.from.row,e.colToProp(f.selRange.from.col),f.selRange.to.row,e.colToProp(f.selRange.to.col));i!==!1&&u.view.mainViewIsActive()&&(f.selRange.from&&!o.isMultiple()?u.view.scrollViewport(f.selRange.from):u.view.scrollViewport(n));o.refreshBorders(null,r)}},refreshBorders:function(n,t){t||c.destroyEditor(n);u.view.render();o.isSelected()&&!t&&c.prepareEditor()},isMultiple:function(){var n=!(f.selRange.to.col===f.selRange.from.col&&f.selRange.to.row===f.selRange.from.row),t=Handsontable.hooks.run(u,"afterIsMultipleSelection",n);if(n)return t},transformStart:function(n,i,r,e){var s=new t(n,i),a=0,v=0,c,l,h;u.runHooks("modifyTransformStart",s);c=u.countRows();l=u.countCols();f.selRange.highlight.row+n>c-1?r&&f.settings.minSpareRows>0?(u.alter("insert_row",c),c=u.countRows()):f.settings.autoWrapCol&&(s.row=1-c,s.col=f.selRange.highlight.col+s.col==l-1?1-l:1):f.settings.autoWrapCol&&f.selRange.highlight.row+s.row<0&&f.selRange.highlight.col+s.col>=0&&(s.row=c-1,s.col=f.selRange.highlight.col+s.col==0?l-1:-1);f.selRange.highlight.col+s.col>l-1?r&&f.settings.minSpareCols>0?(u.alter("insert_col",l),l=u.countCols()):f.settings.autoWrapRow&&(s.row=f.selRange.highlight.row+s.row==c-1?1-c:1,s.col=1-l):f.settings.autoWrapRow&&f.selRange.highlight.col+s.col<0&&f.selRange.highlight.row+s.row>=0&&(s.row=f.selRange.highlight.row+s.row==0?c-1:-1,s.col=l-1);h=new t(f.selRange.highlight.row+s.row,f.selRange.highlight.col+s.col);h.row<0?(a=-1,h.row=0):h.row>0&&h.row>=c&&(a=1,h.row=c-1);h.col<0?(v=-1,h.col=0):h.col>0&&h.col>=l&&(v=1,h.col=l-1);u.runHooks("afterModifyTransformStart",h,a,v);o.setRangeStart(h,e)},transformEnd:function(n,i){var e=new t(n,i),s=0,h=0,c,l,r;u.runHooks("modifyTransformEnd",e);c=u.countRows();l=u.countCols();r=new t(f.selRange.to.row+e.row,f.selRange.to.col+e.col);r.row<0?(s=-1,r.row=0):r.row>0&&r.row>=c&&(s=1,r.row=c-1);r.col<0?(h=-1,r.col=0):r.col>0&&r.col>=l&&(h=1,r.col=l-1);u.runHooks("afterModifyTransformEnd",r,s,h);o.setRangeEnd(r,!0)},isSelected:function(){return f.selRange!==null},inInSelection:function(n){return o.isSelected()?f.selRange.includes(n):!1},deselect:function(){o.isSelected()&&(u.selection.inProgress=!1,f.selRange=null,u.view.wt.selections.current.clear(),u.view.wt.selections.area.clear(),(f.settings.currentRowClassName||f.settings.currentColClassName)&&u.view.wt.selections.highlight.clear(),c.destroyEditor(),o.refreshBorders(),Handsontable.hooks.run(u,"afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(o.setRangeStart(new t(0,0)),o.setRangeEnd(new t(u.countRows()-1,u.countCols()-1),!1))},empty:function(){if(o.isSelected()){for(var i=f.selRange.getTopLeftCorner(),r=f.selRange.getBottomRightCorner(),t,e=[],n=i.row;n<=r.row;n++)for(t=i.col;t<=r.col;t++)u.getCellMeta(n,t).readOnly||e.push([n,t,""]);u.setDataAtCell(e)}}};this.init=function(){Handsontable.hooks.run(u,"beforeInit");Handsontable.mobileBrowser&&p.addClass(u.rootElement,"mobile");this.updateSettings(f.settings,!0);this.view=new rt(this);c=new g(u,f,o,e);this.forceFullRender=!0;this.view.render();typeof f.firstRun=="object"&&(Handsontable.hooks.run(u,"afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1);Handsontable.hooks.run(u,"afterInit")};this.validateCell=function(n,t,i,r){function e(n){var r=t.col,f=t.row,e=u.getCell(f,r,!0);e&&u.view.wt.wtSettings.settings.cellRenderer(f,r,e);i(n)}var f=u.getCellValidator(t);Object.prototype.toString.call(f)==="[object RegExp]"&&(f=function(n){return function(t,i){i(n.test(t))}}(f));typeof f=="function"?(n=Handsontable.hooks.run(u,"beforeValidate",n,t.row,t.prop,r),u._registerTimeout(setTimeout(function(){f.call(t,n,function(i){i=Handsontable.hooks.run(u,"afterValidate",i,n,t.row,t.prop,r);t.valid=i;e(i);Handsontable.hooks.run(u,"postAfterValidate",i,n,t.row,t.prop,r)})},0))):(t.valid=!0,e(t.valid))};this.setDataAtCell=function(n,t,i,r){for(var f=ut(n,t,i),o=[],s,u=0,h=f.length;u<h;u++){if(typeof f[u]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof f[u][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=e.colToProp(f[u][1]);o.push([f[u][0],s,e.get(f[u][0],s),f[u][2]])}r||typeof n!="object"||(r=t);v(o,r,function(){y(o,r)})};this.setDataAtRowProp=function(n,t,i,r){for(var f=ut(n,t,i),o=[],u=0,s=f.length;u<s;u++)o.push([f[u][0],f[u][1],e.get(f[u][0],f[u][1]),f[u][2]]);r||typeof n!="object"||(r=t);v(o,r,function(){y(o,r)})};this.listen=function(){Handsontable.activeGuid=u.guid;document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===u.guid};this.destroyEditor=function(n){o.refreshBorders(n)};this.populateFromArray=function(n,i,r,u,f,e,o,s,c){var l;if(!(typeof r=="object"&&typeof r[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");return l=typeof u=="number"?new t(u,f):null,h.populateFromArray(new t(n,i),r,l,e,o,s,c)};this.spliceCol=function(){return e.spliceCol.apply(e,arguments)};this.spliceRow=function(){return e.spliceRow.apply(e,arguments)};this.getSelected=function(){if(o.isSelected())return[f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col]};this.getSelectedRange=function(){if(o.isSelected())return f.selRange};this.render=function(){u.view&&(u.forceFullRender=!0,o.refreshBorders(null,!0))};this.loadData=function(n){function l(){f.cellSettings.length=0}var t,i,o,r,c;if(typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null)for(n=[],i=0,o=f.settings.startRows;i<o;i++){for(t=[],r=0,c=f.settings.startCols;r<c;r++)t.push(null);n.push(t)}else throw new Error("loadData only accepts array of objects or array of arrays ("+typeof n+" given)");f.isPopulated=!1;s.prototype.data=n;u.dataType=Array.isArray(f.settings.dataSchema)||Array.isArray(n[0])?"array":typeof f.settings.dataSchema=="function"?"function":"object";e=new d(u,f,s);l();h.adjustRowsAndCols();Handsontable.hooks.run(u,"afterLoadData");f.firstRun?f.firstRun=[null,"loadData"]:(Handsontable.hooks.run(u,"afterChange",null,"loadData"),u.render());f.isPopulated=!0};this.getData=function(n,i,r,u){return typeof n=="undefined"?e.getAll():e.getRange(new t(n,i),new t(r,u),e.DESTINATION_RENDERER)};this.getCopyableData=function(n,i,r,u){return e.getCopyableText(new t(n,i),new t(r,u))};this.getSchema=function(){return e.getSchema()};this.updateSettings=function(n,t){var r,y,w,b,v,c,a;if(typeof n.rows!="undefined")throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(typeof n.cols!="undefined")throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(r in n)if(r==="data")continue;else Handsontable.hooks.getRegistered().indexOf(r)>-1?(typeof n[r]=="function"||Array.isArray(n[r]))&&u.addHook(r,n[r]):!t&&n.hasOwnProperty(r)&&(s.prototype[r]=n[r]);if(n.data===void 0&&f.settings.data===void 0?u.loadData(null):n.data!==void 0?u.loadData(n.data):n.columns!==void 0&&e.createMap(),y=u.countCols(),f.cellSettings.length=0,y>0)for(r=0;r<y;r++)f.columnSettings[r]=i.columnFactory(s,f.columnsSettingConflicts),w=f.columnSettings[r].prototype,s.prototype.columns&&(b=s.prototype.columns[r],i.extend(w,b),i.extend(w,l(b)));if(typeof n.cell!="undefined")for(r in n.cell)n.cell.hasOwnProperty(r)&&(v=n.cell[r],u.setCellMetaObject(v.row,v.col,v));Handsontable.hooks.run(u,"afterCellMetaReset");typeof n.className!="undefined"&&(s.prototype.className&&p.removeClass(u.rootElement,s.prototype.className),n.className&&p.addClass(u.rootElement,n.className));typeof n.height!="undefined"&&(c=n.height,typeof c=="function"&&(c=c()),u.rootElement.style.height=c+"px");typeof n.width!="undefined"&&(a=n.width,typeof a=="function"&&(a=a()),u.rootElement.style.width=a+"px");c&&(u.rootElement.style.overflow="hidden");t||Handsontable.hooks.run(u,"afterUpdateSettings");h.adjustRowsAndCols();u.view&&!f.firstRun&&(u.forceFullRender=!0,o.refreshBorders(null,!0))};this.getValue=function(){var n=u.getSelected();if(s.prototype.getValue){if(typeof s.prototype.getValue=="function")return s.prototype.getValue.call(u);if(n)return u.getData()[n[0]][s.prototype.getValue]}else if(n)return u.getDataAtCell(n[0],n[1])};this.getSettings=function(){return f.settings};this.clear=function(){o.selectAll();o.empty()};this.alter=function(n,t,i,r,u){h.alter(n,t,i,r,u)};this.getCell=function(n,i,r){return u.view.getCellAtCoords(new t(n,i),r)};this.getCoords=function(n){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,n)};this.colToProp=function(n){return e.colToProp(n)};this.propToCol=function(n){return e.propToCol(n)};this.getDataAtCell=function(n,t){return e.get(n,e.colToProp(t))};this.getDataAtRowProp=function(n,t){return e.get(n,t)};this.getDataAtCol=function(n){var i=[];return i.concat.apply(i,e.getRange(new t(0,n),new t(f.settings.data.length-1,n),e.DESTINATION_RENDERER))};this.getDataAtProp=function(n){var i=[],r;return r=e.getRange(new t(0,e.propToCol(n)),new t(f.settings.data.length-1,e.propToCol(n)),e.DESTINATION_RENDERER),i.concat.apply(i,r)};this.getSourceDataAtCol=function(n){for(var i=[],r=f.settings.data,t=0;t<r.length;t++)i.push(r[t][n]);return i};this.getSourceDataAtRow=function(n){return f.settings.data[n]};this.getDataAtRow=function(n){var i=e.getRange(new t(n,0),new t(n,this.countCols()-1),e.DESTINATION_RENDERER);return i[0]};this.removeCellMeta=function(n,t,i){var r=u.getCellMeta(n,t);r[i]!=undefined&&delete f.cellSettings[n][t][i]};this.setCellMetaObject=function(n,t,i){var r,u;if(typeof i=="object")for(r in i)i.hasOwnProperty(r)&&(u=i[r],this.setCellMeta(n,t,r,u))};this.setCellMeta=function(n,t,i,r){f.cellSettings[n]||(f.cellSettings[n]=[]);f.cellSettings[n][t]||(f.cellSettings[n][t]=new f.columnSettings[t]);f.cellSettings[n][t][i]=r;Handsontable.hooks.run(u,"afterSetCellMeta",n,t,i,r)};this.getCellMeta=function(n,t){var h=e.colToProp(t),r,o;return n=ot(n),t=st(t),f.columnSettings[t]||(f.columnSettings[t]=i.columnFactory(s,f.columnsSettingConflicts)),f.cellSettings[n]||(f.cellSettings[n]=[]),f.cellSettings[n][t]||(f.cellSettings[n][t]=new f.columnSettings[t]),r=f.cellSettings[n][t],r.row=n,r.col=t,r.prop=h,r.instance=u,Handsontable.hooks.run(u,"beforeGetCellMeta",n,t,r),i.extend(r,l(r)),r.cells&&(o=r.cells.call(r,n,t,h),o&&(i.extend(r,o),i.extend(r,l(o)))),Handsontable.hooks.run(u,"afterGetCellMeta",n,t,r),r};this.isColumnModificationAllowed=function(){return!(u.dataType==="object"||u.getSettings().columns)};ft=i.cellMethodLookupFactory("renderer");this.getCellRenderer=function(n,t){var i=ft.call(this,n,t);return it(i)};this.getCellEditor=i.cellMethodLookupFactory("editor");this.getCellValidator=i.cellMethodLookupFactory("validator");this.validateCells=function(n){var r=new a,t,i;for(r.onQueueEmpty=n,t=u.countRows()-1;t>=0;){for(i=u.countCols()-1;i>=0;)r.addValidatorToQueue(),u.validateCell(u.getDataAtCell(t,i),u.getCellMeta(t,i),function(){r.removeValidatorFormQueue()},"validateCells"),i--;t--}r.checkIfQueueIsEmpty()};this.getRowHeader=function(n){var i,t,r;if(n===void 0){for(i=[],t=0,r=u.countRows();t<r;t++)i.push(u.getRowHeader(t));return i}return Array.isArray(f.settings.rowHeaders)&&f.settings.rowHeaders[n]!==void 0?f.settings.rowHeaders[n]:typeof f.settings.rowHeaders=="function"?f.settings.rowHeaders(n):f.settings.rowHeaders&&typeof f.settings.rowHeaders!="string"&&typeof f.settings.rowHeaders!="number"?n+1:f.settings.rowHeaders};this.hasRowHeaders=function(){return!!f.settings.rowHeaders};this.hasColHeaders=function(){if(f.settings.colHeaders!==void 0&&f.settings.colHeaders!==null)return!!f.settings.colHeaders;for(var n=0,t=u.countCols();n<t;n++)if(u.getColHeader(n))return!0;return!1};this.getColHeader=function(n){var r,t,e,o;if(n===void 0){for(r=[],t=0,e=u.countCols();t<e;t++)r.push(u.getColHeader(t));return r}return o=n,n=Handsontable.hooks.run(u,"modifyCol",n),f.settings.columns&&f.settings.columns[n]&&f.settings.columns[n].title?f.settings.columns[n].title:Array.isArray(f.settings.colHeaders)&&f.settings.colHeaders[n]!==void 0?f.settings.colHeaders[n]:typeof f.settings.colHeaders=="function"?f.settings.colHeaders(n):f.settings.colHeaders&&typeof f.settings.colHeaders!="string"&&typeof f.settings.colHeaders!="number"?i.spreadsheetColumnLabel(o):f.settings.colHeaders};this._getColWidthFromSettings=function(n){var i=u.getCellMeta(0,n),t=i.width;if((t===void 0||t===f.settings.width)&&(t=i.colWidths),t!==void 0&&t!==null){switch(typeof t){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getColWidth=function(n){var t=u._getColWidthFromSettings(n);return t||(t=50),Handsontable.hooks.run(u,"modifyColWidth",t,n)};this._getRowHeightFromSettings=function(n){var t=f.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getRowHeight=function(n){var t=u._getRowHeightFromSettings(n);return Handsontable.hooks.run(u,"modifyRowHeight",t,n)};this.countRows=function(){return f.settings.data.length};this.countCols=function(){return u.dataType==="object"||u.dataType==="function"?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:e.colToPropCache.length:u.dataType==="array"?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0};this.rowOffset=function(){return u.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return u.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(n){for(var t=u.countRows()-1,i=0,r;t>=0;){if(r=Handsontable.hooks.run(this,"modifyRow",t),u.isEmptyRow(r))i++;else if(n)break;t--}return i};this.countEmptyCols=function(n){if(u.countRows()<1)return 0;for(var t=u.countCols()-1,i=0;t>=0;){if(u.isEmptyCol(t))i++;else if(n)break;t--}return i};this.isEmptyRow=function(n){return f.settings.isEmptyRow.call(u,n)};this.isEmptyCol=function(n){return f.settings.isEmptyCol.call(u,n)};this.selectCell=function(n,i,r,e,s,h){var c;return(h=typeof h=="undefined"||h===!0,typeof n!="number"||n<0||n>=u.countRows())?!1:typeof i!="number"||i<0||i>=u.countCols()?!1:typeof r!="undefined"&&(typeof r!="number"||r<0||r>=u.countRows()||typeof e!="number"||e<0||e>=u.countCols())?!1:(c=new t(n,i),f.selRange=new k(c,c,c),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),h&&u.listen(),typeof r=="undefined"?o.setRangeEnd(f.selRange.from,s):o.setRangeEnd(new t(r,e),s),u.selection.finish(),!0)};this.selectCellByProp=function(){return arguments[1]=e.propToCol(arguments[1]),typeof arguments[3]!="undefined"&&(arguments[3]=e.propToCol(arguments[3])),u.selectCell.apply(u,arguments)};this.deselectCell=function(){o.deselect()};this.destroy=function(){u._clearTimeouts();u.view&&u.view.destroy();p.empty(u.rootElement);et.clear();Handsontable.hooks.run(u,"afterDestroy");Handsontable.hooks.destroy(u);for(var n in u)u.hasOwnProperty(n)&&(typeof u[n]=="function"?n!=="runHooks"&&(u[n]=ht):n!=="guid"&&(u[n]=null));f=null;e=null;h=null;o=null;c=null;u=null;s=null};this.getActiveEditor=function(){return c.getActiveEditor()};this.getPlugin=function(n){return tt(this,n)};this.getInstance=function(){return u};this.addHook=function(n,t){Handsontable.hooks.add(n,t,u)};this.addHookOnce=function(n,t){Handsontable.hooks.once(n,t,u)};this.removeHook=function(n,t){Handsontable.hooks.remove(n,t,u)};this.runHooks=function(n,t,i,r,f,e,o){return Handsontable.hooks.run(u,n,t,i,r,f,e,o)};this.timeouts=[];this._registerTimeout=function(n){this.timeouts.push(n)};this._clearTimeouts=function(){for(var n=0,t=this.timeouts.length;n<t;n++)clearTimeout(this.timeouts[n])};this.version=Handsontable.version};b=function(){};b.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(n){for(var t,f,r=0,u=this.countCols();r<u;r++)if(t=this.getDataAtCell(n,r),t!==""&&t!==null&&typeof t!="undefined")return typeof t=="object"?(f=this.getCellMeta(n,r),i.isObjectEquals(this.getSchema()[f.prop],t)):!1;return!0},isEmptyCol:function(n){for(var i,t=0,r=this.countRows();t<r;t++)if(i=this.getDataAtCell(t,n),i!==""&&i!==null&&typeof i!="undefined")return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,disableVisualSelection:!1,sortIndicator:!1,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0};Handsontable.DefaultSettings=b},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/cell/range.js":6,"./3rdparty/walkontable/src/selection.js":18,"./dataMap.js":26,"./dom.js":27,"./editorManager.js":28,"./eventManager.js":41,"./helpers.js":42,"./plugins.js":45,"./renderers.js":70,"./tableView.js":85,numeral:"numeral"}],26:[function(n,t,i){"use strict";function r(n,t,i){this.instance=n;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap()}var h;Object.defineProperties(i,{DataMap:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,u=(f=n("./helpers.js"),f&&f.__esModule&&f||{"default":f}),c=(e=n("./multiMap.js"),e&&e.__esModule&&e||{"default":e}).MultiMap,s=(o=n("SheetClip"),o&&o.__esModule&&o||{"default":o}).default;Handsontable.DataMap=r;r.prototype.DESTINATION_RENDERER=1;r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;r.prototype.recursiveDuckSchema=function(n){return Handsontable.helper.duckSchema(n)};r.prototype.recursiveDuckColumns=function(n,t,i){var u,r;if(typeof t=="undefined"&&(t=0,i=""),typeof n=="object"&&!Array.isArray(n))for(r in n)n.hasOwnProperty(r)&&(n[r]===null?(u=i+r,this.colToPropCache.push(u),this.propToColCache.set(u,t),t++):t=this.recursiveDuckColumns(n[r],t,r+"."));return t};r.prototype.createMap=function(){var n,i,r=this.getSchema(),t;if(typeof r=="undefined")throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");if(this.colToPropCache=[],this.propToColCache=new c,t=this.instance.getSettings().columns,t)for(n=0,i=t.length;n<i;n++)typeof t[n].data!="undefined"&&(this.colToPropCache[n]=t[n].data,this.propToColCache.set(t[n].data,n));else this.recursiveDuckColumns(r)};r.prototype.colToProp=function(n){return(n=Handsontable.hooks.run(this.instance,"modifyCol",n),this.colToPropCache&&typeof this.colToPropCache[n]!="undefined")?this.colToPropCache[n]:n};r.prototype.propToCol=function(n){var t;return t=typeof this.propToColCache.get(n)!="undefined"?this.propToColCache.get(n):n,Handsontable.hooks.run(this.instance,"modifyCol",t)};r.prototype.getSchema=function(){var n=this.instance.getSettings().dataSchema;return n?typeof n=="function"?n():n:this.duckSchema};r.prototype.createRow=function(n,t,i){var r,h=this.instance.countCols(),f=0,o,s,e;for(t||(t=1),(typeof n!="number"||n>=this.instance.countRows())&&(n=this.instance.countRows()),o=n,s=this.instance.getSettings().maxRows;f<t&&this.instance.countRows()<s;){if(this.instance.dataType==="array")for(r=[],e=0;e<h;e++)r.push(null);else this.instance.dataType==="function"?r=this.instance.getSettings().dataSchema(n):(r={},u.deepExtend(r,this.getSchema()));n===this.instance.countRows()?this.dataSource.push(r):this.dataSource.splice(n,0,r);f++;o++}return Handsontable.hooks.run(this.instance,"afterCreateRow",n,f,i),this.instance.forceFullRender=!0,f};r.prototype.createCol=function(n,t,i){var c,r;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var h=this.instance.countRows(),f=this.dataSource,s,e=0,o;for(t||(t=1),o=n,c=this.instance.getSettings().maxCols;e<t&&this.instance.countCols()<c;){if(s=u.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),typeof n!="number"||n>=this.instance.countCols()){for(r=0;r<h;r++)typeof f[r]=="undefined"&&(f[r]=[]),f[r].push(null);this.priv.columnSettings.push(s)}else{for(r=0;r<h;r++)f[r].splice(o,0,null);this.priv.columnSettings.splice(o,0,s)}e++;o++}return Handsontable.hooks.run(this.instance,"afterCreateCol",n,e,i),this.instance.forceFullRender=!0,e};r.prototype.removeRow=function(n,t){var r,u,i,f;(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countRows()+n)%this.instance.countRows(),r=this.physicalRowsToLogical(n,t),u=Handsontable.hooks.run(this.instance,"beforeRemoveRow",n,t),u!==!1)&&(i=this.dataSource,f=i.filter(function(n,t){return r.indexOf(t)==-1}),i.length=0,Array.prototype.push.apply(i,f),Handsontable.hooks.run(this.instance,"afterRemoveRow",n,t),this.instance.forceFullRender=!0)};r.prototype.removeCol=function(n,t){var r,u,i,f;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countCols()+n)%this.instance.countCols(),r=Handsontable.hooks.run(this.instance,"beforeRemoveCol",n,t),r!==!1){for(u=this.dataSource,i=0,f=this.instance.countRows();i<f;i++)u[i].splice(n,t);this.priv.columnSettings.splice(n,t);Handsontable.hooks.run(this.instance,"afterRemoveCol",n,t);this.instance.forceFullRender=!0}};r.prototype.spliceCol=function(n,t,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getDataAtCol(n),o=e.slice(t,t+i),s=e.slice(t+i),f;for(u.extendArray(r,s),f=0;f<i;)r.push(null),f++;return u.to2dArray(r),this.instance.populateFromArray(t,n,r,null,null,"spliceCol"),o};r.prototype.spliceRow=function(n,t,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],e=this.instance.getSourceDataAtRow(n),o=e.slice(t,t+i),s=e.slice(t+i),f;for(u.extendArray(r,s),f=0;f<i;)r.push(null),f++;return this.instance.populateFromArray(n,t,[r],null,null,"spliceRow"),o};r.prototype.get=function(n,t){var u,i,r,f;if(n=Handsontable.hooks.run(this.instance,"modifyRow",n),typeof t=="string"&&t.indexOf(".")>-1){if(u=t.split("."),i=this.dataSource[n],!i)return null;for(r=0,f=u.length;r<f;r++)if(i=i[u[r]],typeof i=="undefined")return null;return i}return typeof t=="function"?t(this.dataSource.slice(n,n+1)[0]):this.dataSource[n]?this.dataSource[n][t]:null};h=u.cellMethodLookupFactory("copyable",!1);r.prototype.getCopyable=function(n,t){return h.call(this.instance,n,this.propToCol(t))?this.get(n,t):""};r.prototype.set=function(n,t,i,r){var f,e,u,o;if(n=Handsontable.hooks.run(this.instance,"modifyRow",n,r||"datamapGet"),typeof t=="string"&&t.indexOf(".")>-1){for(f=t.split("."),e=this.dataSource[n],u=0,o=f.length-1;u<o;u++)typeof e[f[u]]=="undefined"&&(e[f[u]]={}),e=e[f[u]];e[f[u]]=i}else typeof t=="function"?t(this.dataSource.slice(n,n+1)[0],i):this.dataSource[n][t]=i};r.prototype.physicalRowsToLogical=function(n,t){for(var i=this.instance.countRows(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=Handsontable.hooks.run(this.instance,"modifyRow",r),u.push(e),f--,r++;return u};r.prototype.clear=function(){for(var t,n=0;n<this.instance.countRows();n++)for(t=0;t<this.instance.countCols();t++)this.set(n,this.colToProp(t),"")};r.prototype.getAll=function(){return this.dataSource};r.prototype.getRange=function(n,t,i){var r,e,u,o,s=[],f,h=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(e=Math.max(n.row,t.row),o=Math.max(n.col,t.col),r=Math.min(n.row,t.row);r<=e;r++){for(f=[],u=Math.min(n.col,t.col);u<=o;u++)f.push(h.call(this,r,this.colToProp(u)));s.push(f)}return s};r.prototype.getText=function(n,t){return s.stringify(this.getRange(n,t,this.DESTINATION_RENDERER))};r.prototype.getCopyableText=function(n,t){return s.stringify(this.getRange(n,t,this.DESTINATION_CLIPBOARD_GENERATOR))}},{"./helpers.js":42,"./multiMap.js":43,SheetClip:"SheetClip"}],27:[function(n,t,i){"use strict";function rt(n){n!=null&&n.isImmediatePropagationEnabled==null&&(n.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1;this.cancelBubble=!0},n.isImmediatePropagationEnabled=!0,n.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})}function ut(n,t,i){while(n!=null&&n!==i){if(n.nodeType===Node.ELEMENT_NODE&&(t.indexOf(n.nodeName)>-1||t.indexOf(n)>-1))return n;n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return null}function ft(n,t){var i=n.parentNode,r=[];for(typeof t=="string"?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);i!=null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function et(n){function r(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName===u.toUpperCase()}for(var u="hot-table",i=!1,t=o(n);t!=null;){if(r(t)){i=!0;break}else if(t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=r(t.host),i)break;t=t.host}t=t.parentNode}return i}function o(n){return typeof Polymer!="undefined"&&typeof wrap=="function"?wrap(n):n}function s(n){return typeof Polymer!="undefined"&&typeof unwrap=="function"?unwrap(n):n}function ot(){var n=document.createElement("div");return n.createShadowRoot&&n.createShadowRoot.toString().match(/\[native code\]/)?!0:!1}function st(n){var t=0;if(n.previousSibling)while(n=n.previousSibling)++t;return t}function ct(n){var t=0,i=[];if(!n||!n.length)return i;while(n[t])i.push(n[t]),t++;return i}function lt(n,t){return h(n,t)}function at(n,t){return c(n,t)}function vt(n,t){return l(n,t)}function v(n,t){var r,i;if(n.nodeType===3)t.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1)for(r=n.childNodes,i=r.length-1;i>=0;i--)v(r[i],n)}function y(n){for(var t;t=n.lastChild;)n.removeChild(t)}function yt(n,t){u.test(t)?n.innerHTML=t:p(n,t)}function p(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?pt?i.textContent=t:i.data=t:(y(n),n.appendChild(document.createTextNode(t)))}function f(n){for(var t=n;s(t)!==document.documentElement;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return f(t.host.impl);if(t.host)return f(t.host);throw new Error("Lost in Web Components world");}else return!1;else if(t.style.display==="none")return!1;t=t.parentNode}return!0}function wt(n){var i,r,u,t,f;if(t=document.documentElement,e()&&n.firstChild&&n.firstChild.nodeName==="CAPTION")return f=n.getBoundingClientRect(),{top:f.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||0),left:f.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)};for(i=n.offsetLeft,r=n.offsetTop,u=n;n=n.offsetParent;){if(n===document.body)break;i+=n.offsetLeft;r+=n.offsetTop;u=n}return u&&u.style.position==="fixed"&&(i+=window.pageXOffset||t.scrollLeft,r+=window.pageYOffset||t.scrollTop),{left:i,top:r}}function w(){var n=window.scrollY;return n==void 0&&(n=document.documentElement.scrollTop),n}function b(){var n=window.scrollX;return n==void 0&&(n=document.documentElement.scrollLeft),n}function bt(n){return n===window?w(n):n.scrollTop}function kt(n){return n===window?b(n):n.scrollLeft}function dt(n){for(var t=n.parentNode,i=["auto","scroll"],r,e,o,u="",f="",s="",h="";t&&t.style&&document.body!==t;){if((r=t.style.overflow,e=t.style.overflowX,o=t.style.overflowY,r=="scroll"||e=="scroll"||o=="scroll")||window.getComputedStyle&&(u=window.getComputedStyle(t),f=u.getPropertyValue("overflow"),s=u.getPropertyValue("overflow-y"),h=u.getPropertyValue("overflow-x"),f==="scroll"||h==="scroll"||s==="scroll")||t.clientHeight<=t.scrollHeight&&(i.indexOf(o)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(s)!==-1)||t.clientWidth<=t.scrollWidth&&(i.indexOf(e)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(h)!==-1))return t;t=t.parentNode}return window}function gt(n){for(var t=n.parentNode,i;t&&t.style&&document.body!==t;){if(t.style.overflow!=="visible"&&t.style.overflow!==""||window.getComputedStyle&&(i=window.getComputedStyle(t),i.getPropertyValue("overflow")!=="visible"&&i.getPropertyValue("overflow")!==""))return t;t=t.parentNode}return window}function ni(n,t){if(n){if(n===window)return t==="width"?window.innerWidth+"px":t==="height"?window.innerHeight+"px":void 0}else return;var r=n.style[t],i;return r!==""&&r!==void 0?r:(i=k(n),i[t]!==""&&i[t]!==void 0)?i[t]:void 0}function k(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}function ti(n){return n.offsetWidth}function ii(n){return e()&&n.firstChild&&n.firstChild.nodeName==="CAPTION"?n.offsetHeight+n.firstChild.offsetHeight:n.offsetHeight}function ri(n){return n.clientHeight||n.innerHeight}function ui(n){return n.clientWidth||n.innerWidth}function fi(n,t,i){window.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}function ei(n,t,i){window.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)}function bi(){var n=document.createElement("TABLE"),t,i;n.style.borderSpacing=0;n.style.borderWidth=0;n.style.padding=0;t=document.createElement("TBODY");n.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t<\/td><\/tr>";i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c";i.style.padding=0;i.style.margin=0;n.insertBefore(i,t);document.body.appendChild(n);d=n.offsetHeight<2*n.lastChild.offsetHeight;document.body.removeChild(n)}function e(){return d===void 0&&bi(),d}function oi(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}function si(n){var t,i;return n.selectionEnd?n.selectionEnd:document.selection?(t=document.selection.createRange(),t==null)?0:(i=n.createTextRange(),i.text.indexOf(t.text)+t.text.length):void 0}function hi(n,t,i){var u,f,r;if(i===void 0&&(i=t),n.setSelectionRange){n.focus();try{n.setSelectionRange(t,i)}catch(e){u=n.parentNode;f=u.style.display;u.style.display="block";n.setSelectionRange(t,i);u.style.display=f}}else n.createTextRange&&(r=n.createTextRange(),r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r.select())}function ki(){var t=document.createElement("p"),n,r,i;return t.style.width="100%",t.style.height="200px",n=document.createElement("div"),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),(document.body||document.documentElement).appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),(document.body||document.documentElement).removeChild(n),r-i}function ci(){return g===void 0&&(g=ki()),g}function nt(){return nt}function ai(){return tt}function vi(){return it}function yi(n,t,i){li||tt?(n.style.top=i,n.style.left=t):it?n.style["-webkit-transform"]="translate3d("+t+","+i+",0)":n.style.transform="translate3d("+t+","+i+",0)"}function pi(n){var t;return n.style.transform&&(t=n.style.transform)!==""?["transform",t]:n.style["-webkit-transform"]&&(t=n.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function wi(n){n.transform&&n.transform!==""?n.transform="":n["-webkit-transform"]&&n["-webkit-transform"]!==""&&(n["-webkit-transform"]="")}var ht,h,c,l,a,r,u,pt,d,g,li,tt,it;Object.defineProperties(i,{enableImmediatePropagation:{get:function(){return rt}},closest:{get:function(){return ut}},isChildOf:{get:function(){return ft}},isChildOfWebComponentTable:{get:function(){return et}},polymerWrap:{get:function(){return o}},polymerUnwrap:{get:function(){return s}},isWebComponentSupportedNatively:{get:function(){return ot}},index:{get:function(){return st}},hasClass:{get:function(){return lt}},addClass:{get:function(){return at}},removeClass:{get:function(){return vt}},removeTextNodes:{get:function(){return v}},empty:{get:function(){return y}},HTML_CHARACTERS:{get:function(){return u}},fastInnerHTML:{get:function(){return yt}},fastInnerText:{get:function(){return p}},isVisible:{get:function(){return f}},offset:{get:function(){return wt}},getWindowScrollTop:{get:function(){return w}},getWindowScrollLeft:{get:function(){return b}},getScrollTop:{get:function(){return bt}},getScrollLeft:{get:function(){return kt}},getScrollableElement:{get:function(){return dt}},getTrimmingContainer:{get:function(){return gt}},getStyle:{get:function(){return ni}},getComputedStyle:{get:function(){return k}},outerWidth:{get:function(){return ti}},outerHeight:{get:function(){return ii}},innerHeight:{get:function(){return ri}},innerWidth:{get:function(){return ui}},addEvent:{get:function(){return fi}},removeEvent:{get:function(){return ei}},hasCaptionProblem:{get:function(){return e}},getCaretPosition:{get:function(){return oi}},getSelectionEndPosition:{get:function(){return si}},setCaretPosition:{get:function(){return hi}},getScrollbarWidth:{get:function(){return ci}},isIE8:{get:function(){return nt}},isIE9:{get:function(){return ai}},isSafari:{get:function(){return vi}},setOverlayPosition:{get:function(){return yi}},getCssTransform:{get:function(){return pi}},resetCssTransform:{get:function(){return wi}},__esModule:{value:!0}});ht=document.documentElement.classList?!0:!1;ht?(a=function(){var n=document.createElement("div");return n.classList.add("test","test2"),n.classList.contains("test2")}(),h=function(n,t){return t===""?!1:n.classList.contains(t)},c=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=ct(t),a)n.classList.add.apply(n.classList,t);else while(t&&t[i])n.classList.add(t[i]),i++},l=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=ct(t),a)n.classList.remove.apply(n.classList,t);else while(t&&t[i])n.classList.remove(t[i]),i++}):(r=function(n){return new RegExp("(\\s|^)"+n+"(\\s|$)")},h=function(n,t){return n.className.match(r(t))?!0:!1},c=function(n,t){var u=0,i=n.className;if(typeof t=="string"&&(t=t.split(" ")),i==="")i=t.join(" ");else while(t&&t[u])r(t[u]).test(i)||(i+=" "+t[u]),u++;n.className=i},l=function(n,t){var u=0,i=n.className;for(typeof t=="string"&&(t=t.split(" "));t&&t[u];)i=i.replace(r(t[u])," ").trim(),u++;n.className!==i&&(n.className=i)});u=/(<(.*)>|&(.*);)/;pt=document.createTextNode("test").textContent?!0:!1;li=!document.createTextNode("test").textContent;tt=!!document.documentMode;it=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);window.Handsontable=window.Handsontable||{};Handsontable.Dom={addClass:at,addEvent:fi,closest:ut,empty:y,enableImmediatePropagation:rt,fastInnerHTML:yt,fastInnerText:p,getCaretPosition:oi,getComputedStyle:k,getCssTransform:pi,getScrollableElement:dt,getScrollbarWidth:ci,getScrollLeft:kt,getScrollTop:bt,getStyle:ni,getSelectionEndPosition:si,getTrimmingContainer:gt,getWindowScrollLeft:b,getWindowScrollTop:w,hasCaptionProblem:e,hasClass:lt,HTML_CHARACTERS:u,index:st,innerHeight:ri,innerWidth:ui,isChildOf:ft,isChildOfWebComponentTable:et,isIE8:nt,isIE9:ai,isSafari:vi,isVisible:f,isWebComponentSupportedNatively:ot,offset:wt,outerHeight:ii,outerWidth:ti,polymerUnwrap:s,polymerWrap:o,removeClass:vt,removeEvent:ei,removeTextNodes:v,resetCssTransform:wi,setCaretPosition:hi,setOverlayPosition:yi}},{}],28:[function(n,t,i){"use strict";function c(n,t,i){function o(n){var r=typeof t.settings.enterMoves=="function"?t.settings.enterMoves(event):t.settings.enterMoves;n?i.transformStart(-r.row,-r.col):i.transformStart(r.row,r.col,!0)}function v(n){n?i.transformEnd(-1,0):i.transformStart(-1,0)}function y(n){n?i.transformEnd(1,0):i.transformStart(1,0)}function p(n){n?i.transformEnd(0,1):i.transformStart(0,1)}function w(n){n?i.transformEnd(0,-1):i.transformStart(0,-1)}function b(c){var a,b,k;if(n.isListening()&&(Handsontable.hooks.run(n,"beforeKeyDown",c),!s)&&(l.enableImmediatePropagation(c),!c.isImmediatePropagationStopped())&&(t.lastKeyCode=c.keyCode,i.isSelected())){if(a=(c.ctrlKey||c.metaKey)&&!c.altKey,u&&!u.isWaiting()&&!r.isMetaKey(c.keyCode)&&!a&&!f.isEditorOpened()){f.openEditor("",c);return}b=c.shiftKey?i.setRangeEnd:i.setRangeStart;switch(c.keyCode){case e.A:!f.isEditorOpened()&&a&&(i.selectAll(),c.preventDefault(),r.stopPropagation(c));break;case e.ARROW_UP:f.isEditorOpened()&&!u.isWaiting()&&f.closeEditorAndSaveChanges(a);v(c.shiftKey);c.preventDefault();r.stopPropagation(c);break;case e.ARROW_DOWN:f.isEditorOpened()&&!u.isWaiting()&&f.closeEditorAndSaveChanges(a);y(c.shiftKey);c.preventDefault();r.stopPropagation(c);break;case e.ARROW_RIGHT:f.isEditorOpened()&&!u.isWaiting()&&f.closeEditorAndSaveChanges(a);p(c.shiftKey);c.preventDefault();r.stopPropagation(c);break;case e.ARROW_LEFT:f.isEditorOpened()&&!u.isWaiting()&&f.closeEditorAndSaveChanges(a);w(c.shiftKey);c.preventDefault();r.stopPropagation(c);break;case e.TAB:k=typeof t.settings.tabMoves=="function"?t.settings.tabMoves(c):t.settings.tabMoves;c.shiftKey?i.transformStart(-k.row,-k.col):i.transformStart(k.row,k.col,!0);c.preventDefault();r.stopPropagation(c);break;case e.BACKSPACE:case e.DELETE:i.empty(c);f.prepareEditor();c.preventDefault();break;case e.F2:f.openEditor(null,c);c.preventDefault();break;case e.ENTER:f.isEditorOpened()?(u&&u.state!==Handsontable.EditorState.WAITING&&f.closeEditorAndSaveChanges(a),o(c.shiftKey)):n.getSettings().enterBeginsEditing?f.openEditor(null,c):o(c.shiftKey);c.preventDefault();c.stopImmediatePropagation();break;case e.ESCAPE:f.isEditorOpened()&&f.closeEditorAndRestoreOriginalValue(a);c.preventDefault();break;case e.HOME:c.ctrlKey||c.metaKey?b(new h(0,t.selRange.from.col)):b(new h(t.selRange.from.row,0));c.preventDefault();r.stopPropagation(c);break;case e.END:c.ctrlKey||c.metaKey?b(new h(n.countRows()-1,t.selRange.from.col)):b(new h(t.selRange.from.row,n.countCols()-1));c.preventDefault();r.stopPropagation(c);break;case e.PAGE_UP:i.transformStart(-n.countVisibleRows(),0);c.preventDefault();r.stopPropagation(c);break;case e.PAGE_DOWN:i.transformStart(n.countVisibleRows(),0);c.preventDefault();r.stopPropagation(c)}}}function k(){function t(n,t,i){i.nodeName=="TD"&&f.openEditor()}n.addHook("afterDocumentKeyDown",b);c.addEventListener(document.documentElement,"keydown",function(t){n.runHooks("afterDocumentKeyDown",t)});n.view.wt.update("onCellDblClick",t);n.addHook("afterDestroy",function(){s=!0})}var f=this,e=r.keyCode,s=!1,c,u;c=a(n);this.destroyEditor=function(n){this.closeEditor(n)};this.getActiveEditor=function(){return u};this.prepareEditor=function(){var r,i,s,h,c,e,o;if(u&&u.isWaiting()){this.closeEditor(!1,!1,function(n){n&&f.prepareEditor()});return}r=t.selRange.highlight.row;i=t.selRange.highlight.col;s=n.colToProp(i);h=n.getCell(r,i);c=n.getDataAtCell(r,i);e=n.getCellMeta(r,i);o=n.getCellEditor(e);o?(u=Handsontable.editors.getEditor(o,n),u.prepare(r,i,s,h,c,e)):u=void 0};this.isEditorOpened=function(){return u&&u.isOpened()};this.openEditor=function(n,t){u&&!u.cellProperties.readOnly?u.beginEditing(n,t):u&&u.cellProperties.readOnly&&t&&t.keyCode===r.keyCode.ENTER&&o()};this.closeEditor=function(n,t,i){u?u.finishEditing(n,t,i):i&&i(!1)};this.closeEditorAndSaveChanges=function(n){return this.closeEditor(!1,n)};this.closeEditorAndRestoreOriginalValue=function(n){return this.closeEditor(!0,n)};k()}Object.defineProperties(i,{EditorManager:{get:function(){return c}},__esModule:{value:!0}});var u,f,e,o,s,h=(u=n("./3rdparty/walkontable/src/cell/coords.js"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords,r=(f=n("./helpers.js"),f&&f.__esModule&&f||{"default":f}),l=(e=n("./dom.js"),e&&e.__esModule&&e||{"default":e}),v=(o=n("./editors.js"),o&&o.__esModule&&o||{"default":o}).getEditor,a=(s=n("./eventManager.js"),s&&s.__esModule&&s||{"default":s}).eventManager;Handsontable.EditorManager=c},{"./3rdparty/walkontable/src/cell/coords.js":5,"./dom.js":27,"./editors.js":29,"./eventManager.js":41,"./helpers.js":42}],29:[function(n,t,i){"use strict";function h(n){var i,t;t={};i=n;this.getConstructor=function(){return n};this.getInstance=function(n){return n.guid in t||(t[n.guid]=new i(n)),t[n.guid]}}function e(n,t){var i=new h(t);typeof n=="string"&&(u[n]=i,Handsontable.editors[s.toUpperCaseFirst(n)+"Editor"]=t);f.set(t,i)}function o(n,t){var i;if(typeof n=="function")f.get(n)||e(null,n),i=f.get(n);else if(typeof n=="string")i=u[n];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!i)throw Error('No editor registered under name "'+n+'"');return i.getInstance(t)}function c(n){var t;if(typeof n=="string")t=u[n];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!t)throw Error('No editor registered under name "'+n+'"');return t.getConstructor()}function l(n){return u[n]?!0:!1}Object.defineProperties(i,{registerEditor:{get:function(){return e}},getEditor:{get:function(){return o}},hasEditor:{get:function(){return l}},getEditorConstructor:{get:function(){return c}},__esModule:{value:!0}});var r,s=(r=n("./helpers.js"),r&&r.__esModule&&r||{"default":r}),u={},f=new WeakMap;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.registerEditor=e;Handsontable.editors.getEditor=o},{"./helpers.js":42}],30:[function(n,t,i){"use strict";function r(n){this.instance=n;this.state=Handsontable.EditorState.VIRGIN;this._opened=!1;this._closeCallback=null;this.init()}Object.defineProperties(i,{BaseEditor:{get:function(){return r}},__esModule:{value:!0}});var u,f,e=(u=n("./../helpers.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./../3rdparty/walkontable/src/cell/coords.js"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.BaseEditor=r;Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};r.prototype._fireCallbacks=function(n){this._closeCallback&&(this._closeCallback(n),this._closeCallback=null)};r.prototype.init=function(){};r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};r.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented");};r.prototype.open=function(){throw Error("Editor open() method unimplemented");};r.prototype.close=function(){throw Error("Editor close() method unimplemented");};r.prototype.prepare=function(n,t,i,r,u,f){this.TD=r;this.row=n;this.col=t;this.prop=i;this.originalValue=u;this.cellProperties=f;this.state=Handsontable.EditorState.VIRGIN};r.prototype.extend=function(){function t(){n.apply(this,arguments)}function i(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n}var n=this.constructor;return i(t,n)};r.prototype.saveValue=function(n,t){var i,r;t?(i=this.instance.getSelected(),i[0]>i[2]&&(r=i[0],i[0]=i[2],i[2]=r),i[1]>i[3]&&(r=i[1],i[1]=i[3],i[3]=r),this.instance.populateFromArray(i[0],i[1],n,i[2],i[3],"edit")):this.instance.populateFromArray(this.row,this.col,n,null,null,"edit")};r.prototype.beginEditing=function(n,t){this.state==Handsontable.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new o(this.row,this.col)),this.instance.view.render(),this.state=Handsontable.EditorState.EDITING,n=typeof n=="string"?n:this.originalValue,this.setValue(e.stringify(n)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render())};r.prototype.finishEditing=function(n,t,i){var r=this,f,u;if(i&&(u=this._closeCallback,this._closeCallback=function(n){u&&u(n);i(n)}),!this.isWaiting()){if(this.state==Handsontable.EditorState.VIRGIN){this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));return}if(this.state==Handsontable.EditorState.EDITING){if(n){this.cancelChanges();this.instance.view.render();return}f=this.instance.getSettings().trimWhitespace?[[typeof this.getValue()=="string"?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]];this.state=Handsontable.EditorState.WAITING;this.saveValue(f,t);this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(n){r.state=Handsontable.EditorState.FINISHED;r.discardEditor(n)}):(this.state=Handsontable.EditorState.FINISHED,this.discardEditor(!0))}}};r.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED;this.discardEditor()};r.prototype.discardEditor=function(n){this.state===Handsontable.EditorState.FINISHED&&(n===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=Handsontable.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=Handsontable.EditorState.VIRGIN,this._fireCallbacks(!0)))};r.prototype.isOpened=function(){return this._opened};r.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING}},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../helpers.js":42}],31:[function(n,t,i){"use strict";function v(n){var t,i,r;if(c=!1,t=this.getActiveEditor(),i=l.keyCode,l.isPrintableChar(n.keyCode)||n.keyCode===i.BACKSPACE||n.keyCode===i.DELETE||n.keyCode===i.INSERT){if(r=0,n.keyCode===i.C&&(n.ctrlKey||n.metaKey))return;t.isOpened()||(r+=10);t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value);c=!0},r))}}var c;Object.defineProperties(i,{AutocompleteEditor:{get:function(){return r}},__esModule:{value:!0}});var e,o,s,h,l=(e=n("./../helpers.js"),e&&e.__esModule&&e||{"default":e}),u=(o=n("./../dom.js"),o&&o.__esModule&&o||{"default":o}),a=(s=n("./../editors.js"),s&&s.__esModule&&s||{"default":s}),p=a.getEditorConstructor,y=a.registerEditor,f=(h=n("./handsontableEditor.js"),h&&h.__esModule&&h||{"default":h}).HandsontableEditor,r=f.prototype.extend();r.prototype.init=function(){f.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};r.prototype.createElements=function(){f.prototype.createElements.apply(this,arguments);u.addClass(this.htContainer,"autocompleteEditor");u.addClass(this.htContainer,window.navigator.platform.indexOf("Mac")!==-1?"htMacScroll":"")};c=!1;r.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",v);f.prototype.prepare.apply(this,arguments)};r.prototype.open=function(){f.prototype.open.apply(this,arguments);var t=this.htEditor.getInstance(),n=this;this.TEXTAREA.style.visibility="visible";this.focus();t.updateSettings({colWidths:[u.outerWidth(this.TEXTAREA)-2],width:u.outerWidth(this.TEXTAREA)+u.getScrollbarWidth()+2,afterRenderer:function(t,i,r,u,f){var s=this.getCellMeta(i,r).filteringCaseSensitive===!0,e,o,f=Handsontable.helper.stringify(f);f&&(e=s?f.indexOf(this.query):f.toLowerCase().indexOf(n.query.toLowerCase()),e!=-1&&(o=f.substr(e,n.query.length),t.innerHTML=f.replace(o,"<strong>"+o+"<\/strong>")))}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=u.getScrollbarWidth()+2+"px";c&&(c=!1);n.instance._registerTimeout(setTimeout(function(){n.queryChoices(n.TEXTAREA.value)},0))};r.prototype.close=function(){f.prototype.close.apply(this,arguments)};r.prototype.queryChoices=function(n){var i,t,r,u;this.query=n;typeof this.cellProperties.source=="function"?(i=this,this.cellProperties.source(n,function(n){i.updateChoicesList(n)})):Array.isArray(this.cellProperties.source)?(n&&this.cellProperties.filter!==!1?(r=this.cellProperties.filteringCaseSensitive===!0,u=n.toLowerCase(),t=this.cellProperties.source.filter(function(t){return r?t.indexOf(n)!=-1:t.toLowerCase().indexOf(u)!=-1})):t=this.cellProperties.source,this.updateChoicesList(t)):this.updateChoicesList([])};r.prototype.updateChoicesList=function(n){var o=u.getCaretPosition(this.TEXTAREA),s=u.getSelectionEndPosition(this.TEXTAREA),i=r.sortByRelevance(this.getValue(),n,this.cellProperties.filteringCaseSensitive),f,e,t,h;if(this.cellProperties.filter!=!1){for(e=[],t=0,h=i.length;t<h;t++)e.push(n[i[t]]);f=0;n=e}else f=i[0];this.choices=n;this.htEditor.loadData(l.pivot([n]));this.updateDropdownHeight();this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(f);this.instance.listen();this.TEXTAREA.focus();u.setCaretPosition(this.TEXTAREA,o,o!=s?s:void 0)};r.prototype.updateDropdownHeight=function(){this.htEditor.updateSettings({height:this.getDropdownHeight()});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};r.prototype.finishEditing=function(n){n||this.instance.removeHook("beforeKeyDown",v);f.prototype.finishEditing.apply(this,arguments)};r.prototype.highlightBestMatchingChoice=function(n){typeof n=="number"?this.htEditor.selectCell(n,0):this.htEditor.deselectCell()};r.sortByRelevance=function(n,t,i){var e=[],f,h=n.length,o,c,s=[],r,u;if(h===0){for(r=0,u=t.length;r<u;r++)s.push(r);return s}for(r=0,u=t.length;r<u;r++)(f=Handsontable.helper.stringify(t[r]),o=i?f.indexOf(n):f.toLowerCase().indexOf(n.toLowerCase()),o!=-1)&&(c=f.length-o-h,e.push({baseIndex:r,index:o,charsLeft:c,value:f}));for(e.sort(function(n,t){return t.index===-1?-1:n.index===-1?1:n.index<t.index?-1:t.index<n.index?1:n.index===t.index?n.charsLeft<t.charsLeft?-1:n.charsLeft>t.charsLeft?1:0:void 0}),r=0,u=e.length;r<u;r++)s.push(e[r].baseIndex);return s};r.prototype.getDropdownHeight=function(){var n=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*n:this.choices.length*n+8};y("autocomplete",r)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./handsontableEditor.js":35}],32:[function(n,t,i){"use strict";Object.defineProperties(i,{CheckboxEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,o=(r=n("./../editors.js"),r&&r.__esModule&&r||{"default":r}).registerEditor,s=(u=n("./_baseEditor.js"),u&&u.__esModule&&u||{"default":u}).BaseEditor,h=(f=n("./../dom.js"),f&&f.__esModule&&f||{"default":f}),e=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=e;$traceurRuntime.createClass(e,{beginEditing:function(){var n=this.TD.querySelector('input[type="checkbox"]');h.hasClass(n,"htBadValue")||n.click()},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},s);o("checkbox",e)},{"./../dom.js":27,"./../editors.js":29,"./_baseEditor.js":30}],33:[function(n,t,i){"use strict";Object.defineProperties(i,{DateEditor:{get:function(){return a}},__esModule:{value:!0}});var f,e,o,s,h,c,l,v=(f=n("./../helpers.js"),f&&f.__esModule&&f||{"default":f}),y=(e=n("./../dom.js"),e&&e.__esModule&&e||{"default":e}),p=(o=n("./../editors.js"),o&&o.__esModule&&o||{"default":o}),g=p.getEditor,b=p.registerEditor,k=(s=n("./textEditor.js"),s&&s.__esModule&&s||{"default":s}).TextEditor,d=(h=n("./../eventManager.js"),h&&h.__esModule&&h||{"default":h}).eventManager,u=(c=n("moment"),c&&c.__esModule&&c||{"default":c}).default,w=(l=n("pikaday"),l&&l.__esModule&&l||{"default":l}).default,a=function(n){this.$datePicker=null;this.datePicker=null;this.datePickerStyle=null;this.defaultDateFormat="DD/MM/YYYY";this.isCellEdited=!1;this.parentDestroyed=!1;$traceurRuntime.superGet(this,r.prototype,"constructor").call(this,n)},r=a;$traceurRuntime.createClass(a,{init:function(){var n=this;if(typeof u!="function")throw new Error("You need to include moment.js to your project.");if(typeof w!="function")throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,r.prototype,"init").call(this);this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0;n.destroyElements()})},createElements:function(){var n=this,t,i,f;$traceurRuntime.superGet(this,r.prototype,"createElements").call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;y.addClass(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);t=this.TEXTAREA;i={format:this.defaultDateFormat,field:t,trigger:t,container:this.datePicker,reposition:!1,bound:!1,onSelect:function(t){isNaN(t.getTime())||(t=u(t).format(n.cellProperties.dateFormat||n.defaultDateFormat));n.setValue(t);n.hideDatepicker()},onClose:function(){n.parentDestroyed||n.finishEditing(!1)}};this.$datePicker=new w(i);f=d(this);f.addEventListener(this.datePicker,"mousedown",function(n){v.stopPropagation(n)});this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(n,t,i,u,f,e){this._opened=!1;$traceurRuntime.superGet(this,r.prototype,"prepare").call(this,n,t,i,u,f,e)},open:function(){var n=arguments[0]!==void 0?arguments[0]:null;$traceurRuntime.superGet(this,r.prototype,"open").call(this);this.showDatepicker(n)},close:function(){var n=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){n.instance.selection.refreshBorders()},0));$traceurRuntime.superGet(this,r.prototype,"close").call(this)},finishEditing:function(){var t=arguments[0]!==void 0?arguments[0]:!1,i=arguments[1]!==void 0?arguments[1]:!1,n;t&&(n=this.originalValue,n!==void 0&&this.setValue(n));this.hideDatepicker();$traceurRuntime.superGet(this,r.prototype,"finishEditing").call(this,t,i)},showDatepicker:function(n){var r=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,f=this.$datePicker.config(),t,e=this.instance.view.isMouseDown(),o=n?v.isMetaKey(n.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+r.top+y.outerHeight(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+r.left+"px";this.$datePicker._onInputFocus=function(){};f.format=i;this.originalValue?(t=this.originalValue,u(t,i,!0).isValid()&&this.$datePicker.setMoment(u(t,i),!0),o||e||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,f.defaultDate=t,u(t,i,!0).isValid()&&this.$datePicker.setMoment(u(t,i),!0),o||e||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none";this.$datePicker.hide()}},{},k);b("date",a)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./textEditor.js":40,moment:"moment",pikaday:"pikaday"}],34:[function(n,t,i){"use strict";Object.defineProperties(i,{DropdownEditor:{get:function(){return f}},__esModule:{value:!0}});var r,u,e=(r=n("./../editors.js"),r&&r.__esModule&&r||{"default":r}),c=e.getEditor,s=e.registerEditor,h=(u=n("./autocompleteEditor.js"),u&&u.__esModule&&u||{"default":u}).AutocompleteEditor,f=function(){$traceurRuntime.superConstructor(o).apply(this,arguments)},o=f;$traceurRuntime.createClass(f,{prepare:function(n,t,i,r,u,f){$traceurRuntime.superGet(this,o.prototype,"prepare").call(this,n,t,i,r,u,f);this.cellProperties.filter=!1;this.cellProperties.strict=!0}},{},h);s("dropdown",f)},{"./../editors.js":29,"./autocompleteEditor.js":31}],35:[function(n,t,i){"use strict";var c;Object.defineProperties(i,{HandsontableEditor:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,s,h=(f=n("./../helpers.js"),f&&f.__esModule&&f||{"default":f}),a=(e=n("./../dom.js"),e&&e.__esModule&&e||{"default":e}),l=(o=n("./../editors.js"),o&&o.__esModule&&o||{"default":o}),y=l.getEditor,v=l.registerEditor,u=(s=n("./textEditor.js"),s&&s.__esModule&&s||{"default":s}).TextEditor,r=u.prototype.extend();r.prototype.createElements=function(){u.prototype.createElements.apply(this,arguments);var n=document.createElement("DIV");n.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(n);this.htContainer=n;this.htEditor=new Handsontable(n);this.assignHooks()};r.prototype.prepare=function(n,t,i,r,f,e){u.prototype.prepare.apply(this,arguments);var o=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var n=this.getValue();n!==void 0&&o.setValue(n);o.instance.destroyEditor()}};this.cellProperties.handsontable&&h.extend(s,e.handsontable);this.htEditor&&this.htEditor.destroy();this.htEditor=new Handsontable(this.htContainer,s)};c=function(n){var r,t,i,f,u;(n!=null&&n.isImmediatePropagationEnabled==null&&(n.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1;this.cancelBubble=!0},n.isImmediatePropagationEnabled=!0,n.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),n.isImmediatePropagationStopped())||(r=this.getActiveEditor(),t=r.htEditor.getInstance(),n.keyCode==h.keyCode.ARROW_DOWN?t.getSelected()?(u=t.getSelected()[0],f=t.countRows()-1,i=Math.min(f,u+1)):i=0:n.keyCode==h.keyCode.ARROW_UP&&t.getSelected()&&(u=t.getSelected()[0],i=u-1),i!==void 0&&(i<0?t.deselectCell():t.selectCell(i,0),n.preventDefault(),n.stopImmediatePropagation(),r.instance.listen(),r.TEXTAREA.focus()))};r.prototype.open=function(){this.instance.addHook("beforeKeyDown",c);u.prototype.open.apply(this,arguments);this.htEditor.render();this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");a.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)};r.prototype.close=function(){this.instance.removeHook("beforeKeyDown",c);this.instance.listen();u.prototype.close.apply(this,arguments)};r.prototype.focus=function(){this.instance.listen();u.prototype.focus.apply(this,arguments)};r.prototype.beginEditing=function(){var n=this.instance.getSettings().onBeginEditing;n&&n()===!1||u.prototype.beginEditing.apply(this,arguments)};r.prototype.finishEditing=function(){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();n!==void 0&&this.setValue(n)}return u.prototype.finishEditing.apply(this,arguments)};r.prototype.assignHooks=function(){var n=this;this.instance.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})};v("handsontable",r)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./textEditor.js":40}],36:[function(n,t,i){"use strict";Object.defineProperties(i,{MobileTextEditor:{get:function(){return u}},__esModule:{value:!0}});var e,o,s,h,c,a=(e=n("./../helpers.js"),e&&e.__esModule&&e||{"default":e}),r=(o=n("./../dom.js"),o&&o.__esModule&&o||{"default":o}),l=(s=n("./../editors.js"),s&&s.__esModule&&s||{"default":s}),b=l.getEditor,v=l.registerEditor,y=(h=n("./_baseEditor.js"),h&&h.__esModule&&h||{"default":h}).BaseEditor,p=(c=n("./../eventManager.js"),c&&c.__esModule&&c||{"default":c}).eventManager,u=y.prototype.extend(),f={},w=function(){this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var n in this.controls)this.controls.hasOwnProperty(n)&&this.positionControls.appendChild(this.controls[n])};u.prototype.valueChanged=function(){return this.initValue!=this.getValue()};u.prototype.init=function(){var n=this;this.eventManager=p(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){n.destroy()})};u.prototype.getValue=function(){return this.TEXTAREA.value};u.prototype.setValue=function(n){this.initValue=n;this.TEXTAREA.value=n};u.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className="positionControls";this.TEXTAREA=document.createElement("TEXTAREA");r.addClass(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);w.call(this);document.body.appendChild(this.editorContainer)};u.prototype.onBeforeKeyDown=function(n){var u=this,i=u.getActiveEditor(),t;if(r.enableImmediatePropagation(n),n.target===i.TEXTAREA&&!n.isImmediatePropagationStopped()){t=a.keyCode;switch(n.keyCode){case t.ENTER:i.close();n.preventDefault();break;case t.BACKSPACE:n.stopImmediatePropagation()}}};u.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);r.addClass(this.editorContainer,"active");r.removeClass(this.cellPointer,"hidden");this.updateEditorPosition()};u.prototype.focus=function(){this.TEXTAREA.focus();r.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};u.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);r.removeClass(this.editorContainer,"active")};u.prototype.scrollToView=function(){var n=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(n)};u.prototype.hideCellPointer=function(){r.hasClass(this.cellPointer,"hidden")||r.addClass(this.cellPointer,"hidden")};u.prototype.updateEditorPosition=function(n,t){var e,i;if(n&&t)n=parseInt(n,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=n+"px";else if(e=this.instance.getSelected(),i=this.instance.getCell(e[0],e[1]),f.cellPointer||(f.cellPointer={height:r.outerHeight(this.cellPointer),width:r.outerWidth(this.cellPointer)}),f.editorContainer||(f.editorContainer={width:r.outerWidth(this.editorContainer)}),i!==undefined){var h=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:r.getScrollLeft(this.instance.view.wt.wtOverlays.leftOverlay.holder),c=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:r.getScrollTop(this.instance.view.wt.wtOverlays.topOverlay.holder),u=r.offset(i),o=r.outerWidth(i),s={x:h,y:c};this.editorContainer.style.top=parseInt(u.top+r.outerHeight(i)-s.y+f.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-f.editorContainer.width/2,10)+"px";u.left+o/2>parseInt(this.editorContainer.style.left,10)+f.editorContainer.width?this.editorContainer.style.left=window.innerWidth-f.editorContainer.width+"px":u.left+o/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px");this.cellPointer.style.left=parseInt(u.left-f.cellPointer.width/2-r.offset(this.editorContainer).left+o/2-s.x,10)+"px"}};u.prototype.updateEditorData=function(){var n=this.instance.getSelected(),t=this.instance.getDataAtCell(n[0],n[1]);this.row=n[0];this.col=n[1];this.setValue(t);this.updateEditorPosition()};u.prototype.prepareAndSave=function(){var n;if(!this.valueChanged())return!0;n=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]];this.saveValue(n)};u.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(0,-1,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(0,1,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(-1,0,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(1,0,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(t.touches.length==1){var i=t.touches[0],r={x:n.editorContainer.offsetLeft,y:n.editorContainer.offsetTop},u={x:i.pageX-r.x,y:i.pageY-r.y};n.eventManager.addEventListener(this,"touchmove",function(t){var i=t.touches[0];n.updateEditorPosition(i.pageX-u.x,i.pageY-u.y);n.hideCellPointer();t.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(t){r.isChildOf(t.target,n.editorContainer)||r.isChildOf(t.target,n.instance.rootElement)||n.close()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(){n.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&n.hideCellPointer()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(){n.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&n.hideCellPointer()})};u.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};v("mobile",u)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30}],37:[function(n,t,i){"use strict";Object.defineProperties(i,{NumericEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,o=(r=n("numeral"),r&&r.__esModule&&r||{"default":r}).default,s=(u=n("./../editors.js"),u&&u.__esModule&&u||{"default":u}),a=s.getEditor,c=s.registerEditor,l=(f=n("./textEditor.js"),f&&f.__esModule&&f||{"default":f}).TextEditor,e=function(){$traceurRuntime.superConstructor(h).apply(this,arguments)},h=e;$traceurRuntime.createClass(e,{beginEditing:function(n){if(typeof n=="undefined"&&this.originalValue){typeof this.cellProperties.language!="undefined"&&o.language(this.cellProperties.language);var t=o.languageData().delimiters.decimal;n=(""+this.originalValue).replace(".",t)}$traceurRuntime.superGet(this,h.prototype,"beginEditing").call(this,n)}},{},l);c("numeric",e)},{"./../editors.js":29,"./textEditor.js":40,numeral:"numeral"}],38:[function(n,t,i){"use strict";Object.defineProperties(i,{PasswordEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,h=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./../editors.js"),u&&u.__esModule&&u||{"default":u}),a=o.getEditor,c=o.registerEditor,l=(f=n("./textEditor.js"),f&&f.__esModule&&f||{"default":f}).TextEditor,e=function(){$traceurRuntime.superConstructor(s).apply(this,arguments)},s=e;$traceurRuntime.createClass(e,{createElements:function(){$traceurRuntime.superGet(this,s.prototype,"createElements").call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;h.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},l);c("password",e)},{"./../dom.js":27,"./../editors.js":29,"./textEditor.js":40}],39:[function(n,t,i){"use strict";var h;Object.defineProperties(i,{SelectEditor:{get:function(){return u}},__esModule:{value:!0}});var f,e,o,s,r=(f=n("./../dom.js"),f&&f.__esModule&&f||{"default":f}),c=(e=n("./../helpers.js"),e&&e.__esModule&&e||{"default":e}),l=(o=n("./../editors.js"),o&&o.__esModule&&o||{"default":o}),y=l.getEditor,v=l.registerEditor,a=(s=n("./_baseEditor.js"),s&&s.__esModule&&s||{"default":s}).BaseEditor,u=a.prototype.extend();u.prototype.init=function(){this.select=document.createElement("SELECT");r.addClass(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select)};u.prototype.prepare=function(){var n,t,i,u;a.prototype.prepare.apply(this,arguments);n=this.cellProperties.selectOptions;t=typeof n=="function"?this.prepareOptions(n(this.row,this.col,this.prop)):this.prepareOptions(n);r.empty(this.select);for(i in t)t.hasOwnProperty(i)&&(u=document.createElement("OPTION"),u.value=i,r.fastInnerHTML(u,t[i]),this.select.appendChild(u))};u.prototype.prepareOptions=function(n){var i={},t,r;if(Array.isArray(n))for(t=0,r=n.length;t<r;t++)i[n[t]]=n[t];else typeof n=="object"&&(i=n);return i};u.prototype.getValue=function(){return this.select.value};u.prototype.setValue=function(n){this.select.value=n};h=function(n){var u=this,t=u.getActiveEditor(),i,r;n!=null&&n.isImmediatePropagationEnabled==null&&(n.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1},n.isImmediatePropagationEnabled=!0,n.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled});switch(n.keyCode){case c.keyCode.ARROW_UP:i=t.select.selectedIndex-1;i>=0&&(t.select[i].selected=!0);n.stopImmediatePropagation();n.preventDefault();break;case c.keyCode.ARROW_DOWN:r=t.select.selectedIndex+1;r<=t.select.length-1&&(t.select[r].selected=!0);n.stopImmediatePropagation();n.preventDefault()}};u.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0};u.prototype.open=function(){var f=r.outerWidth(this.TD),e=r.outerHeight(this.TD),i=r.offset(this.instance.rootElement),u=r.offset(this.TD),o=this.checkEditorSection(),t,n;switch(o){case"top":t=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":t=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":t=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}n=this.select.style;t&&t!=-1?n[t[0]]=t[1]:r.resetCssTransform(this.select);n.height=e+"px";n.minWidth=f+"px";n.top=u.top-i.top+"px";n.left=u.left-i.left+"px";n.margin="0px";n.display="";this.instance.addHook("beforeKeyDown",h)};u.prototype.close=function(){this.select.style.display="none";this.instance.removeHook("beforeKeyDown",h)};u.prototype.focus=function(){this.select.focus()};v("select",u)},{"./../dom.js":27,"./../editors.js":29,"./../helpers.js":42,"./_baseEditor.js":30}],40:[function(n,t,i){"use strict";var a;Object.defineProperties(i,{TextEditor:{get:function(){return u}},__esModule:{value:!0}});var f,e,o,s,h,c,r=(f=n("./../dom.js"),f&&f.__esModule&&f||{"default":f}),l=(e=n("./../helpers.js"),e&&e.__esModule&&e||{"default":e}),y=(o=n("autoResize"),o&&o.__esModule&&o||{"default":o}).default,p=(s=n("./_baseEditor.js"),s&&s.__esModule&&s||{"default":s}).BaseEditor,w=(h=n("./../eventManager.js"),h&&h.__esModule&&h||{"default":h}).eventManager,v=(c=n("./../editors.js"),c&&c.__esModule&&c||{"default":c}),k=v.getEditor,b=v.registerEditor,u=p.prototype.extend();u.prototype.init=function(){var n=this;this.createElements();this.eventManager=w(this);this.bindEvents();this.autoResize=y();this.instance.addHook("afterDestroy",function(){n.destroy()})};u.prototype.getValue=function(){return this.TEXTAREA.value};u.prototype.setValue=function(n){this.TEXTAREA.value=n};a=function(n){var h=this,i=h.getActiveEditor(),t,f,u,o;if(t=l.keyCode,f=(n.ctrlKey||n.metaKey)&&!n.altKey,r.enableImmediatePropagation(n),n.target===i.TEXTAREA&&!n.isImmediatePropagationStopped()){if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){n.stopImmediatePropagation();return}switch(n.keyCode){case t.ARROW_RIGHT:case t.ARROW_LEFT:case t.ARROW_UP:case t.ARROW_DOWN:i.isWaiting()||n.stopImmediatePropagation();break;case t.ENTER:if(u=i.instance.getSelected(),o=!(u[0]===u[2]&&u[1]===u[3]),f&&!o||n.altKey){if(i.isOpened()){var e=r.getCaretPosition(i.TEXTAREA),s=i.getValue(),c=s.slice(0,e)+"\n"+s.slice(e);i.setValue(c);r.setCaretPosition(i.TEXTAREA,e+1)}else i.beginEditing(i.originalValue+"\n");n.stopImmediatePropagation()}n.preventDefault();break;case t.A:case t.X:case t.C:case t.V:f&&n.stopImmediatePropagation();break;case t.BACKSPACE:case t.DELETE:case t.HOME:case t.END:n.stopImmediatePropagation()}i.autoResize.resize(String.fromCharCode(n.keyCode))}};u.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",a)};u.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",a)};u.prototype.focus=function(){this.TEXTAREA.focus();r.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};u.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");r.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");r.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var n=this;this.instance._registerTimeout(setTimeout(function(){n.refreshDimensions()},0))};u.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0};u.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex=""}if(n!=-1&&n!=-2)return n};u.prototype.refreshDimensions=function(){if(this.state===Handsontable.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var u=r.offset(this.TD),f=r.offset(this.instance.rootElement),e=r.getScrollableElement(this.TD),t=u.top-f.top-1-(e.scrollTop||0),i=u.left-f.left-1-(e.scrollLeft||0),o=this.instance.getSettings(),s=o.rowHeaders?1:0,y=o.colHeaders?1:0,p=this.checkEditorSection(),h=this.TD.style.backgroundColor,n;switch(p){case"top":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=r.getCssTransform(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"corner":n=r.getCssTransform(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode)}t<0&&(t=0);i<0&&(i=0);y&&this.instance.getSelected()[0]===0&&(t+=1);s&&this.instance.getSelected()[1]===0&&(i+=1);n&&n!=-1?this.textareaParentStyle[n[0]]=n[1]:r.resetCssTransform(this.textareaParentStyle);this.textareaParentStyle.top=t+"px";this.textareaParentStyle.left=i+"px";var w=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),b=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),c=r.innerWidth(this.TD)-8,l=this.instance.view.maximumVisibleElementWidth(b)-10,a=this.TD.scrollHeight+1,v=this.instance.view.maximumVisibleElementHeight(w)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(a-=1);parseInt(this.TD.style.borderLeftWidth,10)>0&&s>0&&(c-=1);this.TEXTAREA.style.fontSize=r.getComputedStyle(this.TD).fontSize;this.TEXTAREA.style.fontFamily=r.getComputedStyle(this.TD).fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=h?h:r.getComputedStyle(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(a,v),maxHeight:v,minWidth:Math.min(c,l),maxWidth:l},!0);this.textareaParentStyle.display="block"}};u.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(n){l.stopPropagation(n)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(n){l.stopPropagation(n)});this.instance.addHook("afterScrollVertically",function(){n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterRowResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterDestroy",function(){n.eventManager.clear()})};u.prototype.destroy=function(){this.eventManager.clear()};b("text",u)},{"./../dom.js":27,"./../editors.js":29,"./../eventManager.js":41,"./../helpers.js":42,"./_baseEditor.js":30,autoResize:"autoResize"}],41:[function(n,t,i){"use strict";function o(n,t){var e="HOT-TABLE",o,f,s,r,i;if(t.isTargetWebComponent=!1,t.realTarget=t.target,!Handsontable.eventManager.isHotTableEnv)return t;for(t=u.polymerWrap(t),i=t.path?t.path.length:0;i--;){if(t.path[i].nodeName===e)o=!0;else if(o&&t.path[i].shadowRoot){r=t.path[i];break}i!==0||r||(r=t.path[i])}return r||(r=t.target),t.isTargetWebComponent=!0,u.isWebComponentSupportedNatively()?t.realTarget=t.srcElement||t.toElement:(n instanceof Handsontable.Core||n instanceof Walkontable)&&(n instanceof Handsontable.Core?f=n.view.wt.wtTable.TABLE:n instanceof Walkontable&&(f=n.wtTable.TABLE.parentNode.parentNode),s=u.closest(t.target,[e],f),t.realTarget=s?f.querySelector(e)||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return u.polymerWrap(r)},enumerable:!0,configurable:!0}),t}function e(n){return new f(n)}Object.defineProperties(i,{EventManager:{get:function(){return f}},eventManager:{get:function(){return e}},__esModule:{value:!0}});var r,u=(r=n("./dom.js"),r&&r.__esModule&&r||{"default":r}),f=function(){var n=arguments[0]!==void 0?arguments[0]:null;this.context=n||this;this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(f,{addEventListener:function(n,t,i){function r(n){n.target==void 0&&n.srcElement!=void 0&&(n.definePoperty?n.definePoperty("target",{value:n.srcElement}):n.target=n.srcElement);n.preventDefault==void 0&&(n.definePoperty?n.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):n.preventDefault=function(){this.returnValue=!1});n=o(f,n);i.call(this,n)}var u=this,f=this.context;return this.context.eventListeners.push({element:n,event:t,callback:i,callbackProxy:r}),window.addEventListener?n.addEventListener(t,r,!1):n.attachEvent("on"+t,r),Handsontable.countEventManagerListeners++,function(){u.removeEventListener(n,t,i)}},removeEventListener:function(n,t,i){for(var u=this.context.eventListeners.length,r;u--;)if(r=this.context.eventListeners[u],r.event==t&&r.element==n){if(i&&i!=r.callback)continue;this.context.eventListeners.splice(u,1);r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy);Handsontable.countEventManagerListeners--}},clearEvents:function(){for(var t=this.context.eventListeners.length,n;t--;)n=this.context.eventListeners[t],n&&this.removeEventListener(n.element,n.event,n.callback)},clear:function(){this.clearEvents()},fireEvent:function(n,t){var i={bubbles:!0,cancelable:t!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},r;document.createEvent?(r=document.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode)):r=document.createEventObject();n.dispatchEvent?n.dispatchEvent(r):n.fireEvent("on"+t,r)}},{});window.Handsontable=window.Handsontable||{};Handsontable.countEventManagerListeners=0;Handsontable.eventManager=e},{"./dom.js":27}],42:[function(n,t,i){"use strict";function b(n){return n==32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function k(n){var t=[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT];return t.indexOf(n)!=-1}function d(n){return[r.CONTROL_LEFT,224,r.COMMAND_LEFT,r.COMMAND_RIGHT].indexOf(n)!=-1}function a(n){switch(typeof n){case"string":case"number":return n+"";case"object":return n===null?"":n.toString();case"undefined":return"";default:return n.toString()}}function g(n){return n[0].toUpperCase()+n.substr(1)}function nt(){for(var i,r,u,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(i=[],r=t.length;r--;)u=a(t[r]).toLowerCase(),i.indexOf(u)===-1&&i.push(u);return i.length===1}function o(n){var i,t;if(Array.isArray(n))i=[];else{i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]&&typeof n[t]=="object"&&!Array.isArray(n[t])?o(n[t]):Array.isArray(n[t])?n[t].length&&typeof n[t][0]=="object"&&!Array.isArray(n[t][0])?[o(n[t][0])]:[]:null)}return i}function s(n){for(var t=n+1,i="",r;t>0;)r=(t-1)%26,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/26,10);return i}function tt(n,t){var u,i,r,f;for(n=typeof n=="number"?n:100,t=typeof t=="number"?t:4,u=[],i=0;i<n;i++){for(f=[],r=0;r<t;r++)f.push(s(r)+(i+1));u.push(f)}return u}function it(n,t){var u,r,i,f;for(n=typeof n=="number"?n:100,t=typeof t=="number"?t:4,u=[],r=0;r<n;r++){for(f={},i=0;i<t;i++)f["prop"+i]=s(i)+(r+1);u.push(f)}return u}function rt(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?n.length?n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):!1:t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):!1}function ut(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function v(n,t){return t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n}function ft(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])}function y(n,t){for(var i in t)t.hasOwnProperty(i)&&(t[i]&&typeof t[i]=="object"?(n[i]||(n[i]=Array.isArray(t[i])?[]:{}),y(n[i],t[i])):n[i]=t[i])}function et(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function ot(n,t){return JSON.stringify(n)===JSON.stringify(t)}function p(n){var i,r,t;return typeof n.__proto__=="object"?i=n.__proto__:(t=n.constructor,typeof n.constructor=="function"&&(r=t,delete n.constructor&&(t=n.constructor,n.constructor=r)),i=t?t.prototype:null),i}function st(n,t){function i(){}v(i,n);for(var r=0,u=t.length;r<u;r++)i.prototype[t[r]]=void 0;return i}function ht(n){for(var t,f,r=[],e=0,i=0,u=n.length;i<u;i++)for(t=0,f=n[i].length;t<f;t++)t==e&&(r.push([]),e++),r[t].push(n[i][t]);return r}function ct(n){for(var t=0,i=n.length;t<i;)n[t]=[n[t]],t++}function lt(n,t){for(var i=0,r=t.length;i<r;)n.push(t[i]),i++}function w(n){return["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true"}function at(n){return w(n)&&n.className.indexOf("handsontableInput")==-1&&n.className.indexOf("copyPaste")==-1}function vt(n){return Object.prototype.toString.call(n)=="[object Object]"}function yt(n){var i=[],u,f,r,t;if(!n||n.length===0||!n[0]||n[0].length===0)return i;for(u=n.length,f=n[0].length,r=0;r<u;r++)for(t=0;t<f;t++)i[t]||(i[t]=[]),i[t][r]=n[r][t];return i}function pt(n,t){return function(){return n.apply(t,arguments)}}function wt(n,t){function i(n){var t=Handsontable.cellTypes[n];if(typeof t=="undefined")throw new Error('You declared cell type "'+n+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t=typeof t=="undefined"?!0:t,function(r,u){return function f(r){if(r){if(r.hasOwnProperty(n)&&r[n]!==void 0)return r[n];if(r.hasOwnProperty("type")&&r.type){var u;if(typeof r.type!="string")throw new Error("Cell type must be a string ");if(u=i(r.type),u.hasOwnProperty(n))return u[n];if(t)return}}else return;return f(p(r))}(typeof r=="number"?this.getCellMeta(r,u):r)}}function bt(n){return n||(n=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)}function kt(){return"ontouchstart"in window}function dt(n){typeof n.stopPropagation=="function"?n.stopPropagation():n.cancelBubble=!0}function gt(n){if(n.pageX)return n.pageX;var t=l.getWindowScrollLeft();return n.clientX+t}function ni(n){if(n.pageY)return n.pageY;var t=l.getWindowScrollTop();return n.clientY+t}function ti(n,t,i,r){r.value=i;r.writable=r.writable===!1?!1:!0;r.enumerable=r.enumerable===!1?!1:!0;r.configurable=r.configurable===!1?!1:!0;Object.defineProperty(n,t,r)}function ri(n){return e.call(window,n)}function ui(n){c.call(window,n)}var f,l,r,u;Object.defineProperties(i,{isPrintableChar:{get:function(){return b}},isMetaKey:{get:function(){return k}},isCtrlKey:{get:function(){return d}},stringify:{get:function(){return a}},toUpperCaseFirst:{get:function(){return g}},equalsIgnoreCase:{get:function(){return nt}},duckSchema:{get:function(){return o}},spreadsheetColumnLabel:{get:function(){return s}},createSpreadsheetData:{get:function(){return tt}},createSpreadsheetObjectData:{get:function(){return it}},isNumeric:{get:function(){return rt}},randomString:{get:function(){return ut}},inherit:{get:function(){return v}},extend:{get:function(){return ft}},deepExtend:{get:function(){return y}},deepClone:{get:function(){return et}},isObjectEquals:{get:function(){return ot}},getPrototypeOf:{get:function(){return p}},columnFactory:{get:function(){return st}},translateRowsToColumns:{get:function(){return ht}},to2dArray:{get:function(){return ct}},extendArray:{get:function(){return lt}},isInput:{get:function(){return w}},isOutsideInput:{get:function(){return at}},keyCode:{get:function(){return r}},isObject:{get:function(){return vt}},pivot:{get:function(){return yt}},proxy:{get:function(){return pt}},cellMethodLookupFactory:{get:function(){return wt}},isMobileBrowser:{get:function(){return bt}},isTouchSupported:{get:function(){return kt}},stopPropagation:{get:function(){return dt}},pageX:{get:function(){return gt}},pageY:{get:function(){return ni}},defineGetter:{get:function(){return ti}},requestAnimationFrame:{get:function(){return ri}},cancelAnimationFrame:{get:function(){return ui}},__esModule:{value:!0}});l=(f=n("./dom.js"),f&&f.__esModule&&f||{"default":f});r={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};var ii=0,h=["ms","moz","webkit","o"],e=window.requestAnimationFrame,c=window.cancelAnimationFrame;for(u=0;u<h.length&&!e;++u)e=window[h[u]+"RequestAnimationFrame"],c=window[h[u]+"CancelAnimationFrame"]||window[h[u]+"CancelRequestAnimationFrame"];e||(e=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-ii)),r=window.setTimeout(function(){n(t+i)},i);return ii=t+i,r});c||(c=function(n){clearTimeout(n)});window.Handsontable=window.Handsontable||{};Handsontable.helper={cancelAnimationFrame:ui,cellMethodLookupFactory:wt,columnFactory:st,createSpreadsheetData:tt,createSpreadsheetObjectData:it,deepClone:et,deepExtend:y,defineGetter:ti,duckSchema:o,equalsIgnoreCase:nt,extend:ft,extendArray:lt,getPrototypeOf:p,inherit:v,isCtrlKey:d,isInput:w,isMetaKey:k,isMobileBrowser:bt,isNumeric:rt,isObject:vt,isObjectEquals:ot,isOutsideInput:at,isPrintableChar:b,isTouchSupported:kt,keyCode:r,pageX:gt,pageY:ni,pivot:yt,proxy:pt,randomString:ut,requestAnimationFrame:ri,spreadsheetColumnLabel:s,stopPropagation:dt,stringify:a,to2dArray:ct,toUpperCaseFirst:g,translateRowsToColumns:ht}},{"./dom.js":27}],43:[function(n,t,i){"use strict";function r(){function t(n){return n!==null&&!r(n)&&(typeof n=="string"||typeof n=="number")}function i(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function r(n){return n!==n}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(r){return t(r)?n.arrayMap[r]:i(r)?n.weakMap.get(r):void 0},set:function(r,u){if(t(r))n.arrayMap[r]=u;else if(i(r))n.weakMap.set(r,u);else throw new Error("Invalid key type");},"delete":function(r){t(r)?delete n.arrayMap[r]:i(r)&&n.weakMap["delete"](r)}}}Object.defineProperties(i,{MultiMap:{get:function(){return r}},__esModule:{value:!0}});window.MultiMap=r},{}],44:[function(n,t,i){"use strict";Object.defineProperties(i,{Hooks:{get:function(){return f}},__esModule:{value:!0}});var u,r=["afterCellMetaReset","afterChange","afterChangesObserved","afterColumnMove","afterColumnResize","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterIsMultipleSelectionCheck","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","afterRenderer","afterRowMove","afterRowResize","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","modifyCol","modifyColWidth","modifyRow","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave"],e=(u=n("./eventManager.js"),u&&u.__esModule&&u||{"default":u}).EventManager,f=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(f,{createEmptyBucket:function(){for(var t=Object.create(null),n=0,i=r.length;n<i;n++)t[r[n]]=[];return t},getBucket:function(){var n=arguments[0]!==void 0?arguments[0]:null;return n?(n.pluginHookBucket||(n.pluginHookBucket=this.createEmptyBucket()),n.pluginHookBucket):this.globalBucket},add:function(n,t){var f=arguments[2]!==void 0?arguments[2]:null,r,u,i;if(Array.isArray(t))for(r=0,u=t.length;r<u;r++)this.add(n,t[r]);else i=this.getBucket(f),typeof i[n]=="undefined"&&(this.register(n),i[n]=[]),t.skip=!1,i[n].indexOf(t)===-1&&i[n].push(t);return this},once:function(n,t){var r=arguments[2]!==void 0?arguments[2]:null,i,u;if(Array.isArray(t))for(i=0,u=t.length;i<u;i++)t[i].runOnce=!0,this.add(n,t[i],r);else t.runOnce=!0,this.add(n,t,r)},remove:function(n,t){var r=arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(r);return typeof i[n]!="undefined"&&i[n].indexOf(t)>=0?(t.skip=!0,!0):!1},run:function(n,t,i,r,u,f,e,o){for(var a,s,y,h,v,c=this.globalBucket[t],p=c?c.length:0,l=0;l<p;l++)c[l].skip||(a=c[l].call(n,i,r,u,f,e,o),a!==void 0&&(i=a),c[l].runOnce&&this.remove(t,c[l]));for(s=this.getBucket(n)[t],y=s?s.length:0,h=0;h<y;h++)s[h].skip||(v=s[h].call(n,i,r,u,f,e,o),v!==void 0&&(i=v),s[h].runOnce&&this.remove(t,s[h],n));return i},destroy:function(){var r=arguments[0]!==void 0?arguments[0]:null,t=this.getBucket(r),n,i,u;for(n in t)for(i=0,u=t[n].length;i<u;i++)this.remove(n,t[n],r)},register:function(n){this.isRegistered(n)||r.push(n)},deregister:function(n){this.isRegistered(n)&&r.splice(r.indexOf(n),1)},isRegistered:function(n){return r.indexOf(n)>=0},getRegistered:function(){return r}},{})},{"./eventManager.js":41}],45:[function(n,t,i){"use strict";function u(n,t){Handsontable.hooks.add("beforeInit",function(){var i;n=n.toLowerCase();r.has(this)||r.set(this,{});i=r.get(this);i[n]||(i[n]=new t(this))});Handsontable.hooks.add("afterDestroy",function(){var t,n;if(r.has(this)){n=r.get(this);for(t in n)n.hasOwnProperty(t)&&n[t].destroy();r.delete(this)}})}function f(n,t){if(typeof t!="string")throw Error('Only strings can be passed as "plugin" parameter');var i=t.toLowerCase();if(!r.has(n)||!r.get(n)[i])throw Error('No plugin registered under name "'+t+'"');return r.get(n)[i]}Object.defineProperties(i,{registerPlugin:{get:function(){return u}},getPlugin:{get:function(){return f}},__esModule:{value:!0}});var r=new WeakMap},{}],46:[function(n,t,i){"use strict";var r,f,u,e;Object.defineProperties(i,{"default":{get:function(){return e}},__esModule:{value:!0}});f=(r=n("./../helpers.js"),r&&r.__esModule&&r||{"default":r}).defineGetter;u=function(n){f(this,"hot",n,{writable:!1})};$traceurRuntime.createClass(u,{destroy:function(){delete this.hot}},{});e=u},{"./../helpers.js":42}],47:[function(n,t,i){"use strict";function s(){function i(n){var i=document,t=this;t.table=i.createElement("table");t.theadTh=i.createElement("th");t.table.appendChild(i.createElement("thead")).appendChild(i.createElement("tr")).appendChild(t.theadTh);t.tableStyle=t.table.style;t.tableStyle.tableLayout="auto";t.tableStyle.width="auto";t.tbody=i.createElement("tbody");t.table.appendChild(t.tbody);t.container=i.createElement("div");t.container.className=n.rootElement.className+" hidden";t.containerStyle=t.container.style;t.container.appendChild(t.table)}var n=this,t=5;this.beforeInit=function(){var t=this;t.autoColumnWidths=[];t.getSettings().autoColumnSize!==!1?t.autoColumnSizeTmp||(t.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},t.addHook("beforeRender",r.determineIfChanged),t.addHook("modifyColWidth",r.modifyColWidth),t.addHook("afterDestroy",r.afterDestroy),t.determineColumnWidth=n.determineColumnWidth):t.autoColumnSizeTmp&&(t.removeHook("beforeRender",r.determineIfChanged),t.removeHook("modifyColWidth",r.modifyColWidth),t.removeHook("afterDestroy",r.afterDestroy),delete t.determineColumnWidth,n.afterDestroy.call(t))};this.determineIfChanged=function(n){n&&r.determineColumnsWidth.apply(this,arguments)};this.determineColumnWidth=function(n){var r=this,f=r.autoColumnSizeTmp,w,u,e,s,c,l,a,b,y,v,p,g;for(f.container||i.call(f,r),f.container.className=r.rootElement.className+" htAutoColumnSize",f.table.className=r.table.className,w=r.countRows(),u={},e=0;e<w;e++)s=r.getDataAtCell(e,n),Array.isArray(s)||(s=h.stringify(s)),c=s.length,u[c]||(u[c]={needed:t,strings:[]}),u[c].needed&&(u[c].strings.push({value:s,row:e}),u[c].needed--);r.getColHeader(n)!==null&&r.view.appendColHeader(n,f.theadTh);o.empty(f.tbody);for(l in u)if(u.hasOwnProperty(l))for(a=0,b=u[l].strings.length;a<b;a++){y=u[l].strings[a].row;v=r.getCellMeta(y,n);v.col=n;v.row=y;var nt=r.getCellRenderer(v),k=document.createElement("tr"),d=document.createElement("td");nt(r,d,y,n,r.colToProp(n),u[l].strings[a].value,v);e++;k.appendChild(d);f.tbody.appendChild(k)}return p=r.rootElement.parentNode,p.appendChild(f.container),g=o.outerWidth(f.table),p.removeChild(f.container),g};this.determineColumnsWidth=function(){var i=this,r=this.getSettings(),u,t;if(r.autoColumnSize||!r.colWidths)for(u=this.countCols(),t=0;t<u;t++)i._getColWidthFromSettings(t)||(this.autoColumnWidths[t]=n.determineColumnWidth.call(i,t));this.view.wt&&this.view.wt.wtOverlays.adjustElementsSize(!0)};this.modifyColWidth=function(n,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>n?this.autoColumnWidths[t]:n};this.afterDestroy=function(){var n=this;n.autoColumnSizeTmp&&n.autoColumnSizeTmp.container&&n.autoColumnSizeTmp.container.parentNode&&n.autoColumnSizeTmp.container.parentNode.removeChild(n.autoColumnSizeTmp.container);n.autoColumnSizeTmp=null}}var r;Object.defineProperties(i,{AutoColumnSize:{get:function(){return s}},__esModule:{value:!0}});var u,f,e,h=(u=n("./../../helpers.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./../../dom.js"),f&&f.__esModule&&f||{"default":f}),c=(e=n("./../../plugins.js"),e&&e.__esModule&&e||{"default":e}).registerPlugin;r=new s;Handsontable.hooks.add("beforeInit",r.beforeInit);Handsontable.hooks.add("afterUpdateSettings",r.beforeInit)},{"./../../dom.js":27,"./../../helpers.js":42,"./../../plugins.js":45}],48:[function(n,t,i){"use strict";function l(n,t,i,r){var l=i.length,a=i?i[0].length:0,c=[],e=[],v,y,u,f,h,o,s;if(v=t.row-n.row,y=t.col-n.col,["down","up"].indexOf(r)!==-1){for(o=0;o<=y;o++)u=parseInt(i[0][o],10),f=parseInt(i[l-1][o],10),h=(r==="down"?f-u:u-f)/(l-1)||0,e.push(h);c.push(e)}if(["right","left"].indexOf(r)!==-1)for(s=0;s<=v;s++)u=parseInt(i[s][0],10),f=parseInt(i[s][a-1],10),h=(r==="right"?f-u:u-f)/(a-1)||0,e=[],e.push(h),c.push(e);return c}function u(n){function e(){if(!n.autofill)return!0;n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,i=!1)}function o(n){var i,r;if(!t.instance.autofill)return!1;i=h.offset(t.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+h.outerHeight(t.instance.table);r=h.offset(t.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+h.outerWidth(t.instance.table);t.addingStarted===!1&&t.instance.autofill.handle.isDragged>0&&n.clientY>i&&n.clientX<=r?(t.instance.mouseDragOutside=!0,t.addingStarted=!0):t.instance.mouseDragOutside=!1;t.instance.mouseDragOutside&&setTimeout(function(){t.addingStarted=!1;t.instance.alter("insert_row")},200)}var t=this,i=!1,u,f,r;this.instance=n;this.addingStarted=!1;r=c(n);r.addEventListener(document,"mouseup",e);r.addEventListener(document,"mousemove",o);u=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown;this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(t){n.autofill.handle.isDragged=1;i=!0;u(t)};f=this.instance.view.wt.wtSettings.settings.onCellMouseOver;this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(t,r,u,e){n.autofill&&i&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(r),n.autofill.checkIfNewRowNeeded());f(t,r,u,e)};this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}Object.defineProperties(i,{Autofill:{get:function(){return u}},__esModule:{value:!0}});var f,e,o,s,h=(f=n("./../../dom.js"),f&&f.__esModule&&f||{"default":f}),c=(e=n("./../../eventManager.js"),e&&e.__esModule&&e||{"default":e}).eventManager,a=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin,r=(s=n("./../../3rdparty/walkontable/src/cell/coords.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords;u.prototype.init=function(){this.handle={}};u.prototype.disable=function(){this.handle.disabled=!0};u.prototype.selectAdjacent=function(){var n,i,t,f,u;n=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();i=this.instance.getData();n:for(t=n[2]+1;t<this.instance.countRows();t++){for(u=n[1];u<=n[3];u++)if(i[t][u])break n;!i[t][n[1]-1]&&!i[t][n[3]+1]||(f=t)}f&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new r(n[0],n[1])),this.instance.view.wt.selections.fill.add(new r(f,n[3])),this.apply())};u.prototype.apply=function(){var n,t,i,u,o,f,s,e;(this.handle.isDragged=0,n=this.instance.view.wt.selections.fill.getCorners(),n)&&(this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",t,n),n[0]===t[0]&&n[1]<t[1]?(f="left",i=new r(n[0],n[1]),u=new r(n[2],t[1]-1)):n[0]===t[0]&&n[3]>t[3]?(f="right",i=new r(n[0],t[3]+1),u=new r(n[2],n[3])):n[0]<t[0]&&n[1]===t[1]?(f="up",i=new r(n[0],n[1]),u=new r(t[0]-1,n[3])):n[2]>t[2]&&n[1]===t[1]&&(f="down",i=new r(t[2]+1,n[1]),u=new r(n[2],n[3])),i&&i.row>-1&&i.col>-1?(e={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},o=this.instance.getData(e.from.row,e.from.col,e.to.row,e.to.col),s=l(i,u,o,f),Handsontable.hooks.run(this.instance,"beforeAutofill",i,u,o),this.instance.populateFromArray(i.row,i.col,o,u.row,u.col,"autofill",null,f,s),this.instance.selection.setRangeStart(new r(n[0],n[1])),this.instance.selection.setRangeEnd(new r(n[2],n[3]))):this.instance.selection.refreshBorders())};u.prototype.showBorder=function(n){var i=this.instance.getSelectedRange().getTopLeftCorner(),t=this.instance.getSelectedRange().getBottomRightCorner();if(this.instance.getSettings().fillHandle!=="horizontal"&&(t.row<n.row||i.row>n.row))n=new r(n.row,t.col);else if(this.instance.getSettings().fillHandle!=="vertical")n=new r(t.row,n.col);else return;this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from);this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to);this.instance.view.wt.selections.fill.add(n);this.instance.view.render()};u.prototype.checkIfNewRowNeeded=function(){var n,t,i=this.instance.countRows(),r=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),n=this.instance.view.wt.selections.fill.getCorners(),t[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){r.instance.alter("insert_row");r.addingStarted=!1},200))))};Handsontable.hooks.add("afterInit",function(){var n=new u(this);typeof this.getSettings().fillHandle!="undefined"&&(n.handle&&this.getSettings().fillHandle===!1?n.disable():n.handle||this.getSettings().fillHandle===!1||(this.autofill=n,this.autofill.init()))});Handsontable.Autofill=u},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45}],49:[function(n,t,i){"use strict";var h;Object.defineProperties(i,{"default":{get:function(){return h}},__esModule:{value:!0}});var u,f,e,o,r=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),c=(f=n("./../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,l=(e=n("./../_base.js"),e&&e.__esModule&&e||{"default":e}).default,a=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin,s=function(n){var i=this,t;$traceurRuntime.superConstructor(v).call(this,n);t=this;this.sortIndicators=[];this.hot.addHook("afterInit",function(){return i.init.call(i,"afterInit")});this.hot.addHook("afterUpdateSettings",function(){return i.init.call(i,"afterUpdateSettings")});this.hot.addHook("modifyRow",function(){return t.translateRow.apply(t,arguments)});this.hot.addHook("afterGetColHeader",function(){return t.getColHeader.apply(t,arguments)});Handsontable.hooks.register("beforeColumnSort");Handsontable.hooks.register("afterColumnSort")},v=s;$traceurRuntime.createClass(s,{init:function(n){var r=this.hot.getSettings().columnSorting,t=this,i,u,f;this.hot.sortingEnabled=!!r;this.hot.sortingEnabled?(this.hot.sortIndex=[],i=this.loadSortingState(),typeof i!="undefined"?(u=i.sortColumn,f=i.sortOrder):(u=r.column,f=r.sortOrder),this.sortByColumn(u,f),this.hot.sort=function(){var n=Array.prototype.slice.call(arguments);return t.sortByColumn.apply(t,n)},typeof this.hot.getSettings().observeChanges=="undefined"&&this.enableObserveChangesPlugin(),n=="afterInit"&&(this.bindColumnSortingAfterClick(),this.hot.addHook("afterCreateRow",function(){t.afterCreateRow.apply(t,arguments)}),this.hot.addHook("afterRemoveRow",function(){t.afterRemoveRow.apply(t,arguments)}),this.hot.addHook("afterLoadData",function(){t.init.apply(t,arguments)}))):(this.hot.sort=void 0,this.hot.removeHook("afterCreateRow",this.afterCreateRow),this.hot.removeHook("afterRemoveRow",this.afterRemoveRow),this.hot.removeHook("afterLoadData",this.init))},setSortingColumn:function(n,t){if(typeof n=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}this.hot.sortOrder=this.hot.sortColumn===n&&typeof t=="undefined"?this.hot.sortOrder===!1?void 0:!this.hot.sortOrder:typeof t!="undefined"?t:!0;this.hot.sortColumn=n},sortByColumn:function(n,t){(this.setSortingColumn(n,t),typeof this.hot.sortColumn!="undefined")&&(Handsontable.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.sort(),this.hot.render(),this.saveSortingState(),Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder))},saveSortingState:function(){var n={};typeof this.hot.sortColumn!="undefined"&&(n.sortColumn=this.hot.sortColumn);typeof this.hot.sortOrder!="undefined"&&(n.sortOrder=this.hot.sortOrder);(n.hasOwnProperty("sortColumn")||n.hasOwnProperty("sortOrder"))&&Handsontable.hooks.run(this.hot,"persistentStateSave","columnSorting",n)},loadSortingState:function(){var n={};return Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",n),n.value},bindColumnSortingAfterClick:function(){function i(){var t=n.hot.view.TBODY.querySelector("tr").querySelectorAll("th");return t.length}function u(n){var t=r.closest(n,"TH");return r.index(t)-i()}var t=c(this.hot),n=this;t.addEventListener(this.hot.rootElement,"click",function(t){if(r.hasClass(t.target,"columnSorting")){var i=u(t.target);if(i!==this.lastSortedColumn)n.sortOrderClass="ascending";else switch(n.hot.sortOrder){case void 0:n.sortOrderClass="ascending";break;case!0:n.sortOrderClass="descending";break;case!1:n.sortOrderClass=void 0}this.lastSortedColumn=i;n.sortByColumn(i)}})},enableObserveChangesPlugin:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(n){return function(t,i){return(typeof t[1]=="string"&&(t[1]=t[1].toLowerCase()),typeof i[1]=="string"&&(i[1]=i[1].toLowerCase()),t[1]===i[1])?0:t[1]===null||t[1]===""?1:i[1]===null||i[1]===""?-1:t[1]<i[1]?n?-1:1:t[1]>i[1]?n?1:-1:0}},dateSort:function(n){return function(t,i){if(t[1]===i[1])return 0;if(t[1]===null)return 1;if(i[1]===null)return-1;var r=new Date(t[1]),u=new Date(i[1]);return r<u?n?-1:1:r>u?n?1:-1:0}},sort:function(){var t,i,r,u,n;if(typeof this.hot.sortOrder!="undefined"){for(this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,r=this.hot.colOffset(),n=0,u=this.hot.countRows()-this.hot.getSettings().minSpareRows;n<u;n++)this.hot.sortIndex.push([n,this.hot.getDataAtCell(n,this.hot.sortColumn+r)]);t=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=t.sortIndicator;switch(t.type){case"date":i=this.dateSort;break;default:i=this.defaultSort}for(this.hot.sortIndex.sort(i(this.hot.sortOrder)),n=this.hot.sortIndex.length;n<this.hot.countRows();n++)this.hot.sortIndex.push([n,this.hot.getDataAtCell(n,this.hot.sortColumn+r)]);this.hot.sortingEnabled=!0}},translateRow:function(n){return this.hot.sortingEnabled&&typeof this.hot.sortOrder!="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[n]?this.hot.sortIndex[n][0]:n},untranslateRow:function(n){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==n)return t},getColHeader:function(n,t){var i=t.querySelector(".colHeader");this.hot.getSettings().columnSorting&&n>=0&&r.addClass(i,"columnSorting");r.removeClass(i,"descending");r.removeClass(i,"ascending");this.sortIndicators[n]&&n===this.hot.sortColumn&&(this.sortOrderClass==="ascending"?r.addClass(i,"ascending"):this.sortOrderClass==="descending"&&r.addClass(i,"descending"))},isSorted:function(){return typeof this.hot.sortColumn!="undefined"},afterCreateRow:function(n,t){var i;if(this.isSorted()){for(i=0;i<this.hot.sortIndex.length;i++)this.hot.sortIndex[i][0]>=n&&(this.hot.sortIndex[i][0]+=t);for(i=0;i<t;i++)this.hot.sortIndex.splice(n+i,0,[n+i,this.hot.getData()[n+i][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(n,t){var r,i;if(this.isSorted()){for(r=this.translateRow(n),this.hot.sortIndex.splice(n,t),i=0;i<this.hot.sortIndex.length;i++)this.hot.sortIndex[i][0]>r&&(this.hot.sortIndex[i][0]-=t);this.saveSortingState()}}},{},l);h=s;a("columnSorting",s)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],50:[function(n,t,i){"use strict";Object.defineProperties(i,{CommentEditor:{get:function(){return e}},__esModule:{value:!0}});var r,f=(r=n("./../../dom.js"),r&&r.__esModule&&r||{"default":r}),e=function(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.editorStyle.position="absolute";this.editorStyle.zIndex=100;this.hide()},u=e;$traceurRuntime.createClass(e,{setPosition:function(n,t){this.editorStyle.left=n+"px";this.editorStyle.top=t+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return this.editorStyle.display==="block"},setValue:function(){var n=arguments[0]!==void 0?arguments[0]:"";n=n||"";this.getInputElement().value=n},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var n=document.querySelector("."+u.CLASS_EDITOR_CONTAINER),t,i;return n||(n=document.createElement("div"),f.addClass(n,u.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),t=document.createElement("div"),f.addClass(t,u.CLASS_EDITOR),i=document.createElement("textarea"),f.addClass(i,u.CLASS_INPUT),t.appendChild(i),n.appendChild(t),t},getInputElement:function(){return this.editor.querySelector("."+u.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"./../../dom.js":27}],51:[function(n,t,i){"use strict";Object.defineProperties(i,{Comments:{get:function(){return l}},__esModule:{value:!0}});var u,f,e,o,s,h,r=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),y=(f=n("./../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).EventManager,c=(e=n("./../../3rdparty/walkontable/src/cell/coords.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords,a=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}),p=a.registerPlugin,k=a.getPlugin,w=(s=n("./../_base.js"),s&&s.__esModule&&s||{"default":s}).default,b=(h=n("./commentEditor.js"),h&&h.__esModule&&h||{"default":h}).CommentEditor,l=function(n){var t=this;($traceurRuntime.superConstructor(v).call(this,n),this.hot.getSettings().comments)&&(this.editor=new b,this.eventManager=new y(this),this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null,this.hot.addHook("afterInit",function(){return t.registerListeners()}),this.hot.addHook("afterContextMenuDefaultOptions",function(n){return t.addToContextMenu(n)}),this.hot.addHook("afterRenderer",function(n,i,r,u,f,e){return t.onAfterRenderer(n,e)}),this.hot.addHook("afterScrollVertically",function(){return t.refreshEditorPosition()}),this.hot.addHook("afterColumnResize",function(){return t.refreshEditorPosition()}),this.hot.addHook("afterRowResize",function(){return t.refreshEditorPosition()}))},v=l;$traceurRuntime.createClass(l,{registerListeners:function(){var n=this;this.eventManager.addEventListener(document,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(document,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(document,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document,"mouseup",function(t){return n.onMouseUp(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return n.onEditorBlur(t)})},setRange:function(n){this.range=n},clearRange:function(){this.range={}},targetIsCellWithComment:function(n){return r.hasClass(n.target,"htCommentCell")&&r.closest(n.target,[this.hot.rootElement])?!0:!1},targetIsCommentTextArea:function(n){return this.editor.getInputElement()===n.target},saveComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.editor.getValue(),t=this.range.from.row,i=this.range.from.col;this.hot.setCellMeta(t,i,"comment",n);this.hot.render()},saveCommentAtCell:function(n,t){this.setRange({from:new c(n,t)});this.saveComment()},removeComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment");this.hot.render();this.hide()},removeCommentAtCell:function(n,t){this.setRange({from:new c(n,t)});this.removeComment()},show:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditorPosition(!0),this.editor.setValue(n.comment||""),this.editor.show(),!0},showAtCell:function(n,t){return this.setRange({from:new c(n,t)}),this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var c=arguments[0]!==void 0?arguments[0]:!1;if(c||this.range.from&&this.editor.isVisible()){var l=this.hot.view.wt.wtTable.getCell(this.range.from),o=r.offset(l),a=this.hot.getColWidth(this.range.from.col),i=o.top,u=o.left,s=0,h=0;this.hot.view.wt.wtViewport.hasVerticalScroll()&&(i=i-this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),s=20);this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(u=u-this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),h=20);var f=u+a,e=i,n=this.hot.view.wt.wtTable.holder.getBoundingClientRect(),t={left:n.left+r.getWindowScrollLeft()+h,right:n.right+r.getWindowScrollLeft()-15,top:n.top+r.getWindowScrollTop()+s,bottom:n.bottom+r.getWindowScrollTop()};f<=t.left||f>t.right||e<=t.top||e>t.bottom?this.hide():this.editor.setPosition(f,e)}},onMouseDown:function(n){(this.mouseDown=!0,this.hot.view&&this.hot.view.wt)&&(this.contextMenuEvent||this.targetIsCommentTextArea(n)||this.targetIsCellWithComment(n)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(n){if(!this.mouseDown&&!this.editor.isFocused())if(this.targetIsCellWithComment(n)){var t=this.hot.view.wt.wtTable.getCoords(n.target),i={from:new c(t.row,t.col)};this.setRange(i);this.show()}else this.targetIsCommentTextArea(n)||this.editor.isFocused()||this.hide()},onMouseMove:function(n){var t=this;this.targetIsCommentTextArea(n)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.mouseDown=!1},200))},onMouseUp:function(){this.mouseDown=!1},onAfterRenderer:function(n,t){t.comment&&r.addClass(n,t.commentedCellClassName)},onEditorBlur:function(){this.saveComment()},checkSelectionCommentsConsistency:function(){var n=!1,t=this.hot.getSelectedRange().from;return this.hot.getCellMeta(t.row,t.col).comment&&(n=!0),n},onContextMenuAddComment:function(){var n=this,t=this.hot.getSelectedRange();this.contextMenuEvent=!0;this.setRange({from:t.from});this.show();setTimeout(function(){n.hot&&(n.hot.deselectCell(),n.editor.focus())},10)},onContextMenuRemoveComment:function(n,t){this.contextMenuEvent=!0;this.removeCommentAtCell(t.start.row,t.start.col)},addToContextMenu:function(n){var t=this;n.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!1}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(n,i){return t.onContextMenuRemoveComment(n,i)},disabled:function(){return!t.checkSelectionCommentsConsistency()}})},destroy:function(){this.eventManager&&this.eventManager.clear();this.editor&&this.editor.destroy();$traceurRuntime.superGet(this,v.prototype,"destroy").call(this)}},{},w);p("comments",l)},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,"./commentEditor.js":50}],52:[function(n,t,i){"use strict";function r(n){var t,l,i,v,u,s,h,y,c;this.instance=n;t=this;t.menus=[];t.htMenus={};t.triggerRows=[];t.eventManager=a(t);this.enabled=!0;this.instance.addHook("afterDestroy",function(){t.destroy()});this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(n,t){this.alter("insert_row",t.start.row)},disabled:function(){var n=this.getSelected(),t=[0,n[1],this.countRows()-1,n[1]],i=t.join(",")==n.join(",");return n[0]<0||this.countRows()>=this.getSettings().maxRows||i}},{key:"row_below",name:"Insert row below",callback:function(n,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var n=this.getSelected(),t=[0,n[1],this.countRows()-1,n[1]],i=t.join(",")==n.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||i}},r.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(n,t){this.alter("insert_col",t.start.col)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var n=this.getSelected(),t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||i}},{key:"col_right",name:"Insert column on the right",callback:function(n,t){this.alter("insert_col",t.end.col+1)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var n=this.getSelected(),t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(",");return n[1]<0||this.countCols()>=this.getSettings().maxCols||i}},r.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(n,t){var i=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,i)},disabled:function(){var n=this.getSelected(),t=[0,n[1],this.countRows()-1,n[1]],i=t.join(",")==n.join(",");return n[0]<0||i}},{key:"remove_col",name:"Remove column",callback:function(n,t){var i=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,i)},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var n=this.getSelected(),t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(",");return n[1]<0||i}},r.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},r.SEPARATOR,{key:"make_read_only",name:function(){var n="Read only",i=t.checkSelectionReadOnlyConsistency(this);return i&&(n=t.markSelected(n)),n},callback:function(){var n=t.checkSelectionReadOnlyConsistency(this),i=this;this.getSelectedRange().forAll(function(t,r){i.getCellMeta(t,r).readOnly=n?!1:!0});this.render()}},r.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var n="Left",i=t.checkSelectionAlignment(this,"htLeft");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var n="Center",i=t.checkSelectionAlignment(this,"htCenter");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var n="Right",i=t.checkSelectionAlignment(this,"htRight");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var n="Justify",i=t.checkSelectionAlignment(this,"htJustify");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},r.SEPARATOR,{name:function(){var n="Top",i=t.checkSelectionAlignment(this,"htTop");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var n="Middle",i=t.checkSelectionAlignment(this,"htMiddle");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var n="Bottom",i=t.checkSelectionAlignment(this,"htBottom");return i&&(n=t.markSelected(n)),n},callback:function(){e.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]};t.options={};f.extend(t.options,this.options);this.bindMouseEvents();this.markSelected=function(n){return"<span class='selected'>"+String.fromCharCode(10003)+"<\/span>"+n};this.checkSelectionAlignment=function(n,t){var i=!1;return n.getSelectedRange().forAll(function(r,u){var f=n.getCellMeta(r,u).className;if(f&&f.indexOf(t)!=-1)return i=!0,!1}),i};this.instance.getSettings().allowInsertRow||(l=o(this.defaultOptions.items,"row_above"),this.defaultOptions.items.splice(l,1),i=o(this.defaultOptions.items,"row_above"),this.defaultOptions.items.splice(i,1),this.defaultOptions.items.splice(i,1));this.instance.getSettings().allowInsertColumn||(v=o(this.defaultOptions.items,"col_left"),this.defaultOptions.items.splice(v,1),u=o(this.defaultOptions.items,"col_right"),this.defaultOptions.items.splice(u,1),this.defaultOptions.items.splice(u,1));s=!1;h=!1;this.instance.getSettings().allowRemoveRow||(y=o(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(y,1),s=!0);this.instance.getSettings().allowRemoveColumn||(c=o(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(c,1),h=!0);s&&h&&this.defaultOptions.items.splice(c,1);this.checkSelectionReadOnlyConsistency=function(n){var t=!1;return n.getSelectedRange().forAll(function(i,r){if(n.getCellMeta(i,r).readOnly)return t=!0,!1}),t};Handsontable.hooks.run(n,"afterContextMenuDefaultOptions",this.defaultOptions)}function v(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i].key===t)return n[i]}function o(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i].key===t)return i}function w(){var n;if(!this.rootElement.className.indexOf("htContextMenu")){var t=0,i=0,u=this.getSettings().data.length,f=parseInt(this.view.wt.wtTable.hider.style.width,10);for(n=0;n<u;n++)this.getSettings().data[n].name==r.SEPARATOR.name?t+=1:i+=26;this.view.wt.wtTable.holder.style.width=f+22+"px";this.view.wt.wtTable.holder.style.height=i+t+4+"px"}}function b(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),n+(" "+t))}function k(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),n+(" "+t))}function d(n){for(var i,r={},t=n.from.row;t<=n.to.row;t++)for(i=n.from.col;i<=n.to.col;i++)r[t]||(r[t]=[]),r[t][i]=this.getCellMeta(t,i).className;return r}function y(n,t,i,r){var u=this.getCellMeta(n,t),f=r;u.className&&(f=i==="vertical"?b(u.className,r):k(u.className,r));this.setCellMeta(n,t,"className",f)}function e(n,t,i){var f=d.call(this,n),r,u;if(this.runHooks("beforeCellAlignment",f,n,t,i),n.from.row==n.to.row&&n.from.col==n.to.col)y.call(this,n.from.row,n.from.col,t,i);else for(r=n.from.row;r<=n.to.row;r++)for(u=n.from.col;u<=n.to.col;u++)y.call(this,r,u,t,i);this.render()}function p(){var n=this,t=n.getSettings().contextMenu,i=f.isObject(t)?t:{};t?(n.contextMenu||(n.contextMenu=new r(n,i)),n.contextMenu.enable()):n.contextMenu&&(n.contextMenu.destroy(),delete n.contextMenu)}Object.defineProperties(i,{ContextMenu:{get:function(){return r}},__esModule:{value:!0}});var s,h,c,l,f=(s=n("./../../helpers.js"),s&&s.__esModule&&s||{"default":s}),u=(h=n("./../../dom.js"),h&&h.__esModule&&h||{"default":h}),a=(c=n("./../../eventManager.js"),c&&c.__esModule&&c||{"default":c}).eventManager,g=(l=n("./../../plugins.js"),l&&l.__esModule&&l||{"default":l}).registerPlugin;r.prototype.createMenu=function(n,t){n&&(n=n.replace(/ /g,"_"),n="htContextSubMenu_"+n);var i;return i=n?document.querySelector(".htContextMenu."+n):document.querySelector(".htContextMenu"),i||(i=document.createElement("DIV"),u.addClass(i,"htContextMenu"),n&&u.addClass(i,n),document.getElementsByTagName("body")[0].appendChild(i)),this.menus.indexOf(i)<0&&(this.menus.push(i),t=t||0,this.triggerRows.push(t)),i};r.prototype.bindMouseEvents=function(){function n(n){function l(n){return n.nodeName==="TD"||n.parentNode.nodeName==="TD"}var c=this.instance.getSettings(),e=this.instance.getSettings().rowHeaders,o=this.instance.getSettings().colHeaders,s,t,h,i;if(t=n.realTarget,this.closeAll(),n.preventDefault(),f.stopPropagation(n),e||o){if(e&&o&&(s=t.parentNode.querySelectorAll(".cornerHeader").length>0,s))return}else if(!l(t)&&!(u.hasClass(t,"current")&&u.hasClass(t,"wtBorder")))return;i=this.createMenu();h=this.getItems(c.contextMenu);this.show(i,h);this.setMenuPosition(n,i);this.eventManager.addEventListener(document.documentElement,"mousedown",f.proxy(r.prototype.closeAll,this))}var t=a(this.instance);t.addEventListener(this.instance.rootElement,"contextmenu",f.proxy(n,this))};r.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};r.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)};r.prototype.performAction=function(n,t){var e=this,o=t.getSelected()[0],i=t.getData()[o],u,f;if(i.disabled!==!0&&(typeof i.disabled!="function"||i.disabled.call(this.instance)!==!0)&&!i.hasOwnProperty("submenu")){if(typeof i.callback!="function")return;u=this.instance.getSelectedRange();f=r.utils.normalizeSelection(u);i.callback.call(this.instance,i.key,f,n);e.closeAll()}};r.prototype.unbindMouseEvents=function(){this.eventManager.clear();var n=a(this.instance);n.removeEventListener(this.instance.rootElement,"contextmenu")};r.prototype.show=function(n,t){var r=this,u,i;n.removeAttribute("style");n.style.display="block";u={data:t,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:f.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(n){r.onBeforeKeyDown(n,i)},afterOnCellMouseOver:function(n,t,u){r.onCellMouseOver(n,t,u,i)}};i=new Handsontable(n,u);i.isHotTableEnv=this.instance.isHotTableEnv;Handsontable.eventManager.isHotTableEnv=this.instance.isHotTableEnv;this.eventManager.removeEventListener(n,"mousedown");this.eventManager.addEventListener(n,"mousedown",function(n){r.performAction(n,i)});this.bindTableEvents();i.listen();this.htMenus[i.guid]=i;Handsontable.hooks.run(this.instance,"afterContextMenuShow",i)};r.prototype.close=function(n){this.hide(n);this.eventManager.clear();this.unbindTableEvents();this.instance.listen()};r.prototype.closeAll=function(){while(this.menus.length>0){var n=this.menus.pop();n&&this.close(n)}this.triggerRows=[]};r.prototype.closeLastOpenedSubMenu=function(){var n=this.menus.pop();n&&this.hide(n)};r.prototype.hide=function(n){n.style.display="none";var t=this.htMenus[n.id];Handsontable.hooks.run(this.instance,"afterContextMenuHide",t);t.destroy();delete this.htMenus[n.id]};r.prototype.renderer=function(n,t,i,f,e,o){function l(n){return n.hasOwnProperty("submenu")}function a(n){return new RegExp(r.SEPARATOR.name,"i").test(n.name)}function v(n){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(c.instance)===!0}var c=this,h=n.getData()[i],s=document.createElement("DIV");typeof o=="function"&&(o=o.call(this.instance));u.empty(t);t.appendChild(s);a(h)?u.addClass(t,"htSeparator"):u.fastInnerHTML(s,o);v(h)?(u.addClass(t,"htDisabled"),this.eventManager.addEventListener(s,"mouseenter",function(){n.deselectCell()})):l(h)?(u.addClass(t,"htSubmenu"),this.eventManager.addEventListener(s,"mouseenter",function(){n.selectCell(i,f)})):(u.removeClass(t,"htSubmenu"),u.removeClass(t,"htDisabled"),this.eventManager.addEventListener(s,"mouseenter",function(){n.selectCell(i,f)}))};r.prototype.onCellMouseOver=function(n,t,i,r){var u=this.menus.length,f;if(u>0?(f=this.menus[u-1],f.id!=r.guid&&this.closeLastOpenedSubMenu()):this.closeLastOpenedSubMenu(),i.className.indexOf("htSubmenu")!=-1){var e=r.getData()[t.row],s=this.getItems(e.submenu),o=this.createMenu(e.name,t.row),h=i.getBoundingClientRect();this.show(o,s);this.setSubMenuPosition(h,o)}};r.prototype.onBeforeKeyDown=function(n,t){function y(n){var t=n.getCell(0,0);r.utils.isSeparator(t)||r.utils.isDisabled(t)?h(0,0,n):n.selectCell(0,0)}function p(n){var t=n.countRows()-1,i=n.getCell(t,0);r.utils.isSeparator(i)||r.utils.isDisabled(i)?c(t,0,n):n.selectCell(t,0)}function h(n,t,i){var u=n+1,f=u<i.countRows()?i.getCell(u,t):null;f&&(r.utils.isSeparator(f)||r.utils.isDisabled(f)?h(u,t,i):i.selectCell(u,t))}function c(n,t,i){var u=n-1,f=u>=0?i.getCell(u,t):null;f&&(r.utils.isSeparator(f)||r.utils.isDisabled(f)?c(u,t,i):i.selectCell(u,t))}function w(n,t,i,r){var u=n.getData()[r],e=t.getItems(u.submenu),f=t.createMenu(u.name,r),o=i.getBoundingClientRect(),s=t.show(f,e);t.setSubMenuPosition(o,f);s.selectCell(0,0)}var i,e,l,o,s,a,v;u.enableImmediatePropagation(n);i=this;e=t.getSelected();switch(n.keyCode){case f.keyCode.ESCAPE:i.closeAll();n.preventDefault();n.stopImmediatePropagation();break;case f.keyCode.ENTER:e&&i.performAction(n,t);break;case f.keyCode.ARROW_DOWN:e?h(e[0],e[1],t,i):y(t,i);n.preventDefault();n.stopImmediatePropagation();break;case f.keyCode.ARROW_UP:e?c(e[0],e[1],t,i):p(t,i);n.preventDefault();n.stopImmediatePropagation();break;case f.keyCode.ARROW_RIGHT:e&&(l=e[0],o=t.getCell(e[0],0),r.utils.hasSubMenu(o)&&w(t,i,o,l));n.preventDefault();n.stopImmediatePropagation();break;case f.keyCode.ARROW_LEFT:e&&(t.rootElement.className.indexOf("htContextSubMenu_")!=-1&&(i.closeLastOpenedSubMenu(),s=i.menus.length,s>0&&(a=i.menus[s-1],v=i.triggerRows.pop(),t=this.htMenus[a.id],t.selectCell(v,0))),n.preventDefault(),n.stopImmediatePropagation())}};r.prototype.getItems=function(n){function u(n){typeof n=="string"?this.name=n:f.extend(this,n)}var r,t,i;if(u.prototype=n,n&&n.items&&(n=n.items),n===!0&&(n=this.defaultOptions.items),!0){r=[];for(i in n)n.hasOwnProperty(i)&&(t=typeof n[i]=="string"?v(this.defaultOptions.items,n[i]):v(this.defaultOptions.items,i),t||(t=n[i]),t=new u(t),typeof n[i]=="object"&&f.extend(t,n[i]),t.key||(t.key=i),r.push(t))}return r};r.prototype.setSubMenuPosition=function(n,t){var r=u.getWindowScrollTop(),f=u.getWindowScrollLeft(),i={top:r+n.top,topRelative:n.top,left:n.left,leftRelative:n.left-f,scrollTop:r,scrollLeft:f,cellHeight:n.height,cellWidth:n.width};this.menuFitsBelowCursor(i,t,document.body.clientWidth)?this.positionMenuBelowCursor(i,t,!0):this.menuFitsAboveCursor(i,t)?this.positionMenuAboveCursor(i,t,!0):this.positionMenuBelowCursor(i,t,!0);this.menuFitsOnRightOfCursor(i,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(i,t,!0):this.positionMenuOnLeftOfCursor(i,t,!0)};r.prototype.setMenuPosition=function(n,t){var r=u.getWindowScrollTop(),f=u.getWindowScrollLeft(),e=n.pageY||n.clientY+r,o=n.pageX||n.clientX+f,i={top:e,topRelative:e-r,left:o,leftRelative:o-f,scrollTop:r,scrollLeft:f,cellHeight:n.target.clientHeight,cellWidth:n.target.clientWidth};this.menuFitsBelowCursor(i,t,document.body.clientHeight)?this.positionMenuBelowCursor(i,t):this.menuFitsAboveCursor(i,t)?this.positionMenuAboveCursor(i,t):this.positionMenuBelowCursor(i,t);this.menuFitsOnRightOfCursor(i,t,document.body.clientWidth)?this.positionMenuOnRightOfCursor(i,t):this.positionMenuOnLeftOfCursor(i,t)};r.prototype.menuFitsAboveCursor=function(n,t){return n.topRelative>=t.offsetHeight};r.prototype.menuFitsBelowCursor=function(n,t,i){return n.topRelative+t.offsetHeight<=i};r.prototype.menuFitsOnRightOfCursor=function(n,t,i){return n.leftRelative+t.offsetWidth<=i};r.prototype.positionMenuBelowCursor=function(n,t){t.style.top=n.top+"px"};r.prototype.positionMenuAboveCursor=function(n,t,i){t.style.top=i?n.top+n.cellHeight-t.offsetHeight+"px":n.top-t.offsetHeight+"px"};r.prototype.positionMenuOnRightOfCursor=function(n,t,i){t.style.left=i?1+n.left+n.cellWidth+"px":1+n.left+"px"};r.prototype.positionMenuOnLeftOfCursor=function(n,t,i){t.style.left=i?n.left-t.offsetWidth+"px":n.left-t.offsetWidth+"px"};r.utils={};r.utils.normalizeSelection=function(n){return{start:n.getTopLeftCorner(),end:n.getBottomRightCorner()}};r.utils.isSeparator=function(n){return u.hasClass(n,"htSeparator")};r.utils.hasSubMenu=function(n){return u.hasClass(n,"htSubmenu")};r.utils.isDisabled=function(n){return u.hasClass(n,"htDisabled")};r.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())};r.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())};r.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var n=this.menus.pop();this.triggerRows.pop();n&&(this.close(n),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(n))}this.unbindMouseEvents();this.unbindTableEvents()};r.prototype.isMenuEnabledByOtherHotInstance=function(){for(var t,i=document.querySelectorAll(".handsontable"),r=!1,n=0,u=i.length;n<u;n++)if(t=this.htMenus[i[n].id],t&&t.getSettings().contextMenu){r=!0;break}return r};r.prototype.removeMenu=function(n){n.parentNode&&this.menu.parentNode.removeChild(n)};r.prototype.align=function(n,t,i){e.call(this,n,t,i)};r.SEPARATOR={name:"---------"};Handsontable.hooks.add("afterInit",p);Handsontable.hooks.add("afterUpdateSettings",p);Handsontable.hooks.add("afterInit",w);Handsontable.hooks.register("afterContextMenuDefaultOptions");Handsontable.hooks.register("afterContextMenuShow");Handsontable.hooks.register("afterContextMenuHide");Handsontable.ContextMenu=r},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],53:[function(n,t,i){"use strict";Object.defineProperties(i,{ContextMenuCopyPaste:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e,o,c=(r=n("./../../dom.js"),r&&r.__esModule&&r||{"default":r}),l=(u=n("./../../eventManager.js"),u&&u.__esModule&&u||{"default":u}).eventManager,a=(f=n("./../../plugins.js"),f&&f.__esModule&&f||{"default":f}).registerPlugin,v=(e=n("./../_base.js"),e&&e.__esModule&&e||{"default":e}).default,h=(o=n("zeroclipboard"),o&&o.__esModule&&o||{"default":o}).default,s=function(n){var t=this;$traceurRuntime.superConstructor(y).call(this,n);this.swfPath=null;this.hotContextMenu=null;this.outsideClickDeselectsCache=null;this.hot.addHook("afterContextMenuShow",function(n){return t.setupZeroClipboard(n)});this.hot.addHook("afterInit",function(){return t.afterInit()});this.hot.addHook("afterContextMenuDefaultOptions",function(n){return t.addToContextMenu(n)})},y=s;$traceurRuntime.createClass(s,{afterInit:function(){if(this.hot.getSettings().contextMenuCopyPaste)typeof this.hot.getSettings().contextMenuCopyPaste=="object"&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath);else return;if(typeof h=="undefined")throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(n){if("undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.");}this.prepareZeroClipboard()},prepareZeroClipboard:function(){this.swfPath&&h.config({swfPath:this.swfPath})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},addToContextMenu:function(n){this.hot.getSettings().contextMenuCopyPaste&&n.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},Handsontable.ContextMenu.SEPARATOR)},setupZeroClipboard:function(n){var i=this,r,u,t,f;if(this.hot.getSettings().contextMenuCopyPaste)for(this.hotContextMenu=n,r=this.hotContextMenu.getData(),t=0,f=r.length;t<f;t++)if(r[t].key==="copy"){u=new h(this.hotContextMenu.getCell(t,0));u.off();u.on("copy",function(n){var t=n.clipboardData;t.setData("text/plain",i.getCopyValue());i.hot.getSettings().outsideClickDeselects=i.outsideClickDeselectsCache});this.bindEvents();break}},removeCurrentClass:function(){if(this.hotContextMenu.rootElement){var n=this.hotContextMenu.rootElement.querySelector("td.current");n&&c.removeClass(n,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){if(this.hotContextMenu.rootElement){var n=this.hotContextMenu.rootElement.querySelector("td.zeroclipboard-is-hover");n&&c.removeClass(n,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache},bindEvents:function(){var n=this,t=l(this.hotContextMenu);t.addEventListener(document,"mouseenter",function(){return n.removeCurrentClass()});t.addEventListener(document,"mouseleave",function(){return n.removeZeroClipboardClass()})}},{},v);a("contextMenuCopyPaste",s)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46,zeroclipboard:"zeroclipboard"}],54:[function(n,t,i){"use strict";function p(n){function i(){n.isListening()&&n.selection.empty()}function u(t){var l,f,i,o,a,s,e,h,r,u;n.isListening()&&n.selection.isSelected()&&(l=t,f=v.parse(l),i=n.getSelected(),o=new c(i[0],i[1]),a=new c(i[2],i[3]),s=new y(o,o,a),e=s.getTopLeftCorner(),h=s.getBottomRightCorner(),r=e,u=new c(Math.max(h.row,f.length-1+e.row),Math.max(h.col,f[0].length-1+e.col)),n.addHookOnce("afterChange",function(n){n&&n.length&&this.selectCell(r.row,r.col,u.row,u.col)}),n.populateFromArray(r.row,r.col,f,u.row,u.col,"paste",n.getSettings().pasteMode))}function f(i){if(n.getSelected()&&(!n.getActiveEditor()||!n.getActiveEditor().isOpened())){if(r.isCtrlKey(i.keyCode)){t.setCopyableText();i.stopImmediatePropagation();return}var u=(i.ctrlKey||i.metaKey)&&!i.altKey;i.keyCode==r.keyCode.A&&u&&n._registerTimeout(setTimeout(r.proxy(t.setCopyableText,t),0))}}var t=this;this.copyPasteInstance=a();this.copyPasteInstance.onCut(i);this.copyPasteInstance.onPaste(u);n.addHook("beforeKeyDown",f);this.destroy=function(){this.copyPasteInstance.removeCallback(i);this.copyPasteInstance.removeCallback(u);this.copyPasteInstance.destroy();n.removeHook("beforeKeyDown",f)};n.addHook("afterDestroy",r.proxy(this.destroy,this));this.triggerPaste=r.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=r.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var f=n.getSettings(),e=f.copyRowsLimit,o=f.copyColsLimit,s=n.getSelectedRange(),h=s.getTopLeftCorner(),c=s.getBottomRightCorner(),t=h.row,i=h.col,r=c.row,u=c.col,l=Math.min(r,t+e-1),a=Math.min(u,i+o-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(t,i,l,a));(r!==l||u!==a)&&Handsontable.hooks.run(n,"afterCopyLimit",r-t+1,u-i+1,e,o)}}function l(){var n=this,t=n.getSettings().copyPaste!==!1;t&&!n.copyPaste?n.copyPaste=new p(n):!t&&n.copyPaste&&(n.copyPaste.destroy(),delete n.copyPaste)}Object.defineProperties(i,{CopyPaste:{get:function(){return CopyPaste}},__esModule:{value:!0}});var u,f,e,o,s,h,r=(u=n("./../../helpers.js"),u&&u.__esModule&&u||{"default":u}),a=(f=n("copyPaste"),f&&f.__esModule&&f||{"default":f}).default,v=(e=n("SheetClip"),e&&e.__esModule&&e||{"default":e}).default,w=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin,c=(s=n("./../../3rdparty/walkontable/src/cell/coords.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords,y=(h=n("./../../3rdparty/walkontable/src/cell/range.js"),h&&h.__esModule&&h||{"default":h}).WalkontableCellRange;Handsontable.hooks.add("afterInit",l);Handsontable.hooks.add("afterUpdateSettings",l);Handsontable.hooks.register("afterCopyLimit")},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../helpers.js":42,"./../../plugins.js":45,SheetClip:"SheetClip",copyPaste:"copyPaste"}],55:[function(n){"use strict";function v(){}var i,r,u,et=(i=n("./../../plugins.js"),i&&i.__esModule&&i||{"default":i}).registerPlugin,w=(r=n("./../../3rdparty/walkontable/src/cell/range.js"),r&&r.__esModule&&r||{"default":r}).WalkontableCellRange,b=(u=n("./../../3rdparty/walkontable/src/selection.js"),u&&u.__esModule&&u||{"default":u}).WalkontableSelection,f,k=function(n){return typeof n=="boolean"&&n===!0?!0:typeof n=="object"&&n.length>0?!0:!1},d=function(){k(this.getSettings().customBorders)&&(this.customBorders||(f=this,this.customBorders=new v))},g=function(n){for(var t=0;t<f.view.wt.selections.length;t++)if(f.view.wt.selections[t].settings.className==n)return t;return-1},c=function(n){var t={row:n.row,col:n.col},i=new b(n,new w(t,t,t)),r=g(n.className);r>=0?f.view.wt.selections[r]=i:f.view.wt.selections.push(i)},nt=function(n,t,i){var r=a(n,t);r=ut(r,i);this.setCellMeta(n,t,"borders",r);c(r)},tt=function(n){for(var i,r,f,t=n.range,u=t.from.row;u<=t.to.row;u++)for(i=t.from.col;i<=t.to.col;i++)r=a(u,i),f=0,u==t.from.row&&(f++,n.hasOwnProperty("top")&&(r.top=n.top)),u==t.to.row&&(f++,n.hasOwnProperty("bottom")&&(r.bottom=n.bottom)),i==t.from.col&&(f++,n.hasOwnProperty("left")&&(r.left=n.left)),i==t.to.col&&(f++,n.hasOwnProperty("right")&&(r.right=n.right)),f>0&&(this.setCellMeta(u,i,"borders",r),c(r))},l=function(n,t){return"border_row"+n+"col"+t},it=function(){return{width:1,color:"#000"}},e=function(){return{hide:!0}},rt=function(){return{width:1,color:"#000",cornerVisible:!1}},a=function(n,t){return{className:l(n,t),border:rt(),row:n,col:t,top:e(),right:e(),bottom:e(),left:e()}},ut=function(n,t){return t.hasOwnProperty("border")&&(n.border=t.border),t.hasOwnProperty("top")&&(n.top=t.top),t.hasOwnProperty("right")&&(n.right=t.right),t.hasOwnProperty("bottom")&&(n.bottom=t.bottom),t.hasOwnProperty("left")&&(n.left=t.left),n},y=function(n){for(var r,i=document.querySelectorAll("."+n),t=0;t<i.length;t++)i[t]&&i[t].nodeName!="TD"&&(r=i[t].parentNode,r.parentNode&&r.parentNode.removeChild(r))},p=function(n,t){var i=l(n,t);y(i);this.removeCellMeta(n,t,"borders")},o=function(n,t,i,r){var u=this.getCellMeta(n,t).borders,f;u&&u.border!=undefined||(u=a(n,t));u[i]=r?e():it();this.setCellMeta(n,t,"borders",u);f=l(n,t);y(f);c(u);this.render()},s=function(n,t,i){var r,u,f,e,s,h;if(n.from.row==n.to.row&&n.from.col==n.to.col)t=="noBorders"?p.call(this,n.from.row,n.from.col):o.call(this,n.from.row,n.from.col,t,i);else switch(t){case"noBorders":for(r=n.from.col;r<=n.to.col;r++)for(u=n.from.row;u<=n.to.row;u++)p.call(this,u,r);break;case"top":for(f=n.from.col;f<=n.to.col;f++)o.call(this,n.from.row,f,t,i);break;case"right":for(e=n.from.row;e<=n.to.row;e++)o.call(this,e,n.to.col,t);break;case"bottom":for(s=n.from.col;s<=n.to.col;s++)o.call(this,n.to.row,s,t);break;case"left":for(h=n.from.row;h<=n.to.row;h++)o.call(this,h,n.from.col,t)}},t=function(n,t){var i=!1;return n.getSelectedRange().forAll(function(r,u){var f=n.getCellMeta(r,u).borders;if(f)if(t){if(!f[t].hasOwnProperty("hide"))return i=!0,!1}else return i=!0,!1}),i},h=function(n){return"<span class='selected'>"+String.fromCharCode(10003)+"<\/span>"+n},ft=function(n){this.getSettings().customBorders&&(n.items.push(Handsontable.ContextMenu.SEPARATOR),n.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var n="Top",i=t(this,"top");return i&&(n=h(n)),n},callback:function(){var n=t(this,"top");s.call(this,this.getSelectedRange(),"top",n)},disabled:!1},right:{name:function(){var n="Right",i=t(this,"right");return i&&(n=h(n)),n},callback:function(){var n=t(this,"right");s.call(this,this.getSelectedRange(),"right",n)},disabled:!1},bottom:{name:function(){var n="Bottom",i=t(this,"bottom");return i&&(n=h(n)),n},callback:function(){var n=t(this,"bottom");s.call(this,this.getSelectedRange(),"bottom",n)},disabled:!1},left:{name:function(){var n="Left",i=t(this,"left");return i&&(n=h(n)),n},callback:function(){var n=t(this,"left");s.call(this,this.getSelectedRange(),"left",n)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){s.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!t(this)}}}}}))};Handsontable.hooks.add("beforeInit",d);Handsontable.hooks.add("afterContextMenuDefaultOptions",ft);Handsontable.hooks.add("afterInit",function(){var t=this.getSettings().customBorders,n;if(t){for(n=0;n<t.length;n++)t[n].range?tt.call(this,t[n]):nt.call(this,t[n].row,t[n].col,t[n]);this.render();this.view.wt.draw(!0)}});Handsontable.CustomBorders=v},{"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/selection.js":18,"./../../plugins.js":45}],56:[function(n,t,i){"use strict";function r(){this.boundaries=null;this.callback=null}var u,f,o,h,e,s;Object.defineProperties(i,{DragToScroll:{get:function(){return r}},__esModule:{value:!0}});o=(u=n("./../../eventManager.js"),u&&u.__esModule&&u||{"default":u}).eventManager;h=(f=n("./../../plugins.js"),f&&f.__esModule&&f||{"default":f}).registerPlugin;Handsontable.plugins.DragToScroll=r;r.prototype.setBoundaries=function(n){this.boundaries=n};r.prototype.setCallback=function(n){this.callback=n};r.prototype.check=function(n,t){var i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom);n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right);this.callback(i,r)};typeof Handsontable!="undefined"&&(s=function(n){n.dragToScrollListening=!1;var t=n.view.wt.wtTable.holder;(e=new r,t!==window)&&(e.setBoundaries(t.getBoundingClientRect()),e.setCallback(function(n,i){n<0?t.scrollLeft-=50:n>0&&(t.scrollLeft+=50);i<0?t.scrollTop-=20:i>0&&(t.scrollTop+=20)}),n.dragToScrollListening=!0)});Handsontable.hooks.add("afterInit",function(){var n=this,t=o(this);t.addEventListener(document,"mouseup",function(){n.dragToScrollListening=!1});t.addEventListener(document,"mousemove",function(t){n.dragToScrollListening&&e.check(t.clientX,t.clientY)})});Handsontable.hooks.add("afterDestroy",function(){o(this).clear()});Handsontable.hooks.add("afterOnCellMouseDown",function(){s(this)});Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){s(this)});Handsontable.plugins.DragToScroll=r},{"./../../eventManager.js":41,"./../../plugins.js":45}],57:[function(n){"use strict";function u(n){var i=[],s={rows:0,cols:0},u={rows:0,cols:0},f=[],o=[],r={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(n){return"ht"+n+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(n){return"htCollapse-"+n},collapseFromLevel:function(n,t){return"htCollapse"+n+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},w=function(n,t){return function(i,r){return typeof t=="undefined"||t==="asc"?i[n]-r[n]:r[n]-i[n]}},b=function(n,t){for(var i=[];n<=t;)i.push(n++);return i},k=function(n,t,i){var e=[],u={row:null,col:null},r;if(n=="cols")while(t<=i)u={row:-1,col:t++},e.push(u);else while(t<=i)u={row:t++,col:-1},e.push(u);var f=nt(e),o=0,s=0;for(r=0;r<f.length;r++)o+=f[r].filter(function(n){return n.rows}).length,s+=f[r].filter(function(n){return n.cols}).length;return{total:{rows:o,cols:s},groups:f}},nt=function(n){for(var i=[],t=0;t<n.length;t++)i.push(tt(n[t]));return i},tt=function(n,t,r){for(var h,e=n.row,o=n.col,c=e===-1?0:e,l=o===-1?0:o,u=[],s=0;s<i.length;s++){var f=i[s],y=f.id,b=f.level,p=f.rows||[],w=f.cols||[];u.indexOf(y)===-1&&(p.indexOf(c)!==-1||w.indexOf(l)!==-1)&&u.push(f)}return o===-1?u=u.concat(a()):e===-1&&(u=u.concat(v())),t&&(u=u.filter(function(n){return n.level===t})),r&&(r==="cols"?u=u.filter(function(n){return n.cols}):r==="rows"&&(u=u.filter(function(n){return n.rows}))),h=[],u.filter(function(n){if(h.indexOf(n.id)===-1)return h.push(n.id),n})},d=function(n){for(var t=0,r=i.length;t<r;t++)if(i[t].id==n)return i[t];return!1},c=function(n,t){for(var r=0,u=i.length;r<u;r++)if(i[r].level==t&&i[r].rows&&i[r].rows.indexOf(n)>-1)return i[r];return!1},l=function(n,t){for(var r=0,u=i.length;r<u;r++)if(i[r].level==t&&i[r].cols&&i[r].cols.indexOf(n)>-1)return i[r];return!1},a=function(){for(var t=[],n=0,r=i.length;n<r;n++)Array.isArray(i[n].cols)&&t.push(i[n]);return t},it=function(n){for(var r=[],t=0,u=i.length;t<u;t++)i[t].cols&&i[t].level===n&&r.push(i[t]);return r},v=function(){for(var t=[],n=0,r=i.length;n<r;n++)Array.isArray(i[n].rows)&&t.push(i[n]);return t},rt=function(n){for(var r=[],t=0,u=i.length;t<u;t++)i[t].rows&&i[t].level===n&&r.push(i[t]);return r},ut=function(n){var t=0;return n.length&&n.forEach(function(n){if(n=n.filter(function(n){return n.cols}),n.length){var r=n.sort(w("level","desc")),i=r[0].level;t<i&&(t=i)}}),t},ft=function(n){var t=0;return n.length&&n.forEach(function(n){if(n=n.filter(function(n){return n.rows}),n.length){var r=n.sort(w("level","desc")),i=r[0].level;t<i&&(t=i)}}),t},et=function(n,t){var f=k("cols",n,t),r=ut(f.groups);r===u.cols?u.cols++:r>u.cols&&(u.cols=r+1);s.cols||(s.cols=a().length);s.cols++;i.push({id:"c"+s.cols,level:r+1,cols:b(n,t),hidden:0})},ot=function(n,t){var f=k("rows",n,t),r=ft(f.groups);u.rows=Math.max(u.rows,r+1);s.rows||(s.rows=v().length);s.rows++;i.push({id:"r"+s.rows,level:r+1,rows:b(n,t),hidden:0})},y=function(n,t){for(var e,r,s,u,i=0,h=t.length;i<h;i++)if(t[i].hidden=n,u=t[i].level,f[u]||(f[u]=[]),o[u]||(o[u]=[]),t[i].rows)for(r=0,e=t[i].rows.length;r<e;r++)f[u][t[i].rows[r]]=n>0?!0:void 0;else if(t[i].cols)for(r=0,s=t[i].cols.length;r<s;r++)o[u][t[i].cols[r]]=n>0?!0:void 0},g=function(n,t,i,r){var f,u;switch(n){case"rows":f=c(t+1,i).id;u=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":f=l(t+1,i).id;u=Handsontable.Grouping.getGroupLevelsByCols()}return!!(u[t+1]&&u[t+1].indexOf(i)>-1&&r==f)},p=function(n,t,i,r){var f,u;switch(n){case"rows":f=c(t-1,i).id;u=Handsontable.Grouping.getGroupLevelsByRows();break;case"cols":f=l(t-1,i).id;u=Handsontable.Grouping.getGroupLevelsByCols()}return!!(u[t-1]&&u[t-1].indexOf(i)>-1&&r==f)},st=function(t,i,r,e){var s;if(i===0)return!1;var h,c,v=p(t,i,r,e),a=g(t,i,r,e),l=!1;switch(t){case"rows":for(h=Handsontable.Grouping.getGroupLevelsByRows(),c=n.countRows(),s=0;s<=u.rows;s++)if(f[s]&&f[s][i+1]){l=!0;break}break;case"cols":for(h=Handsontable.Grouping.getGroupLevelsByCols(),c=n.countCols(),s=0;s<=u.cols;s++)if(o[s]&&o[s][i+1]){l=!0;break}}return v&&(i==c-1||!a||a&&l||!h[i+1])?!0:!1},ht=function(t){var r,i;switch(t){case"rows":for(r=u.rows,i=0;i<=r;i++)if(f[i]&&f[i][n.countRows()-1])return!0;break;case"cols":for(r=u.cols,i=0;i<=r;i++)if(o[i]&&o[i][n.countCols()-1])return!0}return!1},ct=function(t,i,r,e){var h,c,w=d(e),l=!1,v=function(n){for(var r=!1,e=n=="rows"?f:o,t=0;t<=u[n];t++){for(s=i;w[n].indexOf(s)>-1;)r=!!(e[t]&&e[t][s]),s--;if(r)break}return r},y=p(t,i,r,e),a=g(t,i,r,e),s;switch(t){case"rows":h=Handsontable.Grouping.getGroupLevelsByRows();c=n.countRows();l=v(t);break;case"cols":h=Handsontable.Grouping.getGroupLevelsByCols();c=n.countCols();l=v(t)}if(i==c-1)return!1;if(i===0){if(a)return!0}else if(!y||y&&l){if(a)return!0}else if(!h[i-1]&&a)return!0;return!1},lt=function(n,i,u,f,e){var s,o;switch(n){case"rows":s=c(i-1,u).id;break;case"cols":s=l(i-1,u).id}return s?i>0&&p(n,i-1,u,s)&&s!=f?(o=document.createElement("DIV"),t.addClass(o,r.expandButton),o.id="htExpand-"+s,o.appendChild(document.createTextNode("+")),o.setAttribute("data-level",u),o.setAttribute("data-type",n),o.setAttribute("data-hidden","1"),e.appendChild(o),o):null:null},h=function(n){for(var u,i=v(),r=a(),t=0,f=i.length;t<f;t++)if(i[t].rows.indexOf(n.row)>-1&&i[t].hidden)return!0;if(n.col===null)return!1;for(t=0,u=r.length;t<u;t++)if(r[t].cols.indexOf(n.col)>-1&&r[t].hidden)return!0;return!1};return{getGroups:function(){return i},getLevels:function(){return u},instance:n,baseSpareRows:n.getSettings().minSpareRows,baseSpareCols:n.getSettings().minSpareCols,getRowGroups:v,getColGroups:a,init:function(){var t=n.getSettings().groups;t&&Array.isArray(t)&&Handsontable.Grouping.initGroups(t)},initGroups:function(n){var t=this;i=[];n.forEach(function(n){var t=[],u=!1,f=!1,i,r;Array.isArray(n.rows)?(t=n.rows,u=!0):Array.isArray(n.cols)&&(t=n.cols,f=!0);i=t[0];r=t[t.length-1];u?ot(i,r):f&&et(i,r)})},resetGroups:function(){var e,h,n,c,f,o;i=[];s={rows:0,cols:0};u={rows:0,cols:0};for(n in r)if(typeof r[n]!="function")for(e=document.querySelectorAll("."+r[n]),f=0,o=e.length;f<o;f++)t.removeClass(e[f],r[n]);for(h=["htGroupColClosest","htGroupCol"],n=0,c=h.length;n<c;n++)for(e=document.querySelectorAll("."+h[n]),f=0,o=e.length;f<o;f++)t.removeClass(e[f],h[n])},updateGroups:function(){var n=this.getSettings().groups;Handsontable.Grouping.resetGroups();Handsontable.Grouping.initGroups(n)},afterGetRowHeader:function(n,i){for(var u=!1,r=0,e=f.length;r<e;r++)f[r]&&f[r][n]===!0&&(u=!0);u?t.addClass(i.parentNode,"hidden"):!u&&t.hasClass(i.parentNode,"hidden")&&t.removeClass(i.parentNode,"hidden")},afterGetColHeader:function(i){var h=this.view.wt.wtSettings.getSetting("rowHeaders").length,u=n.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(i+h+1,10)+")"),f,s,r,e;if(u.length!==0){for(f=!1,r=0,s=o.length;r<s;r++)o[r]&&o[r][i]===!0&&(f=!0);if(f)for(r=0,e=u.length;r<e;r++)t.addClass(u[r],"hidden");else if(!f&&t.hasClass(u[0],"hidden"))for(r=0,e=u.length;r<e;r++)t.removeClass(u[r],"hidden")}},groupIndicatorsFactory:function(n,i){var o,b,h,f,a,k,v,d,y,p,w;switch(i){case"horizontal":o=Handsontable.Grouping.getGroupLevelsByCols();b=function(n){return Array.prototype.indexOf.call(n.parentNode.parentNode.childNodes,n.parentNode)+1};h=function(n,t){return l(n,t).id};f="cols";a=function(n,t){return l(n-1,t)};k="columnHeaders";v=function(n){if(n.length===1){var i=n[0];n[0]=function(n,u,f){n<-1?p()(n,u,f):(t.removeClass(u,r.groupIndicatorContainer),i(n,u,f))}}return function(){return n}};d=!0;break;case"vertical":o=Handsontable.Grouping.getGroupLevelsByRows();b=function(n){return t.index(n)+1};h=function(n,t){return c(n,t).id};f="rows";a=function(n,t){return c(n-1,t)};k="rowHeaders";v=function(n){return n}}if(y=function(n){var i=document.createElement("div");return n.appendChild(i),{button:i,addClass:function(n){t.addClass(i,n)}}},p=function(){var n=i.charAt(0).toUpperCase()+i.slice(1);return function(i,u,s){var b,c,l,v,p,w,k;for(s++;b=u.lastChild;)u.removeChild(b);t.addClass(u,r.groupIndicatorContainer);l=h(i,s);i>-1&&o[i]&&o[i].indexOf(s)>-1&&(c=y(u),c.addClass(r.groupIndicator(n)),ct(f,i,s,l)&&c.addClass(r.groupStart),st(f,i,s,l)&&(c.button.appendChild(document.createTextNode("-")),c.addClass(r.collapseButton),c.button.id=r.collapseGroupId(l),c.button.setAttribute("data-level",s),c.button.setAttribute("data-type",f)));d&&(v=t.index(u.parentNode),(i===-1||i<-1&&v===Handsontable.Grouping.getLevels().cols+1||v===0&&Handsontable.Grouping.getLevels().cols===0)&&(c=y(u),c.addClass(r.levelTrigger),i===-1?(c.button.id=r.collapseFromLevel("Cols",s),c.button.appendChild(document.createTextNode(s))):(i<-1&&v===Handsontable.Grouping.getLevels().cols+1||v===0&&Handsontable.Grouping.getLevels().cols===0)&&(p=t.index(u)+1,c.button.id=r.collapseFromLevel("Rows",p),c.button.appendChild(document.createTextNode(p)))));w=lt(f,i,s,l,u);i>0&&(k=a(i-1,s),w&&k.hidden&&t.addClass(w,r.clickable));e()}},n=v(n),s[f]>0)for(w=0;w<u[f]+1;w++)Array.isArray(n)||(n=typeof n=="function"?n():new Array(n)),n.unshift(p())},getGroupLevelsByRows:function(){for(var i,u,t=v(),r=[],n=0,f=t.length;n<f;n++)if(t[n].rows)for(i=0,u=t[n].rows.length;i<u;i++)r[t[n].rows[i]]||(r[t[n].rows[i]]=[]),r[t[n].rows[i]].push(t[n].level);return r},getGroupLevelsByCols:function(){for(var i,u,t=a(),r=[],n=0,f=t.length;n<f;n++)if(t[n].cols)for(i=0,u=t[n].cols.length;i<u;i++)r[t[n].cols[i]]||(r[t[n].cols[i]]=[]),r[t[n].cols[i]].push(t[n].level);return r},toggleGroupVisibility:function(i){var h,nt,o,l;if(t.hasClass(i.target,r.expandButton)||t.hasClass(i.target,r.collapseButton)||t.hasClass(i.target,r.levelTrigger)){var e=i.target,a=e.id.split("-"),w=[],b,ut,f,s,ft=function(n){n&&(e=n);a=e.id.split("-");b=a[1];ut=parseInt(e.getAttribute("data-level"),10);f=e.getAttribute("data-type");s=parseInt(e.getAttribute("data-hidden"));s=isNaN(s)?1:s?0:1;e.setAttribute("data-hidden",s.toString());w.push(d(b))};if(e.className.indexOf(r.levelTrigger)>-1){var c,k=[],g=[],v=e.id.indexOf("Rows")>-1?"rows":"cols";for(h=1,nt=u[v];h<=nt;h++)if(c=v=="rows"?rt(h):it(h),h>=parseInt(a[1],10))for(o=0,l=c.length;o<l;o++)g.push(c[o]);else for(o=0,l=c.length;o<l;o++)k.push(c[o]);y(!0,g);y(!1,k)}else ft(),y(s,w);f=f||v;var et=ht(f),p=f.charAt(0).toUpperCase()+f.slice(1),tt=Handsontable.Grouping["baseSpare"+p];et?tt==0&&(n.alter("insert_"+f.slice(0,-1),n["count"+p]()),Handsontable.Grouping["dummy"+f.slice(0,-1)]=!0):tt==0&&Handsontable.Grouping["dummy"+f.slice(0,-1)]&&(n.alter("remove_"+f.slice(0,-1),n["count"+p]()-1),Handsontable.Grouping["dummy"+f.slice(0,-1)]=!1);n.render();i.stopImmediatePropagation()}},modifySelectionFactory:function(n){var u=this.instance,t,i=new WalkontableCellCoords(0,0),r=function(n,t){var i=0;switch(n){case"down":while(h(t))i++,t.row+=1;break;case"up":while(h(t))i--,t.row-=1;break;case"right":while(h(t))i++,t.col+=1;break;case"left":while(h(t))i--,t.col-=1}return i},f=function(n,t){n.row>0?h(t)&&(n.row+=r("down",t)):n.row<0&&h(t)&&(n.row+=r("up",t));n.col>0?h(t)&&(n.col+=r("right",t)):n.col<0&&h(t)&&(n.col+=r("left",t))};switch(n){case"start":return function(n){t=u.getSelected();i.row=t[0]+n.row;i.col=t[1]+n.col;f(n,i)};case"end":return function(n){t=u.getSelected();i.row=t[2]+n.row;i.col=t[3]+n.col;f(n,i)}}},modifyRowHeight:function(t,i){if(n.view.wt.wtTable.rowFilter&&h({row:i,col:null}))return 0},validateGroups:function(){for(var o,r,s,e=function(n,t){if(n[0]<t[0]&&n[1]<t[1]&&t[0]<=n[1]||n[0]>t[0]&&t[1]<n[1]&&n[0]<=t[1])return!0},i=n.getSettings().groups,u=[],f=[],t=0,h=i.length;t<h;t++)if(i[t].rows){if(i[t].rows.length===1)throw new Error("Grouping error:  Group {"+i[t].rows[0]+"} is invalid. Cannot define single-entry groups.");else if(i[t].rows.length===0)throw new Error("Grouping error:  Cannot define empty groups.");for(f.push(i[t].rows),r=0,o=f.length;r<o;r++)if(e(i[t].rows,f[r]))throw new Error("Grouping error:  ranges {"+i[t].rows[0]+", "+i[t].rows[1]+"} and {"+f[r][0]+", "+f[r][1]+"} are overlapping.");}else if(i[t].cols){if(i[t].cols.length===1)throw new Error("Grouping error:  Group {"+i[t].cols[0]+"} is invalid. Cannot define single-entry groups.");else if(i[t].cols.length===0)throw new Error("Grouping error:  Cannot define empty groups.");for(u.push(i[t].cols),r=0,s=u.length;r<s;r++)if(e(i[t].cols,u[r]))throw new Error("Grouping error:  ranges {"+i[t].cols[0]+", "+i[t].cols[1]+"} and {"+u[r][0]+", "+u[r][1]+"} are overlapping.");}return!0},afterGetRowHeaderRenderers:function(n){Handsontable.Grouping.groupIndicatorsFactory(n,"vertical")},afterGetColumnHeaderRenderers:function(n){Handsontable.Grouping.groupIndicatorsFactory(n,"horizontal")},hookProxy:function(t,i){return function(){if(n.getSettings().groups)return i?Handsontable.Grouping[t](i).apply(this,arguments):Handsontable.Grouping[t].apply(this,arguments)}}}}var i,r,t=(i=n("./../../dom.js"),i&&i.__esModule&&i||{"default":i}),o=(r=n("./../../plugins.js"),r&&r.__esModule&&r||{"default":r}).registerPlugin,f,e;u.prototype.beforeInit=function(){};f=function(){var n=this,r=!!n.getSettings().groups,t,i;if(r){if(t={},Handsontable.Grouping=new u(n),n.getSettings().rowHeaders||(t.rowHeaders=!0),n.getSettings().colHeaders||(t.colHeaders=!0),(t.colHeaders||t.rowHeaders)&&n.updateSettings(t),i=Handsontable.Grouping.validateGroups(),!i)return;n.addHook("beforeInit",Handsontable.Grouping.hookProxy("init"));n.addHook("afterUpdateSettings",Handsontable.Grouping.hookProxy("updateGroups"));n.addHook("afterGetColumnHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetColumnHeaderRenderers"));n.addHook("afterGetRowHeaderRenderers",Handsontable.Grouping.hookProxy("afterGetRowHeaderRenderers"));n.addHook("afterGetRowHeader",Handsontable.Grouping.hookProxy("afterGetRowHeader"));n.addHook("afterGetColHeader",Handsontable.Grouping.hookProxy("afterGetColHeader"));n.addHook("beforeOnCellMouseDown",Handsontable.Grouping.hookProxy("toggleGroupVisibility"));n.addHook("modifyTransformStart",Handsontable.Grouping.hookProxy("modifySelectionFactory","start"));n.addHook("modifyTransformEnd",Handsontable.Grouping.hookProxy("modifySelectionFactory","end"));n.addHook("modifyRowHeight",Handsontable.Grouping.hookProxy("modifyRowHeight"))}};e=function(){for(var i,n,u,f=document.querySelectorAll("colgroup"),r=0,e=f.length;r<e;r++){if(i=f[r].querySelectorAll("col.rowHeader"),i.length===0)return;for(n=0,u=i.length+1;n<u;n++){if(u==2)return;n<Handsontable.Grouping.getLevels().rows+1&&(n==Handsontable.Grouping.getLevels().rows?t.addClass(i[n],"htGroupColClosest"):t.addClass(i[n],"htGroupCol"))}}};Handsontable.hooks.add("beforeInit",f);Handsontable.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!Handsontable.Grouping?f.call(this,arguments):!this.getSettings().groups&&Handsontable.Grouping&&(Handsontable.Grouping.resetGroups(),Handsontable.Grouping=void 0)});Handsontable.plugins.Grouping=u},{"./../../dom.js":27,"./../../plugins.js":45}],58:[function(n,t,i){"use strict";function u(n){function a(i){i.items.push(Handsontable.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var i=n.getSelected()[1];return i>t-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var t=n.getSelected();return t[1]!==t[3]},callback:function(){var i=n.getSelected()[1];i>t-1?h(i):c(i)}})}function f(){n.updateSettings({fixedColumnsLeft:t+1});t++}function e(){n.updateSettings({fixedColumnsLeft:t-1});t--}function r(t){n.manualColumnPositions&&n.manualColumnPositions.length!==0||n.manualColumnPositions||(n.manualColumnPositions=[]);t?n.manualColumnPositions[t]||o(t+1):o(n.countCols())}function o(t){if(n.manualColumnPositions.length<t)for(var i=n.manualColumnPositions.length;i<t;i++)n.manualColumnPositions[i]=i}function u(i,r,u,f){u==null&&(u=i);f==="freeze"?n.manualColumnPositions.splice(t,0,n.manualColumnPositions.splice(r,1)[0]):f==="unfreeze"&&n.manualColumnPositions.splice(u,0,n.manualColumnPositions.splice(r,1)[0])}function s(n){for(var r=t,u=i(r),f=i(n);u<f;)r++,u=i(r);return r-1}function h(e){if(!(e<=t-1)){var o=i(e)||e;r(o);u(o,e,null,"freeze");f();n.view.wt.wtOverlays.leftOverlay.refresh();n.view.wt.wtOverlays.adjustElementsSize()}}function c(f){if(!(f>t-1)){var h=s(f),o=i(f)||f;r(o);u(o,f,h,"unfreeze");e();n.view.wt.wtOverlays.leftOverlay.refresh()}}function i(t){return n.manualColumnPositions[t]}function v(n){return this.manualColumnPositionsPluginUsages.length>1?n:i(n)}function y(){n.addHook("modifyCol",v);n.addHook("afterContextMenuDefaultOptions",a)}var t=n.getSettings().fixedColumnsLeft,l=function(){typeof n.manualColumnPositionsPluginUsages!="undefined"?n.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):n.manualColumnPositionsPluginUsages=["manualColumnFreeze"];y()};return{init:l,freezeColumn:h,unfreezeColumn:c,helpers:{addFixedColumn:f,removeFixedColumn:e,checkPositionData:r,modifyColumnOrder:u,getBestColumnReturnPosition:s}}}var r,e,f;Object.defineProperties(i,{ManualColumnFreeze:{get:function(){return u}},__esModule:{value:!0}});e=(r=n("./../../plugins.js"),r&&r.__esModule&&r||{"default":r}).registerPlugin;f=function(){if(this.getSettings().manualColumnFreeze){var n;Handsontable.plugins.manualColumnFreeze=u;this.manualColumnFreeze=new u(this);n=this.manualColumnFreeze;n.init.call(this)}};Handsontable.hooks.add("beforeInit",f)},{"./../../plugins.js":45}],59:[function(n,t,i){"use strict";function c(){function p(t){var i,r;a=this;e=t;i=this.view.wt.wtTable.getCoords(t).col;i>=0&&(o=i,r=e.getBoundingClientRect(),f=r.left,n.style.top=r.top+"px",n.style.left=f+"px",a.rootElement.appendChild(n))}function g(t,i){var r=t.getBoundingClientRect();n.style.left=i>0?r.left+r.width-6+"px":r.left+"px"}function nt(){var i=this,r;s.addClass(n,"active");s.addClass(t,"active");r=e.getBoundingClientRect();t.style.width=r.width+"px";t.style.height=i.view.maximumVisibleElementHeight(0)+"px";t.style.top=n.style.top;t.style.left=f+"px";i.rootElement.appendChild(t)}function tt(n){t.style.left=f+n+"px"}function it(){s.removeClass(n,"active");s.removeClass(t,"active")}var u,i,c,f,o,a,e,n=document.createElement("DIV"),t=document.createElement("DIV"),r=l(this),v,y;n.className="manualColumnMover";t.className="manualColumnMoverGuide";v=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualColumnPositions",n.manualColumnPositions)};y=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualColumnPositions",n),n.value};var w=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="THEAD"?!0:(n=n.parentNode,w(n)):!1},b=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:b(n.parentNode):null},rt=function(){var n=this,t;r.addEventListener(n.rootElement,"mouseover",function(r){var f,e;w(r.target)&&(f=b(r.target),f&&(t?(e=n.view.wt.wtTable.getCoords(f).col,e>=0&&(i=e,g(r.target,i-u))):p.call(n,f)))});r.addEventListener(n.rootElement,"mousedown",function(r){s.hasClass(r.target,"manualColumnMover")&&(c=h.pageX(r),nt.call(n),t=n,u=o,i=o)});r.addEventListener(window,"mousemove",function(n){t&&tt(h.pageX(n)-c)});r.addEventListener(window,"mouseup",function(){t&&(it(),t=!1,d(n.manualColumnPositions,n.countCols()),n.manualColumnPositions.splice(i,0,n.manualColumnPositions.splice(u,1)[0]),n.forceFullRender=!0,n.view.render(),v.call(n),Handsontable.hooks.run(n,"afterColumnMove",u,i),p.call(n,e))});n.addHook("afterDestroy",k)},k=function(){r.clear()},d=function(n,t){if(n.length<t)for(var i=n.length;i<t;i++)n[i]=i};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(n){var t=this,f=!!this.getSettings().manualColumnMove,i,r,u;f?(i=this.getSettings().manualColumnMove,r=y.call(t),this.manualColumnPositions=typeof r!="undefined"?r:Array.isArray(i)?i:[],n=="afterInit"&&(typeof t.manualColumnPositionsPluginUsages!="undefined"?t.manualColumnPositionsPluginUsages.push("manualColumnMove"):t.manualColumnPositionsPluginUsages=["manualColumnMove"],rt.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))):(u=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1,u>-1&&(k.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[u]=void 0))};this.modifyCol=function(n){return this.getSettings().manualColumnMove?(typeof this.manualColumnPositions[n]=="undefined"&&d(this.manualColumnPositions,n+1),this.manualColumnPositions[n]):n};this.afterRemoveCol=function(n,t){if(this.getSettings().manualColumnMove){var r,i=this.manualColumnPositions;r=i.splice(n,t);i=i.map(function(n){for(var i=n,t=0;t<r.length;t++)n>r[t]&&i--;return i});this.manualColumnPositions=i}};this.afterCreateCol=function(n,t){var i,r,u;if(this.getSettings().manualColumnMove&&(i=this.manualColumnPositions,i.length)){for(r=[],u=0;u<t;u++)r.push(n+u);n>=i.length?i.concat(r):(i=i.map(function(i){return i>=n?i+t:i}),i.splice.apply(i,[n,0].concat(r)));this.manualColumnPositions=i}}}var r;Object.defineProperties(i,{ManualColumnMove:{get:function(){return c}},__esModule:{value:!0}});var u,f,e,o,h=(u=n("./../../helpers.js"),u&&u.__esModule&&u||{"default":u}),s=(f=n("./../../dom.js"),f&&f.__esModule&&f||{"default":f}),l=(e=n("./../../eventManager.js"),e&&e.__esModule&&e||{"default":e}).eventManager,a=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin;r=new c;Handsontable.hooks.add("beforeInit",r.beforeInit);Handsontable.hooks.add("afterInit",function(){r.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){r.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyCol",r.modifyCol);Handsontable.hooks.add("afterRemoveCol",r.afterRemoveCol);Handsontable.hooks.add("afterCreateCol",r.afterCreateCol);Handsontable.hooks.register("afterColumnMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],60:[function(n,t,i){"use strict";function c(){function b(t){var f,i;e=this;s=t;f=this.view.wt.wtTable.getCoords(t).col;f>=0&&(r=f,i=s.getBoundingClientRect(),a=i.left-6,u=parseInt(i.width,10),n.style.top=i.top+"px",n.style.left=a+u+"px",e.rootElement.appendChild(n))}function nt(){n.style.left=a+c+"px"}function tt(){var i=this;o.addClass(n,"active");o.addClass(t,"active");t.style.top=n.style.top;t.style.left=n.style.left;t.style.height=i.view.maximumVisibleElementHeight(0)+"px";i.rootElement.appendChild(t)}function it(){t.style.left=n.style.left}function rt(){o.removeClass(n,"active");o.removeClass(t,"active")}var s,r,c,e,i,y,u,a,n=document.createElement("DIV"),t=document.createElement("DIV"),f=l(this),p,w,v;n.className="manualColumnResizer";t.className="manualColumnResizerGuide";p=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualColumnWidths",n.manualColumnWidths)};w=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualColumnWidths",n),n.value};var k=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="THEAD"?!0:(n=n.parentNode,k(n)):!1},d=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:d(n.parentNode):null},ut=function(){var n=this,t,l=0,e=null;f.addEventListener(n.rootElement,"mouseover",function(i){if(k(i.target)){var r=d(i.target);r&&(t||b.call(n,r))}});f.addEventListener(n.rootElement,"mousedown",function(f){o.hasClass(f.target,"manualColumnResizer")&&(tt.call(n),t=n,e==null&&(e=setTimeout(function(){l>=2&&(i=n.determineColumnWidth.call(n,r),v(r,i),n.forceFullRender=!0,n.view.render(),Handsontable.hooks.run(n,"afterColumnResize",r,i));l=0;e=null},500),n._registerTimeout(e)),l++,y=h.pageX(f),i=u)});f.addEventListener(window,"mousemove",function(n){t&&(c=u+(h.pageX(n)-y),i=v(r,c),nt(),it())});f.addEventListener(window,"mouseup",function(){t&&(rt(),t=!1,i!=u&&(n.forceFullRender=!0,n.view.render(),n.view.wt.wtOverlays.adjustElementsSize(),p.call(n),Handsontable.hooks.run(n,"afterColumnResize",r,i)),b.call(n,s))});n.addHook("afterDestroy",g)},g=function(){f.clear()};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(n){var t=this,f=!!this.getSettings().manualColumnResize,i,r,u;f?(i=this.getSettings().manualColumnResize,r=w.call(t),typeof t.manualColumnWidthsPluginUsages!="undefined"?t.manualColumnWidthsPluginUsages.push("manualColumnResize"):t.manualColumnWidthsPluginUsages=["manualColumnResize"],this.manualColumnWidths=typeof r!="undefined"?r:Array.isArray(i)?i:[],n=="afterInit"&&(ut.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))):(u=t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1,u>-1&&(g.call(this),this.manualColumnWidths=[]))};v=function(n,t){return t=Math.max(t,20),n=Handsontable.hooks.run(e,"modifyCol",n),e.manualColumnWidths[n]=t,t};this.modifyColWidth=function(n,t){return(t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:n}}var s;Object.defineProperties(i,{ManualColumnResize:{get:function(){return c}},__esModule:{value:!0}});var r,u,f,e,h=(r=n("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),l=(f=n("./../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,a=(e=n("./../../plugins.js"),e&&e.__esModule&&e||{"default":e}).registerPlugin;s=new c;Handsontable.hooks.add("beforeInit",s.beforeInit);Handsontable.hooks.add("afterInit",function(){s.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){s.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyColWidth",s.modifyColWidth);Handsontable.hooks.register("afterColumnResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],61:[function(n,t,i){"use strict";function c(){function y(t){var u=this,i,r;e=t;i=this.view.wt.wtTable.getCoords(t).row;i>=0&&(s=i,r=e.getBoundingClientRect(),f=r.top,n.style.top=f+"px",n.style.left=r.left+"px",u.rootElement.appendChild(n))}function d(t,i){var r=t.getBoundingClientRect();n.style.top=i>0?r.top+r.height-6+"px":r.top+"px"}function g(){var i=this,r;o.addClass(n,"active");o.addClass(t,"active");r=e.getBoundingClientRect();t.style.width=i.view.maximumVisibleElementWidth(0)+"px";t.style.height=r.height+"px";t.style.top=f+"px";t.style.left=n.style.left;i.rootElement.appendChild(t)}function nt(n){t.style.top=f+n+"px"}function tt(){o.removeClass(n,"active");o.removeClass(t,"active")}var u,i,c,f,s,e,n=document.createElement("DIV"),t=document.createElement("DIV"),r=l(this),a,v;n.className="manualRowMover";t.className="manualRowMoverGuide";a=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualRowPositions",n.manualRowPositions)};v=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualRowPositions",n),n.value};var p=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="TBODY"?!0:(n=n.parentNode,p(n)):!1},w=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:w(n.parentNode):null},it=function(){var n=this,t;r.addEventListener(n.rootElement,"mouseover",function(r){if(p(r.target)){var f=w(r.target);f&&(t?(i=n.view.wt.wtTable.getCoords(f).row,d(f,i-u)):y.call(n,f))}});r.addEventListener(n.rootElement,"mousedown",function(r){o.hasClass(r.target,"manualRowMover")&&(c=h.pageY(r),g.call(n),t=n,u=s,i=s)});r.addEventListener(window,"mousemove",function(n){t&&nt(h.pageY(n)-c)});r.addEventListener(window,"mouseup",function(){t&&(tt(),t=!1,k(n.manualRowPositions,n.countRows()),n.manualRowPositions.splice(i,0,n.manualRowPositions.splice(u,1)[0]),n.forceFullRender=!0,n.view.render(),a.call(n),Handsontable.hooks.run(n,"afterRowMove",u,i),y.call(n,e))});n.addHook("afterDestroy",b)},b=function(){r.clear()},k=function(n,t){if(n.length<t)for(var i=n.length;i<t;i++)n[i]=i};this.beforeInit=function(){this.manualRowPositions=[]};this.init=function(n){var t=this,f=!!t.getSettings().manualRowMove,i,r,u;f?(i=t.getSettings().manualRowMove,r=v.call(t),typeof t.manualRowPositionsPluginUsages!="undefined"?t.manualRowPositionsPluginUsages.push("manualColumnMove"):t.manualRowPositionsPluginUsages=["manualColumnMove"],this.manualRowPositions=typeof r!="undefined"?r:Array.isArray(i)?i:[],n==="afterInit"&&(it.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))):(u=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1,u>-1&&(b.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[u]=void 0))};this.modifyRow=function(n){var t=this;return t.getSettings().manualRowMove?(typeof t.manualRowPositions[n]=="undefined"&&k(this.manualRowPositions,n+1),t.manualRowPositions[n]):n}}var s;Object.defineProperties(i,{ManualRowMove:{get:function(){return c}},__esModule:{value:!0}});var r,u,f,e,h=(r=n("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),l=(f=n("./../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,a=(e=n("./../../plugins.js"),e&&e.__esModule&&e||{"default":e}).registerPlugin;s=new c;Handsontable.hooks.add("beforeInit",s.beforeInit);Handsontable.hooks.add("afterInit",function(){s.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){s.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRow",s.modifyRow);Handsontable.hooks.register("afterRowMove")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],62:[function(n,t,i){"use strict";function c(){function b(t){var f,r;e=this;s=t;f=this.view.wt.wtTable.getCoords(t).row;f>=0&&(i=f,r=s.getBoundingClientRect(),a=r.top-6,u=parseInt(r.height,10),n.style.left=r.left+"px",n.style.top=a+u+"px",e.rootElement.appendChild(n))}function nt(){n.style.top=a+c+"px"}function tt(){var i=this;o.addClass(n,"active");o.addClass(t,"active");t.style.top=n.style.top;t.style.left=n.style.left;t.style.width=i.view.maximumVisibleElementWidth(0)+"px";i.rootElement.appendChild(t)}function it(){t.style.top=n.style.top}function rt(){o.removeClass(n,"active");o.removeClass(t,"active")}var s,i,c,e,r,y,u,a,n=document.createElement("DIV"),t=document.createElement("DIV"),f=l(this),p,w,v;n.className="manualRowResizer";t.className="manualRowResizerGuide";p=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualRowHeights",n.manualRowHeights)};w=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualRowHeights",n),n.value};var k=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="TBODY"?!0:(n=n.parentNode,k(n)):!1},d=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:d(n.parentNode):null},ut=function(){var n=this,t,l=0,e=null;f.addEventListener(n.rootElement,"mouseover",function(i){if(k(i.target)){var r=d(i.target);r&&(t||b.call(n,r))}});f.addEventListener(n.rootElement,"mousedown",function(f){o.hasClass(f.target,"manualRowResizer")&&(tt.call(n),t=n,e==null&&(e=setTimeout(function(){l>=2&&(v(i,null),n.forceFullRender=!0,n.view.render(),Handsontable.hooks.run(n,"afterRowResize",i,r));l=0;e=null},500),n._registerTimeout(e)),l++,y=h.pageY(f),r=u)});f.addEventListener(window,"mousemove",function(n){t&&(c=u+(h.pageY(n)-y),r=v(i,c),nt(),it())});f.addEventListener(window,"mouseup",function(){t&&(rt(),t=!1,r!=u&&(n.forceFullRender=!0,n.view.render(),p.call(n),Handsontable.hooks.run(n,"afterRowResize",i,r)),b.call(n,s))});n.addHook("afterDestroy",g)},g=function(){f.clear()};this.beforeInit=function(){this.manualRowHeights=[]};this.init=function(n){var t=this,f=!!this.getSettings().manualRowResize,i,r,u;f?(i=this.getSettings().manualRowResize,r=w.call(t),typeof t.manualRowHeightsPluginUsages!="undefined"?t.manualRowHeightsPluginUsages.push("manualRowResize"):t.manualRowHeightsPluginUsages=["manualRowResize"],this.manualRowHeights=typeof r!="undefined"?r:Array.isArray(i)?i:[],n==="afterInit"?(ut.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())):(u=t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1,u>-1&&(g.call(this),this.manualRowHeights=[],t.manualRowHeightsPluginUsages[u]=void 0))};v=function(n,t){return n=Handsontable.hooks.run(e,"modifyRow",n),e.manualRowHeights[n]=t,t};this.modifyRowHeight=function(n,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),this.manualRowHeights[t]!==void 0)?this.manualRowHeights[t]:n}}var s;Object.defineProperties(i,{ManualRowResize:{get:function(){return c}},__esModule:{value:!0}});var r,u,f,e,h=(r=n("./../../helpers.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),l=(f=n("./../../eventManager.js"),f&&f.__esModule&&f||{"default":f}).eventManager,a=(e=n("./../../plugins.js"),e&&e.__esModule&&e||{"default":e}).registerPlugin;s=new c;Handsontable.hooks.add("beforeInit",s.beforeInit);Handsontable.hooks.add("afterInit",function(){s.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){s.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRowHeight",s.modifyRowHeight);Handsontable.hooks.register("afterRowResize")},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../helpers.js":42,"./../../plugins.js":45}],63:[function(n,t,i){"use strict";function y(){var n=[];return n.getInfo=function(n,t){for(var i=0,r=this.length;i<r;i++)if(this[i].row<=n&&this[i].row+this[i].rowspan-1>=n&&this[i].col<=t&&this[i].col+this[i].colspan-1>=t)return this[i]},n.setInfo=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t].row===n.row&&this[t].col===n.col){this[t]=n;return}this.push(n)},n.removeInfo=function(n,t){for(var i=0,r=this.length;i<r;i++)if(this[i].row===n&&this[i].col===t){this.splice(i,1);break}},n}function u(n){if(this.mergedCellInfoCollection=new y,Array.isArray(n))for(var t=0,i=n.length;t<i;t++)this.mergedCellInfoCollection.setInfo(n[t])}function rt(n){var i=this.getSettings().mergeCells,t;i&&!this.selection.isMultiple()&&(t=this.mergeCells.mergedCellInfoCollection.getInfo(n[0],n[1]),t&&(n[0]=t.row,n[1]=t.col,n[2]=t.row+t.rowspan-1,n[3]=t.col+t.colspan-1))}Object.defineProperties(i,{MergeCells:{get:function(){return u}},__esModule:{value:!0}});var e,o,s,h,ut=(e=n("./../../plugins.js"),e&&e.__esModule&&e||{"default":e}).registerPlugin,r=(o=n("./../../3rdparty/walkontable/src/cell/coords.js"),o&&o.__esModule&&o||{"default":o}).WalkontableCellCoords,f=(s=n("./../../3rdparty/walkontable/src/cell/range.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellRange,v=(h=n("./../../3rdparty/walkontable/src/table.js"),h&&h.__esModule&&h||{"default":h}).WalkontableTable;u.prototype.canMergeRange=function(n){return!n.isSingle()};u.prototype.mergeRange=function(n){if(this.canMergeRange(n)){var i=n.getTopLeftCorner(),r=n.getBottomRightCorner(),t={};t.row=i.row;t.col=i.col;t.rowspan=r.row-i.row+1;t.colspan=r.col-i.col+1;this.mergedCellInfoCollection.setInfo(t)}};u.prototype.mergeOrUnmergeSelection=function(n){var t=this.mergedCellInfoCollection.getInfo(n.from.row,n.from.col);t?this.unmergeSelection(n.from):this.mergeSelection(n)};u.prototype.mergeSelection=function(n){this.mergeRange(n)};u.prototype.unmergeSelection=function(n){var t=this.mergedCellInfoCollection.getInfo(n.row,n.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)};u.prototype.applySpanProperties=function(n,t,i){var r=this.mergedCellInfoCollection.getInfo(t,i);r?r.row===t&&r.col===i?(n.setAttribute("rowspan",r.rowspan),n.setAttribute("colspan",r.colspan)):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"))};u.prototype.modifyTransform=function(n,t,i){var nt=function(n,t){return t.row>=n.row&&t.row<=n.row+n.rowspan-1?!0:!1},tt=function(n,t){return t.col>=n.col&&t.col<=n.col+n.colspan-1?!0:!1},it=function(n){return new r(t.to.row+n.row,t.to.col+n.col)},u={row:i.row,col:i.col},s,e,rt,l,a,w,c,y,v;if(n=="modifyTransformStart"){for(this.lastDesiredCoords||(this.lastDesiredCoords=new r(null,null)),s=new r(t.highlight.row,t.highlight.col),e=this.mergedCellInfoCollection.getInfo(s.row,s.col),c=0,y=this.mergedCellInfoCollection.length;c<y;c++)if(l=this.mergedCellInfoCollection[c],l=new r(l.row+l.rowspan-1,l.col+l.colspan-1),t.includes(l)){rt=!0;break}if(e){var p=new r(e.row,e.col),k=new r(e.row+e.rowspan-1,e.col+e.colspan-1),ut=new f(p,p,k);ut.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new r(null,null));u.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-s.row:u.row;u.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-s.col:u.col;i.row>0?u.row=e.row+e.rowspan-1-s.row+i.row:i.row<0&&(u.row=s.row-e.row+i.row);i.col>0?u.col=e.col+e.colspan-1-s.col+i.col:i.col<0&&(u.col=s.col-e.col+i.col)}a=new r(t.highlight.row+u.row,t.highlight.col+u.col);w=this.mergedCellInfoCollection.getInfo(a.row,a.col);w&&(this.lastDesiredCoords=a,u={row:w.row-s.row,col:w.col-s.col})}else if(n=="modifyTransformEnd")for(c=0,y=this.mergedCellInfoCollection.length;c<y;c++){var o=this.mergedCellInfoCollection[c],p=new r(o.row,o.col),k=new r(o.row+o.rowspan-1,o.col+o.colspan-1),h=new f(p,p,k),b=t.getBordersSharedWith(h);h.isEqual(t)?t.setDirection("NW-SE"):b.length>0&&(v=t.highlight.isEqual(h.from),b.indexOf("top")>-1?t.to.isSouthEastOf(h.from)&&v?t.setDirection("NW-SE"):t.to.isSouthWestOf(h.from)&&v&&t.setDirection("NE-SW"):b.indexOf("bottom")>-1&&(t.to.isNorthEastOf(h.from)&&v?t.setDirection("SW-NE"):t.to.isNorthWestOf(h.from)&&v&&t.setDirection("SE-NW")));var a=it(u),d=nt(o,a),g=tt(o,a);t.includesRange(h)&&(h.includes(a)||d||g)&&(d&&(u.row<0?u.row-=o.rowspan-1:u.row>0&&(u.row+=o.rowspan-1)),g&&(u.col<0?u.col-=o.colspan-1:u.col>0&&(u.col+=o.colspan-1)))}u.row!==0&&(i.row=u.row);u.col!==0&&(i.col=u.col)};var p=function(){var n=this,t=n.getSettings().mergeCells;t&&(n.mergeCells||(n.mergeCells=new u(t)))},w=function(){var n=this;n.mergeCells&&(n.view.wt.wtTable.getCell=function(t){if(n.getSettings().mergeCells){var i=n.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);i&&(t=i)}return v.prototype.getCell.call(this,t)})},b=function(n){if(this.mergeCells){var t=(n.ctrlKey||n.metaKey)&&!n.altKey;t&&n.keyCode===77&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),n.stopImmediatePropagation())}},k=function(n){this.getSettings().mergeCells&&(n.items.push(Handsontable.ContextMenu.SEPARATOR),n.items.push({key:"mergeCells",name:function(){var n=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(n[0],n[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return!1}}))},d=function(n,t,i){this.mergeCells&&this.mergeCells.applySpanProperties(n,t,i)},a=function(n){return function(t){var f=this.getSettings().mergeCells,i,u,r;f&&(i=this.getSelectedRange(),this.mergeCells.modifyTransform(n,i,t),n==="modifyTransformEnd"&&(u=this.countRows(),r=this.countCols(),i.from.row<0?i.from.row=0:i.from.row>0&&i.from.row>=u&&(i.from.row=i.from-1),i.from.col<0?i.from.col=0:i.from.col>0&&i.from.col>=r&&(i.from.col=r-1)))}},g=function(n){var o,t,u,e,s;if(this.lastDesiredCoords=null,o=this.getSettings().mergeCells,o){t=this.getSelectedRange();t.highlight=new r(t.highlight.row,t.highlight.col);t.to=n;u=!1;do for(u=!1,e=0,s=this.mergeCells.mergedCellInfoCollection.length;e<s;e++){var i=this.mergeCells.mergedCellInfoCollection[e],h=new r(i.row,i.col),c=new r(i.row+i.rowspan-1,i.col+i.colspan-1),l=new f(h,h,c);t.expandByRange(l)&&(n.row=t.to.row,n.col=t.to.col,u=!0)}while(u)}},nt=function(n,t){var h,e,c;if(t&&t=="area"&&(h=this.getSettings().mergeCells,h)){var i=this.getSelectedRange(),o=new f(i.from,i.from,i.from),s=new f(i.to,i.to,i.to);for(e=0,c=this.mergeCells.mergedCellInfoCollection.length;e<c;e++){var u=this.mergeCells.mergedCellInfoCollection[e],l=new r(u.row,u.col),v=new r(u.row+u.rowspan-1,u.col+u.colspan-1),a=new f(l,l,v);o.expandByRange(a)&&(n[0]=o.from.row,n[1]=o.from.col);s.expandByRange(a)&&(n[2]=s.from.row,n[3]=s.from.col)}}},tt=function(n,t,i){var u=this.getSettings().mergeCells,r;u&&(r=this.mergeCells.mergedCellInfoCollection.getInfo(n,t),r&&(r.row!=n||r.col!=t)&&(i.copyable=!1))},c=function(n){var f=this.getSettings().mergeCells,u,t,i,r;if(f)for(u=this.countCols(),i=0;i<u;i++){if(t=this.mergeCells.mergedCellInfoCollection.getInfo(n.startRow,i),t&&t.row<n.startRow)return n.startRow=t.row,c.call(this,n);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(n.endRow,i),t&&(r=t.row+t.rowspan-1,r>n.endRow))return n.endRow=r,c.call(this,n)}},l=function(n){var f=this.getSettings().mergeCells,u,t,i,r;if(f)for(u=this.countRows(),i=0;i<u;i++){if(t=this.mergeCells.mergedCellInfoCollection.getInfo(i,n.startColumn),t&&t.col<n.startColumn)return n.startColumn=t.col,l.call(this,n);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(i,n.endColumn),t&&(r=t.col+t.colspan-1,r>n.endColumn))return n.endColumn=r,l.call(this,n)}},it=function(n){var t,r,i;if(n&&this.mergeCells){t=this.mergeCells.mergedCellInfoCollection;r=this.getSelectedRange();for(i in t)if(r.highlight.row==t[i].row&&r.highlight.col==t[i].col&&r.to.row==t[i].row+t[i].rowspan-1&&r.to.col==t[i].col+t[i].colspan-1)return!1}return n};Handsontable.hooks.add("beforeInit",p);Handsontable.hooks.add("afterInit",w);Handsontable.hooks.add("beforeKeyDown",b);Handsontable.hooks.add("modifyTransformStart",a("modifyTransformStart"));Handsontable.hooks.add("modifyTransformEnd",a("modifyTransformEnd"));Handsontable.hooks.add("beforeSetRangeEnd",g);Handsontable.hooks.add("beforeDrawBorders",nt);Handsontable.hooks.add("afterIsMultipleSelection",it);Handsontable.hooks.add("afterRenderer",d);Handsontable.hooks.add("afterContextMenuDefaultOptions",k);Handsontable.hooks.add("afterGetCellMeta",tt);Handsontable.hooks.add("afterViewportRowCalculatorOverride",c);Handsontable.hooks.add("afterViewportColumnCalculatorOverride",l);Handsontable.hooks.add("afterAutofillApplyValues",rt);Handsontable.MergeCells=u},{"./../../3rdparty/walkontable/src/cell/coords.js":5,"./../../3rdparty/walkontable/src/cell/range.js":6,"./../../3rdparty/walkontable/src/table.js":20,"./../../plugins.js":45}],64:[function(n,t,i){"use strict";var c;Object.defineProperties(i,{"default":{get:function(){return c}},__esModule:{value:!0}});var u,f,e,o,r=(u=n("./../../dom.js"),u&&u.__esModule&&u||{"default":u}),l=(f=n("./../_base.js"),f&&f.__esModule&&f||{"default":f}).default,a=(e=n("./../../eventManager.js"),e&&e.__esModule&&e||{"default":e}).eventManager,v=(o=n("./../../plugins.js"),o&&o.__esModule&&o||{"default":o}).registerPlugin,s=function(n){var t=this;$traceurRuntime.superConstructor(h).call(this,n);this.dragged=[];this.eventManager=a(this.hot);this.bindTouchEvents();this.hot.addHook("afterInit",function(){return t.init()})},h=s;$traceurRuntime.createClass(s,{init:function(){this.lastSetCell=null;Handsontable.plugins.multipleSelectionHandles=new h(this.hot)},bindTouchEvents:function(){function t(t){if(n.dragged.length===1)return n.dragged.splice(0,n.dragged.length),!0;var i=n.dragged.indexOf(t);if(i==-1)return!1;i===0?n.dragged=n.dragged.slice(0,1):i==1&&(n.dragged=n.dragged.slice(-1))}var n=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var i;return r.hasClass(t.target,"topLeftSelectionHandle-HitArea")?(i=n.hot.getSelectedRange(),n.dragged.push("topLeft"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):r.hasClass(t.target,"bottomRightSelectionHandle-HitArea")?(i=n.hot.getSelectedRange(),n.dragged.push("bottomRight"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(i){return r.hasClass(i.target,"topLeftSelectionHandle-HitArea")?(t.call(n,"topLeft"),n.touchStartRange=void 0,i.preventDefault(),!1):r.hasClass(i.target,"bottomRightSelectionHandle-HitArea")?(t.call(n,"bottomRight"),n.touchStartRange=void 0,i.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var c=r.getWindowScrollTop(),l=r.getWindowScrollLeft(),i,u,f,o,s,h,e;n.dragged.length!==0&&(i=document.elementFromPoint(t.touches[0].screenX-l,t.touches[0].screenY-c),i&&i!==n.lastSetCell)&&((i.nodeName=="TD"||i.nodeName=="TH")&&(u=n.hot.getCoords(i),u.col==-1&&(u.col=0),f=n.hot.getSelectedRange(),o=f.getWidth(),s=f.getHeight(),h=f.getDirection(),o==1&&s==1&&n.hot.selection.setRangeEnd(u),e=n.getCurrentRangeCoords(f,u,n.touchStartRange.direction,h,n.dragged[0]),e.start!==null&&n.hot.selection.setRangeStart(e.start),n.hot.selection.setRangeEnd(e.end),n.lastSetCell=i),t.preventDefault())})},getCurrentRangeCoords:function(n,t,i,r,u){var e=n.getTopLeftCorner(),o=n.getBottomRightCorner(),s=n.getBottomLeftCorner(),h=n.getTopRightCorner(),f={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":f=u=="topLeft"?{start:new WalkontableCellCoords(t.row,n.highlight.col),end:new WalkontableCellCoords(s.row,t.col)}:{start:new WalkontableCellCoords(n.highlight.row,t.col),end:new WalkontableCellCoords(t.row,e.col)};break;case"SE-NW":u=="bottomRight"&&(f={start:new WalkontableCellCoords(o.row,t.col),end:new WalkontableCellCoords(t.row,e.col)})}break;case"NW-SE":switch(r){case"NE-SW":u=="topLeft"?f={start:t,end:s}:f.end=t;break;case"NW-SE":u=="topLeft"?f={start:t,end:o}:f.end=t;break;case"SE-NW":u=="topLeft"?f={start:t,end:e}:f.end=t;break;case"SW-NE":u=="topLeft"?f={start:t,end:h}:f.end=t}break;case"SW-NE":switch(r){case"NW-SE":f=u=="bottomRight"?{start:new WalkontableCellCoords(t.row,e.col),end:new WalkontableCellCoords(s.row,t.col)}:{start:new WalkontableCellCoords(e.row,t.col),end:new WalkontableCellCoords(t.row,o.col)};break;case"SW-NE":f=u=="topLeft"?{start:new WalkontableCellCoords(n.highlight.row,t.col),end:new WalkontableCellCoords(t.row,o.col)}:{start:new WalkontableCellCoords(t.row,e.col),end:new WalkontableCellCoords(e.row,t.col)};break;case"SE-NW":u=="bottomRight"?f={start:new WalkontableCellCoords(t.row,h.col),end:new WalkontableCellCoords(e.row,t.col)}:u=="topLeft"&&(f={start:s,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":u=="topLeft"&&(f.end=t);break;case"SE-NW":u=="topLeft"?f.end=t:f={start:t,end:e}}}return f},isDragged:function(){return this.dragged.length>0}},{},l);c=s;v("multipleSelectionHandles",s)},{"./../../dom.js":27,"./../../eventManager.js":41,"./../../plugins.js":45,"./../_base.js":46}],65:[function(n,t,i){"use strict";function h(){}function s(){var n=this,t=n.getSettings().observeChanges;t?(n.observer&&e.call(n),c.call(n),v.call(n)):t||e.call(n)}function c(){var n=this;n.observeChangesActive=!0;n.pauseObservingChanges=function(){n.observeChangesActive=!1};n.resumeObservingChanges=function(){n.observeChangesActive=!0};n.observedData=n.getData();n.observer=o.observe(n.observedData,function(t){n.observeChangesActive&&(l.call(n,t),n.render());n.runHooks("afterChangesObserved")})}function l(n){function s(n){var t;return t=c(n),h(t)}function h(n){var t=[];return n.filter(function(n){var i=e(n.path);if(["add","remove"].indexOf(n.op)!=-1&&!isNaN(i.col)){if(t.indexOf(i.col)!=-1)return!1;t.push(i.col)}return!0})}function c(n){return n.filter(function(n){return!/[/]length/ig.test(n.path)})}function e(n){var t=n.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r,t,i=this,f=s(n),u=0,o=f.length;u<o;u++){r=f[u];t=e(r.path);switch(r.op){case"add":isNaN(t.col)?i.runHooks("afterCreateRow",t.row):i.runHooks("afterCreateCol",t.col);break;case"remove":isNaN(t.col)?i.runHooks("afterRemoveRow",t.row,1):i.runHooks("afterRemoveCol",t.col,1);break;case"replace":i.runHooks("afterChange",[t.row,t.col,null,r.value],"external")}}}function e(){var n=this;n.observer&&(a.call(n),y.call(n))}function a(){var n=this;o.unobserve(n.observedData,n.observer);delete n.observeChangesActive;delete n.pauseObservingChanges;delete n.resumeObservingChanges}function v(){var n=this;n.addHook("afterDestroy",e);n.addHook("afterCreateRow",r);n.addHook("afterRemoveRow",r);n.addHook("afterCreateCol",r);n.addHook("afterRemoveCol",r);n.addHook("afterChange",function(n,t){t!="loadData"&&r.call(this)})}function y(){var n=this;n.removeHook("afterDestroy",e);n.removeHook("afterCreateRow",r);n.removeHook("afterRemoveRow",r);n.removeHook("afterCreateCol",r);n.removeHook("afterRemoveCol",r);n.removeHook("afterChange",r)}function r(){var n=this;n.pauseObservingChanges();n.addHookOnce("afterChangesObserved",function(){n.resumeObservingChanges()})}Object.defineProperties(i,{ObserveChanges:{get:function(){return h}},__esModule:{value:!0}});var u,f,p=(u=n("./../../plugins.js"),u&&u.__esModule&&u||{"default":u}).registerPlugin,o=(f=n("jsonpatch"),f&&f.__esModule&&f||{"default":f}).default;Handsontable.hooks.add("afterLoadData",s);Handsontable.hooks.add("afterUpdateSettings",s);Handsontable.hooks.register("afterChangesObserved")},{"./../../plugins.js":45,jsonpatch:"jsonpatch"}],66:[function(n,t,i){"use strict";function o(n){var t,i=function(){window.localStorage[n+"__persistentStateKeys"]=JSON.stringify(t)},r=function(){var i=window.localStorage[n+"__persistentStateKeys"],r=typeof i=="string"?JSON.parse(i):void 0;t=r?r:[]},u=function(){t=[];i()};r();this.saveValue=function(r,u){window.localStorage[n+"_"+r]=JSON.stringify(u);t.indexOf(r)==-1&&(t.push(r),i())};this.loadValue=function(t,i){t=typeof t!="undefined"?t:i;var r=window.localStorage[n+"_"+t];if(typeof r!="undefined")return JSON.parse(r)};this.reset=function(t){window.localStorage.removeItem(n+"_"+t)};this.resetAll=function(){for(var i=0;i<t.length;i++)window.localStorage.removeItem(n+"_"+t[i]);u()}}function f(){function r(){var i=this;for(var t in n)n.hasOwnProperty(t)&&i.addHook(t,n[t])}function u(){var i=this;for(var t in n)n.hasOwnProperty(t)&&i.removeHook(t,n[t])}var t=this,n,i;this.init=function(){var n=this,i=n.getSettings().persistentState;if(t.enabled=!!i,!t.enabled){u.call(n);return}n.storage||(n.storage=new o(n.rootElement.id));n.resetState=t.resetValue;r.call(n)};this.saveValue=function(n,t){var i=this;i.storage.saveValue(n,t)};this.loadValue=function(n,t){var i=this;t.value=i.storage.loadValue(n)};this.resetValue=function(n){var t=this;typeof n!="undefined"?t.storage.reset(n):t.storage.resetAll()};n={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};for(i in n)n.hasOwnProperty(i)&&Handsontable.hooks.register(i)}var r,e,u;Object.defineProperties(i,{HandsontablePersistentState:{get:function(){return f}},__esModule:{value:!0}});e=(r=n("./../../plugins.js"),r&&r.__esModule&&r||{"default":r}).registerPlugin;u=new f;Handsontable.hooks.add("beforeInit",u.init);Handsontable.hooks.add("afterUpdateSettings",u.init)},{"./../../plugins.js":45}],67:[function(n){"use strict";function e(){var n=this,t=!!n.getSettings().search;t?n.search=new Handsontable.Search(n):delete n.search}var t,i,r=(t=n("./../../dom.js"),t&&t.__esModule&&t||{"default":t}),u=(i=n("./../../renderers.js"),i&&i.__esModule&&i||{"default":i}),o=u.registerRenderer,s=u.getRenderer,f;Handsontable.Search=function(n){this.query=function(t,i,r){var a=n.countRows(),v=n.countCols(),o=[],u,f,l;for(i||(i=Handsontable.Search.global.getDefaultCallback()),r||(r=Handsontable.Search.global.getDefaultQueryMethod()),u=0;u<a;u++)for(f=0;f<v;f++){var e=n.getDataAtCell(u,f),s=n.getCellMeta(u,f),h=s.search.callback||i,y=s.search.queryMethod||r,c=y(t,e);c&&(l={row:u,col:f,data:e},o.push(l));h&&h(n,u,f,e,c)}return o}};Handsontable.Search.DEFAULT_CALLBACK=function(n,t,i,r,u){n.getCellMeta(t,i).isSearchResult=u};Handsontable.Search.DEFAULT_QUERY_METHOD=function(n,t){return typeof n=="undefined"||n==null||!n.toLowerCase||n.length===0?!1:typeof t=="undefined"||t==null?!1:t.toString().toLowerCase().indexOf(n.toLowerCase())!=-1};Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";Handsontable.Search.global=function(){var n=Handsontable.Search.DEFAULT_CALLBACK,t=Handsontable.Search.DEFAULT_QUERY_METHOD,i=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return n},setDefaultCallback:function(t){n=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(n){t=n},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(n){i=n}}}();Handsontable.SearchCellDecorator=function(n,t,i,u,f,e,o){var s=o.search!==null&&typeof o.search=="object"&&o.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();o.isSearchResult?r.addClass(t,s):r.removeClass(t,s)};f=s("base");o("base",function(){f.apply(this,arguments);Handsontable.SearchCellDecorator.apply(this,arguments)});Handsontable.hooks.add("afterInit",e);Handsontable.hooks.add("afterUpdateSettings",e)},{"./../../dom.js":27,"./../../renderers.js":70}],68:[function(n,t,i){"use strict";Object.defineProperties(i,{TouchScroll:{get:function(){return o}},__esModule:{value:!0}});var r,u,f,e=(r=n("./../../dom.js"),r&&r.__esModule&&r||{"default":r}),s=(u=n("./../_base.js"),u&&u.__esModule&&u||{"default":u}).default,h=(f=n("./../../plugins.js"),f&&f.__esModule&&f||{"default":f}).registerPlugin,o=function(n){var t=this;$traceurRuntime.superConstructor(c).call(this,n);this.hot.addHook("afterInit",function(){return t.init()});this.hot.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()});this.scrollbars=[];this.clones=[]},c=o;$traceurRuntime.createClass(o,{init:function(){this.registerEvents();this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var n=this;this.hot.addHookOnce("afterRender",function(){var t=n.hot.view.wt.wtOverlays;n.scrollbars=[];n.scrollbars.push(t.topOverlay);n.scrollbars.push(t.leftOverlay);t.topLeftCornerOverlay&&n.scrollbars.push(t.topLeftCornerOverlay);n.clones=[];t.topOverlay.needFullRender&&n.clones.push(t.topOverlay.clone.wtTable.holder.parentNode);t.leftOverlay.needFullRender&&n.clones.push(t.leftOverlay.clone.wtTable.holder.parentNode);t.topLeftCornerOverlay&&n.clones.push(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var n=this;this.hot.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()});this.hot.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){Handsontable.freezeOverlays=!0;for(var n=0,t=this.clones.length;n<t;n++)e.addClass(this.clones[n],"hide-tween")},onAfterMomentumScroll:function(){var r,t,u,i,f,n,o;for(Handsontable.freezeOverlays=!1,r=this,t=0,u=this.clones.length;t<u;t++)e.removeClass(this.clones[t],"hide-tween");for(i=0,f=this.clones.length;i<f;i++)e.addClass(this.clones[i],"show-tween");for(setTimeout(function(){for(var n=0,t=r.clones.length;n<t;n++)e.removeClass(r.clones[n],"show-tween")},400),n=0,o=this.scrollbars.length;n<o;n++)this.scrollbars[n].refresh(),this.scrollbars[n].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},s);h("touchScroll",o)},{"./../../dom.js":27,"./../../plugins.js":45,"./../_base.js":46}],69:[function(n){"use strict";function r(){var n=this,t=typeof n.getSettings().undo=="undefined"||n.getSettings().undo;t?n.undoRedo||(n.undoRedo=new Handsontable.UndoRedo(n),e(n),n.addHook("beforeKeyDown",u),n.addHook("afterChange",f)):n.undoRedo&&(delete n.undoRedo,o(n),n.removeHook("beforeKeyDown",u),n.removeHook("afterChange",f))}function u(n){var t=this,i=(n.ctrlKey||n.metaKey)&&!n.altKey;i&&(n.keyCode===89||n.shiftKey&&n.keyCode===90?(t.undoRedo.redo(),n.stopImmediatePropagation()):n.keyCode===90&&(t.undoRedo.undo(),n.stopImmediatePropagation()))}function f(n,t){var i=this;if(t=="loadData")return i.undoRedo.clear()}function e(n){n.undo=function(){return n.undoRedo.undo()};n.redo=function(){return n.undoRedo.redo()};n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()};n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()};n.clearUndo=function(){return n.undoRedo.clear()}}function o(n){delete n.undo;delete n.redo;delete n.isUndoAvailable;delete n.isRedoAvailable;delete n.clearUndo}var i,t=(i=n("./../../helpers.js"),i&&i.__esModule&&i||{"default":i});Handsontable.UndoRedo=function(n){var t=this;this.instance=n;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;n.addHook("afterChange",function(n){if(n){var i=new Handsontable.UndoRedo.ChangeAction(n);t.done(i)}});n.addHook("afterCreateRow",function(n,i,r){if(!r){var u=new Handsontable.UndoRedo.CreateRowAction(n,i);t.done(u)}});n.addHook("beforeRemoveRow",function(n,i){var r=t.instance.getData(),u,f;n=(r.length+n)%r.length;u=r.slice(n,n+i);f=new Handsontable.UndoRedo.RemoveRowAction(n,u);t.done(f)});n.addHook("afterCreateCol",function(n,i,r){if(!r){var u=new Handsontable.UndoRedo.CreateColumnAction(n,i);t.done(u)}});n.addHook("beforeRemoveCol",function(i,r){var e=t.instance.getData(),f,u,o,s,h;for(i=(t.instance.countCols()+i)%t.instance.countCols(),f=[],u=0,o=e.length;u<o;u++)f[u]=e[u].slice(i,i+r);Array.isArray(n.getSettings().colHeaders)&&(s=n.getSettings().colHeaders.slice(i,i+f.length));h=new Handsontable.UndoRedo.RemoveColumnAction(i,f,s);t.done(h)});n.addHook("beforeCellAlignment",function(n,i,r,u){var f=new Handsontable.UndoRedo.CellAlignmentAction(n,i,r,u);t.done(f)})};Handsontable.UndoRedo.prototype.done=function(n){this.ignoreNewActions||(this.doneActions.push(n),this.undoneActions.length=0)};Handsontable.UndoRedo.prototype.undo=function(){var n,t;this.isUndoAvailable()&&(n=this.doneActions.pop(),this.ignoreNewActions=!0,t=this,n.undo(this.instance,function(){t.ignoreNewActions=!1;t.undoneActions.push(n)}))};Handsontable.UndoRedo.prototype.redo=function(){var n,t;this.isRedoAvailable()&&(n=this.undoneActions.pop(),this.ignoreNewActions=!0,t=this,n.redo(this.instance,function(){t.ignoreNewActions=!1;t.doneActions.push(n)}))};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(n){this.changes=n};t.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(n,i){for(var u=t.deepClone(this.changes),e=n.countEmptyRows(!0),o=n.countEmptyCols(!0),r=0,f=u.length;r<f;r++)u[r].splice(3,1);for(n.addHookOnce("afterChange",i),n.setDataAtRowProp(u,null,null,"undo"),r=0,f=u.length;r<f;r++)n.getSettings().minSpareRows&&u[r][0]+1+n.getSettings().minSpareRows===n.countRows()&&e==n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(u[r][0]+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&u[r][1]+1+n.getSettings().minSpareCols===n.countCols()&&o==n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(u[r][1]+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(n,i){for(var r=t.deepClone(this.changes),u=0,f=r.length;u<f;u++)r[u].splice(2,1);n.addHookOnce("afterChange",i);n.setDataAtRowProp(r,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(n,t){this.index=n;this.amount=t};t.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(n,t){var i=n.countRows(),r=n.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r);n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateRow",t);n.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(n,t){this.index=n;this.data=t};t.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(n,t){var i=[this.index,0];Array.prototype.push.apply(i,this.data);Array.prototype.splice.apply(n.getData(),i);n.addHookOnce("afterRender",t);n.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(n,t){this.index=n;this.amount=t};t.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateCol",t);n.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.CellAlignmentAction=function(n,t,i,r){this.stateBefore=n;this.range=t;this.type=i;this.alignment=r};Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=function(n,t){var i,r;if(n.contextMenu){for(i=this.range.from.row;i<=this.range.to.row;i++)for(r=this.range.from.col;r<=this.range.to.col;r++)n.setCellMeta(i,r,"className",this.stateBefore[i][r]||" htLeft");n.addHookOnce("afterRender",t);n.render()}};Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(n,t){var i,r;if(n.contextMenu){for(i=this.range.from.row;i<=this.range.to.row;i++)for(r=this.range.from.col;r<=this.range.to.col;r++)n.contextMenu.align.call(n,this.range,this.type,this.alignment);n.addHookOnce("afterRender",t);n.render()}};Handsontable.UndoRedo.RemoveColumnAction=function(n,t,i){this.index=n;this.data=t;this.amount=this.data[0].length;this.headers=i};t.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(n,t){for(var u,i,r=0,f=n.getData().length;r<f;r++)u=n.getSourceDataAtRow(r),i=[this.index,0],Array.prototype.push.apply(i,this.data[r]),Array.prototype.splice.apply(u,i);typeof this.headers!="undefined"&&(i=[this.index,0],Array.prototype.push.apply(i,this.headers),Array.prototype.splice.apply(n.getSettings().colHeaders,i));n.addHookOnce("afterRender",t);n.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)};Handsontable.hooks.add("afterInit",r);Handsontable.hooks.add("afterUpdateSettings",r)},{"./../../helpers.js":42}],70:[function(n,t,i){"use strict";function f(n,t){var i;u[n]=t;i=o.toUpperCaseFirst(n)+"Renderer";Handsontable.renderers[i]=t;Handsontable[i]=t}function e(n){if(typeof n=="function")return n;if(typeof n!="string")throw Error('Only strings and functions can be passed as "renderer" parameter');if(!(n in u))throw Error('No editor registered under name "'+n+'"');return u[n]}function s(n){return n in u}Object.defineProperties(i,{registerRenderer:{get:function(){return f}},getRenderer:{get:function(){return e}},hasRenderer:{get:function(){return s}},__esModule:{value:!0}});var r,o=(r=n("./helpers.js"),r&&r.__esModule&&r||{"default":r}),u={};Handsontable.renderers=Handsontable.renderers||{};Handsontable.renderers.registerRenderer=f;Handsontable.renderers.getRenderer=e},{"./helpers.js":42}],71:[function(n,t,i){"use strict";function e(n,t,i,r,u,e,o){o.className&&(t.className=t.className?t.className+" "+o.className:o.className);o.readOnly&&f.addClass(t,o.readOnlyCellClassName);o.valid===!1&&o.invalidCellClassName?f.addClass(t,o.invalidCellClassName):f.removeClass(t,o.invalidCellClassName);o.wordWrap===!1&&o.noWordWrapClassName&&f.addClass(t,o.noWordWrapClassName);!e&&o.placeholder&&f.addClass(t,o.placeholderCellClassName)}Object.defineProperties(i,{cellDecorator:{get:function(){return e}},__esModule:{value:!0}});var r,u,f=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),o=(u=n("./../renderers.js"),u&&u.__esModule&&u||{"default":u}).registerRenderer;o("base",e);Handsontable.renderers.cellDecorator=e},{"./../dom.js":27,"./../renderers.js":70}],72:[function(n,t,i){"use strict";function l(n,t,i,r,u,f,e){var y=c.cloneNode(!0),l=o.cloneNode(!0),h;v("text")(n,t,i,r,u,f,e);t.appendChild(l);s.addClass(t,"htAutocomplete");t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160)));n.acArrowListener||(h=a(n),n.acArrowListener=function(u){s.hasClass(u.target,"htAutocompleteArrow")&&n.view.wt.getSetting("onCellDblClick",null,new p(i,r),t)},h.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",function(){h.clear()}))}var o,w;Object.defineProperties(i,{autocompleteRenderer:{get:function(){return l}},__esModule:{value:!0}});var r,u,f,e,s=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),a=(u=n("./../eventManager.js"),u&&u.__esModule&&u||{"default":u}).eventManager,h=(f=n("./../renderers.js"),f&&f.__esModule&&f||{"default":f}),v=h.getRenderer,y=h.registerRenderer,p=(e=n("./../3rdparty/walkontable/src/cell/coords.js"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords,c=document.createElement("DIV");c.className="htAutocompleteWrapper";o=document.createElement("DIV");o.className="htAutocompleteArrow";o.appendChild(document.createTextNode(String.fromCharCode(9660)));w=function(n,t){t.innerHTML=n.innerHTML;s.empty(n);n.appendChild(t)};y("autocomplete",l)},{"./../3rdparty/walkontable/src/cell/coords.js":5,"./../dom.js":27,"./../eventManager.js":41,"./../renderers.js":70}],73:[function(n,t,i){"use strict";function a(n,t,i,u,f,e,o){function d(n){var t=[r.keyCode.SPACE,r.keyCode.ENTER,r.keyCode.DELETE,r.keyCode.BACKSPACE];s.enableImmediatePropagation(n);t.indexOf(n.keyCode)===-1||n.isImmediatePropagationStopped()||k(function(){n.stopImmediatePropagation();n.preventDefault()});(n.keyCode==r.keyCode.SPACE||n.keyCode==r.keyCode.ENTER)&&p();(n.keyCode==r.keyCode.DELETE||n.keyCode==r.keyCode.BACKSPACE)&&p(!1)}function p(){var n=arguments[0]!==void 0?arguments[0]:null;k(function(t){for(var i=0,r=t.length;i<r;i++){if(s.hasClass(t[i],l)&&n===null)return;g(t[i],n)}})}function g(n){var t=arguments[1]!==void 0?arguments[1]:null;n.checked=t===null?!n.checked:t;a.fireEvent(n,"change")}function k(t){for(var i,u=n.getSelectedRange(),f=u.getTopLeftCorner(),e=u.getBottomRightCorner(),r=f.row;r<=e.row;r++)for(i=f.col;i<=e.col;i++){var s=n.getCell(r,i),h=n.getCellMeta(r,i),o=s.querySelectorAll("input[type=checkbox]");o.length>0&&!h.readOnly&&t(o)}}var a=new y(n),h=w();typeof o.checkedTemplate=="undefined"&&(o.checkedTemplate=!0);typeof o.uncheckedTemplate=="undefined"&&(o.uncheckedTemplate=!1);s.empty(t);e===o.checkedTemplate||r.equalsIgnoreCase(e,o.checkedTemplate)?(h.checked=!0,t.appendChild(h)):e===o.uncheckedTemplate||r.equalsIgnoreCase(e,o.uncheckedTemplate)?t.appendChild(h):e===null?(s.addClass(h,"noValue"),t.appendChild(h)):(h.style.display="none",s.addClass(h,l),t.appendChild(h),t.appendChild(document.createTextNode("#bad-value#")));o.readOnly?a.addEventListener(h,"click",b):(a.addEventListener(h,"mousedown",v),a.addEventListener(h,"mouseup",v),a.addEventListener(h,"change",function(t){n.setDataAtRowProp(i,f,t.target.checked?o.checkedTemplate:o.uncheckedTemplate)}));c.has(n)||(c.set(n,!0),n.addHook("beforeKeyDown",d))}function w(){var n=document.createElement("INPUT");return n.className="htCheckboxRendererInput",n.type="checkbox",n.setAttribute("autocomplete","off"),n.cloneNode(!1)}function b(n){n.preventDefault()}function v(n){r.stopPropagation(n)}Object.defineProperties(i,{checkboxRenderer:{get:function(){return a}},__esModule:{value:!0}});var u,f,e,o,s=(u=n("./../dom.js"),u&&u.__esModule&&u||{"default":u}),r=(f=n("./../helpers.js"),f&&f.__esModule&&f||{"default":f}),y=(e=n("./../eventManager.js"),e&&e.__esModule&&e||{"default":e}).EventManager,h=(o=n("./../renderers.js"),o&&o.__esModule&&o||{"default":o}),k=h.getRenderer,p=h.registerRenderer,c=new WeakMap,l="htBadValue";p("checkbox",a)},{"./../dom.js":27,"./../eventManager.js":41,"./../helpers.js":42,"./../renderers.js":70}],74:[function(n,t,i){"use strict";function e(n,t,i,r,u,f){s("base").apply(this,arguments);o.fastInnerHTML(t,f)}Object.defineProperties(i,{htmlRenderer:{get:function(){return e}},__esModule:{value:!0}});var r,u,o=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),f=(u=n("./../renderers.js"),u&&u.__esModule&&u||{"default":u}),s=f.getRenderer,h=f.registerRenderer;h("html",e)},{"./../dom.js":27,"./../renderers.js":70}],75:[function(n,t,i){"use strict";function h(n,t,i,r,u,f,e){l.isNumeric(f)&&(typeof e.language!="undefined"&&o.language(e.language),f=o(f).format(e.format||"0"),c.addClass(t,"htNumeric"));a("text")(n,t,i,r,u,f,e)}Object.defineProperties(i,{numericRenderer:{get:function(){return h}},__esModule:{value:!0}});var r,u,f,e,c=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),l=(u=n("./../helpers.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("numeral"),f&&f.__esModule&&f||{"default":f}).default,s=(e=n("./../renderers.js"),e&&e.__esModule&&e||{"default":e}),a=s.getRenderer,v=s.registerRenderer;v("numeric",h)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70,numeral:"numeral"}],76:[function(n,t,i){"use strict";function e(n,t,i,r,u,f,e){s("text").apply(this,arguments);f=t.innerHTML;for(var l=e.hashLength||f.length,c=e.hashSymbol||"*",h="";h.split(c).length-1<l;h+=c);o.fastInnerHTML(t,h)}Object.defineProperties(i,{passwordRenderer:{get:function(){return e}},__esModule:{value:!0}});var r,u,o=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),f=(u=n("./../renderers.js"),u&&u.__esModule&&u||{"default":u}),s=f.getRenderer,h=f.registerRenderer;h("password",e)},{"./../dom.js":27,"./../renderers.js":70}],77:[function(n,t,i){"use strict";function s(n,t,i,r,u,f,o){var l,s;c("base").apply(this,arguments);!f&&o.placeholder&&(f=o.placeholder);l=h.stringify(f);n.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160)));o.rendererTemplate?(e.empty(t),s=document.createElement("TEMPLATE"),s.setAttribute("bind","{{}}"),s.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(s),s.model=n.getSourceDataAtRow(i),t.appendChild(s)):e.fastInnerText(t,l)}Object.defineProperties(i,{textRenderer:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e=(r=n("./../dom.js"),r&&r.__esModule&&r||{"default":r}),h=(u=n("./../helpers.js"),u&&u.__esModule&&u||{"default":u}),o=(f=n("./../renderers.js"),f&&f.__esModule&&f||{"default":f}),c=o.getRenderer,l=o.registerRenderer;l("text",s)},{"./../dom.js":27,"./../helpers.js":42,"./../renderers.js":70}],78:[function(){"use strict";Array.prototype.filter||(Array.prototype.filter=function(n,t){function e(n){return/NodeList/i.test(n.item)}function o(n){for(var i=[],t=0,r=n.length;t<r;t++)i[t]=n[t];return i}if(typeof this=="undefined"||this===null)throw new TypeError;if(typeof n!="function")throw new TypeError;t=t||this;e(t)&&(t=o(t));for(var f=t.length,u=[],r,i=0;i<f;i+=1)t.hasOwnProperty(i)&&(r=t[i],n.call(t,r,i,t)&&u.push(r));return u})},{}],79:[function(){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length>>>0,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1})},{}],80:[function(){"use strict";Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)=="[object Array]"})},{}],81:[function(n){"use strict";(function(n){function c(n){return{configurable:!0,enumerable:!1,value:n,writable:!0}}function f(){return"__$"+Math.floor(Math.random()*1e9)+"$"+ ++it+"$__"}function wt(n){return y[n]}function ut(){var n=f();return y[n]=!0,n}function p(n){return typeof n=="object"&&n instanceof u}function bt(n){return p(n)?"symbol":typeof n}function r(n){var t=new u(n);if(!(this instanceof r))return t;throw new TypeError("Symbol cannot be new'ed");}function u(n){var i=f();t(this,a,{value:this});t(this,e,{value:i});t(this,rt,{value:n});k(this);v[i]=this}function s(n){var i=n[ft];return i&&i.self===n?i:pt(n)?(b.hash.value=kt++,b.self.value=n,w.value=h(null,b),t(n,ft,w),w.value):undefined}function k(n){return s(n),lt.apply(this,arguments)}function dt(n){return s(n),vt.apply(this,arguments)}function gt(n){return s(n),yt.apply(this,arguments)}function d(n){return v[n]||y[n]}function g(n){return p(n)?n[e]:n}function et(n){for(var i=[],t=0;t<n.length;t++)d(n[t])||i.push(n[t]);return i}function ni(n){return et(o(n))}function ti(n){return et(tt(n))}function ii(n){for(var i,r=[],u=o(n),t=0;t<u.length;t++)i=v[u[t]],i&&r.push(i);return r}function ri(n,t){return nt(n,g(t))}function ui(n){return at.call(this,g(n))}function ot(t){return n.traceur&&n.traceur.options[t]}function fi(n,i,r){return p(i)&&(i=i[e]),t(n,i,r),n}function ei(n){t(n,"defineProperty",{value:fi});t(n,"getOwnPropertyNames",{value:ni});t(n,"getOwnPropertyDescriptor",{value:ri});t(n.prototype,"hasOwnProperty",{value:ui});t(n,"freeze",{value:k});t(n,"preventExtensions",{value:dt});t(n,"seal",{value:gt});t(n,"keys",{value:ti})}function oi(n){for(var u,r,f,i=1;i<arguments.length;i++)for(u=o(arguments[i]),r=0;r<u.length;r++)(f=u[r],d(f))||function(i,r){t(n,r,{get:function(){return i[r]},enumerable:!0})}(arguments[i],u[r]);return n}function si(n){return n!=null&&(typeof n=="object"||typeof n=="function")}function hi(n){if(n==null)throw ht();return i(n)}function ci(n){if(n==null)throw new TypeError("Value cannot be converted to an Object");return n}function li(n,t){n.Symbol||(n.Symbol=t,Object.getOwnPropertySymbols=ii);n.Symbol.iterator||(n.Symbol.iterator=t("Symbol.iterator"))}function st(n){li(n,r);n.Reflect=n.Reflect||{};n.Reflect.global=n.Reflect.global||n;ei(n.Object)}var l,it;if(!n.$traceurRuntime){var i=Object,ht=TypeError,h=i.create,ct=i.defineProperties,t=i.defineProperty,lt=i.freeze,nt=i.getOwnPropertyDescriptor,o=i.getOwnPropertyNames,tt=i.keys,at=i.prototype.hasOwnProperty,ai=i.prototype.toString,vt=Object.preventExtensions,yt=Object.seal,pt=Object.isExtensible;l=c;it=0;var e=f(),rt=f(),a=f(),v=h(null),y=h(null);t(r.prototype,"constructor",c(r));t(r.prototype,"toString",l(function(){var t=this[a],n;if(!ot("symbols"))return t[e];if(!t)throw TypeError("Conversion from symbol to string");return n=t[rt],n===undefined&&(n=""),"Symbol("+n+")"}));t(r.prototype,"valueOf",l(function(){var n=this[a];if(!n)throw TypeError("Conversion from symbol to string");return ot("symbols")?n:n[e]}));t(u.prototype,"constructor",c(r));t(u.prototype,"toString",{value:r.prototype.toString,enumerable:!1});t(u.prototype,"valueOf",{value:r.prototype.valueOf,enumerable:!1});var ft=ut(),w={value:undefined},b={hash:{value:undefined},self:{value:undefined}},kt=0;k(u.prototype);st(n);n.$traceurRuntime={checkObjectCoercible:ci,createPrivateName:ut,defineProperties:ct,defineProperty:t,exportStar:oi,getOwnHashObject:s,getOwnPropertyDescriptor:nt,getOwnPropertyNames:o,isObject:si,isPrivateName:wt,isSymbolString:d,keys:tt,setupGlobals:st,toObject:hi,toProperty:g,"typeof":bt}}})(window),function(){function i(i,r){function u(n){return n.slice(-1)==="/"}function f(n){return n[0]==="/"}function e(n){return n[0]==="."}if(t=t||typeof n!="undefined"&&n("path"),!u(r)&&!f(r))return e(r)?n(t.resolve(t.dirname(i),r)):n(r)}var t;$traceurRuntime.require=i}(),function(){function n(){for(var t,u,i=[],f=0,r,n=0;n<arguments.length;n++){if(t=$traceurRuntime.checkObjectCoercible(arguments[n]),typeof t[$traceurRuntime.toProperty(Symbol.iterator)]!="function")throw new TypeError("Cannot spread non-iterable object.");for(u=t[$traceurRuntime.toProperty(Symbol.iterator)]();!(r=u.next()).done;)i[f++]=r.value}return i}$traceurRuntime.spread=n}(),function(){function e(n,r){var u=i(n),f;do{if(f=t(u,r),f)return f;u=i(u)}while(u);return undefined}function y(n){return n.__proto__}function o(n,t,i,r){return s(n,t,i).apply(n,r)}function s(n,t,i){var r=e(t,i);return r?r.get?r.get.call(n):r.value:undefined}function p(t,i,r,u){var f=e(i,r);if(f&&f.set)return f.set.call(t,u),u;throw n("super has no setter '"+r+"'.");}function h(n){for(var u,f,e,r={},o=a(n),i=0;i<o.length;i++)u=o[i],r[u]=t(n,u);for(f=v(n),i=0;i<f.length;i++)e=f[i],r[$traceurRuntime.toProperty(e)]=t(n,$traceurRuntime.toProperty(e));return r}function w(n,t,i,r){return u(t,"constructor",{value:n,configurable:!0,enumerable:!1,writable:!0}),arguments.length>3?(typeof r=="function"&&(n.__proto__=r),n.prototype=c(b(r),h(t))):n.prototype=t,u(n,"prototype",{configurable:!1,writable:!1}),l(n,h(i))}function b(t){if(typeof t=="function"){var i=t.prototype;if(r(i)===i||i===null)return t.prototype;throw new n("super prototype must be an Object or null");}if(t===null)return null;throw new n("Super expression must either be null or a function, not "+typeof t+".");}function k(n,t,r){i(t)!==null&&o(n,t,"constructor",r)}var r=Object,n=TypeError,c=r.create,l=$traceurRuntime.defineProperties,u=$traceurRuntime.defineProperty,t=$traceurRuntime.getOwnPropertyDescriptor,d=$traceurRuntime.getOwnPropertyNames,i=Object.getPrototypeOf,f=Object,a=f.getOwnPropertyNames,v=f.getOwnPropertySymbols;$traceurRuntime.createClass=w;$traceurRuntime.defaultSuperCall=k;$traceurRuntime.superCall=o;$traceurRuntime.superConstructor=y;$traceurRuntime.superGet=s;$traceurRuntime.superSet=p}()},{path:undefined}],82:[function(){"use strict";Object.keys||(Object.keys=function(){var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(u){if(typeof u!="object"&&(typeof u!="function"||u===null))throw new TypeError("Object.keys called on non-object");var e=[],o,f;for(o in u)t.call(u,o)&&e.push(o);if(i)for(f=0;f<r;f++)t.call(u,n[f])&&e.push(n[f]);return e}}())},{}],83:[function(){"use strict";if(!String.prototype.trim){var n=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(n,"")}}},{}],84:[function(){"use strict";typeof WeakMap=="undefined"&&function(){var i=Object.defineProperty,n,r,t;try{n=!0;i(function(){},"foo",{})}catch(u){n=!1}r=+new Date%1e9;t=function(){this.name="__st"+(Math.random()*1e9>>>0)+(r+++"__");n||(this._wmCache=[])};t.prototype=n?{set:function(n,t){var r=n[this.name];r&&r[0]===n?r[1]=t:i(n,this.name,{value:[n,t],writable:!0})},get:function(n){var t;return(t=n[this.name])&&t[0]===n?t[1]:undefined},has:function(n){return this.get(n)?!0:!1},"delete":function(n){this.set(n,undefined)}}:{set:function(n,t){if(typeof n!="undefined"&&typeof t!="undefined"){for(var i=0,r=this._wmCache.length;i<r;i++)if(this._wmCache[i].key==n){this._wmCache[i].value=t;return}this._wmCache.push({key:n,value:t})}},get:function(n){if(typeof n!="undefined"){for(var t=0,i=this._wmCache.length;t<i;t++)if(this._wmCache[t].key==n)return this._wmCache[t].value;return void 0}},has:function(n){return this.get(n)?!0:!1},"delete":function(n){if(typeof n!="undefined")for(var t=0,i=this._wmCache.length;t<i;t++)this._wmCache[t].key==n&&Array.prototype.slice.call(this._wmCache,t,1)}};window.WeakMap=t}()},{}],85:[function(n,t,i){"use strict";function r(n){var t=this,e,r,f,s,i,o;this.eventManager=y(n);this.instance=n;this.settings=n.getSettings();e=n.rootElement.getAttribute("style");e&&n.rootElement.setAttribute("data-originalstyle",e);u.addClass(n.rootElement,"handsontable");r=document.createElement("TABLE");r.className="htCore";this.THEAD=document.createElement("THEAD");r.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");r.appendChild(this.TBODY);n.table=r;n.container.insertBefore(r,n.container.firstChild);this.eventManager.addEventListener(n.rootElement,"mousedown",function(n){t.isTextSelectionAllowed(n.target)||(s(),n.preventDefault(),window.focus())});this.eventManager.addEventListener(document.documentElement,"keyup",function(t){n.selection.isInProgress()&&!t.shiftKey&&n.selection.finish()});this.isMouseDown=function(){return f};this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){n.selection.isInProgress()&&t.which===1&&n.selection.finish();f=!1;l.isOutsideInput(document.activeElement)&&n.unlisten()});this.eventManager.addEventListener(document.documentElement,"mousedown",function(i){var r=i.target,e=i.x||i.clientX,o=i.y||i.clientY,u;if(!f){if(r!==n.view.wt.wtTable.holder)while(r!==document.documentElement){if(r===null){if(i.isTargetWebComponent)break;return}if(r===n.rootElement)return;r=r.parentNode}else if(u=Handsontable.Dom.getScrollbarWidth(),document.elementFromPoint(e+u,o)!==n.view.wt.wtTable.holder||document.elementFromPoint(e,o+u)!==n.view.wt.wtTable.holder)return;t.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}});this.eventManager.addEventListener(r,"selectstart",function(n){t.settings.fragmentSelection||n.preventDefault()});s=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()};i=[new a({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&!n.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!t.isCellEdited()&&!n.selection.isMultiple()}}}),new a({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return t.settings.fillHandle&&!t.isCellEdited()&&n.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!t.isCellEdited()&&n.selection.isMultiple()}}}),new a({className:"highlight",highlightRowClassName:t.settings.currentRowClassName,highlightColumnClassName:t.settings.currentColClassName}),new a({className:"fill",border:{width:1,color:"red"}})];i.current=i[0];i.area=i[1];i.highlight=i[2];i.fill=i[3];o={debug:function(){return t.settings.debug},table:r,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,fixedColumnsLeft:function(){return t.settings.fixedColumnsLeft},fixedRowsTop:function(){return t.settings.fixedRowsTop},renderAllRows:t.settings.renderAllRows,rowHeaders:function(){var i=[];return n.hasRowHeaders()&&i.push(function(n,i){t.appendRowHeader(n,i)}),Handsontable.hooks.run(n,"afterGetRowHeaderRenderers",i),i},columnHeaders:function(){var i=[];return n.hasColHeaders()&&i.push(function(n,i){t.appendColHeader(n,i)}),Handsontable.hooks.run(n,"afterGetColumnHeaderRenderers",i),i},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(n,i,r){var u=t.instance.colToProp(i),f=t.instance.getCellMeta(n,i),o=t.instance.getCellRenderer(f),e=t.instance.getDataAtRowProp(n,u);o(t.instance,r,n,i,u,e,f);Handsontable.hooks.run(t.instance,"afterRenderer",r,n,i,u,e,f)},selections:i,hideBorderOnMouseDownOver:function(){return t.settings.fragmentSelection},onCellMouseDown:function(i,r,e,o){n.listen();t.activeWt=o;f=!0;u.enableImmediatePropagation(i);Handsontable.hooks.run(n,"beforeOnCellMouseDown",i,r,e);i.isImmediatePropagationStopped()||(i.button===2&&n.selection.inInSelection(r)||(i.shiftKey?r.row>=0&&r.col>=0&&n.selection.setRangeEnd(r):(r.row<0||r.col<0)&&(r.row>=0||r.col>=0)?(r.row<0&&(n.selectCell(0,r.col,n.countRows()-1,r.col),n.selection.setSelectedHeaders(!1,!0)),r.col<0&&(n.selectCell(r.row,0,r.row,n.countCols()-1),n.selection.setSelectedHeaders(!0,!1))):(r.row=r.row<0?0:r.row,r.col=r.col<0?0:r.col,n.selection.setRangeStart(r))),Handsontable.hooks.run(n,"afterOnCellMouseDown",i,r,e),t.activeWt=t.wt)},onCellMouseOver:function(i,r,u,e){t.activeWt=e;r.row>=0&&r.col>=0?f&&n.selection.setRangeEnd(r):f&&(r.row<0&&(n.selection.setRangeEnd(new v(n.countRows()-1,r.col)),n.selection.setSelectedHeaders(!1,!0)),r.col<0&&(n.selection.setRangeEnd(new v(r.row,n.countCols()-1)),n.selection.setSelectedHeaders(!0,!1)));Handsontable.hooks.run(n,"afterOnCellMouseOver",i,r,u);t.activeWt=t.wt},onCellCornerMouseDown:function(t){t.preventDefault();Handsontable.hooks.run(n,"afterOnCellCornerMouseDown",t)},beforeDraw:function(n){t.beforeRender(n)},onDraw:function(n){t.onDraw(n)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,i){n.runHooks("beforeDrawBorders",t,i)},onBeforeTouchScroll:function(){n.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){n.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(i){t.settings.viewportRowRenderingOffset&&(i.startRow=Math.max(i.startRow-t.settings.viewportRowRenderingOffset,0),i.endRow=Math.min(i.endRow+t.settings.viewportRowRenderingOffset,n.countRows()-1));n.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:function(i){t.settings.viewportColumnRenderingOffset&&(i.startColumn=Math.max(i.startColumn-t.settings.viewportColumnRenderingOffset,0),i.endColumn=Math.min(i.endColumn+t.settings.viewportColumnRenderingOffset,n.countCols()-1));n.runHooks("afterViewportColumnCalculatorOverride",i)}};Handsontable.hooks.run(n,"beforeInitWalkontable",o);this.wt=new p(o);this.activeWt=this.wt;this.eventManager.addEventListener(t.wt.wtTable.spreader,"mousedown",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&l.stopPropagation(n)});this.eventManager.addEventListener(t.wt.wtTable.spreader,"contextmenu",function(n){n.target===t.wt.wtTable.spreader&&n.which===3&&l.stopPropagation(n)});this.eventManager.addEventListener(document.documentElement,"click",function(){t.settings.observeDOMVisibility&&t.wt.drawInterrupted&&(t.instance.forceFullRender=!0,t.render())})}Object.defineProperties(i,{TableView:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,s,h,c,u=(f=n("./dom.js"),f&&f.__esModule&&f||{"default":f}),l=(e=n("./helpers.js"),e&&e.__esModule&&e||{"default":e}),y=(o=n("./eventManager.js"),o&&o.__esModule&&o||{"default":o}).eventManager,v=(s=n("./3rdparty/walkontable/src/cell/coords.js"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords,a=(h=n("./3rdparty/walkontable/src/selection.js"),h&&h.__esModule&&h||{"default":h}).WalkontableSelection,p=(c=n("./3rdparty/walkontable/src/core.js"),c&&c.__esModule&&c||{"default":c}).Walkontable;Handsontable.TableView=r;r.prototype.isTextSelectionAllowed=function(n){return l.isInput(n)?!0:this.settings.fragmentSelection&&u.isChildOf(n,this.TBODY)?!0:!1};r.prototype.isCellEdited=function(){var n=this.instance.getActiveEditor();return n&&n.isOpened()};r.prototype.beforeRender=function(n){n&&Handsontable.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)};r.prototype.onDraw=function(n){n&&Handsontable.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)};r.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=!1};r.prototype.getCellAtCoords=function(n,t){var i=this.wt.getCell(n,t);return i<0?null:i};r.prototype.scrollViewport=function(n){this.wt.scrollViewport(n)};r.prototype.appendRowHeader=function(n,t){var f,i,r;if(t.firstChild){if(f=t.firstChild,!u.hasClass(f,"relative")){u.empty(t);this.appendRowHeader(n,t);return}this.updateCellHeader(f.firstChild,n,this.instance.getRowHeader)}else i=document.createElement("div"),r=document.createElement("span"),i.className="relative",r.className="colHeader",this.updateCellHeader(r,n,this.instance.getRowHeader),i.appendChild(r),t.appendChild(i);Handsontable.hooks.run(this.instance,"afterGetRowHeader",n,t)};r.prototype.appendColHeader=function(n,t){var f,i,r;if(t.firstChild){if(f=t.firstChild,!u.hasClass(f,"relative")){u.empty(t);this.appendRowHeader(n,t);return}this.updateCellHeader(f.firstChild,n,this.instance.getColHeader)}else i=document.createElement("div"),r=document.createElement("span"),i.className="relative",r.className="colHeader",this.updateCellHeader(r,n,this.instance.getColHeader),i.appendChild(r),t.appendChild(i);Handsontable.hooks.run(this.instance,"afterGetColHeader",n,t)};r.prototype.updateCellHeader=function(n,t,i){t>-1?u.fastInnerHTML(n,i(t)):(u.fastInnerText(n,String.fromCharCode(160)),u.addClass(n,"cornerHeader"))};r.prototype.maximumVisibleElementWidth=function(n){var i=this.wt.wtViewport.getWorkspaceWidth(),t=i-n;return t>0?t:0};r.prototype.maximumVisibleElementHeight=function(n){var i=this.wt.wtViewport.getWorkspaceHeight(),t=i-n;return t>0?t:0};r.prototype.mainViewIsActive=function(){return this.wt===this.activeWt};r.prototype.destroy=function(){this.wt.destroy();this.eventManager.clear()}},{"./3rdparty/walkontable/src/cell/coords.js":5,"./3rdparty/walkontable/src/core.js":7,"./3rdparty/walkontable/src/selection.js":18,"./dom.js":27,"./eventManager.js":41,"./helpers.js":42}],86:[function(){"use strict";var n=function(n,t){var i=n,r=typeof i=="string"?i.toLowerCase():null;return function(n){for(var f=!1,u=0,e=n.length;u<e;u++)if(i===n[u]){f=!0;break}else if(r===Handsontable.helper.stringify(n[u]).toLowerCase()){f=!0;break}t(f)}};Handsontable.AutocompleteValidator=function(t,i){this.strict&&this.source?typeof this.source=="function"?this.source(t,n(t,i)):n(t,i)(this.source):i(!0)}},{}],87:[function(n){"use strict";var t,i,r=(t=n("moment"),t&&t.__esModule&&t||{"default":t}).default,f=(i=n("./../editors.js"),i&&i.__esModule&&i||{"default":i}).getEditor,u;Handsontable.DateValidator=function(n,t){var i=!0,h=f("date",this.instance),e,o,s;n===null&&(n="");e=r(new Date(n)).isValid();o=r(n,this.dateFormat||h.defaultDateFormat,!0).isValid();e||(i=!1);!e&&o&&(i=!0);e&&!o&&(this.correctFormat===!0?(s=u(n,this.dateFormat),this.instance.setDataAtCell(this.row,this.col,s,"dateValidator"),i=!0):i=!1);t(i)};u=function(n,t){var i=r(new Date(n));return i.format("YYYY").length>4&&i.year((i.year()+"").substr(0,4)),i.format(t)}},{"./../editors.js":29,moment:"moment"}],88:[function(){"use strict";Handsontable.NumericValidator=function(n,t){n===null&&(n="");t(/^-?\d*(\.|\,)?\d*$/.test(n))}},{}],SheetClip:[function(n,t,i){"use strict";(function(n){function r(n){return n.split('"').length-1}var t={parse:function(n){var i,c,t,u=[],f=0,e,h,o,s;for(t=n.split("\n"),t.length>1&&t[t.length-1]===""&&t.pop(),i=0,c=t.length;i<c;i+=1){for(t[i]=t[i].split("\t"),e=0,h=t[i].length;e<h;e+=1)u[f]||(u[f]=[]),o&&e===0?(s=u[f].length-1,u[f][s]=u[f][s]+"\n"+t[i][0],o&&r(t[i][0])&1&&(o=!1,u[f][s]=u[f][s].substring(0,u[f][s].length-1).replace(/""/g,'"'))):e===h-1&&t[i][e].indexOf('"')===0&&r(t[i][e])&1?(u[f].push(t[i][e].substring(1).replace(/""/g,'"')),o=!0):(u[f].push(t[i][e].replace(/""/g,'"')),o=!1);o||(f+=1)}return u},stringify:function(n){for(var r,e,u="",t,i=0,f=n.length;i<f;i+=1){for(e=n[i].length,r=0;r<e;r+=1)r>0&&(u+="\t"),t=n[i][r],u+=typeof t=="string"?t.indexOf("\n")>-1?'"'+t.replace(/"/g,'""')+'"':t:t===null||t===void 0?"":t;u+="\n"}return u}};typeof i!="undefined"?(i.parse=t.parse,i.stringify=t.stringify):n.SheetClip=t})(window)},{}],autoResize:[function(n,t,i){"use strict";function r(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n,s=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),u=function(n,t,i){window.attachEvent?n.attachEvent("on"+t,i):n.addEventListener(t,i,!1)},f=function(n,t,i){window.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)},e=function(r){var u,f;r?/^[a-zA-Z \.,\\\/\|0-9]$/.test(r)||(r="."):r="";o.textContent!==void 0?o.textContent=n.value+r:o.data=n.value+r;i.style.fontSize=Handsontable.Dom.getComputedStyle(n).fontSize;i.style.fontFamily=Handsontable.Dom.getComputedStyle(n).fontFamily;i.style.whiteSpace="pre";s.appendChild(i);u=i.clientWidth+2;s.removeChild(i);n.style.height=t.minHeight+"px";n.style.width=t.minWidth>u?t.minWidth+"px":u>t.maxWidth?t.maxWidth+"px":u+"px";f=n.scrollHeight?n.scrollHeight-1:0;t.minHeight>f?n.style.height=t.minHeight+"px":t.maxHeight<f?(n.style.height=t.maxHeight+"px",n.style.overflowY="visible"):n.style.height=f+"px"},r=function(){window.setTimeout(e,0)},h=function(r){var u,f,e,s;r&&r.minHeight&&(r.minHeight=="inherit"?t.minHeight=n.clientHeight:(u=parseInt(r.minHeight),isNaN(u)||(t.minHeight=u)));r&&r.maxHeight&&(r.maxHeight=="inherit"?t.maxHeight=n.clientHeight:(f=parseInt(r.maxHeight),isNaN(f)||(t.maxHeight=f)));r&&r.minWidth&&(r.minWidth=="inherit"?t.minWidth=n.clientWidth:(e=parseInt(r.minWidth),isNaN(e)||(t.minWidth=e)));r&&r.maxWidth&&(r.maxWidth=="inherit"?t.maxWidth=n.clientWidth:(s=parseInt(r.maxWidth),isNaN(s)||(t.maxWidth=s)));i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))},c=function(i,f,o){n=i;h(f);n.nodeName=="TEXTAREA"&&(n.style.resize="none",n.style.overflowY="",n.style.height=t.minHeight+"px",n.style.minWidth=t.minWidth+"px",n.style.maxWidth=t.maxWidth+"px",n.style.overflowY="hidden");o&&(u(n,"change",e),u(n,"cut",r),u(n,"paste",r),u(n,"drop",r),u(n,"keydown",r));e()};return{init:function(n,t,i){c(n,t,i)},unObserve:function(){f(n,"change",e);f(n,"cut",r);f(n,"paste",r);f(n,"drop",r);f(n,"keydown",r)},resize:e}}typeof i!="undefined"&&(t.exports=r)},{}],copyPaste:[function(n,t,i){"use strict";function f(){return u?u.hasBeenDestroyed()&&u.init():u=new r,u.refCounter++,u}function r(){this.refCounter=0;this.init()}var u;typeof i!="undefined"&&(t.exports=f);r.prototype.init=function(){var n,t;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];t=document.body;document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",n=this.elDiv.style,n.position="fixed",n.top="-10000px",n.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(n){var t,i;if("WebkitAppearance"in document.documentElement.style)return t=n.clipboardData.getData("Text"),navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&(i=t.split("\n"),i.pop(),t=i.join("\n")),this.value=t,!1},n=this.elTextarea.style,n.width="10000px",n.height="10000px",n.overflow="hidden",this.elDiv.appendChild(this.elTextarea),typeof n.opacity!="undefined"&&(n.opacity=0));this.onKeyDownRef=this.onKeyDown.bind(this);document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)};r.prototype.onKeyDown=function(n){function r(){var n=document.activeElement;return n.shadowRoot&&n.shadowRoot.activeElement&&(n=n.shadowRoot.activeElement),["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true"}var t=this,i=!1;if(n.metaKey?i=!0:n.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1&&(i=!0),i){if(document.activeElement!==this.elTextarea&&(this.getSelectionText()!==""||r()))return;this.selectNodeText(this.elTextarea);setTimeout(function(){document.activeElement!==t.elTextarea&&t.selectNodeText(t.elTextarea)},0)}i&&(n.keyCode===67||n.keyCode===86||n.keyCode===88)&&(n.keyCode===88?setTimeout(function(){t.triggerCut(n)},0):n.keyCode===86&&setTimeout(function(){t.triggerPaste(n)},0))};r.prototype.selectNodeText=function(n){n&&n.select()};r.prototype.getSelectionText=function(){var n="";return window.getSelection?n=window.getSelection().toString():document.selection&&document.selection.type!=="Control"&&(n=document.selection.createRange().text),n};r.prototype.copyable=function(n){if(typeof n!="string"&&n.toString===void 0)throw new Error("copyable requires string parameter");this.elTextarea.value=n;this.selectNodeText(this.elTextarea)};r.prototype.onCut=function(n){this.cutCallbacks.push(n)};r.prototype.onPaste=function(n){this.pasteCallbacks.push(n)};r.prototype.removeCallback=function(n){for(var t=0,i=this.copyCallbacks.length;t<i;t++)if(this.copyCallbacks[t]===n)return this.copyCallbacks.splice(t,1),!0;for(t=0,i=this.cutCallbacks.length;t<i;t++)if(this.cutCallbacks[t]===n)return this.cutCallbacks.splice(t,1),!0;for(t=0,i=this.pasteCallbacks.length;t<i;t++)if(this.pasteCallbacks[t]===n)return this.pasteCallbacks.splice(t,1),!0;return!1};r.prototype.triggerCut=function(n){var t=this;t.cutCallbacks&&setTimeout(function(){for(var i=0,r=t.cutCallbacks.length;i<r;i++)t.cutCallbacks[i](n)},50)};r.prototype.triggerPaste=function(n,t){var i=this;i.pasteCallbacks&&setTimeout(function(){for(var u=t||i.elTextarea.value,r=0,f=i.pasteCallbacks.length;r<f;r++)i.pasteCallbacks[r](u,n)},50)};r.prototype.destroy=function(){this.hasBeenDestroyed()||--this.refCounter!=0||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef))};r.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],jsonpatch:[function(n,t,i){"use strict";var r;(function(n){function t(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function c(n,i){var u;for(var r in n)if(n.hasOwnProperty(r)){if(n[r]===i)return t(r)+"/";if(typeof n[r]=="object"&&(u=c(n[r],i),u!=""))return t(r)+"/"+u}return""}function b(n,t){if(n===t)return"/";var i=c(n,t);if(i==="")throw new Error("Object not found in root");return"/"+i}function v(n){for(var t=0,r=i.length;t<r;t++)if(i[t].obj===n)return i[t]}function k(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].callback===t)return n.observers[i].observer}function d(n,t){for(var i=0,r=n.observers.length;i<r;i++)if(n.observers[i].observer===t){n.observers.splice(i,1);return}}function g(n,t){o(t);Object.observe?e(t,n):clearTimeout(t.next);var i=v(n);d(i,t)}function nt(n,t){var u=[],nt=n,r,s=v(n);if(s?r=k(s,t):(s=new l(n),i.push(s)),r)return r;if(Object.observe)r=function(i){var o,c,s;for(e(r,n),f(r,n),o=0,c=i.length;o<c;){if(!(i[o].name==="length"&&h(i[o].object))&&!(i[o].name==="__Jasmine_been_here_before__")){s=i[o].type;switch(s){case"new":s="add";break;case"deleted":s="delete";break;case"updated":s="update"}w[s].call(i[o],u,b(nt,i[o].object))}o++}u&&t&&t(u);r.patches=u;u=[]};else if(r={},s.value=JSON.parse(JSON.stringify(n)),t){r.callback=t;r.next=null;var p=this.intervals||[100,1e3,1e4,6e4],c=0,g=function(){o(r)},y=function(){clearTimeout(r.next);r.next=setTimeout(function(){g();c=0;r.next=setTimeout(d,p[c++])},0)},d=function(){g();c==p.length&&(c=p.length-1);r.next=setTimeout(d,p[c++])};typeof window!="undefined"&&(window.addEventListener?(window.addEventListener("mousedown",y),window.addEventListener("mouseup",y),window.addEventListener("keydown",y)):(window.attachEvent("onmousedown",y),window.attachEvent("onmouseup",y),window.attachEvent("onkeydown",y)));r.next=setTimeout(d,p[c++])}return r.patches=u,r.object=n,s.observers.push(new a(t,r)),f(r,n)}function f(n,t){var r,i;if(Object.observe){Object.observe(t,n);for(r in t)t.hasOwnProperty(r)&&(i=t[r],i&&typeof i=="object"&&f(n,i))}return n}function e(n,t){var r,i;if(Object.observe){Object.unobserve(t,n);for(r in t)t.hasOwnProperty(r)&&(i=t[r],i&&typeof i=="object"&&e(n,i))}return n}function o(n){var u,t,f,r;if(Object.observe)Object.deliverChangeRecords(n);else{for(t=0,f=i.length;t<f;t++)if(i[t].obj===n.object){u=i[t];break}y(u.value,n.object,n.patches,"")}return r=n.patches,r.length>0&&(n.patches=[],n.callback&&n.callback(r)),r}function y(n,i,r,u){for(var h,o,f,c=s(i),l=s(n),v=!1,a=!1,e=l.length-1;e>=0;e--)f=l[e],h=n[f],i.hasOwnProperty(f)?(o=i[f],h instanceof Object?y(h,o,r,u+"/"+t(f)):h!=o&&(v=!0,r.push({op:"replace",path:u+"/"+t(f),value:o}),n[f]=o)):(r.push({op:"remove",path:u+"/"+t(f)}),delete n[f],a=!0);if(a||c.length!=l.length)for(e=0;e<c.length;e++)f=c[e],n.hasOwnProperty(f)||(r.push({op:"add",path:u+"/"+t(f),value:i[f]}),n[f]=JSON.parse(JSON.stringify(i[f])))}function r(n,t){for(var o=!1,s=0,v=t.length,r,l,e;s<v;){r=t[s];for(var c=r.path.split("/"),i=n,f=1,a=c.length;;)if(h(i)){if(l=parseInt(c[f],10),f++,f>=a){o=p[r.op].call(r,i,l,n);break}i=i[l]}else{if(e=c[f],e.indexOf("~")!=-1&&(e=e.replace(/~1/g,"/").replace(/~0/g,"~")),f++,f>=a){o=u[r.op].call(r,i,e,n);break}i=i[e]}s++}return o}var u={add:function(n,t){return n[t]=this.value,!0},remove:function(n,t){return delete n[t],!0},replace:function(n,t){return n[t]=this.value,!0},move:function(n,t,i){var u={op:"_get",path:this.from};return r(i,[u]),r(i,[{op:"remove",path:this.from}]),r(i,[{op:"add",path:this.path,value:u.value}]),!0},copy:function(n,t,i){var u={op:"_get",path:this.from};return r(i,[u]),r(i,[{op:"add",path:this.path,value:u.value}]),!0},test:function(n,t){return JSON.stringify(n[t])===JSON.stringify(this.value)},_get:function(n,t){this.value=n[t]}},p={add:function(n,t){return n.splice(t,0,this.value),!0},remove:function(n,t){return n.splice(t,1),!0},replace:function(n,t){return n[t]=this.value,!0},move:u.move,copy:u.copy,test:u.test,_get:u._get},w={add:function(n,i){var r={op:"add",path:i+t(this.name),value:this.object[this.name]};n.push(r)},"delete":function(n,i){var r={op:"remove",path:i+t(this.name)};n.push(r)},update:function(n,i){var r={op:"replace",path:i+t(this.name),value:this.object[this.name]};n.push(r)}},i=[],l,a,s,h;n.intervals;l=function(){function n(n){this.observers=[];this.obj=n}return n}();a=function(){function n(n,t){this.callback=n;this.observer=t}return n}();n.unobserve=g;n.observe=nt;n.generate=o;s=Object.keys?Object.keys:function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t};h=Array.isArray?Array.isArray:function(n){return n.push&&typeof n.length=="number"};n.apply=r})(r||(r={}));typeof i!="undefined"&&(i.apply=r.apply,i.observe=r.observe,i.unobserve=r.unobserve,i.generate=r.generate)},{}],moment:[function(t,i,r){
//! moment.js
//! version : 2.10.3
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(t,u){typeof r=="object"&&typeof i!="undefined"?i.exports=u():typeof n=="function"&&n.amd?n(u):t.moment=u()})(this,function(){"use strict";function u(){return iu.apply(null,arguments)}function eo(n){iu=n}function ei(n){return Object.prototype.toString.call(n)==="[object Array]"}function oi(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function oo(n,t){for(var r=[],i=0;i<n.length;++i)r.push(t(n[i],i));return r}function et(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function si(n,t){for(var i in t)et(t,i)&&(n[i]=t[i]);return et(t,"toString")&&(n.toString=t.toString),et(t,"valueOf")&&(n.valueOf=t.valueOf),n}function gt(n,t,i,r){return of(n,t,i,r,!0).utc()}function so(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function h(n){return n._pf==null&&(n._pf=so()),n._pf}function ru(n){if(n._isValid==null){var t=h(n);n._isValid=!isNaN(n._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated;n._strict&&(n._isValid=n._isValid&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined)}return n._isValid}function uu(n){var t=gt(NaN);return n!=null?si(h(t),n):h(t).userInvalidated=!0,t}function fu(n,t){var u,i,r;if(typeof t._isAMomentObject!="undefined"&&(n._isAMomentObject=t._isAMomentObject),typeof t._i!="undefined"&&(n._i=t._i),typeof t._f!="undefined"&&(n._f=t._f),typeof t._l!="undefined"&&(n._l=t._l),typeof t._strict!="undefined"&&(n._strict=t._strict),typeof t._tzm!="undefined"&&(n._tzm=t._tzm),typeof t._isUTC!="undefined"&&(n._isUTC=t._isUTC),typeof t._offset!="undefined"&&(n._offset=t._offset),typeof t._pf!="undefined"&&(n._pf=h(t)),typeof t._locale!="undefined"&&(n._locale=t._locale),gi.length>0)for(u in gi)i=gi[u],r=t[i],typeof r!="undefined"&&(n[i]=r);return n}function ni(n){fu(this,n);this._d=new Date(+n._d);nr===!1&&(nr=!0,u.updateOffset(this),nr=!1)}function rt(n){return n instanceof ni||n!=null&&n._isAMomentObject!=null}function c(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function eu(n,t,i){for(var f=Math.min(n.length,t.length),e=Math.abs(n.length-t.length),u=0,r=0;r<f;r++)(i&&n[r]!==t[r]||!i&&c(n[r])!==c(t[r]))&&u++;return u+e}function ou(){}function su(n){return n?n.toLowerCase().replace("_","-"):n}function ho(n){for(var r=0,i,t,f,u;r<n.length;){for(u=su(n[r]).split("-"),i=u.length,t=su(n[r+1]),t=t?t.split("-"):null;i>0;){if(f=hu(u.slice(0,i).join("-")),f)return f;if(t&&t.length>=i&&eu(u,t,!0)>=i-1)break;i--}r++}return null}function hu(n){var r=null;if(!ot[n]&&typeof i!="undefined"&&i&&i.exports)try{r=hi._abbr;t("./locale/"+n);ti(r)}catch(u){}return ot[n]}function ti(n,t){var i;return n&&(i=typeof t=="undefined"?st(n):cu(n,t),i&&(hi=i)),hi._abbr}function cu(n,t){return t!==null?(t.abbr=n,ot[n]||(ot[n]=new ou),ot[n].set(t),ti(n),ot[n]):(delete ot[n],null)}function st(n){var t;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return hi;if(!ei(n)){if(t=hu(n),t)return t;n=[n]}return ho(n)}function v(n,t){var i=n.toLowerCase();ii[i]=ii[i+"s"]=ii[t]=n}function w(n){return typeof n=="string"?ii[n]||ii[n.toLowerCase()]:undefined}function lu(n){var r={},t;for(var i in n)et(n,i)&&(t=w(i),t&&(r[t]=n[i]));return r}function bt(n,t){return function(i){return i!=null?(au(this,n,i),u.updateOffset(this,t),this):ci(this,n)}}function ci(n,t){return n._d["get"+(n._isUTC?"UTC":"")+t]()}function au(n,t,i){return n._d["set"+(n._isUTC?"UTC":"")+t](i)}function vu(n,t){var i;if(typeof n=="object")for(i in n)this.set(i,n[i]);else if(n=w(n),typeof this[n]=="function")return this[n](t);return this}function tr(n,t,i){for(var r=""+Math.abs(n),u=n>=0;r.length<t;)r="0"+r;return(u?i?"+":"":"-")+r}function e(n,t,i,r){var u=r;typeof r=="string"&&(u=function(){return this[r]()});n&&(kt[n]=u);t&&(kt[t[0]]=function(){return tr(u.apply(this,arguments),t[1],t[2])});i&&(kt[i]=function(){return this.localeData().ordinal(u.apply(this,arguments),n)})}function co(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function lo(n){for(var i=n.match(yu),t=0,r=i.length;t<r;t++)i[t]=kt[i[t]]?kt[i[t]]:co(i[t]);return function(u){var f="";for(t=0;t<r;t++)f+=i[t]instanceof Function?i[t].call(u,n):i[t];return f}}function rr(n,t){return n.isValid()?(t=pu(t,n.localeData()),ir[t]||(ir[t]=lo(t)),ir[t](n)):n.localeData().invalidDate()}function pu(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(li.lastIndex=0;i>=0&&li.test(n);)n=n.replace(li,r),li.lastIndex=0,i-=1;return n}function r(n,t,i){er[n]=typeof t=="function"?t:function(n){return n&&i?i:t}}function ao(n,t){return et(er,n)?er[n](t._strict,t._locale):new RegExp(vo(n))}function vo(n){return n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(n,t){var i,r=t;for(typeof n=="string"&&(n=[n]),typeof t=="number"&&(r=function(n,i){i[t]=c(n)}),i=0;i<n.length;i++)or[n[i]]=r}function ui(n,t){a(n,function(n,i,r,u){r._w=r._w||{};t(n,r._w,r,u)})}function yo(n,t,i){t!=null&&et(or,n)&&or[n](t,i._a,i,n)}function sr(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function po(n){return this._months[n.month()]}function wo(n){return this._monthsShort[n.month()]}function bo(n,t,i){var r,u,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++)if((u=gt([2e3,r]),i&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(u,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(u,"").replace(".","")+"$","i")),i||this._monthsParse[r]||(f="^"+this.months(u,"")+"|^"+this.monthsShort(u,""),this._monthsParse[r]=new RegExp(f.replace(".",""),"i")),i&&t==="MMMM"&&this._longMonthsParse[r].test(n))||i&&t==="MMM"&&this._shortMonthsParse[r].test(n)||!i&&this._monthsParse[r].test(n))return r}function gu(n,t){var i;return typeof t=="string"&&(t=n.localeData().monthsParse(t),typeof t!="number")?n:(i=Math.min(n.date(),sr(n.year(),t)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](t,i),n)}function nf(n){return n!=null?(gu(this,n),u.updateOffset(this,!0),this):ci(this,"Month")}function ko(){return sr(this.year(),this.month())}function hr(n){var i,t=n._a;return t&&h(n).overflow===-2&&(i=t[tt]<0||t[tt]>11?tt:t[k]<1||t[k]>sr(t[nt],t[tt])?k:t[y]<0||t[y]>24||t[y]===24&&(t[ht]!==0||t[ct]!==0||t[lt]!==0)?y:t[ht]<0||t[ht]>59?ht:t[ct]<0||t[ct]>59?ct:t[lt]<0||t[lt]>999?lt:-1,h(n)._overflowDayOfYear&&(i<nt||i>k)&&(i=k),h(n).overflow=i),n}function tf(n){u.suppressDeprecationWarnings===!1&&typeof console!="undefined"&&console.warn&&console.warn("Deprecation warning: "+n)}function b(n,t){var i=!0,r=n+"\n"+(new Error).stack;return si(function(){return i&&(tf(r),i=!1),t.apply(this,arguments)},t)}function go(n,t){cr[n]||(tf(t),cr[n]=!0)}function rf(n){var t,i,r=n._i,u=ns.exec(r);if(u){for(h(n).iso=!0,t=0,i=lr.length;t<i;t++)if(lr[t][1].exec(r)){n._f=lr[t][0]+(u[6]||" ");break}for(t=0,i=ar.length;t<i;t++)if(ar[t][1].exec(r)){n._f+=ar[t][0];break}r.match(wi)&&(n._f+="Z");wr(n)}else n._isValid=!1}function is(n){var t=ts.exec(n._i);if(t!==null){n._d=new Date(+t[1]);return}rf(n);n._isValid===!1&&(delete n._isValid,u.createFromInputFallback(n))}function rs(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<1970&&o.setFullYear(n),o}function vr(n){var t=new Date(Date.UTC.apply(null,arguments));return n<1970&&t.setUTCFullYear(n),t}function uf(n){return ff(n)?366:365}function ff(n){return n%4==0&&n%100!=0||n%400==0}function us(){return ff(this.year())}function at(n,t,i){var f=i-t,r=i-n.day(),u;return r>f&&(r-=7),r<f-7&&(r+=7),u=s(n).add(r,"d"),{week:Math.ceil(u.dayOfYear()/7),year:u.year()}}function fs(n){return at(n,this._week.dow,this._week.doy).week}function es(){return this._week.dow}function os(){return this._week.doy}function ss(n){var t=this.localeData().week(this);return n==null?t:this.add((n-t)*7,"d")}function hs(n){var t=at(this,1,4).week;return n==null?t:this.add((n-t)*7,"d")}function cs(n,t,i,r,u){var f=vr(n,0,1).getUTCDay(),o,e;return f=f===0?7:f,i=i!=null?i:u,o=u-f+(f>r?7:0)-(f<u?7:0),e=7*(t-1)+(i-u)+o+1,{year:e>0?n:n-1,dayOfYear:e>0?e:uf(n-1)+e}}function ls(n){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?t:this.add(n-t,"d")}function dt(n,t,i){return n!=null?n:t!=null?t:i}function as(n){var t=new Date;return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function pr(n){var t,i,r=[],u,f;if(!n._d){for(u=as(n),n._w&&n._a[k]==null&&n._a[tt]==null&&vs(n),n._dayOfYear&&(f=dt(n._a[nt],u[nt]),n._dayOfYear>uf(f)&&(h(n)._overflowDayOfYear=!0),i=vr(f,0,n._dayOfYear),n._a[tt]=i.getUTCMonth(),n._a[k]=i.getUTCDate()),t=0;t<3&&n._a[t]==null;++t)n._a[t]=r[t]=u[t];for(;t<7;t++)n._a[t]=r[t]=n._a[t]==null?t===2?1:0:n._a[t];n._a[y]===24&&n._a[ht]===0&&n._a[ct]===0&&n._a[lt]===0&&(n._nextDay=!0,n._a[y]=0);n._d=(n._useUTC?vr:rs).apply(null,r);n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm);n._nextDay&&(n._a[y]=24)}}function vs(n){var t,e,u,r,i,f,o;t=n._w;t.GG!=null||t.W!=null||t.E!=null?(i=1,f=4,e=dt(t.GG,n._a[nt],at(s(),1,4).year),u=dt(t.W,1),r=dt(t.E,1)):(i=n._locale._week.dow,f=n._locale._week.doy,e=dt(t.gg,n._a[nt],at(s(),i,f).year),u=dt(t.w,1),t.d!=null?(r=t.d,r<i&&++u):r=t.e!=null?t.e+i:i);o=cs(e,u,r,f,i);n._a[nt]=o.year;n._dayOfYear=o.dayOfYear}function wr(n){if(n._f===u.ISO_8601){rf(n);return}n._a=[];h(n).empty=!0;for(var t=""+n._i,i,r,o,c=t.length,s=0,e=pu(n._f,n._locale).match(yu)||[],f=0;f<e.length;f++)r=e[f],i=(t.match(ao(r,n))||[])[0],i&&(o=t.substr(0,t.indexOf(i)),o.length>0&&h(n).unusedInput.push(o),t=t.slice(t.indexOf(i)+i.length),s+=i.length),kt[r]?(i?h(n).empty=!1:h(n).unusedTokens.push(r),yo(r,i,n)):n._strict&&!i&&h(n).unusedTokens.push(r);h(n).charsLeftOver=c-s;t.length>0&&h(n).unusedInput.push(t);h(n).bigHour===!0&&n._a[y]<=12&&n._a[y]>0&&(h(n).bigHour=undefined);n._a[y]=ys(n._locale,n._a[y],n._meridiem);pr(n);hr(n)}function ys(n,t,i){var r;return i==null?t:n.meridiemHour!=null?n.meridiemHour(t,i):n.isPM!=null?(r=n.isPM(i),r&&t<12&&(t+=12),r||t!==12||(t=0),t):t}function ps(n){var t,f,u,r,i;if(n._f.length===0){h(n).invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=fu({},n),n._useUTC!=null&&(t._useUTC=n._useUTC),t._f=n._f[r],wr(t),ru(t))&&(i+=h(t).charsLeftOver,i+=h(t).unusedTokens.length*10,h(t).score=i,(u==null||i<u)&&(u=i,f=t));si(n,f||t)}function ws(n){if(!n._d){var t=lu(n._i);n._a=[t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond];pr(n)}}function bs(n){var t=n._i,r=n._f,i;return(n._locale=n._locale||st(n._l),t===null||r===undefined&&t==="")?uu({nullInput:!0}):(typeof t=="string"&&(n._i=t=n._locale.preparse(t)),rt(t))?new ni(hr(t)):(ei(r)?ps(n):r?wr(n):oi(t)?n._d=t:ks(n),i=new ni(hr(n)),i._nextDay&&(i.add(1,"d"),i._nextDay=undefined),i)}function ks(n){var t=n._i;t===undefined?n._d=new Date:oi(t)?n._d=new Date(+t):typeof t=="string"?is(n):ei(t)?(n._a=oo(t.slice(0),function(n){return parseInt(n,10)}),pr(n)):typeof t=="object"?ws(n):typeof t=="number"?n._d=new Date(t):u.createFromInputFallback(n)}function of(n,t,i,r,u){var f={};return typeof i=="boolean"&&(r=i,i=undefined),f._isAMomentObject=!0,f._useUTC=f._isUTC=u,f._l=i,f._i=n,f._f=t,f._strict=r,bs(f)}function s(n,t,i,r){return of(n,t,i,r,!1)}function cf(n,t){var r,i;if(t.length===1&&ei(t[0])&&(t=t[0]),!t.length)return s();for(r=t[0],i=1;i<t.length;++i)t[i][n](r)&&(r=t[i]);return r}function ds(){var n=[].slice.call(arguments,0);return cf("isBefore",n)}function gs(){var n=[].slice.call(arguments,0);return cf("isAfter",n)}function bi(n){var t=lu(n),i=t.year||0,r=t.quarter||0,u=t.month||0,f=t.week||0,e=t.day||0,o=t.hour||0,s=t.minute||0,h=t.second||0,c=t.millisecond||0;this._milliseconds=+c+h*1e3+s*6e4+o*36e5;this._days=+e+f*7;this._months=+u+r*3+i*12;this._data={};this._locale=st();this._bubble()}function br(n){return n instanceof bi}function lf(n,t){e(n,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+tr(~~(n/60),2)+t+tr(~~n%60,2)})}function kr(n){var i=(n||"").match(wi)||[],u=i[i.length-1]||[],t=(u+"").match(af)||["-",0,0],r=+(t[1]*60)+c(t[2]);return t[0]==="+"?r:-r}function dr(n,t){var i,r;return t._isUTC?(i=t.clone(),r=(rt(n)||oi(n)?+n:+s(n))-+i,i._d.setTime(+i._d+r),u.updateOffset(i,!1),i):s(n).local()}function gr(n){return-Math.round(n._d.getTimezoneOffset()/15)*15}function nh(n,t){var i=this._offset||0,r;return n!=null?(typeof n=="string"&&(n=kr(n)),Math.abs(n)<16&&(n=n*60),!this._isUTC&&t&&(r=gr(this)),this._offset=n,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==n&&(!t||this._changeInProgress?kf(this,ut(n-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,u.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?i:gr(this)}function th(n,t){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,t),this):-this.utcOffset()}function ih(n){return this.utcOffset(0,n)}function rh(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(gr(this),"m")),this}function uh(){return this._tzm?this.utcOffset(this._tzm):typeof this._i=="string"&&this.utcOffset(kr(this._i)),this}function fh(n){return n=n?s(n).utcOffset():0,(this.utcOffset()-n)%60==0}function eh(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function oh(){if(this._a){var n=this._isUTC?gt(this._a):s(this._a);return this.isValid()&&eu(this._a,n.toArray())>0}return!1}function sh(){return!this._isUTC}function hh(){return this._isUTC}function vf(){return this._isUTC&&this._offset===0}function ut(n,t){var i=n,r=null,u,f,e;return br(n)?i={ms:n._milliseconds,d:n._days,M:n._months}:typeof n=="number"?(i={},t?i[t]=n:i.milliseconds=n):(r=yf.exec(n))?(u=r[1]==="-"?-1:1,i={y:0,d:c(r[k])*u,h:c(r[y])*u,m:c(r[ht])*u,s:c(r[ct])*u,ms:c(r[lt])*u}):(r=pf.exec(n))?(u=r[1]==="-"?-1:1,i={y:vt(r[2],u),M:vt(r[3],u),d:vt(r[4],u),h:vt(r[5],u),m:vt(r[6],u),s:vt(r[7],u),w:vt(r[8],u)}):i==null?i={}:typeof i=="object"&&("from"in i||"to"in i)&&(e=ch(s(i.from),s(i.to)),i={},i.ms=e.milliseconds,i.M=e.months),f=new bi(i),br(n)&&et(n,"_locale")&&(f._locale=n._locale),f}function vt(n,t){var i=n&&parseFloat(n.replace(",","."));return(isNaN(i)?0:i)*t}function wf(n,t){var i={milliseconds:0,months:0};return i.months=t.month()-n.month()+(t.year()-n.year())*12,n.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+n.clone().add(i.months,"M"),i}function ch(n,t){var i;return t=dr(t,n),n.isBefore(t)?i=wf(n,t):(i=wf(t,n),i.milliseconds=-i.milliseconds,i.months=-i.months),i}function bf(n,t){return function(i,r){var u,f;return r===null||isNaN(+r)||(go(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),f=i,i=r,r=f),i=typeof i=="string"?+i:i,u=ut(i,r),kf(this,u,n),this}}function kf(n,t,i,r){var o=t._milliseconds,f=t._days,e=t._months;r=r==null?!0:r;o&&n._d.setTime(+n._d+o*i);f&&au(n,"Date",ci(n,"Date")+f*i);e&&gu(n,ci(n,"Month")+e*i);r&&u.updateOffset(n,f||e)}function lh(n){var i=n||s(),r=dr(i,this).startOf("day"),t=this.diff(r,"days",!0),u=t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(u,this,s(i)))}function ah(){return new ni(this)}function vh(n,t){var i;return t=w(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(n=rt(n)?n:s(n),+this>+n):(i=rt(n)?+n:+s(n),i<+this.clone().startOf(t))}function yh(n,t){var i;return t=w(typeof t!="undefined"?t:"millisecond"),t==="millisecond"?(n=rt(n)?n:s(n),+this<+n):(i=rt(n)?+n:+s(n),+this.clone().endOf(t)<i)}function ph(n,t,i){return this.isAfter(n,i)&&this.isBefore(t,i)}function wh(n,t){var i;return t=w(t||"millisecond"),t==="millisecond"?(n=rt(n)?n:s(n),+this==+n):(i=+s(n),+this.clone().startOf(t)<=i&&i<=+this.clone().endOf(t))}function d(n){return n<0?Math.ceil(n):Math.floor(n)}function bh(n,t,i){var f=dr(n,this),e=(f.utcOffset()-this.utcOffset())*6e4,u,r;return t=w(t),t==="year"||t==="month"||t==="quarter"?(r=kh(this,f),t==="quarter"?r=r/3:t==="year"&&(r=r/12)):(u=this-f,r=t==="second"?u/1e3:t==="minute"?u/6e4:t==="hour"?u/36e5:t==="day"?(u-e)/864e5:t==="week"?(u-e)/6048e5:u),i?r:d(r)}function kh(n,t){var r=(t.year()-n.year())*12+(t.month()-n.month()),i=n.clone().add(r,"months"),u,f;return t-i<0?(u=n.clone().add(r-1,"months"),f=(t-i)/(i-u)):(u=n.clone().add(r+1,"months"),f=(t-i)/(u-i)),-(r+f)}function dh(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ne(){var n=this.clone().utc();return 0<n.year()&&n.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():rr(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):rr(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function gh(n){var t=rr(this,n||u.defaultFormat);return this.localeData().postformat(t)}function nc(n,t){return this.isValid()?ut({to:this,from:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function tc(n){return this.from(s(),n)}function ic(n,t){return this.isValid()?ut({from:this,to:n}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function rc(n){return this.to(s(),n)}function te(n){var t;return n===undefined?this._locale._abbr:(t=st(n),t!=null&&(this._locale=t),this)}function ie(){return this._locale}function uc(n){n=w(n);switch(n){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"&&this.weekday(0),n==="isoWeek"&&this.isoWeekday(1),n==="quarter"&&this.month(Math.floor(this.month()/3)*3),this}function fc(n){return(n=w(n),n===undefined||n==="millisecond")?this:this.startOf(n).add(1,n==="isoWeek"?"week":n).subtract(1,"ms")}function ec(){return+this._d-(this._offset||0)*6e4}function oc(){return Math.floor(+this/1e3)}function sc(){return this._offset?new Date(+this):this._d}function hc(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function cc(){return ru(this)}function lc(){return si({},h(this))}function ac(){return h(this).overflow}function ki(n,t){e(0,[n,n.length],0,t)}function re(n,t,i){return at(s([n,11,31+t-i]),t,i).week}function vc(n){var t=at(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return n==null?t:this.add(n-t,"y")}function yc(n){var t=at(this,1,4).year;return n==null?t:this.add(n-t,"y")}function pc(){return re(this.year(),1,4)}function wc(){var n=this.localeData()._week;return re(this.year(),n.dow,n.doy)}function bc(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}function kc(n,t){if(typeof n=="string")if(isNaN(n)){if(n=t.weekdaysParse(n),typeof n!="number")return null}else n=parseInt(n,10);return n}function dc(n){return this._weekdays[n.day()]}function gc(n){return this._weekdaysShort[n.day()]}function nl(n){return this._weekdaysMin[n.day()]}function tl(n){var t,i,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(i=s([2e3,1]).day(t),r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(n))return t}function il(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=kc(n,this.localeData()),this.add(n-t,"d")):t}function rl(n){var t=(this.day()+7-this.localeData()._week.dow)%7;return n==null?t:this.add(n-t,"d")}function ul(n){return n==null?this.day()||7:this.day(this.day()%7?n:n-7)}function oe(n,t){e(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function se(n,t){return t._meridiemParse}function fl(n){return(n+"").toLowerCase().charAt(0)==="p"}function el(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"}function ve(n){e(0,[n,3],0,"millisecond")}function ol(){return this._isUTC?"UTC":""}function sl(){return this._isUTC?"Coordinated Universal Time":""}function hl(n){return s(n*1e3)}function cl(){return s.apply(null,arguments).parseZone()}function ll(n,t,i){var r=this._calendar[n];return typeof r=="function"?r.call(t,i):r}function al(n){var t=this._longDateFormat[n];return!t&&this._longDateFormat[n.toUpperCase()]&&(t=this._longDateFormat[n.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n]=t),t}function vl(){return this._invalidDate}function yl(n){return this._ordinal.replace("%d",n)}function no(n){return n}function pl(n,t,i,r){var u=this._relativeTime[i];return typeof u=="function"?u(n,t,i,r):u.replace(/%d/i,n)}function wl(n,t){var i=this._relativeTime[n>0?"future":"past"];return typeof i=="function"?i(t):i.replace(/%s/i,t)}function bl(n){var t;for(var i in n)t=n[i],typeof t=="function"?this[i]=t:this["_"+i]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function io(n,t,i,r){var u=st(),f=gt().set(r,t);return u[i](f,n)}function fi(n,t,i,r,u){if(typeof n=="number"&&(t=n,n=undefined),n=n||"",t!=null)return io(n,t,i,u);for(var e=[],f=0;f<r;f++)e[f]=io(n,f,i,u);return e}function kl(n,t){return fi(n,t,"months",12,"month")}function dl(n,t){return fi(n,t,"monthsShort",12,"month")}function gl(n,t){return fi(n,t,"weekdays",7,"day")}function na(n,t){return fi(n,t,"weekdaysShort",7,"day")}function ta(n,t){return fi(n,t,"weekdaysMin",7,"day")}function ia(){var n=this._data;return this._milliseconds=g(this._milliseconds),this._days=g(this._days),this._months=g(this._months),n.milliseconds=g(n.milliseconds),n.seconds=g(n.seconds),n.minutes=g(n.minutes),n.hours=g(n.hours),n.months=g(n.months),n.years=g(n.years),this}function ro(n,t,i,r){var u=ut(t,i);return n._milliseconds+=r*u._milliseconds,n._days+=r*u._days,n._months+=r*u._months,n._bubble()}function ra(n,t){return ro(this,n,t,1)}function ua(n,t){return ro(this,n,t,-1)}function fa(){var o=this._milliseconds,t=this._days,i=this._months,n=this._data,u,f,e,r=0;return n.milliseconds=o%1e3,u=d(o/1e3),n.seconds=u%60,f=d(u/60),n.minutes=f%60,e=d(f/60),n.hours=e%24,t+=d(e/24),r=d(uo(t)),t-=d(fo(r)),i+=d(t/30),t%=30,r+=d(i/12),i%=12,n.days=t,n.months=i,n.years=r,this}function uo(n){return n*400/146097}function fo(n){return n*146097/400}function ea(n){var t,r,i=this._milliseconds;if(n=w(n),n==="month"||n==="year")return t=this._days+i/864e5,r=this._months+uo(t)*12,n==="month"?r:r/12;t=this._days+Math.round(fo(this._months/12));switch(n){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return t*24+i/36e5;case"minute":return t*1440+i/6e4;case"second":return t*86400+i/1e3;case"millisecond":return Math.floor(t*864e5)+i;default:throw new Error("Unknown unit "+n);}}function oa(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+c(this._months/12)*31536e6}function ft(n){return function(){return this.as(n)}}function wa(n){return n=w(n),this[n+"s"]()}function yt(n){return function(){return this._data[n]}}function rv(){return d(this.days()/7)}function uv(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function fv(n,t,i){var r=ut(n).abs(),h=pt(r.as("s")),f=pt(r.as("m")),e=pt(r.as("h")),o=pt(r.as("d")),s=pt(r.as("M")),c=pt(r.as("y")),u=h<it.s&&["s",h]||f===1&&["m"]||f<it.m&&["mm",f]||e===1&&["h"]||e<it.h&&["hh",e]||o===1&&["d"]||o<it.d&&["dd",o]||s===1&&["M"]||s<it.M&&["MM",s]||c===1&&["y"]||["yy",c];return u[2]=t,u[3]=+n>0,u[4]=i,uv.apply(null,u)}function ev(n,t){return it[n]===undefined?!1:t===undefined?it[n]:(it[n]=t,!0)}function ov(n){var t=this.localeData(),i=fv(this,!n,t);return n&&(i=t.pastFuture(+this,i)),t.postformat(i)}function di(){var r=wt(this.years()),u=wt(this.months()),f=wt(this.days()),n=wt(this.hours()),t=wt(this.minutes()),i=wt(this.seconds()+this.milliseconds()/1e3),e=this.asSeconds();return e?(e<0?"-":"")+"P"+(r?r+"Y":"")+(u?u+"M":"")+(f?f+"D":"")+(n||t||i?"T":"")+(n?n+"H":"")+(t?t+"M":"")+(i?i+"S":""):"P0D"}var iu,gi=u.momentProperties=[],nr=!1,ot={},hi,ii={},yu=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,li=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ir={},kt={},wu=/\d/,p=/\d\d/,bu=/\d{3}/,ur=/\d{4}/,ai=/[+-]?\d{6}/,l=/\d\d?/,vi=/\d{1,3}/,fr=/\d{1,4}/,yi=/[+-]?\d{1,6}/,pi=/[+-]?\d+/,wi=/Z|[+-]\d\d:?\d\d/gi,ri=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,er={},or={},nt=0,tt=1,k=2,y=3,ht=4,ct=5,lt=6,ku,du,cr,yr,ef,sf,hf,af,yf,pf,df,gf,nu,tu,ue,fe,ee,he,ce,le,ae,ye,n,pe,we,be,ke,de,ge,to,f,g,pt,it,wt,o;e("M",["MM",2],"Mo",function(){return this.month()+1});e("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});e("MMMM",0,0,function(n){return this.localeData().months(this,n)});v("month","M");r("M",l);r("MM",l,p);r("MMM",ri);r("MMMM",ri);a(["M","MM"],function(n,t){t[tt]=c(n)-1});a(["MMM","MMMM"],function(n,t,i,r){var u=i._locale.monthsParse(n,r,i._strict);u!=null?t[tt]=u:h(i).invalidMonth=n});ku="January_February_March_April_May_June_July_August_September_October_November_December".split("_");du="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");cr={};u.suppressDeprecationWarnings=!1;var ns=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ar=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ts=/^\/?Date\((\-?\d+)/i;u.createFromInputFallback=b("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});e(0,["YY",2],0,function(){return this.year()%100});e(0,["YYYY",4],0,"year");e(0,["YYYYY",5],0,"year");e(0,["YYYYYY",6,!0],0,"year");v("year","y");r("Y",pi);r("YY",l,p);r("YYYY",fr,ur);r("YYYYY",yi,ai);r("YYYYYY",yi,ai);a(["YYYY","YYYYY","YYYYYY"],nt);a("YY",function(n,t){t[nt]=u.parseTwoDigitYear(n)});u.parseTwoDigitYear=function(n){return c(n)+(c(n)>68?1900:2e3)};yr=bt("FullYear",!1);e("w",["ww",2],"wo","week");e("W",["WW",2],"Wo","isoWeek");v("week","w");v("isoWeek","W");r("w",l);r("ww",l,p);r("W",l);r("WW",l,p);ui(["w","ww","W","WW"],function(n,t,i,r){t[r.substr(0,1)]=c(n)});ef={dow:0,doy:6};e("DDD",["DDDD",3],"DDDo","dayOfYear");v("dayOfYear","DDD");r("DDD",vi);r("DDDD",bu);a(["DDD","DDDD"],function(n,t,i){i._dayOfYear=c(n)});u.ISO_8601=function(){};sf=b("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var n=s.apply(null,arguments);return n<this?this:n});hf=b("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var n=s.apply(null,arguments);return n>this?this:n});lf("Z",":");lf("ZZ","");r("Z",wi);r("ZZ",wi);a(["Z","ZZ"],function(n,t,i){i._useUTC=!0;i._tzm=kr(n)});af=/([\+\-]|\d\d)/gi;u.updateOffset=function(){};yf=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/;pf=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;ut.fn=bi.prototype;df=bf(1,"add");gf=bf(-1,"subtract");u.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";nu=b("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===undefined?this.localeData():this.locale(n)});e(0,["gg",2],0,function(){return this.weekYear()%100});e(0,["GG",2],0,function(){return this.isoWeekYear()%100});ki("gggg","weekYear");ki("ggggg","weekYear");ki("GGGG","isoWeekYear");ki("GGGGG","isoWeekYear");v("weekYear","gg");v("isoWeekYear","GG");r("G",pi);r("g",pi);r("GG",l,p);r("gg",l,p);r("GGGG",fr,ur);r("gggg",fr,ur);r("GGGGG",yi,ai);r("ggggg",yi,ai);ui(["gggg","ggggg","GGGG","GGGGG"],function(n,t,i,r){t[r.substr(0,2)]=c(n)});ui(["gg","GG"],function(n,t,i,r){t[r]=u.parseTwoDigitYear(n)});e("Q",0,0,"quarter");v("quarter","Q");r("Q",wu);a("Q",function(n,t){t[tt]=(c(n)-1)*3});e("D",["DD",2],"Do","date");v("date","D");r("D",l);r("DD",l,p);r("Do",function(n,t){return n?t._ordinalParse:t._ordinalParseLenient});a(["D","DD"],k);a("Do",function(n,t){t[k]=c(n.match(l)[0],10)});tu=bt("Date",!0);e("d",0,"do","day");e("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});e("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});e("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});e("e",0,0,"weekday");e("E",0,0,"isoWeekday");v("day","d");v("weekday","e");v("isoWeekday","E");r("d",l);r("e",l);r("E",l);r("dd",ri);r("ddd",ri);r("dddd",ri);ui(["dd","ddd","dddd"],function(n,t,i){var r=i._locale.weekdaysParse(n);r!=null?t.d=r:h(i).invalidWeekday=n});ui(["d","e","E"],function(n,t,i,r){t[r]=c(n)});ue="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");fe="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");ee="Su_Mo_Tu_We_Th_Fr_Sa".split("_");e("H",["HH",2],0,"hour");e("h",["hh",2],0,function(){return this.hours()%12||12});oe("a",!0);oe("A",!1);v("hour","h");r("a",se);r("A",se);r("H",l);r("h",l);r("HH",l,p);r("hh",l,p);a(["H","HH"],y);a(["a","A"],function(n,t,i){i._isPm=i._locale.isPM(n);i._meridiem=n});a(["h","hh"],function(n,t,i){t[y]=c(n);h(i).bigHour=!0});he=/[ap]\.?m?\.?/i;ce=bt("Hours",!0);e("m",["mm",2],0,"minute");v("minute","m");r("m",l);r("mm",l,p);a(["m","mm"],ht);le=bt("Minutes",!1);e("s",["ss",2],0,"second");v("second","s");r("s",l);r("ss",l,p);a(["s","ss"],ct);ae=bt("Seconds",!1);e("S",0,0,function(){return~~(this.millisecond()/100)});e(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve("SSS");ve("SSSS");v("millisecond","ms");r("S",vi,wu);r("SS",vi,p);r("SSS",vi,bu);r("SSSS",/\d+/);a(["S","SS","SSS","SSSS"],function(n,t){t[lt]=c(("0."+n)*1e3)});ye=bt("Milliseconds",!1);e("z",0,0,"zoneAbbr");e("zz",0,0,"zoneName");n=ni.prototype;n.add=df;n.calendar=lh;n.clone=ah;n.diff=bh;n.endOf=fc;n.format=gh;n.from=nc;n.fromNow=tc;n.to=ic;n.toNow=rc;n.get=vu;n.invalidAt=ac;n.isAfter=vh;n.isBefore=yh;n.isBetween=ph;n.isSame=wh;n.isValid=cc;n.lang=nu;n.locale=te;n.localeData=ie;n.max=hf;n.min=sf;n.parsingFlags=lc;n.set=vu;n.startOf=uc;n.subtract=gf;n.toArray=hc;n.toDate=sc;n.toISOString=ne;n.toJSON=ne;n.toString=dh;n.unix=oc;n.valueOf=ec;n.year=yr;n.isLeapYear=us;n.weekYear=vc;n.isoWeekYear=yc;n.quarter=n.quarters=bc;n.month=nf;n.daysInMonth=ko;n.week=n.weeks=ss;n.isoWeek=n.isoWeeks=hs;n.weeksInYear=wc;n.isoWeeksInYear=pc;n.date=tu;n.day=n.days=il;n.weekday=rl;n.isoWeekday=ul;n.dayOfYear=ls;n.hour=n.hours=ce;n.minute=n.minutes=le;n.second=n.seconds=ae;n.millisecond=n.milliseconds=ye;n.utcOffset=nh;n.utc=ih;n.local=rh;n.parseZone=uh;n.hasAlignedHourOffset=fh;n.isDST=eh;n.isDSTShifted=oh;n.isLocal=sh;n.isUtcOffset=hh;n.isUtc=vf;n.isUTC=vf;n.zoneAbbr=ol;n.zoneName=sl;n.dates=b("dates accessor is deprecated. Use date instead.",tu);n.months=b("months accessor is deprecated. Use month instead",nf);n.years=b("years accessor is deprecated. Use year instead",yr);n.zone=b("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",th);pe=n;we={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};be={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"};ke="Invalid date";de="%d";ge=/\d{1,2}/;to={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};f=ou.prototype;f._calendar=we;f.calendar=ll;f._longDateFormat=be;f.longDateFormat=al;f._invalidDate=ke;f.invalidDate=vl;f._ordinal=de;f.ordinal=yl;f._ordinalParse=ge;f.preparse=no;f.postformat=no;f._relativeTime=to;f.relativeTime=pl;f.pastFuture=wl;f.set=bl;f.months=po;f._months=ku;f.monthsShort=wo;f._monthsShort=du;f.monthsParse=bo;f.week=fs;f._week=ef;f.firstDayOfYear=os;f.firstDayOfWeek=es;f.weekdays=dc;f._weekdays=ue;f.weekdaysMin=nl;f._weekdaysMin=ee;f.weekdaysShort=gc;f._weekdaysShort=fe;f.weekdaysParse=tl;f.isPM=fl;f._meridiemParse=he;f.meridiem=el;ti("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var t=n%10,i=c(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+i}});u.lang=b("moment.lang is deprecated. Use moment.locale instead.",ti);u.langData=b("moment.langData is deprecated. Use moment.localeData instead.",st);g=Math.abs;var sa=ft("ms"),ha=ft("s"),ca=ft("m"),la=ft("h"),aa=ft("d"),va=ft("w"),ya=ft("M"),pa=ft("y");var ba=yt("milliseconds"),ka=yt("seconds"),da=yt("minutes"),ga=yt("hours"),nv=yt("days"),tv=yt("months"),iv=yt("years");return pt=Math.round,it={s:45,m:45,h:22,d:26,M:11},wt=Math.abs,o=bi.prototype,o.abs=ia,o.add=ra,o.subtract=ua,o.as=ea,o.asMilliseconds=sa,o.asSeconds=ha,o.asMinutes=ca,o.asHours=la,o.asDays=aa,o.asWeeks=va,o.asMonths=ya,o.asYears=pa,o.valueOf=oa,o._bubble=fa,o.get=wa,o.milliseconds=ba,o.seconds=ka,o.minutes=da,o.hours=ga,o.days=nv,o.weeks=rv,o.months=tv,o.years=iv,o.humanize=ov,o.toISOString=di,o.toString=di,o.toJSON=di,o.locale=te,o.localeData=ie,o.toIsoString=b("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",di),o.lang=nu,e("X",0,0,"unix"),e("x",0,0,"valueOf"),r("x",pi),r("X",/[+-]?\d+(\.\d{1,3})?/),a("X",function(n,t,i){i._d=new Date(parseFloat(n,10)*1e3)}),a("x",function(n,t,i){i._d=new Date(c(n))}),u.version="2.10.3",eo(s),u.fn=pe,u.min=ds,u.max=gs,u.utc=gt,u.unix=hl,u.months=kl,u.isDate=oi,u.locale=ti,u.invalid=uu,u.duration=ut,u.isMoment=rt,u.weekdays=gl,u.parseZone=cl,u.localeData=st,u.isDuration=br,u.monthsShort=dl,u.weekdaysMin=ta,u.defineLocale=cu,u.weekdaysShort=na,u.normalizeUnits=w,u.relativeTimeThreshold=ev,u})},{}],numeral:[function(t,i){"use strict";(function(){function s(n){this._value=n}function h(n,t,i,r){var f=Math.pow(10,t),e,u;return u=(i(n*f)/f).toFixed(t),r&&(e=new RegExp("0{1,"+r+"}$"),u=u.replace(e,"")),u}function v(n,t,i){return t.indexOf("$")>-1?p(n,t,i):t.indexOf("%")>-1?w(n,t,i):t.indexOf(":")>-1?b(n,t):c(n._value,t,i)}function y(n,i){var o=i,s,h,c,l,a=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=!1,e;if(i.indexOf(":")>-1)n._value=k(i);else if(i===f)n._value=0;else{for(t[r].delimiters.decimal!=="."&&(i=i.replace(/\./g,"").replace(t[r].delimiters.decimal,".")),s=new RegExp("[^a-zA-Z]"+t[r].abbreviations.thousand+"(?:\\)|(\\"+t[r].currency.symbol+")?(?:\\))?)?$"),h=new RegExp("[^a-zA-Z]"+t[r].abbreviations.million+"(?:\\)|(\\"+t[r].currency.symbol+")?(?:\\))?)?$"),c=new RegExp("[^a-zA-Z]"+t[r].abbreviations.billion+"(?:\\)|(\\"+t[r].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+t[r].abbreviations.trillion+"(?:\\)|(\\"+t[r].currency.symbol+")?(?:\\))?)?$"),e=0;e<=a.length;e++)if(u=i.indexOf(a[e])>-1?Math.pow(1024,e+1):!1,u)break;n._value=(u?u:1)*(o.match(s)?Math.pow(10,3):1)*(o.match(h)?Math.pow(10,6):1)*(o.match(c)?Math.pow(10,9):1)*(o.match(l)?Math.pow(10,12):1)*(i.indexOf("%")>-1?.01:1)*((i.split("-").length+Math.min(i.split("(").length-1,i.split(")").length-1))%2?1:-1)*Number(i.replace(/[^0-9\.]+/g,""));n._value=u?Math.ceil(n._value):n._value}return n._value}function p(n,i,u){var o=i.indexOf("$"),h=i.indexOf("("),l=i.indexOf("-"),e="",s,f;return i.indexOf(" $")>-1?(e=" ",i=i.replace(" $","")):i.indexOf("$ ")>-1?(e=" ",i=i.replace("$ ","")):i=i.replace("$",""),f=c(n._value,i,u),o<=1?f.indexOf("(")>-1||f.indexOf("-")>-1?(f=f.split(""),s=1,(o<h||o<l)&&(s=0),f.splice(s,0,t[r].currency.symbol+e),f=f.join("")):f=t[r].currency.symbol+e+f:f.indexOf(")")>-1?(f=f.split(""),f.splice(-1,0,e+t[r].currency.symbol),f=f.join("")):f=f+e+t[r].currency.symbol,f}function w(n,t,i){var u="",r,f=n._value*100;return t.indexOf(" %")>-1?(u=" ",t=t.replace(" %","")):t=t.replace("%",""),r=c(f,t,i),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,u+"%"),r=r.join("")):r=r+u+"%",r}function b(n){var i=Math.floor(n._value/3600),t=Math.floor((n._value-i*3600)/60),r=Math.round(n._value-i*3600-t*60);return i+":"+(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function k(n){var i=n.split(":"),t=0;return i.length===3?(t=t+Number(i[0])*3600,t=t+Number(i[1])*60,t=t+Number(i[2])):i.length===2&&(t=t+Number(i[0])*60,t=t+Number(i[1])),Number(t)}function c(n,i,u){var b=!1,it=!1,rt=!1,e="",d=!1,g=!1,nt=!1,tt=!1,v=!1,y="",p="",l=Math.abs(n),ut=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k,ft,a,s,o,et,c="",w=!1;if(n===0&&f!==null)return f;if(i.indexOf("(")>-1?(b=!0,i=i.slice(1,-1)):i.indexOf("+")>-1&&(it=!0,i=i.replace(/\+/g,"")),i.indexOf("a")>-1&&(d=i.indexOf("aK")>=0,g=i.indexOf("aM")>=0,nt=i.indexOf("aB")>=0,tt=i.indexOf("aT")>=0,v=d||g||nt||tt,i.indexOf(" a")>-1?(e=" ",i=i.replace(" a","")):i=i.replace("a",""),l>=Math.pow(10,12)&&!v||tt?(e=e+t[r].abbreviations.trillion,n=n/Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)&&!v||nt?(e=e+t[r].abbreviations.billion,n=n/Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)&&!v||g?(e=e+t[r].abbreviations.million,n=n/Math.pow(10,6)):(l<Math.pow(10,6)&&l>=Math.pow(10,3)&&!v||d)&&(e=e+t[r].abbreviations.thousand,n=n/Math.pow(10,3))),i.indexOf("b")>-1)for(i.indexOf(" b")>-1?(y=" ",i=i.replace(" b","")):i=i.replace("b",""),a=0;a<=ut.length;a++)if(k=Math.pow(1024,a),ft=Math.pow(1024,a+1),n>=k&&n<ft){y=y+ut[a];k>0&&(n=n/k);break}return i.indexOf("o")>-1&&(i.indexOf(" o")>-1?(p=" ",i=i.replace(" o","")):i=i.replace("o",""),p=p+t[r].ordinal(n)),i.indexOf("[.]")>-1&&(rt=!0,i=i.replace("[.]",".")),s=n.toString().split(".")[0],o=i.split(".")[1],et=i.indexOf(","),o?(o.indexOf("[")>-1?(o=o.replace("]",""),o=o.split("["),c=h(n,o[0].length+o[1].length,u,o[1].length)):c=h(n,o.length,u),s=c.split(".")[0],c=c.split(".")[1].length?t[r].delimiters.decimal+c.split(".")[1]:"",rt&&Number(c.slice(1))===0&&(c="")):s=h(n,null,u),s.indexOf("-")>-1&&(s=s.slice(1),w=!0),et>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+t[r].delimiters.thousands)),i.indexOf(".")===0&&(s=""),(b&&w?"(":"")+(!b&&w?"-":"")+(!w&&it?"+":"")+s+c+(p?p:"")+(e?e:"")+(y?y:"")+(b&&w?")":"")}function d(n,i){t[n]=i}function l(n){var t=n.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function e(){var n=Array.prototype.slice.call(arguments);return n.reduce(function(n,t){var i=l(n),r=l(t);return i>r?i:r},-Infinity)}var u,t={},r="en",f=null,o="0,0",a=typeof i!="undefined"&&i.exports;u=function(n){return u.isNumeral(n)?n=n.value():n===0||typeof n=="undefined"?n=0:Number(n)||(n=u.fn.unformat(n)),new s(Number(n))};u.version="1.5.3";u.isNumeral=function(n){return n instanceof s};u.language=function(n,i){if(!n)return r;if(n&&!i){if(!t[n])throw new Error("Unknown language : "+n);r=n}return(i||!t[n])&&d(n,i),u};u.languageData=function(n){if(!n)return t[r];if(!t[n])throw new Error("Unknown language : "+n);return t[n]};u.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});u.zeroFormat=function(n){f=typeof n=="string"?n:null};u.defaultFormat=function(n){o=typeof n=="string"?n:"0.0"};u.validate=function(n,t){var s,h,c,i,e,o,f,r;if(typeof n!="string"&&(n+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",n)),n=n.trim(),n==="")return!1;n=n.replace(/^[+-]?/,"");try{f=u.languageData(t)}catch(l){f=u.languageData(u.language())}return(c=f.currency.symbol,e=f.abbreviations,s=f.delimiters.decimal,h=f.delimiters.thousands==="."?"\\.":f.delimiters.thousands,r=n.match(/^[^\d\.\,]+/),r!==null&&(n=n.substr(1),r[0]!==c))?!1:(r=n.match(/[^\d]+$/),r!==null&&(n=n.slice(0,-1),r[0]!==e.thousand&&r[0]!==e.million&&r[0]!==e.billion&&r[0]!==e.trillion))?!1:!n.match(/^\d+$/)?(o=new RegExp(h+"{2}"),!n.match(/[^\d.,]/g))?(i=n.split(s),i.length>2?!1:i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o):i[0]===""?!i[0].match(o)&&!!i[1].match(/^\d+$/):i[0].length===1?!!i[0].match(/^\d+$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(o)&&!!i[1].match(/^\d+$/)):!1:!0};"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof n)throw new TypeError(n+" is not a function");var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});u.fn=s.prototype={clone:function(){return u(this)},format:function(n,t){return v(this,n?n:o,t!==undefined?t:Math.round)},unformat:function(n){return Object.prototype.toString.call(n)==="[object Number]"?n:y(this,n?n:o)},value:function(){return this._value},valueOf:function(){return this._value},set:function(n){return this._value=Number(n),this},add:function(n){function i(n,i){return n+t*i}var t=e.call(null,this._value,n);return this._value=[this._value,n].reduce(i,0)/t,this},subtract:function(n){function i(n,i){return n-t*i}var t=e.call(null,this._value,n);return this._value=[n].reduce(i,this._value*t)/t,this},multiply:function(n){function t(n,t){var i=e(n,t);return n*i*t*i/(i*i)}return this._value=[this._value,n].reduce(t,1),this},divide:function(n){function t(n,t){var i=e(n,t);return n*i/(t*i)}return this._value=[this._value,n].reduce(t),this},difference:function(n){return Math.abs(u(this._value).subtract(n).value())}};a&&(i.exports=u);typeof ender=="undefined"&&(this.numeral=u);typeof n=="function"&&n.amd&&n([],function(){return u})}).call(window)},{}],pikaday:[function(t,i,r){
/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
(function(u,f){"use strict";var e;if(typeof r=="object"){try{e=t("moment")}catch(o){}i.exports=f(e)}else typeof n=="function"&&n.amd?n(function(n){try{e=n("moment")}catch(t){}return f(e)}):u.Pikaday=f(u.moment)})(this,function(n){"use strict";var e=typeof n=="function",c=!!window.addEventListener,t=window.document,s=window.setTimeout,u=function(n,t,i,r){c?n.addEventListener(t,i,!!r):n.attachEvent("on"+t,i)},f=function(n,t,i,r){c?n.removeEventListener(t,i,!!r):n.detachEvent("on"+t,i)},a=function(n,i,r){var u;t.createEvent?(u=t.createEvent("HTMLEvents"),u.initEvent(i,!0,!1),u=o(u,r),n.dispatchEvent(u)):t.createEventObject&&(u=t.createEventObject(),u=o(u,r),n.fireEvent("on"+i,u))},k=function(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")},r=function(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")!==-1},d=function(n,t){r(n,t)||(n.className=n.className===""?t:n.className+" "+t)},g=function(n,t){n.className=k((" "+n.className+" ").replace(" "+t+" "," "))},l=function(n){return/Array/.test(Object.prototype.toString.call(n))},i=function(n){return/Date/.test(Object.prototype.toString.call(n))&&!isNaN(n.getTime())},nt=function(n){var t=n.getDay();return t===0||t===6},tt=function(n){return n%4==0&&n%100!=0||n%400==0},it=function(n,t){return[31,tt(n)?29:28,31,30,31,30,31,31,30,31,30,31][t]},h=function(n){i(n)&&n.setHours(0,0,0,0)},v=function(n,t){return n.getTime()===t.getTime()},o=function(n,t,r){var u,f;for(u in t)f=n[u]!==undefined,f&&typeof t[u]=="object"&&t[u]!==null&&t[u].nodeName===undefined?i(t[u])?r&&(n[u]=new Date(t[u].getTime())):l(t[u])?r&&(n[u]=t[u].slice(0)):n[u]=o({},t[u],r):(r||!f)&&(n[u]=t[u]);return n},y=function(n){return n.month<0&&(n.year-=Math.ceil(Math.abs(n.month)/12),n.month+=12),n.month>11&&(n.year+=Math.floor(Math.abs(n.month)/12),n.month-=12),n},p={field:null,bound:undefined,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},w=function(n,t,i){for(t+=n.firstDay;t>=7;)t-=7;return i?n.i18n.weekdaysShort[t]:n.i18n.weekdays[t]},rt=function(n,t,i,r,u,f,e){if(e)return'<td class="is-empty"><\/td>';var o=[];return f&&o.push("is-disabled"),u&&o.push("is-today"),r&&o.push("is-selected"),'<td data-day="'+n+'" class="'+o.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+i+'" data-pika-month="'+t+'" data-pika-day="'+n+'">'+n+"<\/button><\/td>"},ut=function(n,t,i){var r=new Date(i,0,1),u=Math.ceil(((new Date(i,t,n)-r)/864e5+r.getDay()+1)/7);return'<td class="pika-week">'+u+"<\/td>"},ft=function(n,t){return"<tr>"+(t?n.reverse():n).join("")+"<\/tr>"},et=function(n){return"<tbody>"+n.join("")+"<\/tbody>"},ot=function(n){var t,i=[];for(n.showWeekNumber&&i.push("<th><\/th>"),t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+w(n,t)+'">'+w(n,t,!0)+"<\/abbr><\/th>");return"<thead>"+(n.isRTL?i.reverse():i).join("")+"<\/thead>"},st=function(n,t,i,r,u){for(var h,f=n._o,v=i===f.minYear,y=i===f.maxYear,s='<div class="pika-title">',c,a,p=!0,w=!0,o=[],e=0;e<12;e++)o.push('<option value="'+(i===u?e-t:12+e-t)+'"'+(e===r?" selected":"")+(v&&e<f.minMonth||y&&e>f.maxMonth?"disabled":"")+">"+f.i18n.months[e]+"<\/option>");for(c='<div class="pika-label">'+f.i18n.months[r]+'<select class="pika-select pika-select-month">'+o.join("")+"<\/select><\/div>",l(f.yearRange)?(e=f.yearRange[0],h=f.yearRange[1]+1):(e=i-f.yearRange,h=1+i+f.yearRange),o=[];e<h&&e<=f.maxYear;e++)e>=f.minYear&&o.push('<option value="'+e+'"'+(e===i?" selected":"")+">"+e+"<\/option>");return a='<div class="pika-label">'+i+f.yearSuffix+'<select class="pika-select pika-select-year">'+o.join("")+"<\/select><\/div>",s+=f.showMonthAfterYear?a+c:c+a,v&&(r===0||f.minMonth>=r)&&(p=!1),y&&(r===11||f.maxMonth<=r)&&(w=!1),t===0&&(s+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+f.i18n.previousMonth+"<\/button>"),t===n._o.numberOfMonths-1&&(s+='<button class="pika-next'+(w?"":" is-disabled")+'" type="button">'+f.i18n.nextMonth+"<\/button>"),s+"<\/div>"},ht=function(n,t){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+ot(n)+et(t)+"<\/table>"},b=function(f){var o=this,h=o.config(f),l;o._onMouseDown=function(n){if(o._v){n=n||window.event;var t=n.target||n.srcElement;if(t){if(!r(t,"is-disabled")){if(r(t,"pika-button")&&!r(t,"is-empty")){o.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day")));h.bound&&s(function(){o.hide();h.field&&h.field.blur()},100);return}r(t,"pika-prev")?o.prevMonth():r(t,"pika-next")&&o.nextMonth()}if(r(t,"pika-select"))o._c=!0;else if(n.preventDefault)n.preventDefault();else return n.returnValue=!1,!1}}};o._onChange=function(n){n=n||window.event;var t=n.target||n.srcElement;t&&(r(t,"pika-select-month")?o.gotoMonth(t.value):r(t,"pika-select-year")&&o.gotoYear(t.value))};o._onInputChange=function(t){var r;t.firedBy!==o&&(e?(r=n(h.field.value,h.format),r=r&&r.isValid()?r.toDate():null):r=new Date(Date.parse(h.field.value)),o.setDate(i(r)?r:null),o._v||o.show())};o._onInputFocus=function(){o.show()};o._onInputClick=function(){o.show()};o._onInputBlur=function(){var n=t.activeElement;do if(r(n,"pika-single"))return;while(n=n.parentNode);o._c||(o._b=s(function(){o.hide()},50));o._c=!1};o._onClick=function(n){n=n||window.event;var t=n.target||n.srcElement,i=t;if(t){!c&&r(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),u(t,"change",o._onChange)));do if(r(i,"pika-single")||i===h.trigger)return;while(i=i.parentNode);o._v&&t!==h.trigger&&i!==h.trigger&&o.hide()}};o.el=t.createElement("div");o.el.className="pika-single"+(h.isRTL?" is-rtl":"");u(o.el,"mousedown",o._onMouseDown,!0);u(o.el,"change",o._onChange);h.field&&(h.container?h.container.appendChild(o.el):h.bound?t.body.appendChild(o.el):h.field.parentNode.insertBefore(o.el,h.field.nextSibling),u(h.field,"change",o._onInputChange),h.defaultDate||(h.defaultDate=e&&h.field.value?n(h.field.value,h.format).toDate():new Date(Date.parse(h.field.value)),h.setDefaultDate=!0));l=h.defaultDate;i(l)?h.setDefaultDate?o.setDate(l,!0):o.gotoDate(l):o.gotoDate(new Date);h.bound?(this.hide(),o.el.className+=" is-bound",u(h.trigger,"click",o._onInputClick),u(h.trigger,"focus",o._onInputFocus),u(h.trigger,"blur",o._onInputBlur)):this.show()};return b.prototype={config:function(n){var t,r,u;return this._o||(this._o=o({},p,!0)),t=o(this._o,n,!0),t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.bound=!!(t.bound!==undefined?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn=typeof t.disableDayFn=="function"?t.disableDayFn:null,r=parseInt(t.numberOfMonths,10)||1,t.numberOfMonths=r>4?4:r,i(t.minDate)||(t.minDate=!1),i(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&(h(t.minDate),t.minYear=t.minDate.getFullYear(),t.minMonth=t.minDate.getMonth()),t.maxDate&&(h(t.maxDate),t.maxYear=t.maxDate.getFullYear(),t.maxMonth=t.maxDate.getMonth()),l(t.yearRange)?(u=(new Date).getFullYear()-10,t.yearRange[0]=parseInt(t.yearRange[0],10)||u,t.yearRange[1]=parseInt(t.yearRange[1],10)||u):(t.yearRange=Math.abs(parseInt(t.yearRange,10))||p.yearRange,t.yearRange>100&&(t.yearRange=100)),t},toString:function(t){return i(this._d)?e?n(this._d).format(t||this._o.format):this._d.toDateString():""},getMoment:function(){return e?n(this._d):null},setMoment:function(t,i){e&&n.isMoment(t)&&this.setDate(t.toDate(),i)},getDate:function(){return i(this._d)?new Date(this._d.getTime()):null},setDate:function(n,t){if(!n)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();if(typeof n=="string"&&(n=new Date(Date.parse(n))),i(n)){var r=this._o.minDate,u=this._o.maxDate;i(r)&&n<r?n=r:i(u)&&n>u&&(n=u);this._d=new Date(n.getTime());h(this._d);this.gotoDate(this._d);this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this}));t||typeof this._o.onSelect!="function"||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(n){var r=!0;if(i(n)){if(this.calendars){var f=new Date(this.calendars[0].year,this.calendars[0].month,1),t=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),u=n.getTime();t.setMonth(t.getMonth()+1);t.setDate(t.getDate()-1);r=u<f.getTime()||t.getTime()<u}r&&(this.calendars=[{month:n.getMonth(),year:n.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths));this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=y(this.calendars[0]);for(var n=1;n<this._o.numberOfMonths;n++)this.calendars[n]=y({month:this.calendars[0].month+n,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(n){isNaN(n)||(this.calendars[0].month=parseInt(n,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(n){isNaN(n)||(this.calendars[0].year=parseInt(n,10),this.adjustCalendars())},setMinDate:function(n){this._o.minDate=n},setMaxDate:function(n){this._o.maxDate=n},draw:function(n){var i,f;if(this._v||n){var t=this._o,e=t.minYear,o=t.maxYear,r=t.minMonth,u=t.maxMonth,h="";for(this._y<=e&&(this._y=e,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=o&&(this._y=o,!isNaN(u)&&this._m>u&&(this._m=u)),i=0;i<t.numberOfMonths;i++)h+='<div class="pika-lendar">'+st(this,i,this.calendars[i].year,this.calendars[i].month,this.calendars[0].year)+this.render(this.calendars[i].year,this.calendars[i].month)+"<\/div>";this.el.innerHTML=h;t.bound&&t.field.type!=="hidden"&&s(function(){t.trigger.focus()},1);typeof this._o.onDraw=="function"&&(f=this,s(function(){f._o.onDraw.call(f)},0))}},adjustPosition:function(){if(!this._o.container){var r=this._o.trigger,u=r,f=this.el.offsetWidth,e=this.el.offsetHeight,s=window.innerWidth||t.documentElement.clientWidth,h=window.innerHeight||t.documentElement.clientHeight,c=window.pageYOffset||t.body.scrollTop||t.documentElement.scrollTop,n,i,o;if(typeof r.getBoundingClientRect=="function")o=r.getBoundingClientRect(),n=o.left+window.pageXOffset,i=o.bottom+window.pageYOffset;else for(n=u.offsetLeft,i=u.offsetTop+u.offsetHeight;u=u.offsetParent;)n+=u.offsetLeft,i+=u.offsetTop;(this._o.reposition&&n+f>s||this._o.position.indexOf("right")>-1&&n-f+r.offsetWidth>0)&&(n=n-f+r.offsetWidth);(this._o.reposition&&i+e>h+c||this._o.position.indexOf("top")>-1&&i-e-r.offsetHeight>0)&&(i=i-e-r.offsetHeight);this.el.style.cssText=["position: absolute","left: "+n+"px","top: "+i+"px"].join(";")}},render:function(n,t){var r=this._o,a=new Date,y=it(n,t),u=new Date(n,t,1).getDay(),p=[],o=[],s,c,f,l;for(h(a),r.firstDay>0&&(u-=r.firstDay,u<0&&(u+=7)),s=y+u,c=s;c>7;)c-=7;for(s+=7-c,f=0,l=0;f<s;f++){var e=new Date(n,t,1+(f-u)),w=i(this._d)?v(e,this._d):!1,b=v(e,a),k=f<u||f>=y+u,d=r.minDate&&e<r.minDate||r.maxDate&&e>r.maxDate||r.disableWeekends&&nt(e)||r.disableDayFn&&r.disableDayFn(e);o.push(rt(1+(f-u),t,n,w,b,d,k));++l==7&&(r.showWeekNumber&&o.unshift(ut(f-u,t,n)),p.push(ft(o,r.isRTL)),o=[],l=0)}return ht(r,p)},isVisible:function(){return this._v},show:function(){this._v||(g(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(u(t,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var n=this._v;n!==!1&&(this._o.bound&&f(t,"click",this._onClick),this.el.style.cssText="",d(this.el,"is-hidden"),this._v=!1,n!==undefined&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){this.hide();f(this.el,"mousedown",this._onMouseDown,!0);f(this.el,"change",this._onChange);this._o.field&&(f(this._o.field,"change",this._onInputChange),this._o.bound&&(f(this._o.trigger,"click",this._onInputClick),f(this._o.trigger,"focus",this._onInputFocus),f(this._o.trigger,"blur",this._onInputBlur)));this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},b})},{moment:"moment"}],zeroclipboard:[function(t,i){
/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface.
 * Copyright (c) 2009-2014 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.2.0
 */
(function(t,r){"use strict";var e=t,c=e.document,k=e.navigator,rt=e.setTimeout,ci=e.clearTimeout,li=e.setInterval,ai=e.clearInterval,wt=e.getComputedStyle,et=e.encodeURIComponent,bt=e.ActiveXObject,vi=e.Error,yi=e.Number.parseInt||e.parseInt,nt=e.Number.parseFloat||e.parseFloat,pi=e.Number.isNaN||e.isNaN,kt=e.Date.now,dt=e.Object.keys,wi=e.Object.defineProperty,l=e.Object.prototype.hasOwnProperty,bi=e.Array.prototype.slice,ki=function(){var i=function(n){return n},n,t;if(typeof e.wrap=="function"&&typeof e.unwrap=="function")try{n=c.createElement("div");t=e.unwrap(n);n.nodeType===1&&t&&t.nodeType===1&&(i=e.unwrap)}catch(r){}return i}(),s=function(n){return bi.call(n,0)},h=function(){for(var i,n,h,u,e=s(arguments),f=e[0]||{},t=1,o=e.length;t<o;t++)if((i=e[t])!=null)for(n in i)l.call(i,n)&&(h=f[n],u=i[n],f!==u&&u!==r&&(f[n]=u));return f},d=function(n){var t,i,u,r;if(typeof n!="object"||n==null||typeof n.nodeType=="number")t=n;else if(typeof n.length=="number")for(t=[],i=0,u=n.length;i<u;i++)l.call(n,i)&&(t[i]=d(n[i]));else{t={};for(r in n)l.call(n,r)&&(t[r]=d(n[r]))}return t},di=function(n,t){for(var r={},i=0,u=t.length;i<u;i++)t[i]in n&&(r[t[i]]=n[t[i]]);return r},gi=function(n,t){var r={};for(var i in n)t.indexOf(i)===-1&&(r[i]=n[i]);return r},nr=function(n){if(n)for(var t in n)l.call(n,t)&&delete n[t];return n},gt=function(n,t){if(n&&n.nodeType===1&&n.ownerDocument&&t&&(t.nodeType===1&&t.ownerDocument&&t.ownerDocument===n.ownerDocument||t.nodeType===9&&!t.ownerDocument&&t===n.ownerDocument))do{if(n===t)return!0;n=n.parentNode}while(n);return!1},ni=function(n){var t;return typeof n=="string"&&n&&(t=n.split("#")[0].split("?")[0],t=n.slice(0,n.lastIndexOf("/")+1)),t},tr=function(n){var i,t;return typeof n=="string"&&n&&(t=n.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),t&&t[1]?i=t[1]:(t=n.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),t&&t[1]&&(i=t[1]))),i},ir=function(){var t,n;try{throw new vi;}catch(i){n=i}return n&&(t=n.sourceURL||n.fileName||tr(n.stack)),t},rr=function(){var t,n,i;if(c.currentScript&&(t=c.currentScript.src))return t;if(n=c.getElementsByTagName("script"),n.length===1)return n[0].src||r;if("readyState"in n[0])for(i=n.length;i--;)if(n[i].readyState==="interactive"&&(t=n[i].src))return t;return c.readyState==="loading"&&(t=n[n.length-1].src)?t:(t=ir())?t:r},ur=function(){for(var n,t,u=c.getElementsByTagName("script"),i=u.length;i--;){if(!(t=u[i].src)){n=null;break}if(t=ni(t),n==null)n=t;else if(n!==t){n=null;break}}return n||r},fr=function(){var n=ni(rr())||ur()||"";return n+"ZeroClipboard.swf"},ti=function(){return t.opener==null&&(!!t.top&&t!=t.top||!!t.parent&&t!=t.parent)}(),f={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},ii="11.0.0",p,w={},v,ot,y={},st=null,ht=0,ct=0,er={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},or=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],b=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],sr=new RegExp("^flash-("+b.map(function(n){return n.replace(/^flash-/,"")}).join("|")+")$"),hr=new RegExp("^flash-("+b.slice(1).map(function(n){return n.replace(/^flash-/,"")}).join("|")+")$"),o={swfPath:fr(),trustedDomains:t.location.host?[t.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},cr=function(n){if(typeof n=="object"&&n!==null)for(var t in n)if(l.call(n,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))o[t]=n[t];else if(f.bridge==null)if(t==="containerId"||t==="swfObjectId")if(uu(n[t]))o[t]=n[t];else throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");else o[t]=n[t];return typeof n=="string"&&n?l.call(o,n)?o[n]:void 0:d(o)},lr=function(){return yt(),{browser:di(k,["userAgent","platform","appName"]),flash:gi(f,["bridge"]),zeroclipboard:{version:u.version,config:u.config()}}},ar=function(){return!!(f.disabled||f.outdated||f.sandboxed||f.unavailable||f.degraded||f.deactivated)},vr=function(n,t){var i,o,e,s={};if(typeof n=="string"&&n)e=n.toLowerCase().split(/\s+/);else if(typeof n=="object"&&n&&typeof t=="undefined")for(i in n)if(l.call(n,i)&&typeof i=="string"&&i&&typeof n[i]=="function")u.on(i,n[i]);if(e&&e.length){for(i=0,o=e.length;i<o;i++)n=e[i].replace(/^on/,""),s[n]=!0,w[n]||(w[n]=[]),w[n].push(t);if(s.ready&&f.ready&&u.emit({type:"ready"}),s.error){for(i=0,o=b.length;i<o;i++)if(f[b[i].replace(/^flash-/,"")]===!0){u.emit({type:"error",name:b[i]});break}p!==r&&u.version!==p&&u.emit({type:"error",name:"version-mismatch",jsVersion:u.version,swfVersion:p})}}return u},yr=function(n,t){var i,o,e,f,r;if(arguments.length===0)f=dt(w);else if(typeof n=="string"&&n)f=n.split(/\s+/);else if(typeof n=="object"&&n&&typeof t=="undefined")for(i in n)l.call(n,i)&&typeof i=="string"&&i&&typeof n[i]=="function"&&u.off(i,n[i]);if(f&&f.length)for(i=0,o=f.length;i<o;i++)if(n=f[i].toLowerCase().replace(/^on/,""),r=w[n],r&&r.length)if(t)for(e=r.indexOf(t);e!==-1;)r.splice(e,1),e=r.indexOf(t,e);else r.length=0;return u},pr=function(n){return typeof n=="string"&&n?d(w[n])||null:d(w)},wr=function(n){var i,r,t;if(n=ri(n),n)return hu(n)?void 0:n.type==="ready"&&f.overdue===!0?u.emit({type:"error",name:"flash-overdue"}):(i=h({},n),ou.call(this,i),n.type==="copy"&&(t=pu(y),r=t.data,st=t.formatMap),r)},br=function(){var t=f.sandboxed,n;yt();typeof f.ready!="boolean"&&(f.ready=!1);f.sandboxed!==t&&f.sandboxed===!0?(f.ready=!1,u.emit({type:"error",name:"flash-sandboxed"})):u.isFlashUnusable()||f.bridge!==null||(n=o.flashLoadTimeout,typeof n=="number"&&n>=0&&(ht=rt(function(){typeof f.deactivated!="boolean"&&(f.deactivated=!0);f.deactivated===!0&&u.emit({type:"error",name:"flash-deactivated"})},n)),f.overdue=!1,vu())},kr=function(){u.clearData();u.blur();u.emit("destroy");yu();u.off()},dr=function(n,t){var i,r;if(typeof n=="object"&&n&&typeof t=="undefined")i=n,u.clearData();else if(typeof n=="string"&&n)i={},i[n]=t;else return;for(r in i)typeof r=="string"&&r&&l.call(i,r)&&typeof i[r]=="string"&&i[r]&&(y[r]=i[r])},gr=function(n){typeof n=="undefined"?(nr(y),st=null):typeof n=="string"&&l.call(y,n)&&delete y[n]},nu=function(n){return typeof n=="undefined"?d(y):typeof n=="string"&&l.call(y,n)?y[n]:void 0},tu=function(n){var t,i,r;n&&n.nodeType===1&&(v&&(it(v,o.activeClass),v!==n&&it(v,o.hoverClass)),v=n,ei(n,o.hoverClass),t=n.getAttribute("title")||o.title,typeof t=="string"&&t&&(i=tt(f.bridge),i&&i.setAttribute("title",t)),r=o.forceHandCursor===!0||oi(n,"cursor")==="pointer",rf(r),tf())},iu=function(){var n=tt(f.bridge);n&&(n.removeAttribute("title"),n.style.left="0px",n.style.top="-9999px",n.style.width="1px",n.style.height="1px");v&&(it(v,o.hoverClass),it(v,o.activeClass),v=null)},ru=function(){return v||null},uu=function(n){return typeof n=="string"&&n&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(n)},ri=function(n){var t,i;if(typeof n=="string"&&n?(t=n,n={}):typeof n=="object"&&n&&typeof n.type=="string"&&n.type&&(t=n.type),t)return t=t.toLowerCase(),!n.target&&(/^(copy|aftercopy|_click)$/.test(t)||t==="error"&&n.name==="clipboard-error")&&(n.target=ot),h(n,{type:t,target:n.target||v||null,relatedTarget:n.relatedTarget||null,currentTarget:f&&f.bridge||null,timeStamp:n.timeStamp||kt()||null}),i=er[n.type],n.type==="error"&&n.name&&i&&(i=i[n.name]),i&&(n.message=i),n.type==="ready"&&h(n,{target:null,version:f.version}),n.type==="error"&&(sr.test(n.name)&&h(n,{target:null,minimumVersion:ii}),hr.test(n.name)&&h(n,{version:f.version})),n.type==="copy"&&(n.clipboardData={setData:u.setData,clearData:u.clearData}),n.type==="aftercopy"&&(n=wu(n,st)),n.target&&!n.relatedTarget&&(n.relatedTarget=fu(n.target)),eu(n)},fu=function(n){var t=n&&n.getAttribute&&n.getAttribute("data-clipboard-target");return t?c.getElementById(t):null},eu=function(n){if(n&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(n.type)){var u=n.target,l=n.type==="_mouseover"&&n.relatedTarget?n.relatedTarget:r,a=n.type==="_mouseout"&&n.relatedTarget?n.relatedTarget:r,f=at(u),v=e.screenLeft||e.screenX||0,y=e.screenTop||e.screenY||0,p=c.body.scrollLeft+c.documentElement.scrollLeft,w=c.body.scrollTop+c.documentElement.scrollTop,o=f.left+(typeof n._stageX=="number"?n._stageX:0),s=f.top+(typeof n._stageY=="number"?n._stageY:0),t=o-p,i=s-w,b=v+t,k=y+i,d=typeof n.movementX=="number"?n.movementX:0,g=typeof n.movementY=="number"?n.movementY:0;delete n._stageX;delete n._stageY;h(n,{srcElement:u,fromElement:l,toElement:a,screenX:b,screenY:k,pageX:o,pageY:s,clientX:t,clientY:i,x:t,y:i,movementX:d,movementY:g,offsetX:0,offsetY:0,layerX:0,layerY:0})}return n},ui=function(n){var t=n&&typeof n.type=="string"&&n.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},fi=function(n,t,i,r){r?rt(function(){n.apply(t,i)},0):n.apply(t,i)},ou=function(n){var r,f,t,u,o,s;if(typeof n=="object"&&n&&n.type){var c=ui(n),l=w["*"]||[],a=w[n.type]||[],i=l.concat(a);if(i&&i.length)for(s=this,r=0,f=i.length;r<f;r++)t=i[r],u=s,typeof t=="string"&&typeof e[t]=="function"&&(t=e[t]),typeof t=="object"&&t&&typeof t.handleEvent=="function"&&(u=t,t=t.handleEvent),typeof t=="function"&&(o=h({},n),fi(t,u,[o],c));return this}},su=function(n){var t=null;return(ti===!1||n&&n.type==="error"&&n.name&&or.indexOf(n.name)!==-1)&&(t=!1),t},hu=function(n){var t=n.target||v||null,r=n._source==="swf",s,c,e,l,i;delete n._source;switch(n.type){case"error":s=n.name==="flash-sandboxed"||su(n);typeof s=="boolean"&&(f.sandboxed=s);b.indexOf(n.name)!==-1?h(f,{disabled:n.name==="flash-disabled",outdated:n.name==="flash-outdated",unavailable:n.name==="flash-unavailable",degraded:n.name==="flash-degraded",deactivated:n.name==="flash-deactivated",overdue:n.name==="flash-overdue",ready:!1}):n.name==="version-mismatch"&&(p=n.swfVersion,h(f,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}));ut();break;case"ready":p=n.swfVersion;c=f.deactivated===!0;h(f,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:c,ready:!c});ut();break;case"beforecopy":ot=t;break;case"copy":i=n.relatedTarget;!(y["text/html"]||y["text/plain"])&&i&&(l=i.value||i.outerHTML||i.innerHTML)&&(e=i.value||i.textContent||i.innerText)?(n.clipboardData.clearData(),n.clipboardData.setData("text/plain",e),l!==e&&n.clipboardData.setData("text/html",l)):!y["text/plain"]&&n.target&&(e=n.target.getAttribute("data-clipboard-text"))&&(n.clipboardData.clearData(),n.clipboardData.setData("text/plain",e));break;case"aftercopy":cu(n);u.clearData();t&&t!==gu()&&t.focus&&t.focus();break;case"_mouseover":u.focus(t);o.bubbleEvents===!0&&r&&(t&&t!==n.relatedTarget&&!gt(n.relatedTarget,t)&&g(h({},n,{type:"mouseenter",bubbles:!1,cancelable:!1})),g(h({},n,{type:"mouseover"})));break;case"_mouseout":u.blur();o.bubbleEvents===!0&&r&&(t&&t!==n.relatedTarget&&!gt(n.relatedTarget,t)&&g(h({},n,{type:"mouseleave",bubbles:!1,cancelable:!1})),g(h({},n,{type:"mouseout"})));break;case"_mousedown":ei(t,o.activeClass);o.bubbleEvents===!0&&r&&g(h({},n,{type:n.type.slice(1)}));break;case"_mouseup":it(t,o.activeClass);o.bubbleEvents===!0&&r&&g(h({},n,{type:n.type.slice(1)}));break;case"_click":ot=null;o.bubbleEvents===!0&&r&&g(h({},n,{type:n.type.slice(1)}));break;case"_mousemove":o.bubbleEvents===!0&&r&&g(h({},n,{type:n.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(n.type))return!0},cu=function(n){if(n.errors&&n.errors.length>0){var t=d(n);h(t,{type:"error",name:"clipboard-error"});delete t.success;rt(function(){u.emit(t)},0)}},g=function(n){if(n&&typeof n.type=="string"&&n){var i,r=n.target||null,u=r&&r.ownerDocument||c,f={view:u.defaultView||e,canBubble:!0,cancelable:!0,detail:n.type==="click"?1:0,button:typeof n.which=="number"?n.which-1:typeof n.button=="number"?n.button:u.createEvent?0:1},t=h(f,n);r&&u.createEvent&&r.dispatchEvent&&(t=[t.type,t.canBubble,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget],i=u.createEvent("MouseEvents"),i.initMouseEvent&&(i.initMouseEvent.apply(i,t),i._source="js",r.dispatchEvent(i)))}},lu=function(){var n=o.flashLoadTimeout,t,i;typeof n=="number"&&n>=0&&(t=Math.min(1e3,n/10),i=o.swfObjectId+"_fallbackContent",ct=li(function(){var n=c.getElementById(i);nf(n)&&(ut(),f.deactivated=null,u.emit({type:"error",name:"swf-not-found"}))},t))},au=function(){var n=c.createElement("div");return n.id=o.containerId,n.className=o.containerClass,n.style.position="absolute",n.style.left="0px",n.style.top="-9999px",n.style.width="1px",n.style.height="1px",n.style.zIndex=""+vt(o.zIndex),n},tt=function(n){for(var t=n&&n.parentNode;t&&t.nodeName==="OBJECT"&&t.parentNode;)t=t.parentNode;return t||null},vu=function(){var l,n=f.bridge,t=tt(n),r,i,s;if(!n){var a=du(e.location.host,o),y=a==="never"?"none":"all",p=ku(h({jsVersion:u.version},o)),v=o.swfPath+bu(o.swfPath,o);t=au();r=c.createElement("div");t.appendChild(r);c.body.appendChild(t);i=c.createElement("div");s=f.pluginType==="activex";i.innerHTML='<object id="'+o.swfObjectId+'" name="'+o.swfObjectId+'" width="100%" height="100%" '+(s?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+v+'"')+">"+(s?'<param name="movie" value="'+v+'"/>':"")+'<param name="allowScriptAccess" value="'+a+'"/><param name="allowNetworking" value="'+y+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+p+'"/><div id="'+o.swfObjectId+'_fallbackContent">&nbsp;<\/div><\/object>';n=i.firstChild;i=null;ki(n).ZeroClipboard=u;t.replaceChild(n,r);lu()}return n||(n=c[o.swfObjectId],n&&(l=n.length)&&(n=n[l-1]),!n&&t&&(n=t.firstChild)),f.bridge=n||null,n},yu=function(){var n=f.bridge,t;n&&(t=tt(n),t&&(f.pluginType==="activex"&&"readyState"in n?(n.style.display="none",function i(){if(n.readyState===4){for(var r in n)typeof n[r]=="function"&&(n[r]=null);n.parentNode&&n.parentNode.removeChild(n);t.parentNode&&t.parentNode.removeChild(t)}else rt(i,10)}()):(n.parentNode&&n.parentNode.removeChild(n),t.parentNode&&t.parentNode.removeChild(t))),ut(),f.ready=null,f.bridge=null,f.deactivated=null,p=r)},pu=function(n){var i={},r={},t;if(typeof n=="object"&&n){for(t in n)if(t&&l.call(n,t)&&typeof n[t]=="string"&&n[t])switch(t.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":i.text=n[t];r.text=t;break;case"text/html":case"html":case"air:html":case"flash:html":i.html=n[t];r.html=t;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":i.rtf=n[t];r.rtf=t}return{data:i,formatMap:r}}},wu=function(n,t){var r,i,f,o,e,u;if(!(typeof n=="object"&&n&&typeof t=="object"&&t))return n;r={};for(i in n)if(l.call(n,i))if(i==="errors")for(r[i]=n[i]?n[i].slice():[],f=0,o=r[i].length;f<o;f++)r[i][f].format=t[r[i][f].format];else if(i!=="success"&&i!=="data")r[i]=n[i];else{r[i]={};e=n[i];for(u in e)u&&l.call(e,u)&&l.call(t,u)&&(r[i][t[u]]=e[u])}return r},bu=function(n,t){var i=t==null||t&&t.cacheBust===!0;return i?(n.indexOf("?")===-1?"?":"&")+"noCache="+kt():""},ku=function(n){var r,o,u,t,i="",f=[];if(n.trustedDomains&&(typeof n.trustedDomains=="string"?t=[n.trustedDomains]:typeof n.trustedDomains=="object"&&"length"in n.trustedDomains&&(t=n.trustedDomains)),t&&t.length)for(r=0,o=t.length;r<o;r++)if(l.call(t,r)&&t[r]&&typeof t[r]=="string"){if(u=lt(t[r]),!u)continue;if(u==="*"){f.length=0;f.push(u);break}f.push.apply(f,[u,"//"+u,e.location.protocol+"//"+u])}return f.length&&(i+="trustedOrigins="+et(f.join(","))),n.forceEnhancedClipboard===!0&&(i+=(i?"&":"")+"forceEnhancedClipboard=true"),typeof n.swfObjectId=="string"&&n.swfObjectId&&(i+=(i?"&":"")+"swfObjectId="+et(n.swfObjectId)),typeof n.jsVersion=="string"&&n.jsVersion&&(i+=(i?"&":"")+"jsVersion="+et(n.jsVersion)),i},lt=function(n){var t,i;return n==null||n===""?null:(n=n.replace(/^\s+|\s+$/g,""),n==="")?null:(t=n.indexOf("//"),n=t===-1?n:n.slice(t+2),i=n.indexOf("/"),n=i===-1?n:t===-1||i===0?null:n.slice(0,i),n&&n.slice(-4).toLowerCase()===".swf")?null:n||null},du=function(){var n=function(n){var i,u,r,t=[];if(typeof n=="string"&&(n=[n]),!(typeof n=="object"&&n&&typeof n.length=="number"))return t;for(i=0,u=n.length;i<u;i++)if(l.call(n,i)&&(r=lt(n[i]))){if(r==="*"){t.length=0;t.push("*");break}t.indexOf(r)===-1&&t.push(r)}return t};return function(t,i){var f=lt(i.swfPath),r,u;if(f===null&&(f=t),r=n(i.trustedDomains),u=r.length,u>0){if(u===1&&r[0]==="*")return"always";if(r.indexOf(t)!==-1)return u===1&&t===f?"sameDomain":"always"}return"never"}}(),gu=function(){try{return c.activeElement}catch(n){return null}},ei=function(n,t){var i,u,f,r=[];if(typeof t=="string"&&t&&(r=t.split(/\s+/)),n&&n.nodeType===1&&r.length>0)if(n.classList)for(i=0,u=r.length;i<u;i++)n.classList.add(r[i]);else if(n.hasOwnProperty("className")){for(f=" "+n.className+" ",i=0,u=r.length;i<u;i++)f.indexOf(" "+r[i]+" ")===-1&&(f+=r[i]+" ");n.className=f.replace(/^\s+|\s+$/g,"")}return n},it=function(n,t){var i,u,f,r=[];if(typeof t=="string"&&t&&(r=t.split(/\s+/)),n&&n.nodeType===1&&r.length>0)if(n.classList&&n.classList.length>0)for(i=0,u=r.length;i<u;i++)n.classList.remove(r[i]);else if(n.className){for(f=(" "+n.className+" ").replace(/[\r\n\t]/g," "),i=0,u=r.length;i<u;i++)f=f.replace(" "+r[i]+" "," ");n.className=f.replace(/^\s+|\s+$/g,"")}return n},oi=function(n,t){var i=wt(n,null).getPropertyValue(t);return t==="cursor"&&(!i||i==="auto")&&n.nodeName==="A"?"pointer":i},at=function(n){var i={left:0,top:0,width:0,height:0},r,u;if(n.getBoundingClientRect){var t=n.getBoundingClientRect(),s=e.pageXOffset,h=e.pageYOffset,l=c.documentElement.clientLeft||0,a=c.documentElement.clientTop||0,f=0,o=0;oi(c.body,"position")==="relative"&&(r=c.body.getBoundingClientRect(),u=c.documentElement.getBoundingClientRect(),f=r.left-u.left||0,o=r.top-u.top||0);i.left=t.left+s-l-f;i.top=t.top+h-a-o;i.width="width"in t?t.width:t.right-t.left;i.height="height"in t?t.height:t.bottom-t.top}return i},nf=function(n){if(!n)return!1;var t=wt(n,null),r=nt(t.height)>0,u=nt(t.width)>0,f=nt(t.top)>=0,e=nt(t.left)>=0,o=r&&u&&f&&e,i=o?null:at(n);return t.display!=="none"&&t.visibility!=="collapse"&&(o||!!i&&(r||i.height>0)&&(u||i.width>0)&&(f||i.top>=0)&&(e||i.left>=0))},ut=function(){ci(ht);ht=0;ai(ct);ct=0},tf=function(){var t,n;v&&(t=tt(f.bridge))&&(n=at(v),h(t.style,{width:n.width+"px",height:n.height+"px",top:n.top+"px",left:n.left+"px",zIndex:""+vt(o.zIndex)}))},rf=function(n){f.ready===!0&&(f.bridge&&typeof f.bridge.setHandCursor=="function"?f.bridge.setHandCursor(n):f.ready=!1)},vt=function(n){if(/^(?:auto|inherit)$/.test(n))return n;var t;return typeof n!="number"||pi(n)?typeof n=="string"&&(t=vt(yi(n,10))):t=n,typeof t=="number"?t:"auto"},yt=function(n){var e,r,u,s=f.sandboxed,i=null;if(n=n===!0,ti===!1)i=!1;else{try{r=t.frameElement||null}catch(o){u={name:o.name,message:o.message}}if(r&&r.nodeType===1&&r.nodeName==="IFRAME")try{i=r.hasAttribute("sandbox")}catch(o){i=null}else{try{e=document.domain||null}catch(o){e=null}(e===null||u&&u.name==="SecurityError"&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(u.message.toLowerCase()))&&(i=!0)}}return f.sandboxed=i,s===i||n||si(bt),i},si=function(n){function e(n){var t=n.match(/[\d]+/g);return t.length=3,t.join(".")}function l(n){return!!n&&(n=n.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(n)||n.slice(-13)==="chrome.plugin")}function c(n){n&&(i=!0,n.version&&(t=e(n.version)),!t&&n.description&&(t=e(n.description)),n.filename&&(h=l(n.filename)))}var u,r,o,i=!1,s=!1,h=!1,t="";if(k.plugins&&k.plugins.length)u=k.plugins["Shockwave Flash"],c(u),k.plugins["Shockwave Flash 2.0"]&&(i=!0,t="2.0.0.11");else if(k.mimeTypes&&k.mimeTypes.length)o=k.mimeTypes["application/x-shockwave-flash"],u=o&&o.enabledPlugin,c(u);else if(typeof n!="undefined"){s=!0;try{r=new n("ShockwaveFlash.ShockwaveFlash.7");i=!0;t=e(r.GetVariable("$version"))}catch(a){try{r=new n("ShockwaveFlash.ShockwaveFlash.6");i=!0;t="6.0.21"}catch(v){try{r=new n("ShockwaveFlash.ShockwaveFlash");i=!0;t=e(r.GetVariable("$version"))}catch(y){s=!1}}}}f.disabled=i!==!0;f.outdated=t&&nt(t)<nt(ii);f.version=t||"0.0.0";f.pluginType=h?"pepper":s?"activex":i?"netscape":"unknown"},u;si(bt);yt(!0);u=function(){if(!(this instanceof u))return new u;typeof u._createClient=="function"&&u._createClient.apply(this,s(arguments))};wi(u,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0});u.config=function(){return cr.apply(this,s(arguments))};u.state=function(){return lr.apply(this,s(arguments))};u.isFlashUnusable=function(){return ar.apply(this,s(arguments))};u.on=function(){return vr.apply(this,s(arguments))};u.off=function(){return yr.apply(this,s(arguments))};u.handlers=function(){return pr.apply(this,s(arguments))};u.emit=function(){return wr.apply(this,s(arguments))};u.create=function(){return br.apply(this,s(arguments))};u.destroy=function(){return kr.apply(this,s(arguments))};u.setData=function(){return dr.apply(this,s(arguments))};u.clearData=function(){return gr.apply(this,s(arguments))};u.getData=function(){return nu.apply(this,s(arguments))};u.focus=u.activate=function(){return tu.apply(this,s(arguments))};u.blur=u.deactivate=function(){return iu.apply(this,s(arguments))};u.activeElement=function(){return ru.apply(this,s(arguments))};var uf=0,a={},ff=0,ft={},pt={};h(o,{autoActivate:!0});var ef=function(n){var t=this;t.id=""+uf++;a[t.id]={instance:t,elements:[],handlers:{}};n&&t.clip(n);u.on("*",function(n){return t.emit(n)});u.on("destroy",function(){t.destroy()});u.create()},of=function(n,t){var i,o,e,s={},h=a[this.id],c=h&&h.handlers;if(!h)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if(typeof n=="string"&&n)e=n.toLowerCase().split(/\s+/);else if(typeof n=="object"&&n&&typeof t=="undefined")for(i in n)if(l.call(n,i)&&typeof i=="string"&&i&&typeof n[i]=="function")this.on(i,n[i]);if(e&&e.length){for(i=0,o=e.length;i<o;i++)n=e[i].replace(/^on/,""),s[n]=!0,c[n]||(c[n]=[]),c[n].push(t);if(s.ready&&f.ready&&this.emit({type:"ready",client:this}),s.error){for(i=0,o=b.length;i<o;i++)if(f[b[i].replace(/^flash-/,"")]){this.emit({type:"error",name:b[i],client:this});break}p!==r&&u.version!==p&&this.emit({type:"error",name:"version-mismatch",jsVersion:u.version,swfVersion:p})}}return this},sf=function(n,t){var i,o,f,u,r,s=a[this.id],e=s&&s.handlers;if(!e)return this;if(arguments.length===0)u=dt(e);else if(typeof n=="string"&&n)u=n.split(/\s+/);else if(typeof n=="object"&&n&&typeof t=="undefined")for(i in n)l.call(n,i)&&typeof i=="string"&&i&&typeof n[i]=="function"&&this.off(i,n[i]);if(u&&u.length)for(i=0,o=u.length;i<o;i++)if(n=u[i].toLowerCase().replace(/^on/,""),r=e[n],r&&r.length)if(t)for(f=r.indexOf(t);f!==-1;)r.splice(f,1),f=r.indexOf(t,f);else r.length=0;return this},hf=function(n){var i=null,t=a[this.id]&&a[this.id].handlers;return t&&(i=typeof n=="string"&&n?t[n]?t[n].slice(0):[]:d(t)),i},cf=function(n){if(pf.call(this,n)){typeof n=="object"&&n&&typeof n.type=="string"&&n.type&&(n=h({},n));var t=h({},ri(n),{client:this});wf.call(this,t)}return this},lf=function(n){var t,i;if(!a[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");for(n=hi(n),t=0;t<n.length;t++)l.call(n,t)&&n[t]&&n[t].nodeType===1&&(n[t].zcClippingId?ft[n[t].zcClippingId].indexOf(this.id)===-1&&ft[n[t].zcClippingId].push(this.id):(n[t].zcClippingId="zcClippingId_"+ff++,ft[n[t].zcClippingId]=[this.id],o.autoActivate===!0&&bf(n[t])),i=a[this.id]&&a[this.id].elements,i.indexOf(n[t])===-1&&i.push(n[t]));return this},af=function(n){var f=a[this.id],u,i,t,r;if(!f)return this;for(u=f.elements,n=typeof n=="undefined"?u.slice(0):hi(n),t=n.length;t--;)if(l.call(n,t)&&n[t]&&n[t].nodeType===1){for(i=0;(i=u.indexOf(n[t],i))!==-1;)u.splice(i,1);if(r=ft[n[t].zcClippingId],r){for(i=0;(i=r.indexOf(this.id,i))!==-1;)r.splice(i,1);r.length===0&&(o.autoActivate===!0&&kf(n[t]),delete n[t].zcClippingId)}}return this},vf=function(){var n=a[this.id];return n&&n.elements?n.elements.slice(0):[]},yf=function(){a[this.id]&&(this.unclip(),this.off(),delete a[this.id])},pf=function(n){if(!(n&&n.type)||n.client&&n.client!==this)return!1;var i=a[this.id],t=i&&i.elements,r=!!t&&t.length>0,u=!n.target||r&&t.indexOf(n.target)!==-1,f=n.relatedTarget&&r&&t.indexOf(n.relatedTarget)!==-1,e=n.client&&n.client===this;return!i||!(u||f||e)?!1:!0},wf=function(n){var i=a[this.id],u,o,t,f,s,c;if(typeof n=="object"&&n&&n.type&&i){var l=ui(n),v=i&&i.handlers["*"]||[],y=i&&i.handlers[n.type]||[],r=v.concat(y);if(r&&r.length)for(c=this,u=0,o=r.length;u<o;u++)t=r[u],f=c,typeof t=="string"&&typeof e[t]=="function"&&(t=e[t]),typeof t=="object"&&t&&typeof t.handleEvent=="function"&&(f=t,t=t.handleEvent),typeof t=="function"&&(s=h({},n),fi(t,f,[s],l))}},hi=function(n){return typeof n=="string"&&(n=[]),typeof n.length!="number"?[n]:n},bf=function(n){if(n&&n.nodeType===1){var t=function(n){(n||(n=e.event))&&(n._source!=="js"&&(n.stopImmediatePropagation(),n.preventDefault()),delete n._source)},i=function(i){(i||(i=e.event))&&(t(i),u.focus(n))};n.addEventListener("mouseover",i,!1);n.addEventListener("mouseout",t,!1);n.addEventListener("mouseenter",t,!1);n.addEventListener("mouseleave",t,!1);n.addEventListener("mousemove",t,!1);pt[n.zcClippingId]={mouseover:i,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},kf=function(n){var t,r,u,f,i,e;if(n&&n.nodeType===1&&(t=pt[n.zcClippingId],typeof t=="object"&&t)){for(f=["move","leave","enter","out","over"],i=0,e=f.length;i<e;i++)r="mouse"+f[i],u=t[r],typeof u=="function"&&n.removeEventListener(r,u,!1);delete pt[n.zcClippingId]}};u._createClient=function(){ef.apply(this,s(arguments))};u.prototype.on=function(){return of.apply(this,s(arguments))};u.prototype.off=function(){return sf.apply(this,s(arguments))};u.prototype.handlers=function(){return hf.apply(this,s(arguments))};u.prototype.emit=function(){return cf.apply(this,s(arguments))};u.prototype.clip=function(){return lf.apply(this,s(arguments))};u.prototype.unclip=function(){return af.apply(this,s(arguments))};u.prototype.elements=function(){return vf.apply(this,s(arguments))};u.prototype.destroy=function(){return yf.apply(this,s(arguments))};u.prototype.setText=function(n){if(!a[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return u.setData("text/plain",n),this};u.prototype.setHtml=function(n){if(!a[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return u.setData("text/html",n),this};u.prototype.setRichText=function(n){if(!a[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return u.setData("application/rtf",n),this};u.prototype.setData=function(){if(!a[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return u.setData.apply(this,s(arguments)),this};u.prototype.clearData=function(){if(!a[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return u.clearData.apply(this,s(arguments)),this};u.prototype.getData=function(){if(!a[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return u.getData.apply(this,s(arguments))};typeof n=="function"&&n.amd?n(function(){return u}):typeof i=="object"&&i&&typeof i.exports=="object"&&i.exports?i.exports=u:t.ZeroClipboard=u})(function(){return this||window}())},{}]},{},[23,47,48,49,65,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,66,67,68,69,86,87,88,72,73,74,75,76,77,31,35,32,33,40,34,36,37,38,39])("zeroclipboard")});