/**
 * @license
 * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>
 * Build: `lodash modern -o ./dist/lodash.js`
 * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <http://lodash.com/license>
 */
(function(){function l(n,t,i){for(var r=(i||0)-1,u=n?n.length:0;++r<u;)if(n[r]===t)return r;return-1}function it(n,t){var i=typeof t,r;return(n=n.cache,i=="boolean"||t==null)?n[t]?0:-1:(i!="number"&&i!="string"&&(i="object"),r=i=="number"?t:ft+t,n=(n=n[i])&&n[r],i=="object"?n&&l(n,t)>-1?0:-1:n?0:-1)}function hi(n){var u=this.cache,t=typeof n,i,r;t=="boolean"||n==null?u[n]=!0:(t!="number"&&t!="string"&&(t="object"),i=t=="number"?n:ft+n,r=u[t]||(u[t]={}),t=="object"?(r[i]||(r[i]=[])).push(n):r[i]=!0)}function wt(n){return n.charCodeAt(0)}function ci(n,t){for(var f=n.criteria,e=t.criteria,u=-1,o=f.length,i,r;++u<o;)if(i=f[u],r=e[u],i!==r){if(i>r||typeof i=="undefined")return 1;if(i<r||typeof r=="undefined")return-1}return n.index-t.index}function ot(n){var u=-1,r=n.length,f=n[0],e=n[r/2|0],o=n[r-1],t,i;if(f&&typeof f=="object"&&e&&typeof e=="object"&&o&&typeof o=="object")return!1;for(t=st(),t["false"]=t["null"]=t["true"]=t.undefined=!1,i=st(),i.array=n,i.cache=t,i.push=hi;++u<r;)i.push(n[u]);return i}function li(n){return"\\"+oi[n]}function u(){return rt.pop()||[]}function st(){return ut.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function i(n){n.length=0;rt.length<ct&&rt.push(n)}function k(n){var t=n.cache;t&&k(t);n.array=n.cache=n.criteria=n.object=n.number=n.string=n.value=null;ut.length<ct&&ut.push(n)}function n(n,t,i){t||(t=0);typeof i=="undefined"&&(i=n?n.length:0);for(var r=-1,u=i-t||0,f=Array(u<0?0:u);++r<u;)f[r]=n[t+r];return f}function ht(c){function nt(n){return n&&typeof n=="object"&&!ut(n)&&oi.call(n,"__wrapped__")?n:new rr(n)}function rr(n,t){this.__chain__=!!t;this.__wrapped__=n}function eo(t){function r(){var t,e,o;return(u&&(t=n(u),lr.apply(t,arguments)),this instanceof r)?(e=yr(i.prototype),o=i.apply(e,t||arguments),hi(o)?o:e):i.apply(f,t||arguments)}var i=t[0],u=t[2],f=t[4];return ru(r,t),r}function pu(t,f,e,o,s){var c,d,v,l,a,g,k;if(e&&(c=e(t),typeof c!="undefined"))return c;if(d=hi(t),d){if(v=ct.call(t),!r[v])return t;l=di[v];switch(v){case y:case p:return new l(+t);case w:case h:return new l(t);case b:return c=l(t.source,ti.exec(t)),c.lastIndex=t.lastIndex,c}}else return t;if(a=ut(t),f){for(g=!o,o||(o=u()),s||(s=u()),k=o.length;k--;)if(o[k]==t)return s[k];c=a?l(t.length):{}}else c=a?n(t):fu({},t);return(a&&(oi.call(t,"index")&&(c.index=t.index),oi.call(t,"input")&&(c.input=t.input)),!f)?c:(o.push(t),s.push(c),(a?ai:tt)(t,function(n,t){c[t]=pu(n,f,e,o,s)}),g&&(i(o),i(s)),c)}function yr(n){return hi(n)?nu(n):{}}function vi(n,t,i){var r,u;if(typeof n!="function")return uf;if(typeof t=="undefined"||!("prototype"in n)||(r=n.__bindData__,typeof r=="undefined"&&(or.funcNames&&(r=!n.name),r=r||!or.funcDecomp,r||(u=io.call(n),or.funcNames||(r=!ii.test(u)),r||(r=vt.test(u),ru(n,r)))),r===!1||r!==!0&&r[1]&1))return n;switch(i){case 1:return function(i){return n.call(t,i)};case 2:return function(i,r){return n.call(t,i,r)};case 3:return function(i,r,u){return n.call(t,i,r,u)};case 4:return function(i,r,u,f){return n.call(t,i,r,u,f)}}return le(n,t)}function cf(t){function f(){var y=c?o:this,t,p;return(e&&(t=n(e),lr.apply(t,arguments)),(u||h)&&(t||(t=n(arguments)),u&&lr.apply(t,u),h&&t.length<s))?(i|=16,cf([r,a?i:i&-4,t,null,o,s])):(t||(t=arguments),l&&(r=y[v]),this instanceof f)?(y=yr(r.prototype),p=r.apply(y,t),hi(p)?p:y):r.apply(y,t)}var r=t[0],i=t[1],e=t[2],u=t[3],o=t[4],s=t[5],c=i&1,l=i&2,h=i&4,a=i&8,v=r;return ru(f,t),f}function pr(n,t){var e=-1,i=iu(),o=n?n.length:0,r=o>=et&&i===l,s=[],u,f;for(r&&(u=ot(t),u?(i=it,t=u):r=!1);++e<o;)f=n[e],i(t,f)<0&&s.push(f);return r&&k(t),s}function nr(n,t,i,r){for(var e=(r||0)-1,h=n?n.length:0,f=[],u;++e<h;)if(u=n[e],u&&typeof u=="object"&&typeof u.length=="number"&&(ut(u)||uu(u))){t||(u=nr(u,t,i));var o=-1,s=u.length,c=f.length;for(f.length+=s;++o<s;)f[c++]=u[o]}else i||f.push(u);return f}function sr(n,r,f,e,o,c){var l,ht,lt,d,it,ut,ft,et,nt,tt,at,g,k,ot,st;if(f&&(l=f(n,r),typeof l!="undefined"))return!!l;if(n===r)return n!==0||1/n==1/r;if(ht=typeof n,lt=typeof r,n===n&&!(n&&t[ht])&&!(r&&t[lt]))return!1;if(n==null||r==null)return n===r;if(d=ct.call(n),it=ct.call(r),d==a&&(d=s),it==a&&(it=s),d!=it)return!1;switch(d){case y:case p:return+n==+r;case w:return n!=+n?r!=+r:n==0?1/n==1/r:n==+r;case b:case h:return n==gi(r)}if(ut=d==v,!ut){if(ft=oi.call(n,"__wrapped__"),et=oi.call(r,"__wrapped__"),ft||et)return sr(ft?n.__wrapped__:n,et?r.__wrapped__:r,f,e,o,c);if(d!=s||(nt=n.constructor,tt=r.constructor,nt!=tt&&!(rt(nt)&&nt instanceof nt&&rt(tt)&&tt instanceof tt)&&"constructor"in n&&"constructor"in r))return!1}for(at=!o,o||(o=u()),c||(c=u()),g=o.length;g--;)if(o[g]==n)return c[g]==r;if(k=0,l=!0,o.push(n),c.push(r),ut){if(g=n.length,k=r.length,l=k==g,l||e)while(k--)if(ot=g,st=r[k],e){while(ot--)if(l=sr(n[ot],st,f,e,o,c))break}else if(!(l=sr(n[k],st,f,e,o,c)))break}else bi(r,function(t,i,r){if(oi.call(r,i))return k++,l=oi.call(n,i)&&sr(n[i],t,f,e,o,c)}),l&&!e&&bi(n,function(n,t,i){if(oi.call(i,t))return l=--k>-1});return o.pop(),c.pop(),at&&(i(o),i(c)),l}function lf(n,t,i,r,u){(ut(t)?ai:tt)(t,function(t,f){var c,l,o=t,e=n[f],s,h;if(t&&((l=ut(t))||ou(t))){for(s=r.length;s--;)if(c=r[s]==t){e=u[s];break}c||(i&&(o=i(e,t),(h=typeof o!="undefined")&&(e=o)),h||(e=l?ut(e)?e:[]:ou(e)?e:{}),r.push(t),u.push(e),h||lf(e,t,i,r,u))}else i&&(o=i(e,t),typeof o=="undefined"&&(o=t)),typeof o!="undefined"&&(e=o);n[f]=e})}function wu(n,t){return n+to(hf()*(t-n+1))}function bu(n,t,r){var e=-1,c=iu(),v=n?n.length:0,a=[],o=!t&&v>=et&&c===l,f=r||o?u():a,y,s,h;for(o&&(y=ot(f),c=it,f=y);++e<v;)s=n[e],h=r?r(s,e,n):s,(t?!e||f[f.length-1]!==h:c(f,h)<0)&&((r||o)&&f.push(h),a.push(s));return o?(i(f.array),k(f)):r&&i(f),a}function ku(n){return function(t,i,r){var f={},u,e,o;if(i=nt.createCallback(i,r,3),u=-1,e=t?t.length:0,typeof e=="number")while(++u<e)o=t[u],n(f,o,i(o,u,t),t);else tt(t,function(t,r,u){n(f,t,i(t,r,u),u)});return f}}function wi(t,i,r,u,f,e){var c=i&1,a=i&2,v=i&4,y=i&8,s=i&16,h=i&32,o,l;if(!a&&!rt(t))throw new ki;return(s&&!r.length&&(i&=-17,s=r=!1),h&&!u.length&&(i&=-33,h=u=!1),o=t&&t.__bindData__,o&&o!==!0)?(o=n(o),o[2]&&(o[2]=n(o[2])),o[3]&&(o[3]=n(o[3])),!c||o[1]&1||(o[4]=f),!c&&o[1]&1&&(i|=8),!v||o[1]&4||(o[5]=e),s&&lr.apply(o[2]||(o[2]=[]),r),h&&ro.apply(o[3]||(o[3]=[]),u),o[1]|=i,wi.apply(null,o)):(l=i==1||i===17?eo:cf,l([t,i,r,u,f,e]))}function oo(n){return du[n]}function iu(){var n=(n=nt.indexOf)===ee?l:n;return n}function tr(n){return typeof n=="function"&&ge.test(n)}function af(n){var t,i;return!(n&&ct.call(n)==s)||(t=n.constructor,rt(t)&&!(t instanceof t))?!1:(bi(n,function(n,t){i=t}),typeof i=="undefined"||oi.call(n,i))}function so(n){return vf[n]}function uu(n){return n&&typeof n=="object"&&typeof n.length=="number"&&ct.call(n)==a||!1}function ao(n,t,i,r){return typeof t!="boolean"&&t!=null&&(r=i,i=t,t=!1),pu(n,t,typeof i=="function"&&vi(i,r,1))}function vo(n,t,i){return pu(n,!0,typeof t=="function"&&vi(t,i,1))}function yo(n,t){var i=yr(n);return t?fu(i,t):i}function po(n,t,i){var r;return t=nt.createCallback(t,i,3),tt(n,function(n,i,u){if(t(n,i,u))return r=i,!1}),r}function wo(n,t,i){var r;return t=nt.createCallback(t,i,3),yf(n,function(n,i,u){if(t(n,i,u))return r=i,!1}),r}function bo(n,t,i){var r=[],u;for(bi(n,function(n,t){r.push(t,n)}),u=r.length,t=vi(t,i,3);u--;)if(t(r[u--],r[u],n)===!1)break;return n}function yf(n,t,i){var u=si(n),f=u.length,r;for(t=vi(t,i,3);f--;)if(r=u[f],t(n[r],r,n)===!1)break;return n}function wr(n){var t=[];return bi(n,function(n,i){rt(n)&&t.push(i)}),t.sort()}function ko(n,t){return n?oi.call(n,t):!1}function pf(n){for(var i=-1,r=si(n),f=r.length,u={},t;++i<f;)t=r[i],u[n[t]]=t;return u}function go(n){return n===!0||n===!1||n&&typeof n=="object"&&ct.call(n)==y||!1}function ns(n){return n&&typeof n=="object"&&ct.call(n)==p||!1}function ts(n){return n&&n.nodeType===1||!1}function is(n){var i=!0,t,r;return n?(t=ct.call(n),r=n.length,t==v||t==h||t==a||t==s&&typeof r=="number"&&rt(n.splice))?!r:(tt(n,function(){return i=!1}),i):i}function rs(n,t,i,r){return sr(n,t,typeof i=="function"&&vi(i,r,2))}function us(n){return uo(n)&&!fo(parseFloat(n))}function rt(n){return typeof n=="function"}function hi(n){return!!(n&&t[typeof n])}function fs(n){return wf(n)&&n!=+n}function es(n){return n===null}function wf(n){return typeof n=="number"||n&&typeof n=="object"&&ct.call(n)==w||!1}function os(n){return n&&typeof n=="object"&&ct.call(n)==b||!1}function br(n){return typeof n=="string"||n&&typeof n=="object"&&ct.call(n)==h||!1}function ss(n){return typeof n=="undefined"}function hs(n,t,i){var r={};return t=nt.createCallback(t,i,3),tt(n,function(n,i,u){r[i]=t(n,i,u)}),r}function cs(t){var f=arguments,r=2,e;if(!hi(t))return t;typeof f[2]!="number"&&(r=f.length);r>3&&typeof f[r-2]=="function"?e=vi(f[--r-1],f[r--],2):r>2&&typeof f[r-1]=="function"&&(e=f[--r]);for(var c=n(arguments,1,r),o=-1,s=u(),h=u();++o<r;)lf(t,c[o],e,s,h);return i(s),i(h),t}function ls(n,t,i){var u={},r,f,o,e;if(typeof t!="function")for(r=[],bi(n,function(n,t){r.push(t)}),r=pr(r,nr(arguments,!0,!1,1)),f=-1,o=r.length;++f<o;)e=r[f],u[e]=n[e];else t=nt.createCallback(t,i,3),bi(n,function(n,i,r){t(n,i,r)||(u[i]=n)});return u}function as(n){for(var t=-1,r=si(n),u=r.length,f=yi(u),i;++t<u;)i=r[t],f[t]=[i,n[i]];return f}function vs(n,t,i){var u={},r;if(typeof t!="function")for(var f=-1,e=nr(arguments,!0,!1,1),o=hi(n)?e.length:0;++f<o;)r=e[f],r in n&&(u[r]=n[r]);else t=nt.createCallback(t,i,3),bi(n,function(n,i,r){t(n,i,r)&&(u[i]=n)});return u}function ys(n,t,i,r){var f=ut(n),u,e;return i==null&&(f?i=[]:(u=n&&n.constructor,e=u&&u.prototype,i=yr(e))),t&&(t=nt.createCallback(t,r,4),(f?ai:tt)(n,function(n,r,u){return t(i,n,r,u)})),i}function su(n){for(var t=-1,i=si(n),r=i.length,u=yi(r);++t<r;)u[t]=n[i[t]];return u}function ps(n){for(var t=arguments,i=-1,r=nr(t,!0,!1,1),u=t[2]&&t[2][t[1]]===n?1:r.length,f=yi(u);++i<u;)f[i]=n[r[i]];return f}function bf(n,t,i){var e=-1,u=iu(),f=n?n.length:0,r=!1;return i=(i<0?pi(0,f+i):i)||0,ut(n)?r=u(n,t,i)>-1:typeof f=="number"?r=(br(n)?n.indexOf(t,i):u(n,t,i))>-1:tt(n,function(n){if(++e>=i)return!(r=n===t)}),r}function df(n,t,i){var u=!0,r,f;if(t=nt.createCallback(t,i,3),r=-1,f=n?n.length:0,typeof f=="number"){while(++r<f)if(!(u=!!t(n[r],r,n)))break}else tt(n,function(n,i,r){return u=!!t(n,i,r)});return u}function hu(n,t,i){var u=[],r,f,e;if(t=nt.createCallback(t,i,3),r=-1,f=n?n.length:0,typeof f=="number")while(++r<f)e=n[r],t(e,r,n)&&u.push(e);else tt(n,function(n,i,r){t(n,i,r)&&u.push(n)});return u}function gu(n,t,i){var r,u,f,e;if(t=nt.createCallback(t,i,3),r=-1,u=n?n.length:0,typeof u=="number"){while(++r<u)if(f=n[r],t(f,r,n))return f}else return tt(n,function(n,i,r){if(t(n,i,r))return e=n,!1}),e}function ws(n,t,i){var r;return t=nt.createCallback(t,i,3),cu(n,function(n,i,u){if(t(n,i,u))return r=n,!1}),r}function ai(n,t,i){var r=-1,u=n?n.length:0;if(t=t&&typeof i=="undefined"?t:vi(t,i,3),typeof u=="number"){while(++r<u)if(t(n[r],r,n)===!1)break}else tt(n,t);return n}function cu(n,t,i){var r=n?n.length:0,u;if(t=t&&typeof i=="undefined"?t:vi(t,i,3),typeof r=="number"){while(r--)if(t(n[r],r,n)===!1)break}else u=si(n),r=u.length,tt(n,function(n,i,f){return i=u?u[--r]:--r,t(f[i],i,f)});return n}function bs(t,i){var f=n(arguments,2),e=-1,o=typeof i=="function",r=t?t.length:0,u=yi(typeof r=="number"?r:0);return ai(t,function(n){u[++e]=(o?i:n[i]).apply(n,f)}),u}function kr(n,t,i){var r=-1,f=n?n.length:0,u;if(t=nt.createCallback(t,i,3),typeof f=="number")for(u=yi(f);++r<f;)u[r]=t(n[r],r,n);else u=[],tt(n,function(n,i,f){u[++r]=t(n,i,f)});return u}function te(n,t,i){var u=-Infinity,r=u,f,o,e;if(typeof t!="function"&&i&&i[t]===n&&(t=null),t==null&&ut(n))for(f=-1,o=n.length;++f<o;)e=n[f],e>r&&(r=e);else t=t==null&&br(n)?wt:nt.createCallback(t,i,3),ai(n,function(n,i,f){var e=t(n,i,f);e>u&&(u=e,r=n)});return r}function ks(n,t,i){var u=Infinity,r=u,f,o,e;if(typeof t!="function"&&i&&i[t]===n&&(t=null),t==null&&ut(n))for(f=-1,o=n.length;++f<o;)e=n[f],e<r&&(r=e);else t=t==null&&br(n)?wt:nt.createCallback(t,i,3),ai(n,function(n,i,f){var e=t(n,i,f);e<u&&(u=e,r=n)});return r}function nf(n,t,i,r){var f,u,e;if(!n)return i;if(f=arguments.length<3,t=nt.createCallback(t,r,4),u=-1,e=n.length,typeof e=="number")for(f&&(i=n[++u]);++u<e;)i=t(i,n[u],u,n);else tt(n,function(n,r,u){i=f?(f=!1,n):t(i,n,r,u)});return i}function ie(n,t,i,r){var u=arguments.length<3;return t=nt.createCallback(t,r,4),cu(n,function(n,r,f){i=u?(u=!1,n):t(i,n,r,f)}),i}function ds(n,t,i){return t=nt.createCallback(t,i,3),hu(n,function(n,i,r){return!t(n,i,r)})}function gs(n,t,i){if(n&&typeof n.length!="number"&&(n=su(n)),t==null||i)return n?n[wu(0,n.length-1)]:o;var r=re(n);return r.length=vr(pi(0,t),r.length),r}function re(n){var i=-1,r=n?n.length:0,t=yi(typeof r=="number"?r:0);return ai(n,function(n){var r=wu(0,++i);t[i]=t[r];t[r]=n}),t}function nh(n){var t=n?n.length:0;return typeof t=="number"?t:si(n).length}function ue(n,t,i){var u,r,f;if(t=nt.createCallback(t,i,3),r=-1,f=n?n.length:0,typeof f=="number"){while(++r<f)if(u=t(n[r],r,n))break}else tt(n,function(n,i,r){return!(u=t(n,i,r))});return!!u}function th(n,t,r){var h=-1,s=ut(t),f=n?n.length:0,e=yi(typeof f=="number"?f:0),o;for(s||(t=nt.createCallback(t,r,3)),ai(n,function(n,i,r){var f=e[++h]=st();s?f.criteria=kr(t,function(t){return n[t]}):(f.criteria=u())[0]=t(n,i,r);f.index=h;f.value=n}),f=e.length,e.sort(ci);f--;)o=e[f],e[f]=o.value,s||i(o.criteria),k(o);return e}function ih(t){return t&&typeof t.length=="number"?n(t):su(t)}function rh(n){for(var i=-1,u=n?n.length:0,r=[],t;++i<u;)t=n[i],t&&r.push(t);return r}function uh(n){return pr(n,nr(arguments,!0,!0,1))}function fh(n,t,i){var r=-1,u=n?n.length:0;for(t=nt.createCallback(t,i,3);++r<u;)if(t(n[r],r,n))return r;return-1}function eh(n,t,i){var r=n?n.length:0;for(t=nt.createCallback(t,i,3);r--;)if(t(n[r],r,n))return r;return-1}function tf(t,i,r){var u=0,e=t?t.length:0,f;if(typeof i!="number"&&i!=null)for(f=-1,i=nt.createCallback(i,r,3);++f<e&&i(t[f],f,t);)u++;else if(u=i,u==null||r)return t?t[0]:o;return n(t,0,vr(pi(0,u),e))}function oh(n,t,i,r){return typeof t!="boolean"&&t!=null&&(r=i,i=typeof t!="function"&&r&&r[t]===n?null:t,t=!1),i!=null&&(n=kr(n,i,r)),nr(n,t)}function ee(n,t,i){var u,r;if(typeof i=="number")u=n?n.length:0,i=i<0?pi(0,u+i):i||0;else if(i)return r=oe(n,t),n[r]===t?r:-1;return l(n,t,i)}function sh(t,i,r){var u=0,e=t?t.length:0,f;if(typeof i!="number"&&i!=null)for(f=e,i=nt.createCallback(i,r,3);f--&&i(t[f],f,t);)u++;else u=i==null||r?1:i||u;return n(t,0,vr(pi(0,e-u),e))}function hh(){for(var e=[],r=-1,o=arguments.length,f=u(),h=iu(),y=h===l,s=u(),n,t;++r<o;)n=arguments[r],(ut(n)||uu(n))&&(e.push(n),f.push(y&&n.length>=et&&ot(r?e[r]:s)));var c=e[0],a=-1,p=c?c.length:0,v=[];n:while(++a<p)if(t=f[0],n=c[a],(t?it(t,n):h(s,n))<0){for(r=o,(t||s).push(n);--r;)if(t=f[r],(t?it(t,n):h(e[r],n))<0)continue n;v.push(n)}while(o--)t=f[o],t&&k(t);return i(f),i(s),v}function ch(t,i,r){var u=0,e=t?t.length:0,f;if(typeof i!="number"&&i!=null)for(f=e,i=nt.createCallback(i,r,3);f--&&i(t[f],f,t);)u++;else if(u=i,u==null||r)return t?t[e-1]:o;return n(t,pi(0,e-u))}function lh(n,t,i){var r=n?n.length:0;for(typeof i=="number"&&(r=(i<0?pi(0,r+i):vr(i,r-1))+1);r--;)if(n[r]===t)return r;return-1}function ah(n){for(var i=arguments,r=0,e=i.length,u=n?n.length:0,t,f;++r<e;)for(t=-1,f=i[r];++t<u;)n[t]===f&&(of.call(n,t--,1),u--);return n}function vh(n,t,i){n=+n||0;i=typeof i=="number"?i:+i||1;t==null&&(t=n,n=0);for(var r=-1,u=pi(0,no((t-n)/(i||1))),f=yi(u);++r<u;)f[r]=n,n+=i;return f}function yh(n,t,i){var r=-1,f=n?n.length:0,e=[],u;for(t=nt.createCallback(t,i,3);++r<f;)u=n[r],t(u,r,n)&&(e.push(u),of.call(n,r--,1),f--);return e}function rf(t,i,r){if(typeof i!="number"&&i!=null){var u=0,f=-1,e=t?t.length:0;for(i=nt.createCallback(i,r,3);++f<e&&i(t[f],f,t);)u++}else u=i==null||r?1:pi(0,i);return n(t,u)}function oe(n,t,i,r){var u=0,e=n?n.length:u,f;for(i=i?nt.createCallback(i,r,1):uf,t=i(t);u<e;)f=u+e>>>1,i(n[f])<t?u=f+1:e=f;return u}function ph(){return bu(nr(arguments,!0,!0))}function se(n,t,i,r){return typeof t!="boolean"&&t!=null&&(r=i,i=typeof t!="function"&&r&&r[t]===n?null:t,t=!1),i!=null&&(i=nt.createCallback(i,r,3)),bu(n,t,i)}function wh(t){return pr(t,n(arguments,1))}function bh(){for(var i=-1,r=arguments.length,n,t;++i<r;)n=arguments[i],(ut(n)||uu(n))&&(t=t?bu(pr(t,n).concat(pr(n,t))):n);return t||[]}function he(){for(var n=arguments.length>1?arguments:arguments[0],t=-1,i=n?te(lu(n,"length")):0,r=yi(i<0?0:i);++t<i;)r[t]=lu(n,t);return r}function ce(n,t){var r=-1,f=n?n.length:0,u={},i;for(t||!f||ut(n[0])||(t=[]);++r<f;)i=n[r],t?u[i]=t[r]:i&&(u[i[0]]=i[1]);return u}function kh(n,t){if(!rt(t))throw new ki;return function(){if(--n<1)return t.apply(this,arguments)}}function le(t,i){return arguments.length>2?wi(t,17,n(arguments,2),null,i):wi(t,1,null,null,i)}function dh(n){for(var i=arguments.length>1?nr(arguments,!0,!1,1):wr(n),r=-1,u=i.length,t;++r<u;)t=i[r],n[t]=wi(n[t],1,null,null,n);return n}function gh(t,i){return arguments.length>2?wi(i,19,n(arguments,2),null,t):wi(i,3,null,null,t)}function nc(){for(var n=arguments,t=n.length;t--;)if(!rt(n[t]))throw new ki;return function(){for(var t=arguments,i=n.length;i--;)t=[n[i].apply(this,t)];return t[0]}}function tc(n,t){return t=typeof t=="number"?t:+t||n.length,wi(n,4,null,null,null,t)}function ae(n,t,i){var f,u,s,h,e,r,y,c=0,l=!1,a=!0,v,p,w;if(!rt(n))throw new ki;return t=pi(0,t)||0,i===!0?(v=!0,a=!1):hi(i)&&(v=i.leading,l="maxWait"in i&&(pi(t,i.maxWait)||0),a="trailing"in i?i.trailing:a),p=function(){var i=t-(ir()-h),l;i<=0?(u&&gr(u),l=y,u=r=y=o,l&&(c=ir(),s=n.apply(e,f),r||u||(f=e=null))):r=ar(p,i)},w=function(){r&&gr(r);u=r=y=o;(a||l!==t)&&(c=ir(),s=n.apply(e,f),r||u||(f=e=null))},function(){var b,o,i;return f=arguments,h=ir(),e=this,y=a&&(r||!v),l===!1?b=v&&!r:(u||v||(c=h),o=l-(h-c),i=o<=0,i?(u&&(u=gr(u)),c=h,s=n.apply(e,f)):u||(u=ar(w,o))),i&&r?r=gr(r):r||t===l||(r=ar(p,t)),b&&(i=!0,s=n.apply(e,f)),!i||r||u||(f=e=null),s}}function ic(t){if(!rt(t))throw new ki;var i=n(arguments,1);return ar(function(){t.apply(o,i)},1)}function rc(t,i){if(!rt(t))throw new ki;var r=n(arguments,2);return ar(function(){t.apply(o,r)},i)}function uc(n,t){if(!rt(n))throw new ki;var i=function(){var r=i.cache,u=t?t.apply(this,arguments):ft+arguments[0];return oi.call(r,u)?r[u]:r[u]=n.apply(this,arguments)};return i.cache={},i}function fc(n){var i,t;if(!rt(n))throw new ki;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}}function ec(t){return wi(t,16,n(arguments,1))}function oc(t){return wi(t,32,null,n(arguments,1))}function sc(n,t,i){var r=!0,u=!0;if(!rt(n))throw new ki;return i===!1?r=!1:hi(i)&&(r="leading"in i?i.leading:r,u="trailing"in i?i.trailing:u),g.leading=r,g.maxWait=t,g.trailing=u,ae(n,t,g)}function hc(n,t){return wi(t,16,[n])}function cc(n){return function(){return n}}function lc(n,t,i){var f=typeof n;if(n==null||f=="function")return vi(n,t,i);if(f!="object")return pe(n);var u=si(n),e=u[0],r=n[e];return u.length==1&&r===r&&!hi(r)?function(n){var t=n[e];return r===t&&(r!==0||1/r==1/t)}:function(t){for(var i=u.length,r=!1;i--;)if(!(r=sr(t[u[i]],n[u[i]],null,!0)))break;return r}}function ac(n){return n==null?"":gi(n).replace(lo,oo)}function uf(n){return n}function ff(n,t,i){var u=!0,f=t&&wr(t),r,e;t&&(i||f.length)||(i==null&&(i=t),r=rr,t=n,n=nt,f=wr(t));i===!1?u=!1:hi(i)&&"chain"in i&&(u=i.chain);r=n;e=rt(r);ai(f,function(i){var f=n[i]=t[i];e&&(r.prototype[i]=function(){var i=this.__chain__,e=this.__wrapped__,o=[e],t;if(lr.apply(o,arguments),t=f.apply(n,o),u||i){if(e===t&&hi(t))return this;t=new r(t);t.__chain__=i}return t})})}function vc(){return c._=de,this}function ve(){}function pe(n){return function(t){return t[n]}}function yc(n,t,i){var f=n==null,r=t==null,u;return(i==null&&(typeof n=="boolean"&&r?(i=n,n=1):r||typeof t!="boolean"||(i=t,r=!0)),f&&r&&(t=1),n=+n||0,r?(t=n,n=0):t=+t||0,i||n%1||t%1)?(u=hf(),vr(n+u*(t-n+parseFloat("1e-"+((u+"").length-1))),t)):wu(n,t)}function pc(n,t){if(n){var i=n[t];return rt(i)?n[t]():i}}function wc(n,t,i){var h=nt.templateSettings,u,s,v,f;n=gi(n||"");i=eu({},i,h);var c=eu({},i.imports,h.imports),p=si(c),w=su(c),e,l=0,a=i.interpolate||d,r="__p += '",b=cr((i.escape||d).source+"|"+a.source+"|"+(a===at?ni:d).source+"|"+(i.evaluate||d).source+"|$","g");n.replace(b,function(t,i,u,f,o,s){return u||(u=f),r+=n.slice(l,s).replace(ui,li),i&&(r+="' +\n__e("+i+") +\n'"),o&&(e=!0,r+="';\n"+o+";\n__p += '"),u&&(r+="' +\n((__t = ("+u+")) == null ? '' : __t) +\n'"),l=s+t.length,t});r+="';\n";u=i.variable;s=u;s||(u="obj",r="with ("+u+") {\n"+r+"\n}\n");r=(e?r.replace(kt,""):r).replace(dt,"$1").replace(gt,"$1;");r="function("+u+") {\n"+(s?"":u+" || ("+u+" = {});\n")+"var __t, __p = '', __e = _.escape"+(e?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+r+"return __p\n}";v="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+ei+++"]")+"\n*/";try{f=dr(p,"return "+r+v).apply(o,w)}catch(y){y.source=r;throw y;}return t?f(t):(f.source=r,f)}function bc(n,t,i){n=(n=+n)>-1?n:0;var r=-1,u=yi(n);for(t=vi(t,i,1);++r<n;)u[r]=t(r);return u}function kc(n){return n==null?"":gi(n).replace(co,so)}function dc(n){var t=++bt;return gi(n==null?"":n)+t}function gc(n){return n=new rr(n),n.__chain__=!0,n}function nl(n,t){return t(n),n}function tl(){return this.__chain__=!0,this}function il(){return gi(this.__wrapped__)}function we(){return this.__wrapped__}var or,ru,eu,bi,tt,ou,kf,gf,ne,lu,fe,ir,ye;c=c?e.defaults(f.Object(),c,e.pick(f,fi)):f;var yi=c.Array,be=c.Boolean,au=c.Date,dr=c.Function,hr=c.Math,ke=c.Number,ur=c.Object,cr=c.RegExp,gi=c.String,ki=c.TypeError,fr=[],ef=ur.prototype,de=c._,ct=ef.toString,ge=cr("^"+gi(ct).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),no=hr.ceil,gr=c.clearTimeout,to=hr.floor,io=dr.prototype.toString,er=tr(er=ur.getPrototypeOf)&&er,oi=ef.hasOwnProperty,lr=fr.push,ar=c.setTimeout,of=fr.splice,ro=fr.unshift,sf=function(){try{var t={},n=tr(n=ur.defineProperty)&&n,i=n(t,t,t)&&n}catch(r){}return i}(),nu=tr(nu=ur.create)&&nu,vu=tr(vu=yi.isArray)&&vu,uo=c.isFinite,fo=c.isNaN,tu=tr(tu=ur.keys)&&tu,pi=hr.max,vr=hr.min,yu=c.parseInt,hf=hr.random,di={};di[v]=yi;di[y]=be;di[p]=au;di[yt]=dr;di[s]=ur;di[w]=ke;di[b]=cr;di[h]=gi;rr.prototype=nt.prototype;or=nt.support={};or.funcDecomp=!tr(c.WinRTError)&&vt.test(ht);or.funcNames=typeof dr.name=="string";nt.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:at,variable:"",imports:{_:nt}};nu||(yr=function(){function n(){}return function(t){if(hi(t)){n.prototype=t;n.prototype=null}return{}||c.Object()}}());ru=sf?function(n,t){pt.value=t;sf(n,"__bindData__",pt)}:ve;var ut=vu||function(n){return n&&typeof n=="object"&&typeof n.length=="number"&&ct.call(n)==v||!1},ho=function(n){var i,r=n,u=[];if(!r||!t[typeof n])return u;for(i in r)oi.call(r,i)&&u.push(i);return u},si=tu?function(n){return hi(n)?tu(n):[]}:ho,du={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},vf=pf(du),co=cr("("+si(vf).join("|")+")","g"),lo=cr("["+si(du).join("")+"]","g"),fu=function(n,i,r){var o,u=n,s=u,h;if(!u)return s;var e=arguments,l=0,f=typeof r=="number"?2:e.length;for(f>3&&typeof e[f-2]=="function"?h=vi(e[--f-1],e[f--],2):f>2&&typeof e[f-1]=="function"&&(h=e[--f]);++l<f;)if(u=e[l],u&&t[typeof u])for(var a=-1,c=t[typeof u]&&si(u),v=c?c.length:0;++a<v;)o=c[a],s[o]=h?h(s[o],u[o]):u[o];return s};return eu=function(n,i,r){var f,u=n,e=u;if(!u)return e;for(var s=arguments,h=0,l=typeof r=="number"?2:s.length;++h<l;)if(u=s[h],u&&t[typeof u])for(var c=-1,o=t[typeof u]&&si(u),a=o?o.length:0;++c<a;)f=o[c],typeof e[f]=="undefined"&&(e[f]=u[f]);return e},bi=function(n,i,r){var f,u=n,e=u;if(!u||!t[typeof u])return e;i=i&&typeof r=="undefined"?i:vi(i,r,3);for(f in u)if(i(u[f],f,n)===!1)return e;return e},tt=function(n,i,r){var f,u=n,e=u;if(!u||!t[typeof u])return e;i=i&&typeof r=="undefined"?i:vi(i,r,3);for(var s=-1,o=t[typeof u]&&si(u),h=o?o.length:0;++s<h;)if(f=o[s],i(u[f],f,n)===!1)return e;return e},ou=er?function(n){if(!(n&&ct.call(n)==s))return!1;var i=n.valueOf,t=tr(i)&&(t=er(i))&&er(t);return t?n==t||er(n)==t:af(n)}:af,kf=ku(function(n,t,i){oi.call(n,i)?n[i]++:n[i]=1}),gf=ku(function(n,t,i){(oi.call(n,i)?n[i]:n[i]=[]).push(t)}),ne=ku(function(n,t,i){n[i]=t}),lu=kr,fe=hu,ir=tr(ir=au.now)&&ir||function(){return(new au).getTime()},ye=yu(lt+"08")==8?yu:function(n,t){return yu(br(n)?n.replace(ri,""):n,t||0)},nt.after=kh,nt.assign=fu,nt.at=ps,nt.bind=le,nt.bindAll=dh,nt.bindKey=gh,nt.chain=gc,nt.compact=rh,nt.compose=nc,nt.constant=cc,nt.countBy=kf,nt.create=yo,nt.createCallback=lc,nt.curry=tc,nt.debounce=ae,nt.defaults=eu,nt.defer=ic,nt.delay=rc,nt.difference=uh,nt.filter=hu,nt.flatten=oh,nt.forEach=ai,nt.forEachRight=cu,nt.forIn=bi,nt.forInRight=bo,nt.forOwn=tt,nt.forOwnRight=yf,nt.functions=wr,nt.groupBy=gf,nt.indexBy=ne,nt.initial=sh,nt.intersection=hh,nt.invert=pf,nt.invoke=bs,nt.keys=si,nt.map=kr,nt.mapValues=hs,nt.max=te,nt.memoize=uc,nt.merge=cs,nt.min=ks,nt.omit=ls,nt.once=fc,nt.pairs=as,nt.partial=ec,nt.partialRight=oc,nt.pick=vs,nt.pluck=lu,nt.property=pe,nt.pull=ah,nt.range=vh,nt.reject=ds,nt.remove=yh,nt.rest=rf,nt.shuffle=re,nt.sortBy=th,nt.tap=nl,nt.throttle=sc,nt.times=bc,nt.toArray=ih,nt.transform=ys,nt.union=ph,nt.uniq=se,nt.values=su,nt.where=fe,nt.without=wh,nt.wrap=hc,nt.xor=bh,nt.zip=he,nt.zipObject=ce,nt.collect=kr,nt.drop=rf,nt.each=ai,nt.eachRight=cu,nt.extend=fu,nt.methods=wr,nt.object=ce,nt.select=hu,nt.tail=rf,nt.unique=se,nt.unzip=he,ff(nt),nt.clone=ao,nt.cloneDeep=vo,nt.contains=bf,nt.escape=ac,nt.every=df,nt.find=gu,nt.findIndex=fh,nt.findKey=po,nt.findLast=ws,nt.findLastIndex=eh,nt.findLastKey=wo,nt.has=ko,nt.identity=uf,nt.indexOf=ee,nt.isArguments=uu,nt.isArray=ut,nt.isBoolean=go,nt.isDate=ns,nt.isElement=ts,nt.isEmpty=is,nt.isEqual=rs,nt.isFinite=us,nt.isFunction=rt,nt.isNaN=fs,nt.isNull=es,nt.isNumber=wf,nt.isObject=hi,nt.isPlainObject=ou,nt.isRegExp=os,nt.isString=br,nt.isUndefined=ss,nt.lastIndexOf=lh,nt.mixin=ff,nt.noConflict=vc,nt.noop=ve,nt.now=ir,nt.parseInt=ye,nt.random=yc,nt.reduce=nf,nt.reduceRight=ie,nt.result=pc,nt.runInContext=ht,nt.size=nh,nt.some=ue,nt.sortedIndex=oe,nt.template=wc,nt.unescape=kc,nt.uniqueId=dc,nt.all=df,nt.any=ue,nt.detect=gu,nt.findWhere=gu,nt.foldl=nf,nt.foldr=ie,nt.include=bf,nt.inject=nf,ff(function(){var n={};return tt(nt,function(t,i){nt.prototype[i]||(n[i]=t)}),n}(),!1),nt.first=tf,nt.last=ch,nt.sample=gs,nt.take=tf,nt.head=tf,tt(nt,function(n,t){var i=t!=="sample";nt.prototype[t]||(nt.prototype[t]=function(t,r){var u=this.__chain__,f=n(this.__wrapped__,t,r);return!u&&(t==null||r&&!(i&&typeof t=="function"))?f:new rr(f,u)})}),nt.VERSION="2.4.1",nt.prototype.chain=tl,nt.prototype.toString=il,nt.prototype.value=we,nt.prototype.valueOf=we,ai(["join","pop","shift"],function(n){var t=fr[n];nt.prototype[n]=function(){var n=this.__chain__,i=t.apply(this.__wrapped__,arguments);return n?new rr(i,n):i}}),ai(["push","reverse","sort","unshift"],function(n){var t=fr[n];nt.prototype[n]=function(){return t.apply(this.__wrapped__,arguments),this}}),ai(["concat","slice","splice"],function(n){var t=fr[n];nt.prototype[n]=function(){return new rr(t.apply(this.__wrapped__,arguments),this.__chain__)}}),nt}var o,rt=[],ut=[],bt=0,ft=+new Date+"",et=75,ct=40,lt=" \t\x0b\f ﻿\n\r\u2028\u2029 ᠎             　",kt=/\b__p \+= '';/g,dt=/\b(__p \+=) '' \+/g,gt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ni=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ti=/\w*$/,ii=/^\s*function[ \n\r\t]+\w/,at=/<%=([\s\S]+?)%>/g,ri=RegExp("^["+lt+"]*0+(?=.$)"),d=/($^)/,vt=/\bthis\b/,ui=/['\n\r\t\u2028\u2029\\]/g,fi=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],ei=0,a="[object Arguments]",v="[object Array]",y="[object Boolean]",p="[object Date]",yt="[object Function]",w="[object Number]",s="[object Object]",b="[object RegExp]",h="[object String]",r={},e;r[yt]=!1;r[a]=r[v]=r[y]=r[p]=r[w]=r[s]=r[b]=r[h]=!0;var g={leading:!1,maxWait:0,trailing:!1},pt={configurable:!1,enumerable:!1,value:null,writable:!1},t={boolean:!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},oi={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},f=t[typeof window]&&window||this,nt=t[typeof exports]&&exports&&!exports.nodeType&&exports,tt=t[typeof module]&&module&&!module.nodeType&&module,si=tt&&tt.exports===nt&&nt,c=t[typeof global]&&global;if(c&&(c.global===c||c.window===c)&&(f=c),e=ht(),typeof define=="function"&&typeof define.amd=="object"&&define.amd)f._=e,define(function(){return e});else if(nt&&tt)si?(tt.exports=e)._=e:nt._=e;else return f._=f._||{},f._=e,f._}).call(this);!function(n,t){"use strict";function y(n,t){var r,i,u=n.toLowerCase();for(t=[].concat(t),r=0;r<t.length;r+=1)if((i=t[r],i)&&(i.test&&i.test(n)||i.toLowerCase()===u))return!0}var h=t.prototype.trim,c=t.prototype.trimRight,l=t.prototype.trimLeft,a=function(n){return n*1||0},r=function(n,t){if(t<1)return"";for(var i="";t>0;)t&1&&(i+=n),t>>=1,n+=n;return i},v=[].slice,f=function(n){return n==null?"\\s":n.source?n.source:"["+i.escapeRegExp(n)+"]"},e={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},o={},s,u,i;for(s in e)o[e[s]]=s;o["'"]="#39";u=function(){function i(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}var f=r,n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){for(var v=1,w=n.length,c="",e,l=[],h,o,a,y,p,s=0;s<w;s++)if(c=i(n[s]),c==="string")l.push(n[s]);else if(c==="array"){if(o=n[s],o[2])for(e=r[v],h=0;h<o[2].length;h++){if(!e.hasOwnProperty(o[2][h]))throw new Error(u('[_.sprintf] property "%s" does not exist',o[2][h]));e=e[o[2][h]]}else e=o[1]?r[o[1]]:r[v++];if(/[^s]/.test(o[8])&&i(e)!="number")throw new Error(u("[_.sprintf] expecting number but found %s",i(e)));switch(o[8]){case"b":e=e.toString(2);break;case"c":e=t.fromCharCode(e);break;case"d":e=parseInt(e,10);break;case"e":e=o[7]?e.toExponential(o[7]):e.toExponential();break;case"f":e=o[7]?parseFloat(e).toFixed(o[7]):parseFloat(e);break;case"o":e=e.toString(8);break;case"s":e=(e=t(e))&&o[7]?e.substring(0,o[7]):e;break;case"u":e=Math.abs(e);break;case"x":e=e.toString(16);break;case"X":e=e.toString(16).toUpperCase()}e=/[def]/.test(o[8])&&o[3]&&e>=0?"+"+e:e;y=o[4]?o[4]=="0"?"0":o[4].charAt(1):" ";p=o[6]-t(e).length;a=o[6]?f(y,p):"";l.push(o[5]?e+a:a+e)}return l.join("")},n.cache={},n.parse=function(n){for(var r=n,t=[],f=[],o=0;r;){if((t=/^[^\x25]+/.exec(r))!==null)f.push(t[0]);else if((t=/^\x25{2}/.exec(r))!==null)f.push("%");else if((t=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(r))!==null){if(t[2]){o|=1;var e=[],u=t[2],i=[];if((i=/^([a-z_][a-z_\d]*)/i.exec(u))!==null)for(e.push(i[1]);(u=u.substring(i[0].length))!=="";)if((i=/^\.([a-z_][a-z_\d]*)/i.exec(u))!==null)e.push(i[1]);else if((i=/^\[(\d+)\]/.exec(u))!==null)e.push(i[1]);else throw new Error("[_.sprintf] huh?");else throw new Error("[_.sprintf] huh?");t[2]=e}else o|=2;if(o===3)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");f.push(t)}else throw new Error("[_.sprintf] huh?");r=r.substring(t[0].length)}return f},n}();i={VERSION:"2.3.0",isBlank:function(n){return n==null&&(n=""),/^\s*$/.test(n)},stripTags:function(n){return n==null?"":t(n).replace(/<\/?[^>]+>/g,"")},capitalize:function(n){return n=n==null?"":t(n),n.charAt(0).toUpperCase()+n.slice(1)},chop:function(n,i){return n==null?[]:(n=t(n),i=~~i,i>0?n.match(new RegExp(".{1,"+i+"}","g")):[n])},clean:function(n){return i.strip(n).replace(/\s+/g," ")},count:function(n,i){if(n==null||i==null)return 0;n=t(n);i=t(i);for(var u=0,r=0,f=i.length;;){if(r=n.indexOf(i,r),r===-1)break;u++;r+=f}return u},chars:function(n){return n==null?[]:t(n).split("")},swapCase:function(n){return n==null?"":t(n).replace(/\S/g,function(n){return n===n.toUpperCase()?n.toLowerCase():n.toUpperCase()})},escapeHTML:function(n){return n==null?"":t(n).replace(/[&<>"']/g,function(n){return"&"+o[n]+";"})},unescapeHTML:function(n){return n==null?"":t(n).replace(/\&([^;]+);/g,function(n,i){var r;return i in e?e[i]:(r=i.match(/^#x([\da-fA-F]+)$/))?t.fromCharCode(parseInt(r[1],16)):(r=i.match(/^#(\d+)$/))?t.fromCharCode(~~r[1]):n})},escapeRegExp:function(n){return n==null?"":t(n).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(n,t,r,u){var f=i.chars(n);return f.splice(~~t,~~r,u),f.join("")},insert:function(n,t,r){return i.splice(n,t,0,r)},include:function(n,i){return i===""?!0:n==null?!1:t(n).indexOf(i)!==-1},join:function(){var t=v.call(arguments),n=t.shift();return n==null&&(n=""),t.join(n)},lines:function(n){return n==null?[]:t(n).split("\n")},reverse:function(n){return i.chars(n).reverse().join("")},startsWith:function(n,i){return i===""?!0:n==null||i==null?!1:(n=t(n),i=t(i),n.length>=i.length&&n.slice(0,i.length)===i)},endsWith:function(n,i){return i===""?!0:n==null||i==null?!1:(n=t(n),i=t(i),n.length>=i.length&&n.slice(n.length-i.length)===i)},succ:function(n){return n==null?"":(n=t(n),n.slice(0,-1)+t.fromCharCode(n.charCodeAt(n.length-1)+1))},titleize:function(n){return n==null?"":(n=t(n).toLowerCase(),n.replace(/(?:^|\s|-)\S/g,function(n){return n.toUpperCase()}))},camelize:function(n){return i.trim(n).replace(/[-_\s]+(.)?/g,function(n,t){return t?t.toUpperCase():""})},underscored:function(n){return i.trim(n).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(n){return i.trim(n).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(n){return i.titleize(t(n).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(n){return i.capitalize(i.underscored(n).replace(/_id$/,"").replace(/_/g," "))},trim:function(n,i){return n==null?"":!i&&h?h.call(n):(i=f(i),t(n).replace(new RegExp("^"+i+"+|"+i+"+$","g"),""))},ltrim:function(n,i){return n==null?"":!i&&l?l.call(n):(i=f(i),t(n).replace(new RegExp("^"+i+"+"),""))},rtrim:function(n,i){return n==null?"":!i&&c?c.call(n):(i=f(i),t(n).replace(new RegExp(i+"+$"),""))},truncate:function(n,i,r){return n==null?"":(n=t(n),r=r||"...",i=~~i,n.length>i?n.slice(0,i)+r:n)},prune:function(n,r,u){if(n==null)return"";if(n=t(n),r=~~r,u=u!=null?t(u):"...",n.length<=r)return n;var e=function(n){return n.toUpperCase()!==n.toLowerCase()?"A":" "},f=n.slice(0,r+1).replace(/.(?=\W*\w*$)/g,e);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):i.rtrim(f.slice(0,f.length-1)),(f+u).length>n.length?n:n.slice(0,f.length)+u},words:function(n,t){return i.isBlank(n)?[]:i.trim(n,t).split(t||/\s+/)},pad:function(n,i,u,f){n=n==null?"":t(n);i=~~i;var e=0;u?u.length>1&&(u=u.charAt(0)):u=" ";switch(f){case"right":return e=i-n.length,n+r(u,e);case"both":return e=i-n.length,r(u,Math.ceil(e/2))+n+r(u,Math.floor(e/2));default:return e=i-n.length,r(u,e)+n}},lpad:function(n,t,r){return i.pad(n,t,r)},rpad:function(n,t,r){return i.pad(n,t,r,"right")},lrpad:function(n,t,r){return i.pad(n,t,r,"both")},sprintf:u,vsprintf:function(n,t){return t.unshift(n),u.apply(null,t)},toNumber:function(n,t){return n?(n=i.trim(n),!n.match(/^-?\d+(?:\.\d+)?$/))?NaN:a(a(n).toFixed(~~t)):0},numberFormat:function(n,t,i,r){if(isNaN(n)||n==null)return"";n=n.toFixed(~~t);r=typeof r=="string"?r:",";var u=n.split("."),f=u[0],e=u[1]?(i||".")+u[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+r)+e},strRight:function(n,i){if(n==null)return"";n=t(n);i=i!=null?t(i):i;var r=i?n.indexOf(i):-1;return~r?n.slice(r+i.length,n.length):n},strRightBack:function(n,i){if(n==null)return"";n=t(n);i=i!=null?t(i):i;var r=i?n.lastIndexOf(i):-1;return~r?n.slice(r+i.length,n.length):n},strLeft:function(n,i){if(n==null)return"";n=t(n);i=i!=null?t(i):i;var r=i?n.indexOf(i):-1;return~r?n.slice(0,r):n},strLeftBack:function(n,t){if(n==null)return"";n+="";t=t!=null?""+t:t;var i=n.lastIndexOf(t);return~i?n.slice(0,i):n},toSentence:function(n,t,r,u){t=t||", ";r=r||" and ";var f=n.slice(),e=f.pop();return n.length>2&&u&&(r=i.rtrim(t)+r),f.length?f.join(t)+r+e:e},toSentenceSerial:function(){var n=v.call(arguments);return n[3]=!0,i.toSentence.apply(i,n)},slugify:function(n){if(n==null)return"";var r="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",u="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",e=new RegExp(f(r),"g");return n=t(n).toLowerCase().replace(e,function(n){var t=r.indexOf(n);return u.charAt(t)||"-"}),i.dasherize(n.replace(/[^\w\s-]/g,""))},surround:function(n,t){return[t,n,t].join("")},quote:function(n,t){return i.surround(n,t||'"')},unquote:function(n,t){return t=t||'"',n[0]===t&&n[n.length-1]===t?n.slice(1,n.length-1):n},exports:function(){var t={};for(var n in this)this.hasOwnProperty(n)&&!n.match(/^(?:include|contains|reverse)$/)&&(t[n]=this[n]);return t},repeat:function(n,i,u){if(n==null)return"";if(i=~~i,u==null)return r(t(n),i);for(var f=[];i>0;f[--i]=n);return f.join(u)},naturalCmp:function(n,i){var r,e,o,s,h;if(n==i)return 0;if(!n)return-1;if(!i)return 1;var c=/(\.\d+)|(\d+)|(\D+)/g,u=t(n).toLowerCase().match(c),f=t(i).toLowerCase().match(c),l=Math.min(u.length,f.length);for(r=0;r<l;r++)if(e=u[r],o=f[r],e!==o)return(s=parseInt(e,10),!isNaN(s)&&(h=parseInt(o,10),!isNaN(h)&&s-h))?s-h:e<o?-1:1;return u.length===f.length?u.length-f.length:n<i?-1:1},levenshtein:function(n,i){var u,e,o,f,r;if(n==null&&i==null)return 0;if(n==null)return t(i).length;if(i==null)return t(n).length;for(n=t(n),i=t(i),u=[],f=0;f<=i.length;f++)for(r=0;r<=n.length;r++)o=f&&r?n.charAt(r-1)===i.charAt(f-1)?e:Math.min(u[r],u[r-1],e)+1:f+r,e=u[r],u[r]=o;return u.pop()},toBoolean:function(n,t,r){return(typeof n=="number"&&(n=""+n),typeof n!="string")?!!n:(n=i.trim(n),y(n,t||["true","1"]))?!0:y(n,r||["false","0"])?!1:void 0}};i.strip=i.trim;i.lstrip=i.ltrim;i.rstrip=i.rtrim;i.center=i.lrpad;i.rjust=i.lpad;i.ljust=i.rpad;i.contains=i.include;i.q=i.quote;i.toBool=i.toBoolean;typeof exports!="undefined"&&(typeof module!="undefined"&&module.exports&&(module.exports=i),exports._s=i);typeof define=="function"&&define.amd&&define("underscore.string",[],function(){return i});n._=n._||{};n._.string=n._.str=i}(this,String);
//! moment.js
//! version : 2.5.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
(function(n){function ui(n,t){return function(i){return u(n.call(this,i),t)}}function kr(n,t){return function(i){return this.lang().ordinal(n.call(this,i),t)}}function fi(){}function ft(n){li(n);o(this,n)}function et(n){var t=oi(n),i=t.year||0,r=t.month||0,u=t.week||0,f=t.day||0,e=t.hour||0,o=t.minute||0,s=t.second||0,h=t.millisecond||0;this._milliseconds=+h+s*1e3+o*6e4+e*36e5;this._days=+f+u*7;this._months=+r+i*12;this._data={};this._bubble()}function o(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return t.hasOwnProperty("toString")&&(n.toString=t.toString),t.hasOwnProperty("valueOf")&&(n.valueOf=t.valueOf),n}function y(n){return n<0?Math.ceil(n):Math.floor(n)}function u(n,t,i){for(var r=Math.abs(n)+"",u=n>=0;r.length<t;)r="0"+r;return(u?i?"+":"":"-")+r}function ot(n,i,r,u){var o=i._milliseconds,f=i._days,e=i._months,s,h;o&&n._d.setTime(+n._d+o*r);(f||e)&&(s=n.minute(),h=n.hour());f&&n.date(n.date()+f*r);e&&n.month(n.month()+e*r);o&&!u&&t.updateOffset(n);(f||e)&&(n.minute(s),n.hour(h))}function st(n){return Object.prototype.toString.call(n)==="[object Array]"}function dr(n){return Object.prototype.toString.call(n)==="[object Date]"||n instanceof Date}function ei(n,t,r){for(var e=Math.min(n.length,t.length),o=Math.abs(n.length-t.length),f=0,u=0;u<e;u++)(r&&n[u]!==t[u]||!r&&i(n[u])!==i(t[u]))&&f++;return f+o}function l(n){if(n){var t=n.toLowerCase().replace(/(.)s$/,"$1");n=wr[n]||br[t]||t}return n}function oi(n){var r={},t;for(var i in n)n.hasOwnProperty(i)&&(t=l(i),t&&(r[t]=n[i]));return r}function gr(i){var r,u;if(i.indexOf("week")===0)r=7,u="day";else if(i.indexOf("month")===0)r=12,u="month";else return;t[i]=function(f,e){var o,s,c=t.fn._lang[i],h=[];if(typeof f=="number"&&(e=f,f=n),s=function(n){var i=t().utc().set(u,n);return c.call(t.fn._lang,i,f||"")},e!=null)return s(e);for(o=0;o<r;o++)h.push(s(o));return h}}function i(n){var t=+n,i=0;return t!==0&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function si(n,t){return new Date(Date.UTC(n,t+1,0)).getUTCDate()}function hi(n){return ci(n)?366:365}function ci(n){return n%4==0&&n%100!=0||n%400==0}function li(n){var t;n._a&&n._pf.overflow===-2&&(t=n._a[a]<0||n._a[a]>11?a:n._a[h]<1||n._a[h]>si(n._a[f],n._a[a])?h:n._a[e]<0||n._a[e]>23?e:n._a[w]<0||n._a[w]>59?w:n._a[b]<0||n._a[b]>59?b:n._a[k]<0||n._a[k]>999?k:-1,n._pf._overflowDayOfYear&&(t<f||t>h)&&(t=h),n._pf.overflow=t)}function ai(n){n._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function vi(n){return n._isValid==null&&(n._isValid=!isNaN(n._d.getTime())&&n._pf.overflow<0&&!n._pf.empty&&!n._pf.invalidMonth&&!n._pf.nullInput&&!n._pf.invalidFormat&&!n._pf.userInvalidated,n._strict&&(n._isValid=n._isValid&&n._pf.charsLeftOver===0&&n._pf.unusedTokens.length===0)),n._isValid}function ht(n){return n?n.toLowerCase().replace("_","-"):n}function ct(n,i){return i._isUTC?t(n).zone(i._offset||0):t(n).local()}function nu(n,t){return t.abbr=n,v[n]||(v[n]=new fi),v[n].set(t),v[n]}function tu(n){delete v[n]}function s(n){var f=0,r,u,i,e,o=function(n){if(!v[n]&&pt)try{require("./lang/"+n)}catch(t){}return v[n]};if(!n)return t.fn._lang;if(!st(n)){if(u=o(n),u)return u;n=[n]}while(f<n.length){for(e=ht(n[f]).split("-"),r=e.length,i=ht(n[f+1]),i=i?i.split("-"):null;r>0;){if(u=o(e.slice(0,r).join("-")),u)return u;if(i&&i.length>=r&&ei(e,i,!0)>=r-1)break;r--}f++}return t.fn._lang}function iu(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function ru(n){for(var i=n.match(wt),t=0,r=i.length;t<r;t++)i[t]=c[i[t]]?c[i[t]]:iu(i[t]);return function(u){var f="";for(t=0;t<r;t++)f+=i[t]instanceof Function?i[t].call(u,n):i[t];return f}}function lt(n,t){return n.isValid()?(t=yi(t,n.lang()),ut[t]||(ut[t]=ru(t)),ut[t](n)):n.lang().invalidDate()}function yi(n,t){function r(n){return t.longDateFormat(n)||n}var i=5;for(d.lastIndex=0;i>=0&&d.test(n);)n=n.replace(d,r),d.lastIndex=0,i-=1;return n}function uu(n,t){var i=t._strict;switch(n){case"DDDD":return gt;case"YYYY":case"GGGG":case"gggg":return i?lr:fr;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return i?ar:er;case"S":if(i)return kt;case"SS":if(i)return dt;case"SSS":case"DDD":return i?gt:ur;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return sr;case"a":case"A":return s(t._l)._meridiemParse;case"X":return cr;case"Z":case"ZZ":return tt;case"T":return hr;case"SSSS":return or;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return i?dt:bt;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return i?kt:bt;default:return new RegExp(hu(su(n.replace("\\","")),"i"))}}function pi(n){n=n||"";var r=n.match(tt)||[],f=r[r.length-1]||[],t=(f+"").match(pr)||["-",0,0],u=+(t[1]*60)+i(t[2]);return t[0]==="+"?-u:u}function fu(n,t,r){var o,u=r._a;switch(n){case"M":case"MM":t!=null&&(u[a]=i(t)-1);break;case"MMM":case"MMMM":o=s(r._l).monthsParse(t);o!=null?u[a]=o:r._pf.invalidMonth=t;break;case"D":case"DD":t!=null&&(u[h]=i(t));break;case"DDD":case"DDDD":t!=null&&(r._dayOfYear=i(t));break;case"YY":u[f]=i(t)+(i(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":u[f]=i(t);break;case"a":case"A":r._isPm=s(r._l).isPM(t);break;case"H":case"HH":case"h":case"hh":u[e]=i(t);break;case"m":case"mm":u[w]=i(t);break;case"s":case"ss":u[b]=i(t);break;case"S":case"SS":case"SSS":case"SSSS":u[k]=i(("0."+t)*1e3);break;case"X":r._d=new Date(parseFloat(t)*1e3);break;case"Z":case"ZZ":r._useUTC=!0;r._tzm=pi(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":n=n.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":n=n.substr(0,2);t&&(r._w=r._w||{},r._w[n]=t)}}function at(n){var r,v,c=[],y,p,b,u,l,o,k,d;if(!n._d){for(y=ou(n),n._w&&n._a[h]==null&&n._a[a]==null&&(b=function(i){var r=parseInt(i,10);return i?i.length<3?r>68?1900+r:2e3+r:r:n._a[f]==null?t().weekYear():n._a[f]},u=n._w,u.GG!=null||u.W!=null||u.E!=null?l=ki(b(u.GG),u.W||1,u.E,4,1):(o=s(n._l),k=u.d!=null?bi(u.d,o):u.e!=null?parseInt(u.e,10)+o._week.dow:0,d=parseInt(u.w,10)||1,u.d!=null&&k<o._week.dow&&d++,l=ki(b(u.gg),d,k,o._week.doy,o._week.dow)),n._a[f]=l.year,n._dayOfYear=l.dayOfYear),n._dayOfYear&&(p=n._a[f]==null?y[f]:n._a[f],n._dayOfYear>hi(p)&&(n._pf._overflowDayOfYear=!0),v=wi(p,0,n._dayOfYear),n._a[a]=v.getUTCMonth(),n._a[h]=v.getUTCDate()),r=0;r<3&&n._a[r]==null;++r)n._a[r]=c[r]=y[r];for(;r<7;r++)n._a[r]=c[r]=n._a[r]==null?r===2?1:0:n._a[r];c[e]+=i((n._tzm||0)/60);c[w]+=i((n._tzm||0)%60);n._d=(n._useUTC?wi:vu).apply(null,c)}}function eu(n){var t;n._d||(t=oi(n._i),n._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],at(n))}function ou(n){var t=new Date;return n._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function vt(n){n._a=[];n._pf.empty=!0;for(var l=s(n._l),t=""+n._i,i,r,o,a=t.length,h=0,f=yi(n._f,l).match(wt)||[],u=0;u<f.length;u++)r=f[u],i=(t.match(uu(r,n))||[])[0],i&&(o=t.substr(0,t.indexOf(i)),o.length>0&&n._pf.unusedInput.push(o),t=t.slice(t.indexOf(i)+i.length),h+=i.length),c[r]?(i?n._pf.empty=!1:n._pf.unusedTokens.push(r),fu(r,i,n)):n._strict&&!i&&n._pf.unusedTokens.push(r);n._pf.charsLeftOver=a-h;t.length>0&&n._pf.unusedInput.push(t);n._isPm&&n._a[e]<12&&(n._a[e]+=12);n._isPm===!1&&n._a[e]===12&&(n._a[e]=0);at(n);li(n)}function su(n){return n.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(n,t,i,r,u){return t||i||r||u})}function hu(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function cu(n){var t,f,u,r,i;if(n._f.length===0){n._pf.invalidFormat=!0;n._d=new Date(NaN);return}for(r=0;r<n._f.length;r++)(i=0,t=o({},n),ai(t),t._f=n._f[r],vt(t),vi(t))&&(i+=t._pf.charsLeftOver,i+=t._pf.unusedTokens.length*10,t._pf.score=i,(u==null||i<u)&&(u=i,f=t));o(n,f||t)}function lu(n){var t,i=n._i,r=vr.exec(i);if(r){for(n._pf.iso=!0,t=4;t>0;t--)if(r[t]){n._f=yr[t-1]+(r[6]||" ");break}for(t=0;t<4;t++)if(ni[t][1].exec(i)){n._f+=ni[t][0];break}i.match(tt)&&(n._f+="Z");vt(n)}else n._d=new Date(i)}function au(t){var i=t._i,r=tr.exec(i);i===n?t._d=new Date:r?t._d=new Date(+r[1]):typeof i=="string"?lu(t):st(i)?(t._a=i.slice(0),at(t)):dr(i)?t._d=new Date(+i):typeof i=="object"?eu(t):t._d=new Date(i)}function vu(n,t,i,r,u,f,e){var o=new Date(n,t,i,r,u,f,e);return n<1970&&o.setFullYear(n),o}function wi(n){var t=new Date(Date.UTC.apply(null,arguments));return n<1970&&t.setUTCFullYear(n),t}function bi(n,t){if(typeof n=="string")if(isNaN(n)){if(n=t.weekdaysParse(n),typeof n!="number")return null}else n=parseInt(n,10);return n}function yu(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function pu(n,t,i){var o=p(Math.abs(n)/1e3),u=p(o/60),f=p(u/60),r=p(f/24),s=p(r/365),e=o<45&&["s",o]||u===1&&["m"]||u<45&&["mm",u]||f===1&&["h"]||f<22&&["hh",f]||r===1&&["d"]||r<=25&&["dd",r]||r<=45&&["M"]||r<345&&["MM",p(r/30)]||s===1&&["y"]||["yy",s];return e[2]=t,e[3]=n>0,e[4]=i,yu.apply({},e)}function g(n,i,r){var e=r-i,u=r-n.day(),f;return u>e&&(u-=7),u<e-7&&(u+=7),f=t(n).add("d",u),{week:Math.ceil(f.dayOfYear()/7),year:f.year()}}function ki(n,t,i,r,f){var o=new Date(u(n,6,!0)+"-01-01").getUTCDay(),s,e;return i=i!=null?i:f,s=f-o+(o>r?7:0),e=7*(t-1)+(i-f)+s+1,{year:e>0?n:n-1,dayOfYear:e>0?e:hi(n-1)+e}}function di(n){var i=n._i,r=n._f;return(typeof n._pf=="undefined"&&ai(n),i===null)?t.invalid({nullInput:!0}):(typeof i=="string"&&(n._i=i=s().preparse(i)),t.isMoment(i)?(n=o({},i),n._d=new Date(+i._d)):r?st(r)?cu(n):vt(n):au(n),new ft(n))}function gi(n,i){t.fn[n]=t.fn[n+"s"]=function(n){var r=this._isUTC?"UTC":"";return n!=null?(this._d["set"+r+i](n),t.updateOffset(this),this):this._d["get"+r+i]()}}function wu(n){t.duration.fn[n]=function(){return this._data[n]}}function nr(n,i){t.duration.fn["as"+n]=function(){return+this/i}}function yt(n){var i=!1,r=t;typeof ender=="undefined"&&(n?(nt.moment=function(){return!i&&console&&console.warn&&(i=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),r.apply(null,arguments)},o(nt.moment,r)):nt.moment=t)}for(var t,nt=this,p=Math.round,r,f=0,a=1,h=2,e=3,w=4,b=5,k=6,v={},pt=typeof module!="undefined"&&module.exports&&typeof require!="undefined",tr=/^\/?Date\((\-?\d+)/i,ir=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,rr=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,wt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,d=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,bt=/\d\d?/,ur=/\d{1,3}/,fr=/\d{1,4}/,er=/[+\-]?\d{1,6}/,or=/\d+/,sr=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,tt=/Z|[\+\-]\d\d:?\d\d/gi,hr=/T/i,cr=/[\+\-]?\d+(\.\d{1,3})?/,kt=/\d/,dt=/\d\d/,gt=/\d{3}/,lr=/\d{4}/,ar=/[+\-]?\d{6}/,vr=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yr=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],ni=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],pr=/([\+\-]|\d\d)/gi,it="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),rt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},wr={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},br={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ut={},ti="DDD w W M D d".split(" "),ii="M D H h m s w W".split(" "),c={M:function(){return this.month()+1},MMM:function(n){return this.lang().monthsShort(this,n)},MMMM:function(n){return this.lang().months(this,n)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(n){return this.lang().weekdaysMin(this,n)},ddd:function(n){return this.lang().weekdaysShort(this,n)},dddd:function(n){return this.lang().weekdays(this,n)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return u(this.year()%100,2)},YYYY:function(){return u(this.year(),4)},YYYYY:function(){return u(this.year(),5)},YYYYYY:function(){var n=this.year(),t=n>=0?"+":"-";return t+u(Math.abs(n),6)},gg:function(){return u(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return u(this.weekYear(),5)},GG:function(){return u(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return u(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return i(this.milliseconds()/100)},SS:function(){return u(i(this.milliseconds()/10),2)},SSS:function(){return u(this.milliseconds(),3)},SSSS:function(){return u(this.milliseconds(),3)},Z:function(){var n=-this.zone(),t="+";return n<0&&(n=-n,t="-"),t+u(i(n/60),2)+":"+u(i(n)%60,2)},ZZ:function(){var n=-this.zone(),t="+";return n<0&&(n=-n,t="-"),t+u(i(n/60),2)+u(i(n)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},ri=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ti.length;)r=ti.pop(),c[r+"o"]=kr(c[r],r);while(ii.length)r=ii.pop(),c[r+r]=ui(c[r],2);for(c.DDDD=ui(c.DDD,3),o(fi.prototype,{set:function(n){var t;for(var i in n)t=n[i],typeof t=="function"?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(n){return this._months[n.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(n){return this._monthsShort[n.month()]},monthsParse:function(n){var i,r,u;for(this._monthsParse||(this._monthsParse=[]),i=0;i<12;i++)if(this._monthsParse[i]||(r=t.utc([2e3,i]),u="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(u.replace(".",""),"i")),this._monthsParse[i].test(n))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(n){return this._weekdays[n.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(n){return this._weekdaysShort[n.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(n){return this._weekdaysMin[n.day()]},weekdaysParse:function(n){var i,r,u;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;i<7;i++)if(this._weekdaysParse[i]||(r=t([2e3,1]).day(i),u="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(u.replace(".",""),"i")),this._weekdaysParse[i].test(n))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(n){var t=this._longDateFormat[n];return!t&&this._longDateFormat[n.toUpperCase()]&&(t=this._longDateFormat[n.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n]=t),t},isPM:function(n){return(n+"").toLowerCase().charAt(0)==="p"},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(n,t){var i=this._calendar[n];return typeof i=="function"?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(n,t,i,r){var u=this._relativeTime[i];return typeof u=="function"?u(n,t,i,r):u.replace(/%d/i,n)},pastFuture:function(n,t){var i=this._relativeTime[n>0?"future":"past"];return typeof i=="function"?i(t):i.replace(/%s/i,t)},ordinal:function(n){return this._ordinal.replace("%d",n)},_ordinal:"%d",preparse:function(n){return n},postformat:function(n){return n},week:function(n){return g(n,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),t=function(t,i,r,u){return typeof r=="boolean"&&(u=r,r=n),di({_i:t,_f:i,_l:r,_strict:u,_isUTC:!1})},t.utc=function(t,i,r,u){return typeof r=="boolean"&&(u=r,r=n),di({_useUTC:!0,_isUTC:!0,_l:r,_i:t,_f:i,_strict:u}).utc()},t.unix=function(n){return t(n*1e3)},t.duration=function(n,r){var s=n,u=null,f,c,o;return t.isDuration(n)?s={ms:n._milliseconds,d:n._days,M:n._months}:typeof n=="number"?(s={},r?s[r]=n:s.milliseconds=n):(u=ir.exec(n))?(f=u[1]==="-"?-1:1,s={y:0,d:i(u[h])*f,h:i(u[e])*f,m:i(u[w])*f,s:i(u[b])*f,ms:i(u[k])*f}):!(u=rr.exec(n))||(f=u[1]==="-"?-1:1,o=function(n){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*f},s={y:o(u[2]),M:o(u[3]),d:o(u[4]),h:o(u[5]),m:o(u[6]),s:o(u[7]),w:o(u[8])}),c=new et(s),t.isDuration(n)&&n.hasOwnProperty("_lang")&&(c._lang=n._lang),c},t.version="2.5.0",t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.updateOffset=function(){},t.lang=function(n,i){var r;return n?(i?nu(ht(n),i):i===null?(tu(n),n="en"):v[n]||s(n),r=t.duration.fn._lang=t.fn._lang=s(n),r._abbr):t.fn._lang._abbr},t.langData=function(n){return n&&n._lang&&n._lang._abbr&&(n=n._lang._abbr),s(n)},t.isMoment=function(n){return n instanceof ft},t.isDuration=function(n){return n instanceof et},r=ri.length-1;r>=0;--r)gr(ri[r]);for(t.normalizeUnits=function(n){return l(n)},t.invalid=function(n){var i=t.utc(NaN);return n!=null?o(i._pf,n):i._pf.userInvalidated=!0,i},t.parseZone=function(n){return t(n).parseZone()},o(t.fn=ft.prototype,{clone:function(){return t(this)},valueOf:function(){return+this._d+(this._offset||0)*6e4},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var n=t(this).utc();return 0<n.year()&&n.year()<=9999?lt(n,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):lt(n,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var n=this;return[n.year(),n.month(),n.date(),n.hours(),n.minutes(),n.seconds(),n.milliseconds()]},isValid:function(){return vi(this)},isDSTShifted:function(){return this._a?this.isValid()&&ei(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray())>0:!1},parsingFlags:function(){return o({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(n){var i=lt(this,n||t.defaultFormat);return this.lang().postformat(i)},add:function(n,i){var r;return r=typeof n=="string"?t.duration(+i,n):t.duration(n,i),ot(this,r,1),this},subtract:function(n,i){var r;return r=typeof n=="string"?t.duration(+i,n):t.duration(n,i),ot(this,r,-1),this},diff:function(n,i,r){var f=ct(n,this),o=(this.zone()-f.zone())*6e4,u,e;return i=l(i),i==="year"||i==="month"?(u=(this.daysInMonth()+f.daysInMonth())*432e5,e=(this.year()-f.year())*12+(this.month()-f.month()),e+=(this-t(this).startOf("month")-(f-t(f).startOf("month")))/u,e-=(this.zone()-t(this).startOf("month").zone()-(f.zone()-t(f).startOf("month").zone()))*6e4/u,i==="year"&&(e=e/12)):(u=this-f,e=i==="second"?u/1e3:i==="minute"?u/6e4:i==="hour"?u/36e5:i==="day"?(u-o)/864e5:i==="week"?(u-o)/6048e5:u),r?e:y(e)},from:function(n,i){return t.duration(this.diff(n)).lang(this.lang()._abbr).humanize(!i)},fromNow:function(n){return this.from(t(),n)},calendar:function(){var i=ct(t(),this).startOf("day"),n=this.diff(i,"days",!0),r=n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(r,this))},isLeapYear:function(){return ci(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=bi(n,this.lang()),this.add({d:n-t})):t},month:function(n){var i=this._isUTC?"UTC":"",r;return n!=null?typeof n=="string"&&(n=this.lang().monthsParse(n),typeof n!="number")?this:(r=this.date(),this.date(1),this._d["set"+i+"Month"](n),this.date(Math.min(r,this.daysInMonth())),t.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(n){n=l(n);switch(n){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return n==="week"?this.weekday(0):n==="isoWeek"&&this.isoWeekday(1),this},endOf:function(n){return n=l(n),this.startOf(n).add(n==="isoWeek"?"week":n,1).subtract("ms",1)},isAfter:function(n,i){return i=typeof i!="undefined"?i:"millisecond",+this.clone().startOf(i)>+t(n).startOf(i)},isBefore:function(n,i){return i=typeof i!="undefined"?i:"millisecond",+this.clone().startOf(i)<+t(n).startOf(i)},isSame:function(n,t){return t=t||"ms",+this.clone().startOf(t)==+ct(n,this).startOf(t)},min:function(n){return n=t.apply(null,arguments),n<this?this:n},max:function(n){return n=t.apply(null,arguments),n>this?this:n},zone:function(n){var i=this._offset||0;if(n!=null)typeof n=="string"&&(n=pi(n)),Math.abs(n)<16&&(n=n*60),this._offset=n,this._isUTC=!0,i!==n&&ot(this,t.duration(i-n,"m"),1,!0);else return this._isUTC?i:this._d.getTimezoneOffset();return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):typeof this._i=="string"&&this.zone(this._i),this},hasAlignedHourOffset:function(n){return n=n?t(n).zone():0,(this.zone()-n)%60==0},daysInMonth:function(){return si(this.year(),this.month())},dayOfYear:function(n){var i=p((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return n==null?i:this.add("d",n-i)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(n){var t=g(this,this.lang()._week.dow,this.lang()._week.doy).year;return n==null?t:this.add("y",n-t)},isoWeekYear:function(n){var t=g(this,1,4).year;return n==null?t:this.add("y",n-t)},week:function(n){var t=this.lang().week(this);return n==null?t:this.add("d",(n-t)*7)},isoWeek:function(n){var t=g(this,1,4).week;return n==null?t:this.add("d",(n-t)*7)},weekday:function(n){var t=(this.day()+7-this.lang()._week.dow)%7;return n==null?t:this.add("d",n-t)},isoWeekday:function(n){return n==null?this.day()||7:this.day(this.day()%7?n:n-7)},get:function(n){return n=l(n),this[n]()},set:function(n,t){return n=l(n),typeof this[n]=="function"&&this[n](t),this},lang:function(t){return t===n?this._lang:(this._lang=s(t),this)}}),r=0;r<it.length;r++)gi(it[r].toLowerCase().replace(/s$/,""),it[r]);gi("year","FullYear");t.fn.days=t.fn.day;t.fn.months=t.fn.month;t.fn.weeks=t.fn.week;t.fn.isoWeeks=t.fn.isoWeek;t.fn.toJSON=t.fn.toISOString;o(t.duration.fn=et.prototype,{_bubble:function(){var e=this._milliseconds,t=this._days,i=this._months,n=this._data,r,u,f,o;n.milliseconds=e%1e3;r=y(e/1e3);n.seconds=r%60;u=y(r/60);n.minutes=u%60;f=y(u/60);n.hours=f%24;t+=y(f/24);n.days=t%30;i+=y(t/30);n.months=i%12;o=y(i/12);n.years=o},weeks:function(){return y(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*864e5+this._months%12*2592e6+i(this._months/12)*31536e6},humanize:function(n){var i=+this,t=pu(i,!n,this.lang());return n&&(t=this.lang().pastFuture(i,t)),this.lang().postformat(t)},add:function(n,i){var r=t.duration(n,i);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(n,i){var r=t.duration(n,i);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(n){return n=l(n),this[n.toLowerCase()+"s"]()},as:function(n){return n=l(n),this["as"+n.charAt(0).toUpperCase()+n.slice(1)+"s"]()},lang:t.fn.lang,toIsoString:function(){var r=Math.abs(this.years()),u=Math.abs(this.months()),f=Math.abs(this.days()),n=Math.abs(this.hours()),t=Math.abs(this.minutes()),i=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(r?r+"Y":"")+(u?u+"M":"")+(f?f+"D":"")+(n||t||i?"T":"")+(n?n+"H":"")+(t?t+"M":"")+(i?i+"S":""):"P0D"}});for(r in rt)rt.hasOwnProperty(r)&&(nr(r,rt[r]),wu(r.toLowerCase()));nr("Weeks",6048e5);t.duration.fn.asMonths=function(){return(+this-this.years()*31536e6)/2592e6+this.years()*12};t.lang("en",{ordinal:function(n){var t=n%10,r=i(n%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return n+r}});pt?(module.exports=t,yt(!0)):typeof define=="function"&&define.amd?define("moment",function(i,r,u){return u.config&&u.config()&&u.config().noGlobal!==!0&&yt(u.config().noGlobal===n),t}):yt()}).call(this);
/*!
 * numeral.js
 * version : 1.5.3
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
(function(){function e(n){this._value=n}function o(n,t,i,r){var f=Math.pow(10,t),e,u;return u=(i(n*f)/f).toFixed(t),r&&(e=new RegExp("0{1,"+r+"}$"),u=u.replace(e,"")),u}function l(n,t,i){return t.indexOf("$")>-1?v(n,t,i):t.indexOf("%")>-1?y(n,t,i):t.indexOf(":")>-1?p(n,t):s(n._value,t,i)}function a(i,u){var o=u,s,h,c,l,a=["KB","MB","GB","TB","PB","EB","ZB","YB"],f=!1,e;if(u.indexOf(":")>-1)i._value=w(u);else if(u===r)i._value=0;else{for(n[t].delimiters.decimal!=="."&&(u=u.replace(/\./g,"").replace(n[t].delimiters.decimal,".")),s=new RegExp("[^a-zA-Z]"+n[t].abbreviations.thousand+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),h=new RegExp("[^a-zA-Z]"+n[t].abbreviations.million+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),c=new RegExp("[^a-zA-Z]"+n[t].abbreviations.billion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),l=new RegExp("[^a-zA-Z]"+n[t].abbreviations.trillion+"(?:\\)|(\\"+n[t].currency.symbol+")?(?:\\))?)?$"),e=0;e<=a.length;e++)if(f=u.indexOf(a[e])>-1?Math.pow(1024,e+1):!1,f)break;i._value=(f?f:1)*(o.match(s)?Math.pow(10,3):1)*(o.match(h)?Math.pow(10,6):1)*(o.match(c)?Math.pow(10,9):1)*(o.match(l)?Math.pow(10,12):1)*(u.indexOf("%")>-1?.01:1)*((u.split("-").length+Math.min(u.split("(").length-1,u.split(")").length-1))%2?1:-1)*Number(u.replace(/[^0-9\.]+/g,""));i._value=f?Math.ceil(i._value):i._value}return i._value}function v(i,r,u){var o=r.indexOf("$"),c=r.indexOf("("),l=r.indexOf("-"),e="",h,f;return r.indexOf(" $")>-1?(e=" ",r=r.replace(" $","")):r.indexOf("$ ")>-1?(e=" ",r=r.replace("$ ","")):r=r.replace("$",""),f=s(i._value,r,u),o<=1?f.indexOf("(")>-1||f.indexOf("-")>-1?(f=f.split(""),h=1,(o<c||o<l)&&(h=0),f.splice(h,0,n[t].currency.symbol+e),f=f.join("")):f=n[t].currency.symbol+e+f:f.indexOf(")")>-1?(f=f.split(""),f.splice(-1,0,e+n[t].currency.symbol),f=f.join("")):f=f+e+n[t].currency.symbol,f}function y(n,t,i){var u="",r,f=n._value*100;return t.indexOf(" %")>-1?(u=" ",t=t.replace(" %","")):t=t.replace("%",""),r=s(f,t,i),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,u+"%"),r=r.join("")):r=r+u+"%",r}function p(n){var i=Math.floor(n._value/3600),t=Math.floor((n._value-i*3600)/60),r=Math.round(n._value-i*3600-t*60);return i+":"+(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function w(n){var i=n.split(":"),t=0;return i.length===3?(t=t+Number(i[0])*3600,t=t+Number(i[1])*60,t=t+Number(i[2])):i.length===2&&(t=t+Number(i[0])*60,t=t+Number(i[1])),Number(t)}function s(i,u,f){var b=!1,it=!1,rt=!1,e="",d=!1,g=!1,nt=!1,tt=!1,v=!1,y="",p="",l=Math.abs(i),ut=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k,ft,a,h,s,et,c="",w=!1;if(i===0&&r!==null)return r;if(u.indexOf("(")>-1?(b=!0,u=u.slice(1,-1)):u.indexOf("+")>-1&&(it=!0,u=u.replace(/\+/g,"")),u.indexOf("a")>-1&&(d=u.indexOf("aK")>=0,g=u.indexOf("aM")>=0,nt=u.indexOf("aB")>=0,tt=u.indexOf("aT")>=0,v=d||g||nt||tt,u.indexOf(" a")>-1?(e=" ",u=u.replace(" a","")):u=u.replace("a",""),l>=Math.pow(10,12)&&!v||tt?(e=e+n[t].abbreviations.trillion,i=i/Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)&&!v||nt?(e=e+n[t].abbreviations.billion,i=i/Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)&&!v||g?(e=e+n[t].abbreviations.million,i=i/Math.pow(10,6)):(l<Math.pow(10,6)&&l>=Math.pow(10,3)&&!v||d)&&(e=e+n[t].abbreviations.thousand,i=i/Math.pow(10,3))),u.indexOf("b")>-1)for(u.indexOf(" b")>-1?(y=" ",u=u.replace(" b","")):u=u.replace("b",""),a=0;a<=ut.length;a++)if(k=Math.pow(1024,a),ft=Math.pow(1024,a+1),i>=k&&i<ft){y=y+ut[a];k>0&&(i=i/k);break}return u.indexOf("o")>-1&&(u.indexOf(" o")>-1?(p=" ",u=u.replace(" o","")):u=u.replace("o",""),p=p+n[t].ordinal(i)),u.indexOf("[.]")>-1&&(rt=!0,u=u.replace("[.]",".")),h=i.toString().split(".")[0],s=u.split(".")[1],et=u.indexOf(","),s?(s.indexOf("[")>-1?(s=s.replace("]",""),s=s.split("["),c=o(i,s[0].length+s[1].length,f,s[1].length)):c=o(i,s.length,f),h=c.split(".")[0],c=c.split(".")[1].length?n[t].delimiters.decimal+c.split(".")[1]:"",rt&&Number(c.slice(1))===0&&(c="")):h=o(i,null,f),h.indexOf("-")>-1&&(h=h.slice(1),w=!0),et>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+n[t].delimiters.thousands)),u.indexOf(".")===0&&(h=""),(b&&w?"(":"")+(!b&&w?"-":"")+(!w&&it?"+":"")+h+c+(p?p:"")+(e?e:"")+(y?y:"")+(b&&w?")":"")}function b(t,i){n[t]=i}function h(n){var t=n.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function u(){var n=Array.prototype.slice.call(arguments);return n.reduce(function(n,t){var i=h(n),r=h(t);return i>r?i:r},-Infinity)}var i,n={},t="en",r=null,f="0,0",c=typeof module!="undefined"&&module.exports;i=function(n){return i.isNumeral(n)?n=n.value():n===0||typeof n=="undefined"?n=0:Number(n)||(n=i.fn.unformat(n)),new e(Number(n))};i.version="1.5.3";i.isNumeral=function(n){return n instanceof e};i.language=function(r,u){if(!r)return t;if(r&&!u){if(!n[r])throw new Error("Unknown language : "+r);t=r}return(u||!n[r])&&b(r,u),i};i.languageData=function(i){if(!i)return n[t];if(!n[i])throw new Error("Unknown language : "+i);return n[i]};i.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(n){var t=n%10;return~~(n%100/10)==1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});i.zeroFormat=function(n){r=typeof n=="string"?n:null};i.defaultFormat=function(n){f=typeof n=="string"?n:"0.0"};i.validate=function(n,t){var s,h,c,r,e,o,f,u;if(typeof n!="string"&&(n+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",n)),n=n.trim(),n==="")return!1;n=n.replace(/^[+-]?/,"");try{f=i.languageData(t)}catch(l){f=i.languageData(i.language())}return(c=f.currency.symbol,e=f.abbreviations,s=f.delimiters.decimal,h=f.delimiters.thousands==="."?"\\.":f.delimiters.thousands,u=n.match(/^[^\d]+/),u!==null&&(n=n.substr(1),u[0]!==c))?!1:(u=n.match(/[^\d]+$/),u!==null&&(n=n.slice(0,-1),u[0]!==e.thousand&&u[0]!==e.million&&u[0]!==e.billion&&u[0]!==e.trillion))?!1:!n.match(/^\d+$/)?(o=new RegExp(h+"{2}"),!n.match(/[^\d.,]/g))?(r=n.split(s),r.length>2?!1:r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(o):r[0].length===1?!!r[0].match(/^\d+$/)&&!r[0].match(o)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(o)&&!!r[1].match(/^\d+$/)):!1:!0};"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(n,t){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof n)throw new TypeError(n+" is not a function");var i,r,f=this.length>>>0,u=!1;for(1<arguments.length&&(r=t,u=!0),i=0;f>i;++i)this.hasOwnProperty(i)&&(u?r=n(r,this[i],i,this):(r=this[i],u=!0));if(!u)throw new TypeError("Reduce of empty array with no initial value");return r});i.fn=e.prototype={clone:function(){return i(this)},format:function(n,t){return l(this,n?n:f,t!==undefined?t:Math.round)},unformat:function(n){return Object.prototype.toString.call(n)==="[object Number]"?n:a(this,n?n:f)},value:function(){return this._value},valueOf:function(){return this._value},set:function(n){return this._value=Number(n),this},add:function(n){function i(n,i){return n+t*i}var t=u.call(null,this._value,n);return this._value=[this._value,n].reduce(i,0)/t,this},subtract:function(n){function i(n,i){return n-t*i}var t=u.call(null,this._value,n);return this._value=[n].reduce(i,this._value*t)/t,this},multiply:function(n){function t(n,t){var i=u(n,t);return n*i*t*i/(i*i)}return this._value=[this._value,n].reduce(t,1),this},divide:function(n){function t(n,t){var i=u(n,t);return n*i/(t*i)}return this._value=[this._value,n].reduce(t),this},difference:function(n){return Math.abs(i(this._value).subtract(n).value())}};c&&(module.exports=i);typeof ender=="undefined"&&(this.numeral=i);typeof define=="function"&&define.amd&&define([],function(){return i})}).call(window),function(n){"use strict";function f(n,t){var i=(n&65535)+(t&65535),r=(n>>16)+(t>>16)+(i>>16);return r<<16|i&65535}function p(n,t){return n<<t|n>>>32-t}function e(n,t,i,r,u,e){return f(p(f(f(t,n),f(r,e)),u),i)}function t(n,t,i,r,u,f,o){return e(t&i|~t&r,n,t,u,f,o)}function i(n,t,i,r,u,f,o){return e(t&r|i&~r,n,t,u,f,o)}function r(n,t,i,r,u,f,o){return e(t^i^r,n,t,u,f,o)}function u(n,t,i,r,u,f,o){return e(i^(t|~r),n,t,u,f,o)}function o(n,e){n[e>>5]|=128<<e%32;n[(e+64>>>9<<4)+14]=e;for(var a,v,y,p,o=1732584193,s=-271733879,h=-1732584194,c=271733878,l=0;l<n.length;l+=16)a=o,v=s,y=h,p=c,o=t(o,s,h,c,n[l],7,-680876936),c=t(c,o,s,h,n[l+1],12,-389564586),h=t(h,c,o,s,n[l+2],17,606105819),s=t(s,h,c,o,n[l+3],22,-1044525330),o=t(o,s,h,c,n[l+4],7,-176418897),c=t(c,o,s,h,n[l+5],12,1200080426),h=t(h,c,o,s,n[l+6],17,-1473231341),s=t(s,h,c,o,n[l+7],22,-45705983),o=t(o,s,h,c,n[l+8],7,1770035416),c=t(c,o,s,h,n[l+9],12,-1958414417),h=t(h,c,o,s,n[l+10],17,-42063),s=t(s,h,c,o,n[l+11],22,-1990404162),o=t(o,s,h,c,n[l+12],7,1804603682),c=t(c,o,s,h,n[l+13],12,-40341101),h=t(h,c,o,s,n[l+14],17,-1502002290),s=t(s,h,c,o,n[l+15],22,1236535329),o=i(o,s,h,c,n[l+1],5,-165796510),c=i(c,o,s,h,n[l+6],9,-1069501632),h=i(h,c,o,s,n[l+11],14,643717713),s=i(s,h,c,o,n[l],20,-373897302),o=i(o,s,h,c,n[l+5],5,-701558691),c=i(c,o,s,h,n[l+10],9,38016083),h=i(h,c,o,s,n[l+15],14,-660478335),s=i(s,h,c,o,n[l+4],20,-405537848),o=i(o,s,h,c,n[l+9],5,568446438),c=i(c,o,s,h,n[l+14],9,-1019803690),h=i(h,c,o,s,n[l+3],14,-187363961),s=i(s,h,c,o,n[l+8],20,1163531501),o=i(o,s,h,c,n[l+13],5,-1444681467),c=i(c,o,s,h,n[l+2],9,-51403784),h=i(h,c,o,s,n[l+7],14,1735328473),s=i(s,h,c,o,n[l+12],20,-1926607734),o=r(o,s,h,c,n[l+5],4,-378558),c=r(c,o,s,h,n[l+8],11,-2022574463),h=r(h,c,o,s,n[l+11],16,1839030562),s=r(s,h,c,o,n[l+14],23,-35309556),o=r(o,s,h,c,n[l+1],4,-1530992060),c=r(c,o,s,h,n[l+4],11,1272893353),h=r(h,c,o,s,n[l+7],16,-155497632),s=r(s,h,c,o,n[l+10],23,-1094730640),o=r(o,s,h,c,n[l+13],4,681279174),c=r(c,o,s,h,n[l],11,-358537222),h=r(h,c,o,s,n[l+3],16,-722521979),s=r(s,h,c,o,n[l+6],23,76029189),o=r(o,s,h,c,n[l+9],4,-640364487),c=r(c,o,s,h,n[l+12],11,-421815835),h=r(h,c,o,s,n[l+15],16,530742520),s=r(s,h,c,o,n[l+2],23,-995338651),o=u(o,s,h,c,n[l],6,-198630844),c=u(c,o,s,h,n[l+7],10,1126891415),h=u(h,c,o,s,n[l+14],15,-1416354905),s=u(s,h,c,o,n[l+5],21,-57434055),o=u(o,s,h,c,n[l+12],6,1700485571),c=u(c,o,s,h,n[l+3],10,-1894986606),h=u(h,c,o,s,n[l+10],15,-1051523),s=u(s,h,c,o,n[l+1],21,-2054922799),o=u(o,s,h,c,n[l+8],6,1873313359),c=u(c,o,s,h,n[l+15],10,-30611744),h=u(h,c,o,s,n[l+6],15,-1560198380),s=u(s,h,c,o,n[l+13],21,1309151649),o=u(o,s,h,c,n[l+4],6,-145523070),c=u(c,o,s,h,n[l+11],10,-1120210379),h=u(h,c,o,s,n[l+2],15,718787259),s=u(s,h,c,o,n[l+9],21,-343485551),o=f(o,a),s=f(s,v),h=f(h,y),c=f(c,p);return[o,s,h,c]}function c(n){for(var i="",t=0;t<n.length*32;t+=8)i+=String.fromCharCode(n[t>>5]>>>t%32&255);return i}function s(n){var t,i=[];for(i[(n.length>>2)-1]=undefined,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<n.length*8;t+=8)i[t>>5]|=(n.charCodeAt(t/8)&255)<<t%32;return i}function w(n){return c(o(s(n),n.length*8))}function b(n,t){var i,r=s(n),u=[],f=[],e;for(u[15]=f[15]=undefined,r.length>16&&(r=o(r,n.length*8)),i=0;i<16;i+=1)u[i]=r[i]^909522486,f[i]=r[i]^1549556828;return e=o(u.concat(s(t)),512+t.length*8),c(o(f.concat(e),640))}function l(n){for(var r="0123456789abcdef",u="",i,t=0;t<n.length;t+=1)i=n.charCodeAt(t),u+=r.charAt(i>>>4&15)+r.charAt(i&15);return u}function h(n){return unescape(encodeURIComponent(n))}function a(n){return w(h(n))}function k(n){return l(a(n))}function v(n,t){return b(h(n),h(t))}function d(n,t){return l(v(n,t))}function y(n,t,i){return t?i?v(t,n):d(t,n):i?a(n):k(n)}typeof define=="function"&&define.amd?define(function(){return y}):n.md5=y}(this);this.j$=this.jStat=function(n){function s(t,i){var r=t>i?t:i;return n.pow(10,17-~~(n.log(r>0?r:-r)*n.LOG10E))}function f(n){return o.call(n)==="[object Function]"}function u(n){return typeof n=="number"&&n===n}function l(n){return c.apply([],n)}function t(){return new t._init(arguments)}function h(){return 0}function a(){return 1}function v(n,t){return n===t?1:0}var c=Array.prototype.concat,e=Array.prototype.slice,o=Object.prototype.toString,r=Array.isArray||function(n){return o.call(n)==="[object Array]"},i;return t.fn=t.prototype,t._init=function(n){var i;if(r(n[0]))if(r(n[0][0])){for(f(n[1])&&(n[0]=t.map(n[0],n[1])),i=0;i<n[0].length;i++)this[i]=n[0][i];this.length=n[0].length}else this[0]=f(n[1])?t.map(n[0],n[1]):n[0],this.length=1;else if(u(n[0]))this[0]=t.seq.apply(null,n),this.length=1;else{if(n[0]instanceof t)return t(n[0].toArray());this[0]=[];this.length=1}return this},t._init.prototype=t.prototype,t._init.constructor=t,t.utils={calcRdx:s,isArray:r,isFunction:f,isNumber:u,toVector:l},t.extend=function(n){var r,i;if(arguments.length===1){for(i in n)t[i]=n[i];return this}for(r=1;r<arguments.length;r++)for(i in arguments[r])n[i]=arguments[r][i];return n},t.rows=function(n){return n.length||1},t.cols=function(n){return n[0].length||1},t.dimensions=function(n){return{rows:t.rows(n),cols:t.cols(n)}},t.row=function(n,t){return n[t]},t.col=function(n,t){for(var r=new Array(n.length),i=0;i<n.length;i++)r[i]=[n[i][t]];return r},t.diag=function(n){for(var r=t.rows(n),u=new Array(r),i=0;i<r;i++)u[i]=[n[i][i]];return u},t.antidiag=function(n){for(var i=t.rows(n)-1,u=new Array(i),r=0;i>=0;i--,r++)u[r]=[n[r][i]];return u},t.transpose=function(n){var i=[],f,e,o,t,u;for(r(n[0])||(n=[n]),e=n.length,o=n[0].length,u=0;u<o;u++){for(f=new Array(e),t=0;t<e;t++)f[t]=n[t][u];i.push(f)}return i.length===1?i[0]:i},t.map=function(n,t,i){var u,o,s,f,e;for(r(n[0])||(n=[n]),o=n.length,s=n[0].length,f=i?n:new Array(o),u=0;u<o;u++)for(f[u]||(f[u]=new Array(s)),e=0;e<s;e++)f[u][e]=t(n[u][e],u,e);return f.length===1?f[0]:f},t.alter=function(n,i){return t.map(n,i,!0)},t.create=function(n,t,i){var e=new Array(n),r,u;for(f(t)&&(i=t,t=n),r=0;r<n;r++)for(e[r]=new Array(t),u=0;u<t;u++)e[r][u]=i(r,u);return e},t.zeros=function(n,i){return u(i)||(i=n),t.create(n,i,h)},t.ones=function(n,i){return u(i)||(i=n),t.create(n,i,a)},t.rand=function(i,r){return u(r)||(r=i),t.create(i,r,n.random)},t.identity=function(n,i){return u(i)||(i=n),t.create(n,i,v)},t.symmetric=function(n){var r=n.length,t,i;if(n.length!==n[0].length)return!1;for(t=0;t<r;t++)for(i=0;i<r;i++)if(n[i][t]!==n[t][i])return!1;return!0},t.clear=function(n){return t.alter(n,h)},t.seq=function(n,t,i,r){f(r)||(r=!1);for(var h=[],u=s(n,t),c=(t*u-n*u)/((i-1)*u),e=n,o=0;e<=t;o++,e=(n*u+c*u*o)/u)h.push(r?r(e,o):e);return h},i=t.prototype,i.length=0,i.push=Array.prototype.push,i.sort=Array.prototype.sort,i.splice=Array.prototype.splice,i.slice=Array.prototype.slice,i.toArray=function(){return this.length>1?e.call(this):e.call(this)[0]},i.map=function(n,i){return t(t.map(this,n,i))},i.alter=function(n){return t.alter(this,n),this},function(n){for(var u=0;u<n.length;u++)(function(n){i[n]=function(u){var e=this,f;return u?(setTimeout(function(){u.call(e,i[n].call(e))}),this):(f=t[n](this),r(f)?t(f):f)}})(n[u])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){i[n]=function(r,u){var f=this;return u?(setTimeout(function(){u.call(f,i[n].call(f,r))}),this):t(t[n](this,r))}})(n[r])}("row col".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(n){i[n]=new Function("return jStat(jStat."+n+".apply(null, arguments));")})(n[t])}("create zeros ones rand identity".split(" ")),t}(Math),function(n,t){function r(n,t){return n-t}function f(n,i,r){return t.max(i,t.min(n,r))}var u=n.utils.isFunction,i;n.sum=function(n){for(var t=0,i=n.length;--i>=0;)t+=n[i];return t};n.sumsqrd=function(n){for(var i=0,t=n.length;--t>=0;)i+=n[t]*n[t];return i};n.sumsqerr=function(t){for(var f=n.mean(t),r=0,u=t.length,i;--u>=0;)i=t[u]-f,r+=i*i;return r};n.product=function(n){for(var t=1,i=n.length;--i>=0;)t*=n[i];return t};n.min=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]<t&&(t=n[i]);return t};n.max=function(n){for(var t=n[0],i=0;++i<n.length;)n[i]>t&&(t=n[i]);return t};n.mean=function(t){return n.sum(t)/t.length};n.meansqerr=function(t){return n.sumsqerr(t)/t.length};n.geomean=function(i){return t.pow(n.product(i),1/i.length)};n.median=function(n){var t=n.length,i=n.slice().sort(r);return(t&1)?i[t/2|0]:(i[t/2-1]+i[t/2])/2};n.cumsum=function(n){var r=n.length,i=new Array(r),t;for(i[0]=n[0],t=1;t<r;t++)i[t]=i[t-1]+n[t];return i};n.diff=function(n){for(var i=[],r=n.length,t=1;t<r;t++)i.push(n[t]-n[t-1]);return i};n.mode=function(n){for(var s=n.length,u=n.slice().sort(r),i=1,e=0,o=0,f=[],t=0;t<s;t++)u[t]===u[t+1]?i++:(i>e?(f=[u[t]],e=i,o=0):i===e&&(f.push(u[t]),o++),i=1);return o===0?f[0]:f};n.range=function(t){return n.max(t)-n.min(t)};n.variance=function(t,i){return n.sumsqerr(t)/(t.length-(i?1:0))};n.stdev=function(i,r){return t.sqrt(n.variance(i,r))};n.meandev=function(i){for(var u=0,f=n.mean(i),r=i.length-1;r>=0;r--)u+=t.abs(i[r]-f);return u/i.length};n.meddev=function(i){for(var u=0,f=n.median(i),r=i.length-1;r>=0;r--)u+=t.abs(i[r]-f);return u/i.length};n.coeffvar=function(t){return n.stdev(t)/n.mean(t)};n.quartiles=function(n){var i=n.length,u=n.slice().sort(r);return[u[t.round(i/4)-1],u[t.round(i/2)-1],u[t.round(i*3/4)-1]]};n.quantiles=function(n,i,u,e){var a=n.slice().sort(r),v=[i.length],y=n.length,o,h,p,c,s,l;for(typeof u=="undefined"&&(u=3/8),typeof e=="undefined"&&(e=3/8),o=0;o<i.length;o++)h=i[o],p=u+h*(1-u-e),c=y*h+p,s=t.floor(f(c,1,y-1)),l=f(c-s,0,1),v[o]=(1-l)*a[s-1]+l*a[s];return v};n.percentileOfScore=function(n,t,i){var e=0,o=n.length,u=!1,f,r;for(i==="strict"&&(u=!0),r=0;r<o;r++)f=n[r],(u&&f<t||!u&&f<=t)&&e++;return e/o};n.covariance=function(t,i){for(var e=n.mean(t),o=n.mean(i),u=t.length,f=new Array(u),r=0;r<u;r++)f[r]=(t[r]-e)*(i[r]-o);return n.sum(f)/(u-1)};n.corrcoeff=function(t,i){return n.covariance(t,i)/n.stdev(t,1)/n.stdev(i,1)};i=n.prototype;i.cumsum=function(t,r){var o=[],e=0,f=this;if(u(t)&&(r=t,t=!1),r)return setTimeout(function(){r.call(f,i.cumsum.call(f,t))}),this;if(this.length>1){for(f=t===!0?this:this.transpose();e<f.length;e++)o[e]=n.cumsum(f[e]);return o}return n.cumsum(this[0],t)},function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(r,f){var s=[],o=0,e=this;if(u(r)&&(f=r,r=!1),f)return setTimeout(function(){f.call(e,i[t].call(e,r))}),this;if(this.length>1){for(e=r===!0?this:this.transpose();o<e.length;o++)s[o]=n[t](e[o]);return r===!0?n[t](n.utils.toVector(s)):s}return n[t](this[0],r)}})(t[r])}("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles".split(" ")),function(t){for(var r=0;r<t.length;r++)(function(t){i[t]=function(){var h=[],e=0,r=this,f=Array.prototype.slice.call(arguments),c,o,s;if(u(f[f.length-1]))return o=f[f.length-1],c=f.slice(0,f.length-1),setTimeout(function(){o.call(r,i[t].apply(r,c))}),this;if(o=undefined,s=function(i){return n[t].apply(r,[i].concat(f))},this.length>1){for(r=r.transpose();e<r.length;e++)h[e]=s(r[e]);return h}return s(this[0])}})(t[r])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(n,t){n.gammaln=function(n){var r=0,o=[76.180091729471457,-86.505320329416776,24.014098240830911,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.0000000001900149,u,e,i;for(i=(e=u=n)+5.5,i-=(u+.5)*t.log(i);r<6;r++)f+=o[r]/++e;return t.log(2.5066282746310007*f/u)-i};n.gammafn=function(n){var l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.96620279041326,-31451.272968848367,-36144.413418691176,66456.143820240541],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.7716715723109,22538.11842098015,4755.8462775278813,-134659.95986496931,-115132.25967555351],e=!1,c=0,o=0,s=0,i=n,u,h,f,r;if(i<=0)if(r=i%1+36e-17,r)e=((i&1)?-1:1)*t.PI/t.sin(t.PI*r),i=1-i;else return Infinity;for(f=i,h=i<1?i++:(i-=c=(i|0)-1)-1,u=0;u<8;++u)s=(s+l[u])*h,o=o*h+a[u];if(r=s/o+1,f<i)r/=f;else if(f>i)for(u=0;u<c;++u)r*=i,i++;return e&&(r=e/r),r};n.gammap=function(i,r){var c=n.gammaln(i),v=i,o=1/i,y=o,e=r+1-i,s=1/1e-30,u=1/e,l=u,f=1,a=-~(t.log(i>=1?i:1/i)*8.5+i*.4+17),h;if(r<0||i<=0)return NaN;if(r<i+1){for(;f<=a;f++)o+=y*=r/++v;return o*t.exp(-r+i*t.log(r)-c)}for(;f<=a;f++)h=-f*(f-i),e+=2,u=h*u+e,s=e+h/s,u=1/u,l*=u*s;return 1-l*t.exp(-r+i*t.log(r)-c)};n.factorialln=function(t){return t<0?NaN:n.gammaln(t+1)};n.factorial=function(t){return t<0?NaN:n.gammafn(t+1)};n.combination=function(i,r){return i>170||r>170?t.exp(n.combinationln(i,r)):n.factorial(i)/n.factorial(r)/n.factorial(i-r)};n.combinationln=function(t,i){return n.factorialln(t)-n.factorialln(i)-n.factorialln(t-i)};n.permutation=function(t,i){return n.factorial(t)/n.factorial(t-i)};n.betafn=function(i,r){return i<=0||r<=0?undefined:i+r>170?t.exp(n.betaln(i,r)):n.gammafn(i)*n.gammafn(r)/n.gammafn(i+r)};n.betaln=function(t,i){return n.gammaln(t)+n.gammaln(i)-n.gammaln(t+i)};n.betacf=function(n,i,r){var f=1e-30,o=1,a=i+r,v=i+1,y=i-1,e=1,u=1-a*n/v,h,s,l,c;for(t.abs(u)<f&&(u=f),u=1/u,c=u;o<=100;o++)if(h=2*o,s=o*(r-o)*n/((y+h)*(i+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,c*=u*e,s=-(i+o)*(a+o)*n/((i+h)*(v+h)),u=1+s*u,t.abs(u)<f&&(u=f),e=1+s/e,t.abs(e)<f&&(e=f),u=1/u,l=u*e,c*=l,t.abs(l-1)<3e-7)break;return c};n.gammapinv=function(i,r){var h=0,e=r-1,c=n.gammaln(r),u,l,f,o,a,s,v;if(i>=1)return t.max(100,r+100*t.sqrt(r));if(i<=0)return 0;for(r>1?(s=t.log(e),v=t.exp(e*(s-1)-c),a=i<.5?i:1-i,f=t.sqrt(-2*t.log(a)),u=(2.30753+f*.27061)/(1+f*(.99229+f*.04481))-f,i<.5&&(u=-u),u=t.max(.001,r*t.pow(1-1/(9*r)-u/(3*t.sqrt(r)),3))):(f=1-r*(.253+r*.12),u=i<f?t.pow(i/f,1/r):1-t.log(1-(i-f)/(1-f)));h<12;h++){if(u<=0)return 0;if(l=n.gammap(r,u)-i,f=r>1?v*t.exp(-(u-e)+e*(t.log(u)-s)):t.exp(-u+e*t.log(u)-c),o=l/f,u-=f=o/(1-.5*t.min(1,o*((r-1)/u-1))),u<=0&&(u=.5*(u+f)),t.abs(f)<1e-8*u)break}return u};n.erf=function(n){var r=[-1.3026537197817094,.64196979235649021,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=r.length-1,h=!1,i=0,f=0,e,o,c,s;for(n<0&&(n=-n,h=!0),e=2/(2+n),o=4*e-2;u>0;u--)c=i,i=o*i-f+r[u],f=c;return s=e*t.exp(-n*n+.5*(r[0]+o*i)-f),h?s-1:1-s};n.erfc=function(t){return 1-n.erf(t)};n.erfcinv=function(i){var o=0,r,f,u,e;if(i>=2)return-100;if(i<=0)return 100;for(e=i<1?i:2-i,u=t.sqrt(-2*t.log(e/2)),r=-.70711*((2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u);o<2;o++)f=n.erfc(r)-e,r+=f/(1.1283791670955126*t.exp(-r*r)-r*f);return i<1?r:-r};n.ibetainv=function(i,r,u){var a=r-1,v=u-1,c=0,y,p,w,e,s,b,f,l,h,o,k;if(i<=0)return 0;if(i>=1)return 1;for(r>=1&&u>=1?(w=i<.5?i:1-i,e=t.sqrt(-2*t.log(w)),f=(2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e,i<.5&&(f=-f),l=(f*f-3)/6,h=2/(1/(2*r-1)+1/(2*u-1)),o=f*t.sqrt(l+h)/h-(1/(2*u-1)-1/(2*r-1))*(l+5/6-2/(3*h)),f=r/(r+u*t.exp(2*o))):(y=t.log(r/(r+u)),p=t.log(u/(r+u)),e=t.exp(r*y)/r,s=t.exp(u*p)/u,o=e+s,f=i<e/o?t.pow(r*o*i,1/r):1-t.pow(u*o*(1-i),1/u)),k=-n.gammaln(r)-n.gammaln(u)+n.gammaln(r+u);c<10;c++){if(f===0||f===1)return f;if(b=n.ibeta(f,r,u)-i,e=t.exp(a*t.log(f)+v*t.log(1-f)+k),s=b/e,f-=e=s/(1-.5*t.min(1,s*(a/f-v/(1-f)))),f<=0&&(f=.5*(f+e)),f>=1&&(f=.5*(f+e+1)),t.abs(e)<1e-8*f&&c>0)break}return f};n.ibeta=function(i,r,u){var f=i===0||i===1?0:t.exp(n.gammaln(r+u)-n.gammaln(r)-n.gammaln(u)+r*t.log(i)+u*t.log(1-i));return i<0||i>1?!1:i<(r+1)/(r+u+2)?f*n.betacf(i,r,u)/r:1-f*n.betacf(1-i,u,r)/u};n.randn=function(i,r){var u,f,e,o,s;if(r||(r=i),i)return n.create(i,r,function(){return n.randn()});do u=t.random(),f=1.7156*(t.random()-.5),e=u-.449871,o=t.abs(f)+.386595,s=e*e+o*(.196*o-.25472*e);while(s>.27597&&(s>.27846||f*f>-4*t.log(u)*u*u));return f/u};n.randg=function(i,r,u){var c=i,o,l,e,f,s,h;if(u||(u=r),i||(i=1),r)return h=n.zeros(r,u),h.alter(function(){return n.randg(i)}),h;i<1&&(i+=1);o=i-1/3;l=1/t.sqrt(9*o);do{do s=n.randn(),f=1+l*s;while(f<=0);f=f*f*f;e=t.random()}while(e>1-.331*t.pow(s,4)&&t.log(e)>.5*s*s+o*(1-f+t.log(f)));if(i==c)return o*f;do e=t.random();while(e===0);return t.pow(e,1/c)*o*f},function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n.map(this,function(i){return n[t](i)}))}})(t[i])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(){return n(n[t].apply(null,arguments))}})(t[i])}("randn".split(" "))}(this.jStat,Math),function(n,t){(function(t){for(var i=0;i<t.length;i++)(function(t){n[t]=function(n,t,i){return(this instanceof arguments.callee)?(this._a=n,this._b=t,this._c=i,this):new arguments.callee(n,t,i)};n.fn[t]=function(i,r,u){var f=n[t](i,r,u);return f.data=this,f};n[t].prototype.sample=function(i){var r=this._a,u=this._b,f=this._c;return i?n.alter(i,function(){return n[t].sample(r,u,f)}):n[t].sample(r,u,f)},function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(r){var u=this._a,f=this._b,e=this._c;return(r||r===0||(r=this.data),typeof r!="number")?n.fn.map.call(r,function(r){return n[t][i](r,u,f,e)}):n[t][i](r,u,f,e)}})(i[r])}("pdf cdf inv".split(" ")),function(i){for(var r=0;r<i.length;r++)(function(i){n[t].prototype[i]=function(){return n[t][i](this._a,this._b,this._c)}})(i[r])}("mean median mode variance".split(" "))})(t[i])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));n.extend(n.beta,{pdf:function(i,r,u){return i>1||i<0?0:r==1&&u==1?1:r<512||u<512?t.pow(i,r-1)*t.pow(1-i,u-1)/n.betafn(r,u):t.exp((r-1)*t.log(i)+(u-1)*t.log(1-i)-n.betaln(r,u))},cdf:function(t,i,r){return t>1||t<0?(t>1)*1:n.ibeta(t,i,r)},inv:function(t,i,r){return n.ibetainv(t,i,r)},mean:function(n,t){return n/(n+t)},median:function(){throw new Error("median not yet implemented");},mode:function(n,i){return n*i/(t.pow(n+i,2)*(n+i+1))},sample:function(t,i){var r=n.randg(t);return r/(r+n.randg(i))},variance:function(n,i){return n*i/(t.pow(n+i,2)*(n+i+1))}});n.extend(n.centralF,{pdf:function(i,r,u){return i<0?undefined:t.sqrt(t.pow(r*i,r)*t.pow(u,u)/t.pow(r*i+u,r+u))/(i*n.betafn(r/2,u/2))},cdf:function(t,i,r){return n.ibeta(i*t/(i*t+r),i/2,r/2)},inv:function(t,i,r){return r/(i*(1/n.ibetainv(t,i/2,r/2)-1))},mean:function(n,t){return t>2?t/(t-2):undefined},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):undefined},sample:function(t,i){var r=n.randg(t/2)*2,u=n.randg(i/2)*2;return r/t/(u/i)},variance:function(n,t){return t<=4?undefined:2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}});n.extend(n.cauchy,{pdf:function(n,i,r){return r/(t.pow(n-i,2)+t.pow(r,2))/t.PI},cdf:function(n,i,r){return t.atan((n-i)/r)/t.PI+.5},inv:function(n,i,r){return i+r*t.tan(t.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(i,r){return n.randn()*t.sqrt(1/(2*n.randg(.5)))*r+i}});n.extend(n.chisquare,{pdf:function(i,r){return t.exp((r/2-1)*t.log(i)-i/2-r/2*t.log(2)-n.gammaln(r/2))},cdf:function(t,i){return n.gammap(i/2,t/2)},inv:function(t,i){return 2*n.gammapinv(t,.5*i)},mean:function(n){return n},median:function(n){return n*t.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(t){return n.randg(t/2)*2},variance:function(n){return 2*n}});n.extend(n.exponential,{pdf:function(n,i){return n<0?0:i*t.exp(-i*n)},cdf:function(n,i){return n<0?0:1-t.exp(-i*n)},inv:function(n,i){return-t.log(1-n)/i},mean:function(n){return 1/n},median:function(n){return 1/n*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(t.random())},variance:function(n){return t.pow(n,-2)}});n.extend(n.gamma,{pdf:function(i,r,u){return t.exp((r-1)*t.log(i)-i/u-n.gammaln(r)-r*t.log(u))},cdf:function(t,i,r){return n.gammap(i,t/r)},inv:function(t,i,r){return n.gammapinv(t,i)*r},mean:function(n,t){return n*t},mode:function(n,t){return n>1?(n-1)*t:undefined},sample:function(t,i){return n.randg(t)*i},variance:function(n,t){return n*t*t}});n.extend(n.invgamma,{pdf:function(i,r,u){return t.exp(-(r+1)*t.log(i)-u/i-n.gammaln(r)+r*t.log(u))},cdf:function(t,i,r){return 1-n.gammap(i,r/t)},inv:function(t,i,r){return r/n.gammapinv(1-t,i)},mean:function(n,t){return n>1?t/(n-1):undefined},mode:function(n,t){return t/(n+1)},sample:function(t,i){return i/n.randg(t)},variance:function(n,t){return n<=2?undefined:t*t/((n-1)*(n-1)*(n-2))}});n.extend(n.kumaraswamy,{pdf:function(n,i,r){return t.exp(t.log(i)+t.log(r)+(i-1)*t.log(n)+(r-1)*t.log(1-t.pow(n,i)))},cdf:function(n,i,r){return 1-t.pow(1-t.pow(n,i),r)},mean:function(t,i){return i*n.gammafn(1+1/t)*n.gammafn(i)/n.gammafn(1+1/t+i)},median:function(n,i){return t.pow(1-t.pow(2,-1/i),1/n)},mode:function(n,i){return(n>=1&&i>=1&&n!==1&&i!==1)?t.pow((n-1)/(n*i-1),1/n):undefined},variance:function(){throw new Error("variance not yet implemented");}});n.extend(n.lognormal,{pdf:function(n,i,r){return t.exp(-t.log(n)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(n)-i,2)/(2*r*r))},cdf:function(i,r,u){return.5+.5*n.erf((t.log(i)-r)/t.sqrt(2*u*u))},inv:function(i,r,u){return t.exp(-1.4142135623730952*u*n.erfcinv(2*i)+r)},mean:function(n,i){return t.exp(n+i*i/2)},median:function(n){return t.exp(n)},mode:function(n,i){return t.exp(n-i*i)},sample:function(i,r){return t.exp(n.randn()*r+i)},variance:function(n,i){return(t.exp(i*i)-1)*t.exp(2*n+i*i)}});n.extend(n.normal,{pdf:function(n,i,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(n-i,2)/(2*r*r))},cdf:function(i,r,u){return.5*(1+n.erf((i-r)/t.sqrt(2*u*u)))},inv:function(t,i,r){return-1.4142135623730952*r*n.erfcinv(2*t)+i},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(t,i){return n.randn()*i+t},variance:function(n,t){return t*t}});n.extend(n.pareto,{pdf:function(n,i,r){return n<=i?undefined:r*t.pow(i,r)/t.pow(n,r+1)},cdf:function(n,i,r){return 1-t.pow(i/n,r)},mean:function(n,i){return i<=1?undefined:i*t.pow(n,i)/(i-1)},median:function(n,i){return n*i*t.SQRT2},mode:function(n){return n},variance:function(n,i){return i<=2?undefined:n*n*i/(t.pow(i-1,2)*(i-2))}});n.extend(n.studentt,{pdf:function(i,r){return n.gammafn((r+1)/2)/(t.sqrt(r*t.PI)*n.gammafn(r/2))*t.pow(1+i*i/r,-((r+1)/2))},cdf:function(i,r){var u=r/2;return n.ibeta((i+t.sqrt(i*i+r))/(2*t.sqrt(i*i+r)),u,u)},inv:function(i,r){var u=n.ibetainv(2*t.min(i,1-i),.5*r,.5);return u=t.sqrt(r*(1-u)/u),i>0?u:-u},mean:function(n){return n>1?0:undefined},median:function(){return 0},mode:function(){return 0},sample:function(i){return n.randn()*t.sqrt(i/(2*n.randg(i/2)))},variance:function(n){return n>2?n/(n-2):n>1?Infinity:undefined}});n.extend(n.weibull,{pdf:function(n,i,r){return n<0?0:r/i*t.pow(n/i,r-1)*t.exp(-t.pow(n/i,r))},cdf:function(n,i,r){return n<0?0:1-t.exp(-t.pow(n/i,r))},inv:function(n,i,r){return i*t.pow(-t.log(1-n),1/r)},mean:function(t,i){return t*n.gammafn(1+1/i)},median:function(n,i){return n*t.pow(t.log(2),1/i)},mode:function(n,i){return i<=1?undefined:n*t.pow((i-1)/i,1/i)},sample:function(n,i){return n*t.pow(-t.log(t.random()),1/i)},variance:function(i,r){return i*i*n.gammafn(1+2/r)-t.pow(this.mean(i,r),2)}});n.extend(n.uniform,{pdf:function(n,t,i){return n<t||n>i?0:1/(i-t)},cdf:function(n,t,i){return n<t?0:n<i?(n-t)/(i-t):1},mean:function(n,t){return.5*(n+t)},median:function(t,i){return n.mean(t,i)},mode:function(){throw new Error("mode is not yet implemented");},sample:function(n,i){return n/2+i/2+(i/2-n/2)*(2*t.random()-1)},variance:function(n,i){return t.pow(i-n,2)/12}});n.extend(n.binomial,{pdf:function(i,r,u){return u===0||u===1?r*u===i?1:0:n.combination(r,i)*t.pow(u,i)*t.pow(1-u,r-i)},cdf:function(t,i,r){var f=[],u=0;if(t<0)return 0;if(t<i){for(;u<=t;u++)f[u]=n.binomial.pdf(u,i,r);return n.sum(f)}return 1}});n.extend(n.negbin,{pdf:function(i,r,u){return i!==i|0?!1:i<0?0:n.combination(i+r-1,r-1)*t.pow(1-u,i)*t.pow(u,r)},cdf:function(t,i,r){var f=0,u=0;if(t<0)return 0;for(;u<=t;u++)f+=n.negbin.pdf(u,i,r);return f}});n.extend(n.hypgeom,{pdf:function(i,r,u,f){var s,e,o;if(i!==i|0)return!1;if(i<0||i<u-(r-f)||i>f||i>u)return 0;if(u*2>r)return f*2>r?n.hypgeom.pdf(r-u-f+i,r,r-u,r-f):n.hypgeom.pdf(f-i,r,r-u,f);if(f*2>r)return n.hypgeom.pdf(u-i,r,u,r-f);if(u<f)return n.hypgeom.pdf(i,r,f,u);for(s=1,e=0,o=0;o<i;o++){while(s>1&&e<f)s*=1-u/(r-e),e++;s*=(f-o)*(u-o)/((o+1)*(r-u-f+o+1))}for(;e<f;e++)s*=1-u/(r-e);return t.min(1,t.max(0,s))},cdf:function(i,r,u,f){var e,c;if(i<0||i<u-(r-f))return 0;if(i>=f||i>=u)return 1;if(u*2>r)return f*2>r?n.hypgeom.cdf(r-u-f+i,r,r-u,r-f):1-n.hypgeom.cdf(f-i-1,r,r-u,f);if(f*2>r)return 1-n.hypgeom.cdf(u-i-1,r,u,r-f);if(u<f)return n.hypgeom.cdf(i,r,f,u);var s=1,h=1,o=0;for(e=0;e<i;e++){while(s>1&&o<f)c=1-u/(r-o),h*=c,s*=c,o++;h*=(f-e)*(u-e)/((e+1)*(r-u-f+e+1));s+=h}for(;o<f;o++)s*=1-u/(r-o);return t.min(1,t.max(0,s))}});n.extend(n.poisson,{pdf:function(i,r){return t.pow(r,i)*t.exp(-r)/n.factorial(i)},cdf:function(t,i){var u=[],r=0;if(t<0)return 0;for(;r<=t;r++)u.push(n.poisson.pdf(r,i));return n.sum(u)},mean:function(n){return n},variance:function(n){return n},sample:function(n){var i=1,r=0,u=t.exp(-n);do r++,i*=t.random();while(i>u);return r-1}});n.extend(n.triangular,{pdf:function(n,t,i,r){return i<=t||r<t||r>i?undefined:n<t||n>i?0:n<=r?2*(n-t)/((i-t)*(r-t)):2*(i-n)/((i-t)*(i-r))},cdf:function(n,i,r,u){return r<=i||u<i||u>r?undefined:n<i?0:n<=u?t.pow(n-i,2)/((r-i)*(u-i)):1-t.pow(r-n,2)/((r-i)*(r-u))},mean:function(n,t,i){return(n+t+i)/3},median:function(n,i,r){return r<=(n+i)/2?i-t.sqrt((i-n)*(i-r))/t.sqrt(2):r>(n+i)/2?n+t.sqrt((i-n)*(r-n))/t.sqrt(2):void 0},mode:function(n,t,i){return i},sample:function(n,i,r){var u=t.random();return u<(r-n)/(i-n)?n+t.sqrt(u*(i-n)*(r-n)):i-t.sqrt((1-u)*(i-n)*(i-r))},variance:function(n,t,i){return(n*n+t*t+i*i-n*t-n*i-t*i)/18}})}(this.jStat,Math),function(n,t){var r=Array.prototype.push,i=n.utils.isArray;n.extend({add:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.map(t,function(n,t,i){return n+r[t][i]})):n.map(t,function(n){return n+r})},subtract:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.map(t,function(n,t,i){return n-r[t][i]||0})):n.map(t,function(n){return n-r})},divide:function(t,r){return i(r)?(i(r[0])||(r=[r]),n.multiply(t,n.inv(r))):n.map(t,function(n){return n/r})},multiply:function(t,r){var u,f,c,o,s=t.length,l=t[0].length,h=n.zeros(s,c=i(r)?r[0].length:l),e=0;if(i(r)){for(;e<c;e++)for(u=0;u<s;u++){for(o=0,f=0;f<l;f++)o+=t[u][f]*r[f][e];h[u][e]=o}return s===1&&e===1?h[0][0]:h}return n.map(t,function(n){return n*r})},dot:function(t,r){i(t[0])||(t=[t]);i(r[0])||(r=[r]);for(var o=t[0].length===1&&t.length!==1?n.transpose(t):t,h=r[0].length===1&&r.length!==1?n.transpose(r):r,f=[],u=0,c=o.length,l=o[0].length,s,e;u<c;u++){for(f[u]=[],s=0,e=0;e<l;e++)s+=o[u][e]*h[u][e];f[u]=s}return f.length===1?f[0]:f},pow:function(i,r){return n.map(i,function(n){return t.pow(n,r)})},abs:function(i){return n.map(i,function(n){return t.abs(n)})},norm:function(n,r){var f=0,u=0;for(isNaN(r)&&(r=2),i(n[0])&&(n=n[0]);u<n.length;u++)f+=t.pow(t.abs(n[u]),r);return t.pow(f,1/r)},angle:function(i,r){return t.acos(n.dot(i,r)/(n.norm(i)*n.norm(r)))},aug:function(n,t){for(var u=n.slice(),i=0;i<u.length;i++)r.apply(u[i],t[i]);return u},inv:function(t){for(var e=t.length,u=t[0].length,s=n.identity(e,u),o=n.gauss_jordan(t,s),f=[],i=0,r;i<e;i++)for(f[i]=[],r=u-1;r<o[0].length;r++)f[i][r-u]=o[i][r];return f},det:function(n){var i=n.length,o=i*2,r=new Array(o),h=i-1,c=o-1,u=h-i+1,f=c,t=0,s=0,e;if(i===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(;t<o;t++)r[t]=1;for(t=0;t<i;t++){for(e=0;e<i;e++)r[u<0?u+i:u]*=n[t][e],r[f<i?f+i:f]*=n[t][e],u++,f--;u=--h-i+1;f=--c}for(t=0;t<i;t++)s+=r[t];for(;t<o;t++)s-=r[t];return s},gauss_elimination:function(i,r){var u=0,e=0,o=i.length,y=i[0].length,a=1,h=0,c=[],s,l,v,f;for(i=n.aug(i,r),s=i[0].length;u<o;u++){for(l=i[u][u],e=u,f=u+1;f<y;f++)l<t.abs(i[f][u])&&(l=i[f][u],e=f);if(e!=u)for(f=0;f<s;f++)v=i[u][f],i[u][f]=i[e][f],i[e][f]=v;for(e=u+1;e<o;e++)for(a=i[e][u]/i[u][u],f=u;f<s;f++)i[e][f]=i[e][f]-a*i[u][f]}for(u=o-1;u>=0;u--){for(h=0,e=u+1;e<=o-1;e++)h=c[e]*i[u][e];c[u]=(i[u][s-1]-h)/i[u][u]}return c},gauss_jordan:function(i,r){for(var h,a,e,o,f=n.aug(i,r),s=f.length,l=f[0].length,u=0;u<s;u++){for(h=u,e=u+1;e<s;e++)t.abs(f[e][u])>t.abs(f[h][u])&&(h=e);for(a=f[u],f[u]=f[h],f[h]=a,e=u+1;e<s;e++)for(c=f[e][u]/f[u][u],o=u;o<l;o++)f[e][o]-=f[u][o]*c}for(u=s-1;u>=0;u--){for(c=f[u][u],e=0;e<u;e++)for(o=l-1;o>u-1;o--)f[e][o]-=f[u][o]*f[e][u]/c;for(f[u][u]/=c,o=s;o<l;o++)f[u][o]/=c}return f},lu:function(){throw new Error("lu not yet implemented");},cholesky:function(){throw new Error("cholesky not yet implemented");},gauss_jacobi:function(i,r,u,f){for(var e=0,o=0,p=i.length,h=[],c=[],s=[],a,v,y,l;e<p;e++)for(h[e]=[],c[e]=[],s[e]=[],o=0;o<p;o++)e>o?(h[e][o]=i[e][o],c[e][o]=s[e][o]=0):e<o?(c[e][o]=i[e][o],h[e][o]=s[e][o]=0):(s[e][o]=i[e][o],h[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(s),n.add(h,c)),-1),v=n.multiply(n.inv(s),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e++;return l},gauss_seidel:function(i,r,u,f){for(var e=0,p=i.length,s=[],c=[],h=[],o,a,v,y,l;e<p;e++)for(s[e]=[],c[e]=[],h[e]=[],o=0;o<p;o++)e>o?(s[e][o]=i[e][o],c[e][o]=h[e][o]=0):e<o?(c[e][o]=i[e][o],s[e][o]=h[e][o]=0):(h[e][o]=i[e][o],s[e][o]=c[e][o]=0);for(y=n.multiply(n.multiply(n.inv(n.add(h,s)),c),-1),v=n.multiply(n.inv(n.add(h,s)),r),a=u,l=n.add(n.multiply(y,u),v),e=2;t.abs(n.norm(n.subtract(l,a)))>f;)a=l,l=n.add(n.multiply(y,a),v),e=e+1;return l},SOR:function(i,r,u,f,e){for(var o=0,w=i.length,c=[],l=[],h=[],s,v,y,p,a;o<w;o++)for(c[o]=[],l[o]=[],h[o]=[],s=0;s<w;s++)o>s?(c[o][s]=i[o][s],l[o][s]=h[o][s]=0):o<s?(l[o][s]=i[o][s],c[o][s]=h[o][s]=0):(h[o][s]=i[o][s],c[o][s]=l[o][s]=0);for(p=n.multiply(n.inv(n.add(h,n.multiply(c,e))),n.subtract(n.multiply(h,1-e),n.multiply(l,e))),y=n.multiply(n.multiply(n.inv(n.add(h,n.multiply(c,e))),r),e),v=u,a=n.add(n.multiply(p,u),y),o=2;t.abs(n.norm(n.subtract(a,v)))>f;)v=a,a=n.add(n.multiply(p,v),y),o++;return a},householder:function(i){for(var s=i.length,l=i[0].length,r=0,f=[],h=[],u,c,e,o,a;r<s-1;r++){for(u=0,o=r+1;o<l;o++)u+=i[o][r]*i[o][r];for(a=i[r+1][r]>0?-1:1,u=a*t.sqrt(u),c=t.sqrt((u*u-i[r+1][r]*u)/2),f=n.zeros(s,1),f[r+1][0]=(i[r+1][r]-u)/(2*c),e=r+2;e<s;e++)f[e][0]=i[e][r]/(2*c);h=n.subtract(n.identity(s,l),n.multiply(n.multiply(f,n.transpose(f)),2));i=n.multiply(h,n.multiply(i,h))}return i},QR:function(i,r){for(var o=i.length,c=i[0].length,u=0,s=[],l=[],a=[],f,e,v,h,y,p;u<o-1;u++){for(e=0,f=u+1;f<c;f++)e+=i[f][u]*i[f][u];for(y=i[u+1][u]>0?-1:1,e=y*t.sqrt(e),v=t.sqrt((e*e-i[u+1][u]*e)/2),s=n.zeros(o,1),s[u+1][0]=(i[u+1][u]-e)/(2*v),h=u+2;h<o;h++)s[h][0]=i[h][u]/(2*v);l=n.subtract(n.identity(o,c),n.multiply(n.multiply(s,n.transpose(s)),2));i=n.multiply(l,i);r=n.multiply(l,r)}for(u=o-1;u>=0;u--){for(p=0,f=u+1;f<=c-1;f++)p=a[f]*i[u][f];a[u]=r[u][0]/i[u][u]}return a},jacobi:function(i){for(var c=1,p=0,o=i.length,l=n.identity(o,o),v=[],y,r,u,f,e,a,h,s;c===1;){for(p++,a=i[0][1],f=0,e=1,r=0;r<o;r++)for(u=0;u<o;u++)r!=u&&a<t.abs(i[r][u])&&(a=t.abs(i[r][u]),f=r,e=u);for(h=i[f][f]===i[e][e]?i[f][e]>0?t.PI/4:-t.PI/4:t.atan(2*i[f][e]/(i[f][f]-i[e][e]))/2,s=n.identity(o,o),s[f][f]=t.cos(h),s[f][e]=-t.sin(h),s[e][f]=t.sin(h),s[e][e]=t.cos(h),l=n.multiply(l,s),y=n.multiply(n.multiply(n.inv(s),i),s),i=y,c=0,r=1;r<o;r++)for(u=1;u<o;u++)r!=u&&t.abs(i[r][u])>.001&&(c=1)}for(r=0;r<o;r++)v.push(i[r][r]);return[l,v]},rungekutta:function(n,t,i,r,u,f){var e,o,s,h,c;if(f===2)while(r<=i)e=t*n(r,u),o=t*n(r+t,u+e),s=u+(e+o)/2,u=s,r=r+t;if(f===4)while(r<=i)e=t*n(r,u),o=t*n(r+t/2,u+e/2),h=t*n(r+t/2,u+o/2),c=t*n(r+t,u+h),s=u+(e+2*o+2*h+c)/6,u=s,r=r+t;return u},romberg:function(n,i,r,u){for(var l=0,a=(r-i)/2,v=[],h=[],e=[],o,c,f,y,s;l<u/2;){for(s=n(i),f=i,y=0;f<=r;f=f+a,y++)v[y]=f;for(o=v.length,f=1;f<o-1;f++)s+=(f%2!=0?4:2)*n(v[f]);s=a/3*(s+n(r));e[l]=s;a/=2;l++}for(c=e.length,o=1;c!==1;){for(f=0;f<c-1;f++)h[f]=(t.pow(4,o)*e[f+1]-e[f])/(t.pow(4,o)-1);c=h.length;e=h;h=[];o++}return e},richardson:function(n,i,r,u){function c(n,t){for(var i=0,u=n.length,r;i<u;i++)n[i]===t&&(r=i);return r}for(var p=n.length,y=t.abs(r-n[c(n,r)+1]),v=0,f=[],o=[],l,a,s,h,e;u>=y;)l=c(n,r+u),a=c(n,r),f[v]=(i[l]-2*i[a]+i[2*a-l])/(u*u),u/=2,v++;for(h=f.length,s=1;h!=1;){for(e=0;e<h-1;e++)o[e]=(t.pow(4,s)*f[e+1]-f[e])/(t.pow(4,s)-1);h=o.length;f=o;o=[];s++}return f},simpson:function(n,t,i,r){for(var o=(i-t)/r,s=n(t),e=[],u=t,h=0,f=1,c;u<=i;u=u+o,h++)e[h]=u;for(c=e.length;f<c-1;f++)s+=(f%2!=0?4:2)*n(e[f]);return o/3*(s+n(i))},hermite:function(n,t,i,r){for(var o=n.length,h=0,u=0,e=[],s=[],c=[],l=[],f;u<o;u++){for(e[u]=1,f=0;f<o;f++)u!=f&&(e[u]*=(r-n[f])/(n[u]-n[f]));for(s[u]=0,f=0;f<o;f++)u!=f&&(s[u]+=1/(n[u]-n[f]));c[u]=(1-2*(r-n[u])*s[u])*e[u]*e[u];l[u]=(r-n[u])*e[u]*e[u];h+=c[u]*t[u]+l[u]*i[u]}return h},lagrange:function(n,t,i){for(var e=0,u=0,r,f,o=n.length;u<o;u++){for(f=t[u],r=0;r<o;r++)u!=r&&(f*=(i-n[r])/(n[u]-n[r]));e+=f}return e},cubic_spline:function(t,i,r){for(var s=t.length,u=0,f,h=[],c=[],l=[],o=[],e=[],a=[],v=[];u<s-1;u++)e[u]=t[u+1]-t[u];for(l[0]=0,u=1;u<s-1;u++)l[u]=3/e[u]*(i[u+1]-i[u])-3/e[u-1]*(i[u]-i[u-1]);for(u=1;u<s-1;u++)h[u]=[],c[u]=[],h[u][u-1]=e[u-1],h[u][u]=2*(e[u-1]+e[u]),h[u][u+1]=e[u],c[u][0]=l[u];for(o=n.multiply(n.inv(h),c),f=0;f<s-1;f++)a[f]=(i[f+1]-i[f])/e[f]-e[f]*(o[f+1][0]+2*o[f][0])/3,v[f]=(o[f+1][0]-o[f][0])/(3*e[f]);for(f=0;f<s;f++)if(t[f]>r)break;return f-=1,i[f]+(r-t[f])*a[f]+n.sq(r-t[f])*o[f]+(r-t[f])*n.sq(r-t[f])*v[f]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented");},PCA:function(t){for(var o=t.length,s=t[0].length,i=0,r,v,y=[],u=[],h=[],p=[],c=[],l=[],f=[],a=[],w=[],e=[],i=0;i<o;i++)y[i]=n.sum(t[i])/s;for(i=0;i<s;i++)for(f[i]=[],r=0;r<o;r++)f[i][r]=t[r][i]-y[r];for(f=n.transpose(f),i=0;i<o;i++)for(a[i]=[],r=0;r<o;r++)a[i][r]=n.dot([f[i]],[f[r]])/(s-1);for(h=n.jacobi(a),w=h[0],u=h[1],e=n.transpose(w),i=0;i<u.length;i++)for(r=i;r<u.length;r++)u[i]<u[r]&&(v=u[i],u[i]=u[r],u[r]=v,p=e[i],e[i]=e[r],e[r]=p);for(l=n.transpose(f),i=0;i<o;i++)for(c[i]=[],r=0;r<l.length;r++)c[i][r]=n.dot([e[i]],[l[r]]);return[t,u,e,c]}}),function(t){for(var i=0;i<t.length;i++)(function(t){n.fn[t]=function(i,r){var u=this;return r?(setTimeout(function(){r.call(u,n.fn[t].call(u,i))},15),this):n(n[t](this,i))}})(t[i])}("add divide multiply subtract dot pow abs norm angle".split(" "))}(this.jStat,Math),function(n,t){var i=[].slice,r=n.utils.isNumber;n.extend({zscore:function(){var t=i.call(arguments);return r(t[1])?(t[0]-t[1])/t[2]:(t[0]-n.mean(t[1]))/n.stdev(t[1],t[2])},ztest:function(){var u=i.call(arguments),f;return u.length===4?r(u[1])?(f=n.zscore(u[0],u[1],u[2]),u[3]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2):(f=u[0],u[2]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2):(f=n.zscore(u[0],u[1],u[3]),u[1]===1?n.normal.cdf(-t.abs(f),0,1):n.normal.cdf(-t.abs(f),0,1)*2)}});n.extend(n.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(i,r,u){var f=t.abs(this.zscore(i,u));return r===1?n.normal.cdf(-f,0,1):n.normal.cdf(-f,0,1)*2}});n.extend({tscore:function(){var r=i.call(arguments);return r.length===4?(r[0]-r[1])/(r[2]/t.sqrt(r[3])):(r[0]-n.mean(r[1]))/(n.stdev(r[1],!0)/t.sqrt(r[1].length))},ttest:function(){var u=i.call(arguments),f;return u.length===5?(f=t.abs(n.tscore(u[0],u[1],u[2],u[3])),u[4]===1?n.studentt.cdf(-f,u[3]-1):n.studentt.cdf(-f,u[3]-1)*2):r(u[1])?(f=t.abs(u[0]),u[2]==1?n.studentt.cdf(-f,u[1]-1):n.studentt.cdf(-f,u[1]-1)*2):(f=t.abs(n.tscore(u[0],u[1])),u[2]==1?n.studentt.cdf(-f,u[1].length-1):n.studentt.cdf(-f,u[1].length-1)*2)}});n.extend(n.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(i,r){return r===1?1-n.studentt.cdf(t.abs(this.tscore(i)),this.cols()-1):n.studentt.cdf(-t.abs(this.tscore(i)),this.cols()-1)*2}});n.extend({anovafscore:function(){var u=i.call(arguments),f,e,c,l,h,o,r,s;if(u.length===1){for(h=new Array(u[0].length),r=0;r<u[0].length;r++)h[r]=u[0][r];u=h}if(u.length===2)return n.variance(u[0])/n.variance(u[1]);for(e=[],r=0;r<u.length;r++)e=e.concat(u[r]);for(c=n.mean(e),f=0,r=0;r<u.length;r++)f=f+u[r].length*t.pow(n.mean(u[r])-c,2);for(f/=u.length-1,o=0,r=0;r<u.length;r++)for(l=n.mean(u[r]),s=0;s<u[r].length;s++)o+=t.pow(u[r][s]-l,2);return o/=e.length-u.length,f/o},anovaftest:function(){var t=i.call(arguments),e,o,u,f;if(r(t[0]))return 1-n.centralF.cdf(t[0],t[1],t[2]);for(anovafscore=n.anovafscore(t),e=t.length-1,u=0,f=0;f<t.length;f++)u=u+t[f].length;return o=u-e-1,1-n.centralF.cdf(anovafscore,e,o)},ftest:function(t,i,r){return 1-n.centralF.cdf(t,i,r)}});n.extend(n.fn,{anovafscore:function(){return n.anovafscore(this.toArray())},anovaftes:function(){for(var i=0,t=0;t<this.length;t++)i=i+this[t].length;return n.ftest(this.anovafscore(),this.length-1,i-this.length)}});n.extend({normalci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.normal.inv(r[1]/2,0,1)*r[2]/t.sqrt(r[3])):t.abs(n.normal.inv(r[1]/2,0,1)*n.stdev(r[2])/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},tci:function(){var r=i.call(arguments),u=new Array(2),f;return f=r.length===4?t.abs(n.studentt.inv(r[1]/2,r[3]-1)*r[2]/t.sqrt(r[3])):t.abs(n.studentt.inv(r[1]/2,r[2].length-1)*n.stdev(r[2],!0)/t.sqrt(r[2].length)),u[0]=r[0]-f,u[1]=r[0]+f,u},significant:function(n,t){return n<t}});n.extend(n.fn,{normalci:function(t,i){return n.normalci(t,i,this.toArray())},tci:function(t,i){return n.tci(t,i,this.toArray())}})}(this.jStat,Math),function(){function t(n,t,i,_,r,u){var f=[],o=2.5066282746310002,s=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0],h=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],e=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0],[1],[2],[3],[4],[5],[6]],c=function(n){for(var t in n)_.isArray(n[t])&&(n[t]=Formula.FLATTEN(n[t]));return n};return Formula.UNIQUE=function(){return _.unique(arguments)},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var n=Array.prototype.slice.call(arguments),t=n[n.length-1],i=t.replace(/(\w+)\(/g,function(){return"Formulae."+arguments[0]});return n[n.length-1]="return "+i+";",i!==t&&n.unshift("Formulae"),Function.apply(null,n)},Formula.MOMENT=function(n,t){return i(n).format(t)},Formula.MOMENTADD=function(n,t,r){return i(n).add(t,r)},Formula.MOMENTDIFF=function(n,t,r){return i(t).diff(i.utc(n),r)},Formula.MOMENTSUB=function(n,t,r){return i(n).subtract(t,r)},Formula.MOMENTUTC=function(n,t){return i.utc(n).format(t)},Formula.MOMENTUTCADD=function(n,t,r){return i.utc(n).add(t,r)},Formula.MOMENTUTCDIFF=function(n,t,r){return i.utc(t).diff(i.utc(n),r)},Formula.MOMENTUTCSUB=function(n,t,r){return i.utc(n).subtract(t,r)},Formula.MOMENTUNIX=function(n){return i.unix(n).toDate()},Formula.MOMENTFORMAT=function(n,t){return i(n).format(t)},Formula.MOMENTISLEAPYEAR=function(n,t){return i(n,t).isLeapYear()},Formula.MOMENTISDST=function(n,t){return i(n,t).isDST()},Formula.MOMENTSTARTOF=function(n,t,r){return i(n,r).startOf(t).toDate()},Formula.MOMENTENDOF=function(n,t,r){return i(n,r).endOf(t).toDate()},Formula.MOMENTISAFTER=function(n,t,r){return i(n,r).isAfter(i(t,r))},Formula.MOMENTISBEFORE=function(n,t,r){return i(n,r).isBefore(i(t,r))},Formula.INTERVAL=function(n){var e=Math.floor(n/94608e4),t,i,r,u,f;return n=n%94608e4,t=Math.floor(n/2592e3),n=n%2592e3,i=Math.floor(n/86400),n=n%86400,r=Math.floor(n/3600),n=n%3600,u=Math.floor(n/60),n=n%60,f=n,e=e>0?e+"Y":"",t=t>0?t+"M":"",i=i>0?i+"D":"",r=r>0?r+"H":"",u=u>0?u+"M":"",f=f>0?f+"S":"","P"+e+t+i+"T"+r+u+f},Formula.ARGSCONCAT=function(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(n[i]);return t},Formula.ARGSTOARRAY=function(n){return Array.prototype.slice.call(n,0)},Formula.CLEANFLOAT=function(n){var t=Math.pow(10,14);return Math.round(n*t)/t},Formula.COUNTIN=function(n,t){for(var r=0,i=0;i<n.length;i++)n[i]===t&&r++;return r},Formula.FINDFIELD=function(n,t){for(var r=null,i=0;i<n.length;i++)if(n[i][0]===t){r=i;break}return r==null?"#VALUE!":r},Formula.FINDRESULTINDEX=function(database,criteria){for(var columnResultIndexes,rowResultIndexes,j,k,maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);for(columnResultIndexes=[],i=1;i<maxCriteriaLength;i++){for(rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[];for(k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}return _.union.apply(_,columnResultIndexes)},Formula.DAVERAGE=function(n,t,i){var r,u,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(r=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=0,f=0;f<r.length;f++)e+=u[r[f]];return Formula.IF(r.length===0,"#DIV/0!",e/r.length)},Formula.DCOUNT=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.COUNT(e)},Formula.DCOUNTA=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.COUNTA(e)},Formula.DGET=function(n,t,i){var r,u,f;return isNaN(t)&&typeof t!="string"?"#VALUE!":(r=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(f=Formula.FINDFIELD(n,t),u=_.rest(n[f])):u=_.rest(n[t]),r.length===0)?"#VALUE!":r.length>1?"#NUM!":u[r[0]]},Formula.DMAX=function(n,t,i){var u,r,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(u=Formula.FINDRESULTINDEX(n,i),r=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),r=_.rest(n[o])):r=_.rest(n[t]),e=r[u[0]],f=1;f<u.length;f++)e<r[u[f]]&&(e=r[u[f]]);return e},Formula.DMIN=function(n,t,i){var u,r,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(u=Formula.FINDRESULTINDEX(n,i),r=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),r=_.rest(n[o])):r=_.rest(n[t]),e=r[u[0]],f=1;f<u.length;f++)e>r[u[f]]&&(e=r[u[f]]);return e},Formula.DPRODUCT=function(n,t,i){var e,f,s,u,r,o;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(s=Formula.FINDFIELD(n,t),f=_.rest(n[s])):f=_.rest(n[t]),u=[],r=0;r<e.length;r++)u[r]=f[e[r]];for(u=_.compact(u),o=1,r=0;r<u.length;r++)o*=u[r];return o},Formula.DSTDEV=function(n,t,i){var e,f,o,r,u;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),f=_.rest(n[o])):f=_.rest(n[t]),r=[],u=0;u<e.length;u++)r[u]=f[e[u]];return r=_.compact(r),Formula.STDEVS(r)},Formula.DSTDEVP=function(n,t,i){var e,f,o,r,u;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),f=_.rest(n[o])):f=_.rest(n[t]),r=[],u=0;u<e.length;u++)r[u]=f[e[u]];return r=_.compact(r),Formula.STDEVP(r)},Formula.DSUM=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.SUM(e)},Formula.DVAR=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.VARS(e)},Formula.DVARP=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.VARP(e)},Formula.GETJSON=function(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.send(null),t.status===200?JSON.parse(t.responseText):void 0},Formula.DATE=function(){if(!arguments.length)return new Date;if(arguments.length===1)return new Date(arguments[0]);var n=arguments;return n[1]=n[1]-1,new(Date.bind.apply(Date,[Date].concat([].splice.call(n,0))))},Formula.DATEVALUE=function(n){return Math.ceil((i(n)-i("1900-01-01"))/864e5)+2},Formula.DAY=function(n){return new Date(n).getDate()},Formula.DAYS=function(n,t){return i(new Date(n)).diff(i(new Date(t)),"days")},Formula.DAYS360=function(n,t,r){var e=i(new Date(n)),o=i(new Date(t)),s=31,h=31,u=e.date(),f=o.date();return r?(u=u===31?30:u,f=f===31?30:f):(e.month()===1&&(s=e.daysInMonth()),o.month()===1&&(h=o.daysInMonth()),u=u===s?30:u,(u===30||u===s)&&(f=f===h?30:f)),360*(o.year()-e.year())+30*(o.month()-e.month())+(f-u)},Formula.EDATE=function(n,t){return i(new Date(n)).add("months",t).toDate()},Formula.EOMONTH=function(n,t){var r=i(new Date(n)).add("months",t);return new Date(r.year(),r.month(),r.daysInMonth())},Formula.FROMNOW=function(n,t){return i(new Date(n)).fromNow(t)},Formula.HOUR=function(n){return n<=1?Math.floor(24*n):new Date(n).getHours()},Formula.MINUTE=function(n){return n<=1?Math.floor(1440*n)-60*Math.floor(24*n):new Date(n).getMinutes()},Formula.ISOWEEKNUM=function(n){return i(new Date(n)).format("w")},Formula.MONTH=function(n){return new Date(n).getMonth()+1},Formula.NETWORKDAYS=function(n,t,i){return Formula.NETWORKDAYSINTL(n,t,1,i)},Formula.NETWORKDAYSINTL=function(n,t,r,u){var y=typeof r=="undefined"?1:r,l=e[y],a=i(n),p=i(t),v=p.diff(a,"days")+1,o=v,s=a,h=[],f,c;if(typeof u!="undefined")for(f=0;f<u.length;f++)h[f]=i(new Date(u[f])).format("MM-DD-YYYY");if(!l.length&&!h.length)return o;for(c=0;c<v;)l.indexOf(parseInt(s.format("d"),10))>=0?o--:h.indexOf(s.format("MM-DD-YYYY"))>=0&&o--,s=s.add("days",1),c++;return o},Formula.NOW=function(){return new Date},Formula.SECOND=function(n){return new Date(n).getSeconds()},Formula.TIME=function(n,t,i){return(3600*n+60*t+i)/86400},Formula.TIMEVALUE=function(n){var t=new Date(n);return(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},Formula.TODAY=Formula.NOW,Formula.WEEKDAY=function(n,t){var r=i(new Date(n)).format("d"),u=typeof t=="undefined"?1:t;return h[u][r]},Formula.WEEKNUM=function(n,t){var f=i(new Date(n)),e=i(new Date(f.year(),0,1)),o=typeof t=="undefined"?1:t,r=s[o],u=e.format("d"),h=u<r?r-u+1:u-r;return o===21?Formula.ISOWEEKNUM(n):Math.floor(f.diff(e.subtract("days",h),"days")/7)+1},Formula.WORKDAY=function(n,t,i){return Formula.WORKDAYINTL(n,t,1,i)},Formula.WORKDAYINTL=function(n,t,r,u){var l=typeof r=="undefined"?1:r,a=e[l],v=i(new Date(n)),f=v,h="",c=[],o,s;if(typeof u!="undefined")for(o=0;o<u.length;o++)c[o]=i(new Date(u[o])).format("MM-DD-YYYY");for(s=0;s<t;)f=f.add("days",1),h=f.format("d"),a.indexOf(parseInt(h,10))<0&&c.indexOf(f.format("MM-DD-YYYY"))<0&&s++;return f.toDate()},Formula.YEAR=function(n){return new Date(n).getFullYear()},Formula.YEARFRAC=function(n,t,r){var u,f,v,a;if(r=typeof r=="undefined"?0:r,u=i(new Date(n)),f=i(new Date(t)),!u.isValid()||!f.isValid())return"#VALUE!";if([0,1,2,3,4].indexOf(r)===-1)return"#NUM!";if(u===f)return 0;u.diff(f)>0&&(f=i(new Date(n)),u=i(new Date(t)));var s=u.year(),c=u.month(),e=u.date(),h=f.year(),l=f.month(),o=f.date();switch(r){case 0:return e===31&&o===31?(e=30,o=30):e===31?e=30:e===30&&o===31?o=30:c===1&&l===1&&u.daysInMonth()===e&&f.daysInMonth()===o?(e=30,o=30):c===1&&u.daysInMonth()===e&&(e=30),(o+l*30+h*360-(e+c*30+s*360))/360;case 1:if(v=function(n,t){var u=i(new Date(n.year(),2,1)),r;return i([n.year()]).isLeapYear()&&n.diff(u)<0&&t.diff(u)>=0?!0:(r=i(new Date(t.year(),2,1)),i([t.year()]).isLeapYear()&&t.diff(r)>=0&&n.diff(r)<0)?!0:!1},a=365,s===h||s+1===h&&(c>l||c===l&&e>=o))return s===h&&i([s]).isLeapYear()?a=366:(v(u,f)||l===1&&o===29)&&(a=366),f.diff(u,"days")/a;var y=h-s+1,p=i(new Date(h+1,0,1)).diff(i(new Date(s,0,1)),"days"),w=p/y;return f.diff(u,"days")/w;case 2:return f.diff(u,"days")/360;case 3:return f.diff(u,"days")/365;case 4:return e===31&&(e=30),o===31&&(o=30),(o+l*30+h*360-(e+c*30+s*360))/360}},Formula.BESSELI=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function r(r){return r<=3.75?n(t,r*r/(3.75*3.75)):Math.exp(Math.abs(r))/Math.sqrt(Math.abs(r))*n(i,3.75/Math.abs(r))}function e(t){return t<3.75?t*n(u,t*t/(3.75*3.75)):(t<0?-1:1)*Math.exp(Math.abs(t))/Math.sqrt(Math.abs(t))*n(f,3.75/Math.abs(t))}var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),i=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),u=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,.00032411].reverse(),f=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function o(n,t){if(t=Math.round(t),t===0)return r(n);if(t===1)return e(n);if(t<0)throw"BESSELI Order ("+t+") must be nonnegative";if(Math.abs(n)===0)return 0;var u,f,l=2/Math.abs(n),h,s,i,c;for(h=2*Math.round((t+Math.round(Math.sqrt(40*t)))/2),s=u=0,i=1,f=h;f>0;f--)c=f*l*i+s,s=i,i=c,Math.abs(i)>1e10&&(i*=1e-10,s*=1e-10,u*=1e-10),f===t&&(u=s);return u*=o(n,0)/i,n<0&&t%2?-u:u}}(),Formula.BESSELJ=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function i(i){var c,s,h,r=i*i,l=Math.abs(i)-.785398164;return Math.abs(i)<8?(s=n(u,r),h=n(f,r),c=s/h):(r=64/r,s=n(e,r),h=n(o,r),c=Math.sqrt(t/Math.abs(i))*(Math.cos(l)*s-Math.sin(l)*h*8/Math.abs(i))),c}function r(i){var u,f,e,r=i*i,o=Math.abs(i)-2.356194491;return Math.abs(i)<8?(f=i*n(s,r),e=n(h,r),u=f/e):(r=64/r,f=n(c,r),e=n(l,r),u=Math.sqrt(t/Math.abs(i))*(Math.cos(o)*f-Math.sin(o)*e*8/Math.abs(i)),i<0&&(u=-u)),u}function a(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}var u=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),f=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),o=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse(),t=.636619772,s=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),h=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),c=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return function(n,t){if(t=Math.round(t),t===0)return i(Math.abs(n));if(t===1)return r(Math.abs(n));if(t<0)throw"BESSELJ: Order ("+t+") must be nonnegative";if(Math.abs(n)===0)return 0;var f,o,v=2/Math.abs(n),c,h,e,s,u,l;if(Math.abs(n)>t)f=a(n,t,i(Math.abs(n)),r(Math.abs(n)),-1);else{for(c=2*Math.floor((t+Math.floor(Math.sqrt(40*t)))/2),h=0,s=f=e=0,u=1,o=c;o>0;o--)l=o*v*u-s,s=u,u=l,Math.abs(u)>1e10&&(u*=1e-10,s*=1e-10,f*=1e-10,e*=1e-10),h&&(e+=u),h=!h,o===t&&(f=s);e=2*e-u;f/=e}return n<0&&t%2?-f:f}}(),Formula.BESSELK=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function r(r){return r<=2?-Math.log(r/2)*Formula.BESSELI(r,0)+n(t,r*r/4):Math.exp(-r)/Math.sqrt(r)*n(i,2/r)}function e(t){return t<=2?Math.log(t/2)*Formula.BESSELI(t,1)+1/t*n(u,t*t/4):Math.exp(-t)/Math.sqrt(t)*n(f,2/t)}function o(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}function s(n,t,i,r,u){return function(f,e){if(e===0)return n(f);if(e===1)return t(f);if(e<0)throw i+": Order ("+e+") must be nonnegative";if(r===1&&f===0)throw i+": Undefined when x == 0";if(r===2&&f<=0)throw i+": Undefined when x <= 0";var s=n(f),h=t(f);return o(f,e,s,h,u)}}var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,.0001075,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,.00053208].reverse(),u=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse();return s(r,e,"BESSELK",2,1)}(),Formula.BESSELY=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function e(e){var c,s,h,o=e*e,l=e-.785398164;return e<8?(s=n(i,o),h=n(r,o),c=s/h+t*Formula.BESSELJ(e,0)*Math.log(e)):(o=64/o,s=n(u,o),h=n(f,o),c=Math.sqrt(t/e)*(Math.sin(l)*s+Math.cos(l)*h*8/e)),c}function l(i){var e,u,f,r=i*i,l=i-2.356194491;return i<8?(u=i*n(o,r),f=n(s,r),e=u/f+t*(Formula.BESSELJ(i,1)*Math.log(i)-1/i)):(r=64/r,u=n(h,r),f=n(c,r),e=Math.sqrt(t/i)*(Math.sin(l)*u+Math.cos(l)*f*8/i)),e}function a(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}function v(n,t,i,r,u){return function(f,e){if(e===0)return n(f);if(e===1)return t(f);if(e<0)throw i+": Order ("+e+") must be nonnegative";if(r===1&&f===0)throw i+": Undefined when x == 0";if(r===2&&f<=0)throw i+": Undefined when x <= 0";var o=n(f),s=t(f);return a(f,e,o,s,u)}}var i=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),t=.636619772,o=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return v(e,l,"BESSELY",1,-1)}(),Formula.VALIDBIN=function(n){return/^[01]{1,10}$/.test(n)},Formula.BIN2DEC=function(n){if(!Formula.VALIDBIN(n))return"#NUM!";var i=parseInt(n,2),t=n.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:i},Formula.BIN2HEX=function(n,t){var u,i;return Formula.VALIDBIN(n)?(u=n.toString(),u.length===10&&u.substring(0,1)==="1")?(0xfffffffe00+parseInt(u.substring(1),2)).toString(16):(i=parseInt(n,2).toString(16),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.BIN2OCT=function(n,t){var u,i;return Formula.VALIDBIN(n)?(u=n.toString(),u.length===10&&u.substring(0,1)==="1")?(1073741312+parseInt(u.substring(1),2)).toString(8):(i=parseInt(n,2).toString(8),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.BITAND=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n&t},Formula.BITLSHIFT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0?"#NUM!":Math.floor(n)!==n?"#NUM!":n>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?n<<t:n>>-t},Formula.BITOR=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n|t},Formula.BITRSHIFT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0?"#NUM!":Math.floor(n)!==n?"#NUM!":n>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?n>>t:n<<-t},Formula.BITXOR=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n^t},Formula.COMPLEX=function(n,t,i){if(isNaN(n)||isNaN(t)||(i=typeof i=="undefined"?"i":i,i!=="i"&&i!=="j"))return"#VALUE!";if(n===0&&t===0)return 0;if(n===0)return t===1?i:t.toString()+i;if(t===0)return n.toString();var r=t>0?"+":"";return n.toString()+r+(t===1?i:t.toString()+i)},Formula.CONVERT=function(n,t,i){var u,w,a,e,b,v,o;if(isNaN(n))return"#VALUE!";var r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,.0001],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,.00064516],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,.0001],["stokes","St",null,"kinematic_viscosity",!1,!1,.0001],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],k={Yi:["yobi",80,1208925819614629174706176,"Yi","yotta"],Zi:["zebi",70,1180591620717411303424,"Zi","zetta"],Ei:["exbi",60,1152921504606846976,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},d={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,h=null,c=t,l=i,y=1,p=1,f;for(u=0;u<r.length;u++)f=r[u][2]===null?[]:r[u][2],(r[u][1]===c||f.indexOf(c)>=0)&&(s=r[u]),(r[u][1]===l||f.indexOf(l)>=0)&&(h=r[u]);if(s===null)for(w=k[t.substring(0,2)],a=d[t.substring(0,1)],t.substring(0,2)==="da"&&(a=["dekao",10,"da"]),w?(y=w[2],c=t.substring(2)):a&&(y=a[1],c=t.substring(a[2].length)),e=0;e<r.length;e++)f=r[e][2]===null?[]:r[e][2],(r[e][1]===c||f.indexOf(c)>=0)&&(s=r[e]);if(h===null)for(b=k[i.substring(0,2)],v=d[i.substring(0,1)],i.substring(0,2)==="da"&&(v=["dekao",10,"da"]),b?(p=b[2],l=i.substring(2)):v&&(p=v[1],l=i.substring(v[2].length)),o=0;o<r.length;o++)f=r[o][2]===null?[]:r[o][2],(r[o][1]===l||f.indexOf(l)>=0)&&(h=r[o]);return s===null||h===null?"#N/A":s[3]!==h[3]?"#N/A":n*s[6]*y/(h[6]*p)},Formula.DEC2BIN=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return"#NUM!";if(n<0)return"1"+r.repeat("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=parseInt(n,10).toString(2);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")},Formula.DEC2HEX=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return"#NUM!";if(n<0)return(1099511627776+n).toString(16);var i=parseInt(n,10).toString(16);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")},Formula.DEC2OCT=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return"#NUM!";if(n<0)return(1073741824+n).toString(8);var i=parseInt(n,10).toString(8);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")},Formula.DELTA=function(n,t){return(t=typeof t=="undefined"?0:t,isNaN(n)||isNaN(t))?"#VALUE!":n===t?1:0},Formula.ERF=function(n,i){return(i=typeof i=="undefined"?0:i,isNaN(n)||isNaN(i))?"#VALUE!":t.erf(n)},Formula.ERFC=function(n){return isNaN(n)?"#VALUE!":t.erfc(n)},Formula.ERFCPRECISE=function(){return},Formula.ERFPRECISE=function(){return},Formula.GESTEP=function(n,t){return(t=typeof t=="undefined"?0:t,isNaN(n)||isNaN(t))?"#VALUE!":n>=t?1:0},Formula.HEX2BIN=function(n,t){var f,i,u;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(f=n.length===10&&n.substring(0,1).toLowerCase()==="f"?!0:!1,i=f?parseInt(n,16)-1099511627776:parseInt(n,16),i<-512||i>511)?"#NUM!":f?"1"+r.repeat("0",9-(512+i).toString(2).length)+(512+i).toString(2):(u=i.toString(2),typeof t=="undefined"?u:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=u.length?r.repeat("0",t-u.length)+u:"#NUM!")):"#NUM!"},Formula.HEX2DEC=function(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return"#NUM!";var t=parseInt(n,16);return t>=549755813888?t-1099511627776:t},Formula.HEX2OCT=function(n,t){var i,u;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(i=parseInt(n,16),i>536870911&&i<0xffe0000000)?"#NUM!":i>=0xffe0000000?(i-0xffc0000000).toString(8):(u=i.toString(8),typeof t=="undefined"?u:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=u.length?r.repeat("0",t-u.length)+u:"#NUM!")):"#NUM!"},Formula.IMABS=function(n){var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Math.sqrt(Math.pow(t,2)+Math.pow(i,2))},Formula.IMAGINARY=function(n){var t,i,r,u;return n===0||n==="0"?0:["i","j"].indexOf(n)>=0?1:(n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j"),t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),r=n.substring(n.length-1,n.length),u=r==="i"||r==="j",t>=0||i>=0?u?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?"#NUM!":Number(n.substring(t+1,n.length-1)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?"#NUM!":-Number(n.substring(i+1,n.length-1)):"#NUM!":u?isNaN(n.substring(0,n.length-1))?"#NUM!":n.substring(0,n.length-1):isNaN(n)?"#NUM!":0)},Formula.IMARGUMENT=function(n){var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":t===0&&i===0?"#DIV/0!":t===0&&i>0?Math.PI/2:t===0&&i<0?-Math.PI/2:i===0&&t>0?0:i===0&&t<0?-Math.PI:t>0?Math.atan(i/t):t<0&&i>=0?Math.atan(i/t)+Math.PI:Math.atan(i/t)-Math.PI},Formula.IMCONJUGATE=function(n){var r=Formula.IMREAL(n),i=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",r==="#NUM!"||i==="#NUM!")?"#NUM!":i!==0?Formula.COMPLEX(r,-i,t):n},Formula.IMCOS=function(n){if(n===!0||n===!1)return"#VALUE!";var r=Formula.IMREAL(n),t=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",r==="#NUM!"||t==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMCOSH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),r=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",t==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMCOT=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV(Formula.IMCOS(n),Formula.IMSIN(n))},Formula.IMCSC=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(n))},Formula.IMCSCH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(n))},Formula.IMDIV=function(n,t){var u=Formula.IMREAL(n),f=Formula.IMAGINARY(n),i=Formula.IMREAL(t),r=Formula.IMAGINARY(t),s=n.substring(n.length-1),h=n.substring(n.length-1),e="i",o;return(s==="j"?e="j":h==="j"&&(e="j"),u==="#NUM!"||f==="#NUM!"||i==="#NUM!"||r==="#NUM!")?"#NUM!":i===0&&r===0?"#NUM!":(o=i*i+r*r,Formula.COMPLEX((u*i+f*r)/o,(f*i-u*r)/o,e))},Formula.IMEXP=function(n){var u=Formula.IMREAL(n),i=Formula.IMAGINARY(n),t=n.substring(n.length-1),r;return(t=t==="i"||t==="j"?t:"i",u==="#NUM!"||i==="#NUM!")?"#NUM!":(r=Math.exp(u),Formula.COMPLEX(r*Math.cos(i),r*Math.sin(i),t))},Formula.IMLN=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r)),Math.atan(r/i),t)},Formula.IMLOG10=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r))/Math.log(10),Math.atan(r/i)/Math.log(10),t)},Formula.IMLOG2=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r))/Math.log(2),Math.atan(r/i)/Math.log(2),t)},Formula.IMPOWER=function(n,t){var r,u;if(isNaN(t))return"#VALUE!";var f=Formula.IMREAL(n),e=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",f==="#NUM!"||e==="#NUM!")?"#NUM!":(r=Math.pow(Formula.IMABS(n),t),u=Formula.IMARGUMENT(n),Formula.COMPLEX(r*Math.cos(t*u),r*Math.sin(t*u),i))},Formula.IMPRODUCT=function(){for(var n=arguments[0],t=1;t<arguments.length;t++){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),u=Formula.IMREAL(arguments[t]),f=Formula.IMAGINARY(arguments[t]);if(i==="#NUM!"||r==="#NUM!"||u==="#NUM!"||f==="#NUM!")return"#NUM!";n=Formula.COMPLEX(i*u-r*f,i*f+r*u)}return n},Formula.IMREAL=function(n){var t,i,r,u;return n===0||n==="0"?0:["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0?0:(t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),r=n.substring(n.length-1,n.length),u=r==="i"||r==="j",t>=0||i>=0?u?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?"#NUM!":Number(n.substring(0,t)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?"#NUM!":Number(n.substring(0,i)):"#NUM!":u?isNaN(n.substring(0,n.length-1))?"#NUM!":0:isNaN(n)?"#NUM!":n)},Formula.IMSEC=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(n))},Formula.IMSECH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(n))},Formula.IMSIN=function(n){if(n===!0||n===!1)return"#VALUE!";var r=Formula.IMREAL(n),t=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",r==="#NUM!"||t==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMSINH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),r=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",t==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,i)},Formula.IMSQRT=function(n){var u=Formula.IMREAL(n),f=Formula.IMAGINARY(n),t=n.substring(n.length-1),i,r;return(t=t==="i"||t==="j"?t:"i",u==="#NUM!"||f==="#NUM!")?"#NUM!":(i=Math.sqrt(Formula.IMABS(n)),r=Formula.IMARGUMENT(n),Formula.COMPLEX(i*Math.cos(r/2),i*Math.sin(r/2),t))},Formula.IMSUB=function(n,t){var r=Formula.IMREAL(n),u=Formula.IMAGINARY(n),f=Formula.IMREAL(t),e=Formula.IMAGINARY(t),o=n.substring(n.length-1),s=n.substring(n.length-1),i="i";return(o==="j"?i="j":s==="j"&&(i="j"),r==="#NUM!"||u==="#NUM!"||f==="#NUM!"||e==="#NUM!")?"#NUM!":Formula.COMPLEX(r-f,u-e,i)},Formula.IMSUM=function(){for(var n=arguments[0],t=1;t<arguments.length;t++){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),u=Formula.IMREAL(arguments[t]),f=Formula.IMAGINARY(arguments[t]);if(i==="#NUM!"||r==="#NUM!"||u==="#NUM!"||f==="#NUM!")return"#NUM!";n=Formula.COMPLEX(i+u,r+f)}return n},Formula.IMTAN=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV(Formula.IMSIN(n),Formula.IMCOS(n))},Formula.OCT2BIN=function(n,t){var f,i,u;return/^[0-7]{1,10}$/.test(n)?(f=n.length===10&&n.substring(0,1)==="7"?!0:!1,i=f?parseInt(n,8)-1073741824:parseInt(n,8),i<-512||i>511)?"#NUM!":f?"1"+r.repeat("0",9-(512+i).toString(2).length)+(512+i).toString(2):(u=i.toString(2),typeof t=="undefined"?u:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=u.length?r.repeat("0",t-u.length)+u:"#NUM!")):"#NUM!"},Formula.OCT2DEC=function(n){if(!/^[0-7]{1,10}$/.test(n))return"#NUM!";var t=parseInt(n,8);return t>=536870912?t-1073741824:t},Formula.OCT2HEX=function(n,t){var u,i;return/^[0-7]{1,10}$/.test(n)?(u=parseInt(n,8),u>=536870912)?"ff"+(u+3221225472).toString(16):(i=u.toString(16),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?r.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.ACCRINT=function(n,t,r,u,f,e,o,s){if(!i(n).isValid()||!i(t).isValid()||!i(r).isValid())return"#VALUE!";if(u<=0||f<=0||[1,2,4].indexOf(e)===-1||[0,1,2,3,4].indexOf(o)===-1||i(n).diff(i(r))>=0)return"#NUM!";f=typeof f=="undefined"?0:f;o=typeof o=="undefined"?0:o;s=typeof s=="undefined"?!0:s;var h=0;switch(o){case 0:h=Formula.YEARFRAC(n,r,o);break;case 1:h=Formula.YEARFRAC(n,r,o);break;case 2:h=Formula.YEARFRAC(n,r,o);break;case 3:h=Formula.YEARFRAC(n,r,o);break;case 4:h=Formula.YEARFRAC(n,r,o)}return f*u*h},Formula.ACCRINTM=function(){return},Formula.AMORDEGRC=function(){return},Formula.AMORLINC=function(){return},Formula.COUPDAYBS=function(){return},Formula.COUPDAYS=function(){return},Formula.COUPDAYSNC=function(){return},Formula.COUPNCD=function(){return},Formula.COUPNUM=function(){return},Formula.COUPPCD=function(){return},Formula.CUMIPMT=function(rate,periods,value,start,end,type){var payment,interest,i;if((rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)||start<1||end<1||start>end||type!==0&&type!==1)return"#NUM!";for(payment=Formula.PMT(rate,periods,value,0,type),interest=0,start===1&&type===0&&(interest=-value,start++),i=start;i<=end;i++)interest+=type===1?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*rate},Formula.CUMPRINC=function(rate,periods,value,start,end,type){var payment,principal,i;if((rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)||start<1||end<1||start>end||type!==0&&type!==1)return"#NUM!";for(payment=Formula.PMT(rate,periods,value,0,type),principal=0,start===1&&(principal=type===0?payment+value*rate:payment,start++),i=start;i<=end;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(n,t,i,r,u){var s;if(u=typeof u=="undefined"?12:u,isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)||isNaN(u))return"#VALUE!";if(n<0||t<0||i<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(u)===-1||r>i)return"#NUM!";if(t>=n)return 0;var f=(1-Math.pow(t/n,1/i)).toFixed(3),h=n*f*u/12,e=h,o=0,c=r===i?i-1:r;for(s=2;s<=c;s++)o=(n-e)*f,e+=o;return r===1?h:r===i?(n-e)*f:o},Formula.DDB=function(n,t,i,r,u){var f,e,o;if(u=typeof u=="undefined"?2:u,isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)||isNaN(u))return"#VALUE!";if(n<0||t<0||i<0||r<0||u<=0||r>i)return"#NUM!";if(t>=n)return 0;for(f=0,e=0,o=1;o<=r;o++)e=Math.min((n-f)*(u/i),n-t-f),f+=e;return e},Formula.DISC=function(){return},Formula.DOLLARDE=function(n,t){var i,r;return isNaN(n)||isNaN(t)?"#VALUE!":t<0?"#NUM!":t>=0&&t<1?"#DIV/0!":(t=parseInt(t,10),i=parseInt(n,10),i+=n%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t,r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1),Math.round(i*r)/r)},Formula.DOLLARFR=function(n,t){if(isNaN(n)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var i=parseInt(n,10);return i+n%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},Formula.DURATION=function(){return},Formula.EFFECT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<=0||t<1?"#NUM!":(t=parseInt(t,10),Math.pow(1+n/t,t)-1)},Formula.FV=function(rate,periods,payment,value,type){var result,term;return type=typeof type=="undefined"?0:type,rate=eval(rate),rate===0?result=value+payment*periods:(term=Math.pow(1+rate,periods),result=type===1?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate),-result},Formula.FVSCHEDULE=function(n,t){for(var r=n,i=0;i<t.length;i++){if(isNaN(t[i]))return"#VALUE!";r*=1+t[i]}return r},Formula.INTRATE=function(){return},Formula.IPMT=function(rate,period,periods,present,future,type){type=typeof type=="undefined"?0:type;rate=eval(rate);periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=period===1?type===1?0:-present:type===1?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(n,t){var i;n=Formula.FLATTEN(n);var a=function(n,t,i){for(var f=i+1,u=n[0],r=1;r<n.length;r++)u+=n[r]/Math.pow(f,(t[r]-t[0])/365);return u},v=function(n,t,i){for(var u,e=i+1,f=0,r=1;r<n.length;r++)u=(t[r]-t[0])/365,f-=u*n[r]/Math.pow(e,u+1);return f},u=[],s=!1,h=!1;for(i=0;i<n.length;i++)u[i]=i===0?0:u[i-1]+365,n[i]>0&&(s=!0),n[i]<0&&(h=!0);if(!s||!h)return"#NUM!";t=typeof t=="undefined"?.1:t;var r=t,c=1e-10,f,l,e,y=0,o=!0;do e=a(n,u,r),f=r-e/v(n,u,r),l=Math.abs(f-r),r=f,o=l>c&&Math.abs(e)>c;while(o&&++y<50);return o?"#NUM!":r},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){return},Formula.MIRR=function(n,t,i){for(var o,s,u=n.length,f=[],e=[],r=0;r<u;r++)n[r]<0?f.push(n[r]):e.push(n[r]);return o=-Formula.NPV(i,e)*Math.pow(1+i,u-1),s=Formula.NPV(t,f)*(1+t),Math.pow(o/s,1/(u-1))-1},Formula.NOMINAL=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<=0||t<1?"#NUM!":(t=parseInt(t,10),(Math.pow(n+1,1/t)-1)*t)},Formula.NPER=function(rate,payment,present,future,type){type=typeof type=="undefined"?0:type;future=typeof future=="undefined"?0:future;rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var u,r,t,n=[],i=0;i<arguments.length;i++)n=n.concat(arguments[i]);for(u=n[0],r=0,t=1;t<n.length;t++)r+=n[t]/Math.pow(1+u,t);return r},Formula.ODDFPRICE=function(){return},Formula.ODDFYIELD=function(){return},Formula.ODDLPRICE=function(){return},Formula.ODDLYIELD=function(){return},Formula.PDURATION=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":n<=0?"#NUM!":(Math.log(i)-Math.log(t))/Math.log(1+n)},Formula.PMT=function(rate,periods,present,future,type){var result,term;return type=typeof type=="undefined"?0:type,rate=eval(rate),periods=eval(periods),rate===0?result=(present+future)/periods:(term=Math.pow(1+rate,periods),result=type===1?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)),-result},Formula.PPMT=function(n,t,i,r,u,f){return Formula.PMT(n,i,r,u,f)-Formula.IPMT(n,t,i,r,u,f)},Formula.PRICE=function(){return},Formula.PRICEDISC=function(){return},Formula.PRICEMAT=function(){return},Formula.PV=function(rate,periods,payment,future,type){return type=typeof type=="undefined"?0:type,rate=eval(rate),periods=eval(periods),rate===0?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess=typeof guess=="undefined"?.01:guess;future=typeof future=="undefined"?0:future;type=typeof type=="undefined"?0:type;periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){return},Formula.RRI=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":n===0||t===0?"#NUM!":Math.pow(i/t,1/n)-1},Formula.SLN=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":i===0?"#NUM!":(n-t)/i},Formula.SYD=function(n,t,i,r){return isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)?"#VALUE!":i===0?"#NUM!":r<1||r>i?"#NUM!":(r=parseInt(r,10),(n-t)*(i-r+1)*2/(i*(i+1)))},Formula.TBILLEQ=function(n,t,r){return!i(n).isValid()||!i(t).isValid()?"#VALUE!":r<=0?"#NUM!":i(n).diff(i(t))>0?"#NUM!":i(t).diff(i(n),"years")>1?"#NUM!":365*r/(360-r*Formula.DAYS360(n,t))},Formula.TBILLPRICE=function(n,t,r){return!i(n).isValid()||!i(t).isValid()?"#VALUE!":r<=0?"#NUM!":i(n).diff(i(t))>0?"#NUM!":i(t).diff(i(n),"years")>1?"#NUM!":100*(1-r*Formula.DAYS360(n,t)/360)},Formula.TBILLYIELD=function(n,t,r){return!i(n).isValid()||!i(t).isValid()?"#VALUE!":r<=0?"#NUM!":i(n).diff(i(t))>0?"#NUM!":i(t).diff(i(n),"years")>1?"#NUM!":(100-r)*360/(r*Formula.DAYS360(n,t))},Formula.VDB=function(){return},Formula.XIRR=function(n,t,r){for(var v=function(n,t,r){for(var e=r+1,f=n[0],u=1;u<n.length;u++)f+=n[u]/Math.pow(e,i(t[u]).diff(i(t[0]),"days")/365);return f},y=function(n,t,r){for(var f,o=r+1,e=0,u=1;u<n.length;u++)f=i(t[u]).diff(i(t[0]),"days")/365,e-=f*n[u]/Math.pow(o,f+1);return e},h=!1,c=!1,f=0;f<n.length;f++)n[f]>0&&(h=!0),n[f]<0&&(c=!0);if(!h||!c)return"#NUM!";r=r||.1;var u=r,l=1e-10,e,a,o,p=0,s=!0;do o=v(n,t,u),e=u-o/y(n,t,u),a=Math.abs(e-u),u=e,s=a>l&&Math.abs(o)>l;while(s&&++p<50);return s?"#NUM!":u},Formula.XNPV=function(n,t,r){for(var f=0,u=0;u<t.length;u++)f+=t[u]/Math.pow(1+n,i(r[u]).diff(i(r[0]),"days")/365);return f},Formula.YIELD=function(){return},Formula.YIELDDISC=function(){return},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(n){return!isNaN(parseFloat(n))&&isFinite(n)?!0:!1},Formula.AND=function(){for(var t=!0,n=0;n<arguments.length;n++)arguments[n]||(t=!1);return t},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var t,n;if(arguments.length>0){var e=arguments[0],i=arguments.length-1,r=Math.floor(i/2),u=!1,f=i%2==0?null:arguments[arguments.length-1];if(r)for(n=0;n<r;n++)if(e===arguments[n*2+1]){t=arguments[n*2+2];u=!0;break}!u&&f&&(t=f)}return t},Formula.IF=function(n,t,i){return n?t:i},Formula.IFNA=function(n,t){return n==="#N/A"?t:n},Formula.NOT=function(n){return!n},Formula.OR=function(){for(var t=!1,n=0;n<arguments.length;n++)arguments[n]&&(t=!0);return t},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var t=0,n=0;n<arguments.length;n++)arguments[n]&&t++;return Math.floor(Math.abs(t))&1?!0:!1},Formula.REFERENCE=function(n,t){try{var r=t.split("."),i=n;return _(r).forEach(function(n){if(n[n.length-1]==="]"){var t=n.indexOf("["),r=n.substring(t+1,n.length-1);i=i[n.substring(0,t)][r]}else i=i[n]}),i}catch(u){return}},Formula.ABS=function(n){return Math.abs(n)},Formula.ACOS=function(n){return Math.acos(n)},Formula.ACOSH=function(n){return Math.log(n+Math.sqrt(n*n-1))},Formula.ACOT=function(n){return Math.atan(1/n)},Formula.ACOTH=function(n){return.5*Math.log((n+1)/(n-1))},Formula.AGGREGATE=function(n){for(var i=[],t=2;t<arguments.length;t++)switch(n){case 1:i[t-2]=Formula.AVERAGE(arguments[t]);break;case 2:i[t-2]=Formula.COUNT(arguments[t]);break;case 3:i[t-2]=Formula.COUNTA(arguments[t]);break;case 4:i[t-2]=Formula.MAX(arguments[t]);break;case 5:i[t-2]=Formula.MIN(arguments[t]);break;case 6:i[t-2]=Formula.PRODUCT(arguments[t]);break;case 7:i[t-2]=Formula.STDEVS(arguments[t]);break;case 8:i[t-2]=Formula.STDEVP(arguments[t]);break;case 9:i[t-2]=Formula.SUM(arguments[t]);break;case 10:i[t-2]=Formula.VARS(arguments[t]);break;case 11:i[t-2]=Formula.VARP(arguments[t]);break;case 12:i[t-2]=Formula.MEDIAN(arguments[t]);break;case 13:i[t-2]=Formula.MODESNGL(arguments[t]);break;case 14:i[t-2]=Formula.LARGE(arguments[t]);break;case 15:i[t-2]=Formula.SMALL(arguments[t]);break;case 16:i[t-2]=Formula.PERCENTILEINC(arguments[t]);break;case 17:i[t-2]=Formula.QUARTILEINC(arguments[t]);break;case 18:i[t-2]=Formula.PERCENTILEEXC(arguments[t]);break;case 19:i[t-2]=Formula.QUARTILEEXC(arguments[t])}return i},Formula.ARABIC=function(n){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))throw new Error("Incorrect roman number");var t=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),t},Formula.ASIN=function(n){return Math.asin(n)},Formula.ASINH=function(n){return Math.log(n+Math.sqrt(n*n+1))},Formula.ATAN=function(n){return Math.atan(n)},Formula.ATAN2=function(n,t){return Math.atan2(n,t)},Formula.ATANH=function(n){return Math.log((1+n)/(1-n))/2},Formula.BASE=function(n,t,i){i=typeof i=="undefined"?0:i;var r=n.toString(t);return new Array(Math.max(i+1-r.length,0)).join("0")+r},Formula.CEILING=function(n,t,i){if(t===0)return 0;t=typeof t=="undefined"?1:Math.abs(t);i=typeof i=="undefined"?0:i;var r=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.ceil(n/t)*t,r):i===0?-Formula.ROUND(Math.floor(Math.abs(n)/t)*t,r):-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,r)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(n,t){return Formula.FACT(n)/(Formula.FACT(t)*Formula.FACT(n-t))},Formula.COMBINA=function(n,t){return n===0&&t===0?1:Formula.COMBIN(n+t-1,n-1)},Formula.COS=Math.cos,Formula.COSH=function(n){return(Math.exp(n)+Math.exp(-n))/2},Formula.COT=function(n){return 1/Math.tan(n)},Formula.COTH=function(n){var t=Math.exp(2*n);return(t+1)/(t-1)},Formula.CSC=function(n){return 1/Math.sin(n)},Formula.CSCH=function(n){return 2/(Math.exp(n)-Math.exp(-n))},Formula.DECIMAL=function(n,t){return parseInt(n,t)},Formula.DEGREES=function(n){return n*180/Math.PI},Formula.EVEN=function(n){return Formula.CEILING(n,-2,-1)},Formula.EXP=Math.exp,Formula.FACT=function(n){var t=Math.floor(n);return t===0||t===1?1:f[t]>0?f[t]:(f[t]=Formula.FACT(t-1)*t,f[t])},Formula.FACTDOUBLE=function(n){var t=Math.floor(n);return t<=0?1:t*Formula.FACTDOUBLE(t-2)},Formula.FLOOR=function(n,t,i){if(t===0)return 0;t=t?Math.abs(t):1;var r=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.floor(n/t)*t,r):i===0||typeof i=="undefined"?-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,r):-Formula.ROUND(Math.floor(Math.abs(n)/t)*t,r)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=function(n,t){if(t===0)return 0;t=t?Math.abs(t):1;var i=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.round(n/t)*t,i):-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,i)},Formula.GCD=function(){for(var r,t,i=arguments.length-1,n=arguments[i];i;)for(t=arguments[--i];r=t%n;t=n,n=r);return n},Formula.INT=function(n){return Math.floor(n)},Formula.ISEVEN=function(n){return Math.floor(Math.abs(n))&1?!1:!0},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(n){return Math.floor(Math.abs(n))&1?!0:!1},Formula.LCM=function(){for(var r=Formula.ARGSTOARRAY(arguments),n,u,t,i,f=1;(t=r.pop())!==undefined;)while(t>1){if(t%2){for(n=3,u=Math.floor(Math.sqrt(t));n<=u&&t%n;n+=2);i=n<=u?n:t}else i=2;for(t/=i,f*=i,n=r.length;n;r[--n]%i==0&&(r[n]/=i)==1&&r.splice(n,1));}return f},Formula.LN=function(n){return Math.log(n)},Formula.LOG=function(n,t){return t=typeof t=="undefined"?10:t,Math.log(n)/Math.log(t)},Formula.LOG10=function(n){return Math.log(n)/Math.log(10)},Formula.MOD=function(n,t){var i=Math.abs(n%t);return t>0?i:-i},Formula.MROUND=function(n,t){if(n*t<0)throw new Error("Number and multiple must have the same sign.");return Math.round(n/t)*t},Formula.MULTINOMIAL=function(){for(var t=0,i=1,n=0;n<arguments.length;n++)t+=arguments[n],i*=Formula.FACT(arguments[n]);return Formula.FACT(t)/i},Formula.ODD=function(n){var t=Math.ceil(Math.abs(n));return t=t&1?t:t+1,n>0?t:-t},Formula.E=function(){return Math.E},Formula.PI=function(){return Math.PI},Formula.POWER=function(n,t){var i=Math.pow(n,t);return isNaN(i)?"#NUM!":i},Formula.PRODUCT=function(){for(var t=1,n=0;n<arguments.length;n++)t*=arguments[n];return t},Formula.QUOTIENT=function(n,t){return(n/t).toFixed(0)},Formula.RADIANS=function(n){return n*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(n,t){return n+Math.ceil((t-n+1)*Math.random())-1},Formula.ROUND=function(n,t){return Math.round(n*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDDOWN=function(n,t){var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDUP=function(n,t){var i=n>0?1:-1;return i*Math.ceil(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.SERIESSUM=function(n,t,i,r){for(var f=r[0]*Math.pow(n,t),u=1;u<r.length;u++)f+=r[u]*Math.pow(n,t+u*i);return f},Formula.SEC=function(n){return 1/Math.cos(n)},Formula.SECH=function(n){return 2/(Math.exp(n)+Math.exp(-n))},Formula.SIGN=function(n){return n<0?-1:n===0?0:1},Formula.SIN=Math.sin,Formula.SINH=function(n){return(Math.exp(n)-Math.exp(-n))/2},Formula.SQRT=Math.sqrt,Formula.SQRTPI=function(n){return Math.sqrt(n*Math.PI)},Formula.SUBTOTAL=function(n){for(var i=[],t=1;t<arguments.length;t++)switch(n){case 1:i[t-1]=Formula.AVERAGE(arguments[t]);break;case 2:i[t-1]=Formula.COUNT(arguments[t]);break;case 3:i[t-1]=Formula.COUNTA(arguments[t]);break;case 4:i[t-1]=Formula.MAX(arguments[t]);break;case 5:i[t-1]=Formula.MIN(arguments[t]);break;case 6:i[t-1]=Formula.PRODUCT(arguments[t]);break;case 7:i[t-1]=Formula.STDEV(arguments[t]);break;case 8:i[t-1]=Formula.STDEVP(arguments[t]);break;case 9:i[t-1]=Formula.SUM(arguments[t]);break;case 10:i[t-1]=Formula.VAR(arguments[t]);break;case 11:i[t-1]=Formula.VARP(arguments[t])}return i},Formula.SUM=function(){for(var i,t=Formula.FLATTEN(arguments),r=0,n=0;n<t.length;n++)if(t[n]instanceof Array)for(i=0;i<t[n].length;i++)r+=Formula.ISNUMBER(t[n][i])?t[n][i]:0;else r+=Formula.ISNUMBER(t[n])?t[n]:0;return r},Formula.SUMIF=function(range,criteria){var result,i;for(range=Formula.FLATTEN(range),result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var fit,j,criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},Formula.SUMPRODUCT=function(){for(var t,r,i,f=arguments.length+1,u=0,n=0;n<arguments[0].length;n++)for(t=0;t<arguments[0][n].length;t++){for(r=1,i=1;i<f;i++)r*=arguments[i-1][n][t];u+=r}return u},Formula.SUMSQ=function(){for(var t=Formula.FLATTEN(arguments),i=0,n=0;n<t.length;n++)i+=Formula.ISNUMBER(t[n])?t[n]*t[n]:0;return i},Formula.SUMX2MY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=n[i]*n[i]-t[i]*t[i];return r},Formula.SUMX2PY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=n[i]*n[i]+t[i]*t[i];return r},Formula.SUMXMY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=Math.pow(n[i]-t[i],2);return r},Formula.TAN=function(n){return Math.tan(n)},Formula.TANH=function(n){var t=Math.exp(2*n);return(t-1)/(t+1)},Formula.TRUNC=function(n,t){t=typeof t=="undefined"?0:t;var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.AVEDEV=function(){var n=Formula.FLATTEN(arguments);return t.sum(t(n).subtract(t.mean(n)).abs()[0])/n.length},Formula.AVERAGE=function(){for(var t=Formula.NUMBERS(Formula.FLATTEN(arguments)),u=t.length,i=0,r=0,n=0;n<u;n++)i+=t[n],r+=1;return i/r},Formula.AVERAGEA=function(){for(var n,r=Formula.FLATTEN(arguments),f=r.length,t=0,u=0,i=0;i<f;i++)n=r[i],typeof n=="number"&&(t+=n),n===!0&&t++,n!==null&&u++;return t/u},Formula.AVERAGEIF=function(range,criteria,average_range){var average_count,result,i;for(average_range=average_range||range,range=Formula.FLATTEN(range),average_range=Formula.FLATTEN(average_range),average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var condition,j,average,args=Formula.ARGSTOARRAY(arguments),criteria=(args.length-1)/2,range=Formula.FLATTEN(args[0]),count=0,result=0,i=0;i<range.length;i++){for(condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}return average=result/count,isNaN(average)?0:average},Formula.BETADIST=function(n,i,r,u,f,e){return f=typeof f=="undefined"?0:f,e=typeof e=="undefined"?1:e,n=(n-f)/(e-f),u?t.beta.cdf(n,i,r):t.beta.pdf(n,i,r)},Formula.BETAINV=function(n,i,r,u,f){return u=typeof u=="undefined"?0:u,f=typeof f=="undefined"?1:f,t.beta.inv(n,i,r)*(f-u)+u},Formula.BINOMDIST=function(n,i,r,u){return u?t.binomial.cdf(n,i,r):t.binomial.pdf(n,i,r)},Formula.BINOMDISTRANGE=function(n,t,i,r){var f,u;for(r=typeof r=="undefined"?i:r,f=0,u=i;u<=r;u++)f+=Formula.COMBIN(n,u)*Math.pow(t,u)*Math.pow(1-t,n-u);return f},Formula.BINOMINV=function(n,i,r){for(var u=0;u<=n;){if(t.binomial.cdf(u,n,i)>=r)return u;u++}},Formula.CHISQDIST=function(n,i,r){return r?t.chisquare.cdf(n,i):t.chisquare.pdf(n,i)},Formula.CHISQDISTRT=function(){return},Formula.CHISQINV=function(n,i){return t.chisquare.inv(n,i)},Formula.CHISQINVRT=function(){return},Formula.CHISQTEST=function(){return},Formula.CONFIDENCENORM=function(n,i,r){return t.normalci(1,n,i,r)[1]-1},Formula.CONFIDENCET=function(n,i,r){return t.tci(1,n,i,r)[1]-1},Formula.CORREL=function(){return t.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){var n=Formula.NUMBERS(Formula.FLATTEN(arguments));return n.length},Formula.COUNTA=function(){var n=Formula.FLATTEN(arguments);return n.length-Formula.COUNTBLANK(n)},Formula.COUNTBLANK=function(){for(var i=Formula.FLATTEN(arguments),r=0,n,t=0;t<i.length;t++)n=i[t],n!==null&&n!==""&&n||r++;return r},Formula.COUNTIF=function(n,t){var r,i;for(n=Formula.FLATTEN(n),r=0,i=0;i<n.length;i++)n[i].match(new RegExp(t))&&r++;return r},Formula.COUNTIFS=function(){for(var fit,j,criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.FLATTEN(arguments)).length},Formula.COVARIANCEP=function(n,i){var r;n=Formula.FLATTEN(n);i=Formula.FLATTEN(i);var e=t.mean(n),o=t.mean(i),u=0,f=n.length;for(r=0;r<f;r++)u+=(n[r]-e)*(i[r]-o);return u/f},Formula.COVARIANCES=function(){return t.covariance.apply(this,c(arguments))},Formula.DEVSQ=function(){for(var n=Formula.ARGSCONCAT(arguments),u=t.mean(n),r=0,i=0;i<n.length;i++)r+=Math.pow(n[i]-u,2);return r},Formula.EXPONDIST=function(n,i,r){return r?t.exponential.cdf(n,i):t.exponential.pdf(n,i)},Formula.FDIST=function(n,i,r,u){return u?t.centralF.cdf(n,i,r):t.centralF.pdf(n,i,r)},Formula.FDISTRT=function(){return},Formula.FINV=function(n,i,r){return n<=0||n>1?"#NUM!":t.centralF.inv(1-n,i,r)},Formula.FINVRT=function(){return},Formula.FTEST=function(){return},Formula.FISHER=function(n){return Math.log((1+n)/(1-n))/2},Formula.FISHERINV=function(n){var t=Math.exp(2*n);return(t-1)/(t+1)},Formula.FORECAST=function(n,i,r){var u,e,c;r=Formula.FLATTEN(r);i=Formula.FLATTEN(i);var f=t.mean(r),o=t.mean(i),l=r.length,s=0,h=0;for(u=0;u<l;u++)s+=(r[u]-f)*(i[u]-o),h+=Math.pow(r[u]-f,2);return e=s/h,c=o-e*f,c+e*n},Formula.FREQUENCY=function(n,t){for(var r,e=n.length,u=t.length,f=[],i=0;i<=u;i++)for(f[i]=0,r=0;r<e;r++)i===0?n[r]<=t[0]&&(f[0]+=1):i<u?n[r]>t[i-1]&&n[r]<=t[i]&&(f[i]+=1):i===u&&n[r]>t[u-1]&&(f[u]+=1);return f},Formula.GAMMA=function(){return t.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(){return},Formula.GAMMAINV=function(){return},Formula.GAMMALN=function(){return t.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){return},Formula.GAUSS=function(n){return t.normal.cdf(n,0,1)-.5},Formula.GEOMEAN=function(){return t.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(n,t,i,r){var u,o,a,l,v,y;if(typeof t=="undefined")for(t=[],u=1;u<=n.length;u++)t.push(u);if(typeof i=="undefined")for(i=[],u=1;u<=n.length;u++)i.push(u);typeof r=="undefined"&&(r=!0);var e=n.length,f=0,s=0,h=0,c=0;for(u=0;u<e;u++)o=t[u],a=Math.log(n[u]),f+=o,s+=a,h+=o*a,c+=o*o;for(f/=e,s/=e,h/=e,c/=e,r?(l=(h-f*s)/(c-f*f),v=s-l*f):(l=h/c,v=0),y=[],u=0;u<i.length;u++)y.push(Math.exp(v+l*i[u]));return y},Formula.HARMEAN=function(){for(var t=Formula.ARGSCONCAT(arguments),i=t.length,r=0,n=0;n<i;n++)r+=1/t[n];return i/r},Formula.HYPGEOMDIST=function(n,t,i,r,u){function f(n,t,i,r){return Formula.COMBIN(i,n)*Formula.COMBIN(r-i,t-n)/Formula.COMBIN(r,t)}function e(n,t,i,r){for(var e=0,u=0;u<=n;u++)e+=f(u,t,i,r);return e}return u?e(n,t,i,r):f(n,t,i,r)},Formula.INTERCEPT=function(n,t){return Formula.FORECAST(0,n,t)},Formula.KURT=function(){for(var i=Formula.ARGSCONCAT(arguments),f=t.mean(i),n=i.length,r=0,u=0;u<n;u++)r+=Math.pow(i[u]-f,4);return r=r/Math.pow(t.stdev(i,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},Formula.LARGE=function(n,t){return n.sort(function(n,t){return t-n})[t-1]},Formula.LINEST=function(n,i){for(var f,h,u=t.mean(i),e=t.mean(n),c=i.length,o=0,s=0,r=0;r<c;r++)o+=(i[r]-u)*(n[r]-e),s+=Math.pow(i[r]-u,2);return f=o/s,h=e-f*u,[f,h]},Formula.LOGEST=function(){return},Formula.LOGNORMDIST=function(n,i,r,u){return u?t.lognormal.cdf(n,i,r):t.lognormal.pdf(n,i,r)},Formula.LOGNORMINV=function(n,i,r){return t.lognormal.inv(n,i,r)},Formula.MAX=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,i=r>0?n[0]:0,t=0;t<r;t++)i=n[t]>i&&n[t]!==!0&&n[t]!==!1?n[t]:i;return i},Formula.MAXA=function(){var n=Formula.FLATTEN(arguments);return n.length>0?Math.max.apply(Math,n):0},Formula.MEDIAN=function(){return t.median(Formula.FLATTEN(arguments))},Formula.MIN=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,i=r>0?n[0]:0,t=0;t<r;t++)i=n[t]<i&&n[t]!==!0&&n[t]!==!1?n[t]:i;return i},Formula.MINA=function(){var n=Formula.FLATTEN(arguments);return n.length>0?Math.min.apply(Math,n):0},Formula.MODEMULT=function(){for(var f=Formula.ARGSCONCAT(arguments),e=f.length,t={},i=[],r=0,n,u=0;u<e;u++)n=f[u],t[n]=t[n]?t[n]+1:1,t[n]>r&&(r=t[n],i=[]),t[n]===r&&(i[i.length]=n);return i},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(n,t){return n-t})[0]},Formula.NEGBINOMDIST=function(n,i,r,u){return u?t.negbin.cdf(n,i,r):t.negbin.pdf(n,i,r)},Formula.NORMDIST=function(n,i,r,u){return isNaN(n)||isNaN(i)||isNaN(r)?"#VALUE!":r<=0?"#NUM!":u?t.normal.cdf(n,i,r):t.normal.pdf(n,i,r)},Formula.NORMINV=function(n,i,r){return t.normal.inv(n,i,r)},Formula.NORMSDIST=function(n,i){return i?t.normal.cdf(n,0,1):t.normal.pdf(n,0,1)},Formula.NORMSINV=function(n){return t.normal.inv(n,0,1)},Formula.PEARSON=function(n,i){for(var u=t.mean(n),f=t.mean(i),h=n.length,e=0,o=0,s=0,r=0;r<h;r++)e+=(n[r]-u)*(i[r]-f),o+=Math.pow(n[r]-u,2),s+=Math.pow(i[r]-f,2);return e/Math.sqrt(o*s)},Formula.PERCENTILEEXC=function(n,t){var u,r,i;return(n=n.sort(function(n,t){return n-t}),u=n.length,t<1/(u+1)||t>1-1/(u+1))?"#NUM!":(r=t*(u+1)-1,i=Math.floor(r),Formula.CLEANFLOAT(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i])))},Formula.PERCENTILEINC=function(n,t){n=n.sort(function(n,t){return n-t});var u=n.length,r=t*(u-1),i=Math.floor(r);return Formula.CLEANFLOAT(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i]))},Formula.PERCENTRANKEXC=function(n,t,i){n=n.sort(function(n,t){return n-t});var u=_.uniq(n),o=n.length,s=u.length;i=typeof i=="undefined"?3:i;for(var h=Math.pow(10,i),f=0,e=!1,r=0;!e&&r<s;)t===u[r]?(f=(n.indexOf(u[r])+1)/(o+1),e=!0):t>=u[r]&&(t<u[r+1]||r===s-1)&&(f=(n.indexOf(u[r])+1+(t-u[r])/(u[r+1]-u[r]))/(o+1),e=!0),r++;return Math.floor(f*h)/h},Formula.PERCENTRANKINC=function(n,t,i){n=n.sort(function(n,t){return n-t});var u=_.uniq(n),o=n.length,s=u.length;i=typeof i=="undefined"?3:i;for(var h=Math.pow(10,i),f=0,e=!1,r=0;!e&&r<s;)t===u[r]?(f=n.indexOf(u[r])/(o-1),e=!0):t>=u[r]&&(t<u[r+1]||r===s-1)&&(f=(n.indexOf(u[r])+(t-u[r])/(u[r+1]-u[r]))/(o-1),e=!0),r++;return Math.floor(f*h)/h},Formula.PERMUT=function(n,t){return Formula.FACT(n)/Formula.FACT(n-t)},Formula.PERMUTATIONA=function(n,t){return Math.pow(n,t)},Formula.PHI=function(n){return Math.exp(-.5*n*n)/o},Formula.POISSONDIST=function(n,i,r){return r?t.poisson.cdf(n,i):t.poisson.pdf(n,i)},Formula.PROB=function(n,t,i,r){var u;if(typeof i=="undefined")return 0;if(r=typeof r=="undefined"?i:r,i===r)return n.indexOf(i)>=0?t[n.indexOf(i)]:0;var f=n.sort(function(n,t){return n-t}),o=f.length,e=0;for(u=0;u<o;u++)f[u]>=i&&f[u]<=r&&(e+=t[n.indexOf(f[u])]);return e},Formula.QUARTILEEXC=function(n,t){switch(t){case 1:return Formula.PERCENTILEEXC(n,.25);case 2:return Formula.PERCENTILEEXC(n,.5);case 3:return Formula.PERCENTILEEXC(n,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(n,t){switch(t){case 1:return Formula.PERCENTILEINC(n,.25);case 2:return Formula.PERCENTILEINC(n,.5);case 3:return Formula.PERCENTILEINC(n,.75);default:return"#NUM!"}},Formula.RANKAVG=function(n,t,i){var u,r;return i=typeof i=="undefined"?!1:i,u=i?function(n,t){return n-t}:function(n,t){return t-n},t=t.sort(u),r=Formula.COUNTIN(t,n),r>1?(2*t.indexOf(n)+r+1)/2:t.indexOf(n)+1},Formula.RANKEQ=function(n,t,i){i=typeof i=="undefined"?!1:i;var r=i?function(n,t){return n-t}:function(n,t){return t-n};return t=t.sort(r),t.indexOf(n)+1},Formula.RSQ=function(n,t){return Math.pow(Formula.PEARSON(n,t),2)},Formula.SKEW=function(){for(var n=Formula.ARGSCONCAT(arguments),f=t.mean(n),i=n.length,u=0,r=0;r<i;r++)u+=Math.pow(n[r]-f,3);return i*u/((i-1)*(i-2)*Math.pow(t.stdev(n,!0),3))},Formula.SKEWP=function(){for(var n=Formula.ARGSCONCAT(arguments),e=t.mean(n),f=n.length,i=0,r=0,u=0;u<f;u++)r+=Math.pow(n[u]-e,3),i+=Math.pow(n[u]-e,2);return r=r/f,i=i/f,r/Math.pow(i,3/2)},Formula.SLOPE=function(n,i){for(var u=t.mean(i),o=t.mean(n),s=i.length,f=0,e=0,r=0;r<s;r++)f+=(i[r]-u)*(n[r]-o),e+=Math.pow(i[r]-u,2);return f/e},Formula.SMALL=function(n,t){return n.sort(function(n,t){return n-t})[t-1]},Formula.STANDARDIZE=function(n,t,i){return(n-t)/i},Formula.STDEVA=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,u=0,f=t.mean(n),i=0;i<r;i++)u+=Math.pow(n[i]-f,2);return Math.sqrt(u/(r-1))},Formula.STDEVP=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return Math.sqrt(i/r)},Formula.STDEVPA=function(){for(var n=Formula.ARGSCONCAT(arguments),r=n.length,u=0,f=t.mean(n),i=0;i<r;i++)u+=Math.pow(n[i]-f,2);return Math.sqrt(u/r)},Formula.STDEVS=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return Math.sqrt(i/(r-1))},Formula.STEYX=function(n,i){for(var f=t.mean(i),e=t.mean(n),o=i.length,s=0,u=0,h=0,r=0;r<o;r++)s+=Math.pow(n[r]-e,2),u+=(i[r]-f)*(n[r]-e),h+=Math.pow(i[r]-f,2);return Math.sqrt((s-u*u/h)/(o-2))},Formula.TDIST=function(n,i,r){return r?t.studentt.cdf(n,i):t.studentt.pdf(n,i)},Formula.TDIST2T=function(){return},Formula.TDISTRT=function(){return},Formula.TINV=function(n,i){return t.studentt.inv(n,i)},Formula.TINV2T=function(){return},Formula.TTEST=function(){return},Formula.TREND=function(){return},Formula.TRIMMEAN=function(n,i){n=Formula.FLATTEN(n);var r=Formula.FLOOR(n.length*i,2)/2;return t.mean(_.initial(_.rest(n.sort(function(n,t){return n-t}),r),r))},Formula.VARA=function(){for(var n,t=Formula.FLATTEN(arguments),e=t.length,u=0,f=0,i=Formula.AVERAGEA(t),r=0;r<e;r++)n=t[r],u+=typeof n=="number"?Math.pow(n-i,2):n===!0?Math.pow(1-i,2):Math.pow(0-i,2),n!==null&&f++;return u/(f-1)},Formula.VARP=function(){for(var n=Formula.NUMBERS(Formula.FLATTEN(arguments)),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)i+=Math.pow(n[t]-f,2),r++;return i/r},Formula.VARPA=function(){for(var n,t=Formula.FLATTEN(arguments),e=t.length,u=0,f=0,i=Formula.AVERAGEA(t),r=0;r<e;r++)n=t[r],u+=typeof n=="number"?Math.pow(n-i,2):n===!0?Math.pow(1-i,2):Math.pow(0-i,2),n!==null&&f++;return u/f},Formula.VARS=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return i/(r-1)},Formula.WEIBULLDIST=function(n,t,i,r){return r?1-Math.exp(-Math.pow(n/i,t)):Math.pow(n,t-1)*Math.exp(-Math.pow(n/i,t))*t/Math.pow(i,t)},Formula.ZTEST=function(n,t,i){var r=n.length,u=typeof i=="undefined"?Formula.STDEVS(n):i;return 1-Formula.NORMSDIST((Formula.AVERAGE(n)-t)/(u/Math.sqrt(r)),Formula.TRUE)},Formula.CHAR=function(n){return String.fromCharCode(n)},Formula.CLEAN=function(n){return n.replace(/[\0-\x1F]/g,"")},Formula.CODE=function(n){return n.charCodeAt(0)},Formula.CONCATENATE=function(){for(var t="",n=0;n<arguments.length;n++)arguments[n]!==null&&arguments[n]!==undefined&&(t+=arguments[n]);return t},Formula.DOLLAR=function(t,i){i=typeof i=="undefined"?2:i;var r="";return i<=0?(t=Math.round(t*Math.pow(10,i))/Math.pow(10,i),r="($0,0)"):i>0&&(r="($0,0."+new Array(i+1).join("0")+")"),n(t).format(r)},Formula.EXACT=function(n,t){return n===t},Formula.FIND=function(n,t,i){return i=typeof i=="undefined"?0:i,t?t.indexOf(n,i-1)+1:null},Formula.FIXED=function(t,i,r){i=typeof i=="undefined"?2:i;r=typeof r=="undefined"?!1:r;var u=r?"0":"0,0";return i<=0?t=Math.round(t*Math.pow(10,i))/Math.pow(10,i):i>0&&(u+="."+new Array(i+1).join("0")),n(t).format(u)},Formula.HTML2TEXT=function(n){var t="";return n&&(n instanceof Array?n.forEach(function(n){t!==""&&(t+="\n");t+=n.replace(/<(?:.|\n)*?>/gm,"")}):t=n.replace(/<(?:.|\n)*?>/gm,"")),t},Formula.HUMANIZE=function(n){if(n instanceof Date){var t=i(n);return t.hours()||t.minutes()||t.seconds()?t.format("dddd, MMMM Do YYYY, h:mm:ss"):t.format("dddd, MMMM Do YYYY")}return n},Formula.JOIN=function(n,t){return n.join(t)},Formula.LEFT=function(n,t){return t=typeof t=="undefined"?1:t,n?n.substring(0,t):null},Formula.LEN=function(n){return n?n.length:0},Formula.LOWER=function(n){return n?n.toLowerCase():n},Formula.MID=function(n,t,i){return n.substring(t-1,i)},Formula.NUMBERVALUE=function(n,t,i){return t=typeof t=="undefined"?".":t,i=typeof i=="undefined"?",":i,Number(n.replace(t,".").replace(i,""))},Formula.NUMBERS=function(){var n=Formula.FLATTEN(arguments);return n.filter(function(n){return typeof n=="number"})},Formula.PROPER=function(n){if(n)return n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},Formula.REGEXEXTRACT=function(n,t){var i=n.match(new RegExp(t));return i?i[i.length>1?i.length-1:0]:null},Formula.REGEXMATCH=function(n,t,i){var r=n.match(new RegExp(t));return i?r:!!r},Formula.REGEXREPLACE=function(n,t,i){return n.replace(new RegExp(t),i)},Formula.REPLACE=function(n,t,i,r){return n.substr(0,t-1)+r+n.substr(t-1+i)},Formula.REPT=function(n,t){return new Array(t+1).join(n)},Formula.RIGHT=function(n,t){return t=typeof t=="undefined"?1:t,n?n.substring(n.length-t):null},Formula.ROMAN=function(n){for(var i=String(n).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],t="",r=3;r--;)t=(u[+i.pop()+r*10]||"")+t;return new Array(+i.join("")+1).join("M")+t},Formula.SEARCH=function(n,t,i){return i=typeof i=="undefined"?0:i,t.toLowerCase().indexOf(n.toLowerCase(),i-1)+1},Formula.SPLIT=function(n,t){return r.words(n,t)},Formula.SUBSTITUTE=function(n,t,i,r){if(n&&t&&i){if(typeof r=="undefined")return n.replace(new RegExp(t,"g"),i);for(var u=0,f=0;n.indexOf(t,u)>0;)if(u=n.indexOf(t,u+1),f++,f===r)return n.substring(0,u)+i+n.substring(u+t.length)}else return n},Formula.T=function(n){return typeof n=="string"?n:null},Formula.TEXT=function(t,r){if(!t)return"";if(t instanceof Object)try{return JSON.stringify(t)}catch(u){return""}return typeof t=="string"?r?r.indexOf("0")>=0?n(t).format(r):i(new Date(t)).format(r):t:t.toString&&typeof t.toString=="function"?t.toString():""},Formula.TRIM=function(n){return r.clean(n)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(n){return n.toUpperCase()},Formula.VALUE=function(t){return n().unformat(t)},Formula.MD5=function(n,t,i){return u(n,t,i)},Formula.NUMERAL=function(t,i){return n(t).format(i)},Formula.ISERR=function(n){return["#DIV/0!","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(n)>=0?!0:!1},Formula.ISERROR=function(n){return Formula.ISERR(n)||n==="#N/A"},Formula.IFERROR=function(n,t){return Formula.ISERROR(n)?t:n},Formula}var n=this,Formula=n.Formula={},i=n._,r=n.numeral,u=n.jStat,f=n.moment,e=i,o=n.md5,s=i.str;if(typeof exports!="undefined")module.exports=t(require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5"));else if(typeof define=="function"&&define.amd)define("formula",["numeral","jstat","moment","lodash","underscore.string","md5"],t);else return Formula=t(r,u,f,e,s,o)}.call(this);var Parser=function(){function st(){this.yy={}}var n=function(n,t,i,r){for(i=i||{},r=n.length;r--;i[n[r]]=t);return i},i=[1,4],r=[1,5],u=[1,7],f=[1,10],e=[1,8],o=[1,9],s=[1,11],h=[1,16],c=[1,17],l=[1,14],a=[1,15],t=[1,18],v=[1,20],it=[1,21],k=[1,22],g=[1,23],nt=[1,24],tt=[1,25],d=[1,26],p=[1,27],w=[1,28],y=[1,29],b=[5,11,12,13,15,16,17,18,19,20,21,22,30,31],ht=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,33],ct=[1,38],et=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,35],ut=[5,12,13,15,16,17,18,19,30,31],rt=[5,12,15,16,17,18,30,31],lt=[5,12,13,15,16,17,18,19,20,21,30,31],ft=[15,30,31],at=[5,11,12,13,15,16,17,18,19,20,21,22,30,31,32,36],ot={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,"&":11,"=":12,"+":13,"(":14,")":15,"<":16,">":17,NOT:18,"-":19,"*":20,"/":21,"^":22,FUNCTION:23,expseq:24,cell:25,FIXEDCELL:26,":":27,CELL:28,ARRAY:29,";":30,",":31,VARIABLE:32,DECIMAL:33,NUMBER:34,"%":35,"#":36,"!":37,$accept:0,$end:1},terminals_:{5:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"&",12:"=",13:"+",14:"(",15:")",16:"<",17:">",18:"NOT",19:"-",20:"*",21:"/",22:"^",23:"FUNCTION",26:"FIXEDCELL",27:":",28:"CELL",29:"ARRAY",30:";",31:",",32:"VARIABLE",33:"DECIMAL",34:"NUMBER",35:"%",36:"#",37:"!"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[25,1],[25,3],[25,1],[25,3],[24,1],[24,1],[24,3],[24,3],[6,1],[6,3],[9,1],[9,3],[9,2],[2,3],[2,4]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1,n1,result,arr;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.handler.helper.callVariable.call(this,$$[$0]);break;case 3:this.$=yy.handler.time.call(yy.obj,$$[$0],!0);break;case 4:this.$=yy.handler.time.call(yy.obj,$$[$0]);break;case 5:this.$=yy.handler.helper.number($$[$0]);break;case 6:this.$=yy.handler.helper.string($$[$0]);break;case 7:this.$=yy.handler.helper.specialMatch("&",$$[$0-2],$$[$0]);break;case 8:this.$=yy.handler.helper.logicMatch("=",$$[$0-2],$$[$0]);break;case 9:this.$=yy.handler.helper.mathMatch("+",$$[$0-2],$$[$0]);break;case 10:this.$=yy.handler.helper.number($$[$0-1]);break;case 11:this.$=yy.handler.helper.logicMatch("<=",$$[$0-3],$$[$0]);break;case 12:this.$=yy.handler.helper.logicMatch(">=",$$[$0-3],$$[$0]);break;case 13:this.$=yy.handler.helper.logicMatch("<>",$$[$0-3],$$[$0]);break;case 14:this.$=yy.handler.helper.logicMatch("NOT",$$[$0-2],$$[$0]);break;case 15:this.$=yy.handler.helper.logicMatch(">",$$[$0-2],$$[$0]);break;case 16:this.$=yy.handler.helper.logicMatch("<",$$[$0-2],$$[$0]);break;case 17:this.$=yy.handler.helper.mathMatch("-",$$[$0-2],$$[$0]);break;case 18:this.$=yy.handler.helper.mathMatch("*",$$[$0-2],$$[$0]);break;case 19:this.$=yy.handler.helper.mathMatch("/",$$[$0-2],$$[$0]);break;case 20:this.$=yy.handler.helper.mathMatch("^",$$[$0-2],$$[$0]);break;case 21:n1=yy.handler.helper.numberInverted($$[$0]);this.$=n1;isNaN(this.$)&&(this.$=0);break;case 22:n1=yy.handler.helper.number($$[$0]);this.$=n1;isNaN(this.$)&&(this.$=0);break;case 23:this.$=yy.handler.helper.callFunction.call(this,$$[$0-2],"");break;case 24:this.$=yy.handler.helper.callFunction.call(this,$$[$0-3],$$[$0-1]);break;case 28:this.$=yy.handler.helper.fixedCellValue.call(yy.obj,$$[$0]);break;case 29:this.$=yy.handler.helper.fixedCellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 30:this.$=yy.handler.helper.cellValue.call(yy.obj,$$[$0]);break;case 31:this.$=yy.handler.helper.cellRangeValue.call(yy.obj,$$[$0-2],$$[$0]);break;case 32:this.$=yy.handler.utils.isArray($$[$0])?$$[$0]:[$$[$0]];break;case 33:result=[];arr=eval("["+yytext+"]");arr.forEach(function(n){result.push(n)});this.$=result;break;case 34:case 35:$$[$0-2].push($$[$0]);this.$=$$[$0-2];break;case 36:this.$=[$$[$0]];break;case 37:this.$=yy.handler.utils.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]];this.$.push($$[$0]);break;case 38:this.$=$$[$0];break;case 39:this.$=($$[$0-2]+"."+$$[$0])*1;break;case 40:this.$=$$[$0-1]*.01;break;case 41:case 42:this.$=$$[$0-2]+$$[$0-1]+$$[$0]}},table:[{2:13,3:1,4:2,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{1:[3]},{5:[1,19],11:v,12:it,13:k,16:g,17:nt,18:tt,19:d,20:p,21:w,22:y},n(b,[2,2],{33:[1,30]}),n(b,[2,3]),n(b,[2,4]),n(b,[2,5],{35:[1,31]}),n(b,[2,6]),{2:13,4:32,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:33,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:34,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{14:[1,35]},n(b,[2,25]),n(b,[2,26],{2:36,32:[1,37],36:t}),n(ht,[2,36],{36:ct}),n(et,[2,38],{33:[1,39]}),n(b,[2,28],{27:[1,40]}),n(b,[2,30],{27:[1,41]}),{32:[1,42]},{1:[2,1]},{2:13,4:43,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:44,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:45,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:48,6:3,7:i,8:r,9:6,10:u,12:[1,46],13:f,14:e,17:[1,47],19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:50,6:3,7:i,8:r,9:6,10:u,12:[1,49],13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:51,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:52,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:53,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:54,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:55,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{32:[1,56]},n(et,[2,40]),{11:v,12:it,13:k,15:[1,57],16:g,17:nt,18:tt,19:d,20:p,21:w,22:y},n(ut,[2,21],{11:v,20:p,21:w,22:y}),n(ut,[2,22],{11:v,20:p,21:w,22:y}),{2:13,4:60,6:3,7:i,8:r,9:6,10:u,13:f,14:e,15:[1,58],19:o,23:s,24:59,25:12,26:h,28:c,29:[1,61],32:l,34:a,36:t},n(b,[2,27]),{36:ct},{32:[1,62]},{34:[1,63]},{26:[1,64]},{28:[1,65]},{37:[1,66]},n(b,[2,7]),n([5,12,15,30,31],[2,8],{11:v,13:k,16:g,17:nt,18:tt,19:d,20:p,21:w,22:y}),n(ut,[2,9],{11:v,20:p,21:w,22:y}),{2:13,4:67,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:68,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},n(rt,[2,16],{11:v,13:k,19:d,20:p,21:w,22:y}),{2:13,4:69,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},n(rt,[2,15],{11:v,13:k,19:d,20:p,21:w,22:y}),n([5,12,15,18,30,31],[2,14],{11:v,13:k,16:g,17:nt,19:d,20:p,21:w,22:y}),n(ut,[2,17],{11:v,20:p,21:w,22:y}),n(lt,[2,18],{11:v,22:y}),n(lt,[2,19],{11:v,22:y}),n([5,12,13,15,16,17,18,19,20,21,22,30,31],[2,20],{11:v}),n(ht,[2,37]),n(b,[2,10]),n(b,[2,23]),{15:[1,70],30:[1,71],31:[1,72]},n(ft,[2,32],{11:v,12:it,13:k,16:g,17:nt,18:tt,19:d,20:p,21:w,22:y}),n(ft,[2,33]),{37:[1,73]},n(et,[2,39]),n(b,[2,29]),n(b,[2,31]),n(at,[2,41]),n(rt,[2,11],{11:v,13:k,19:d,20:p,21:w,22:y}),n(rt,[2,13],{11:v,13:k,19:d,20:p,21:w,22:y}),n(rt,[2,12],{11:v,13:k,19:d,20:p,21:w,22:y}),n(b,[2,24]),{2:13,4:74,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},{2:13,4:75,6:3,7:i,8:r,9:6,10:u,13:f,14:e,19:o,23:s,25:12,26:h,28:c,32:l,34:a,36:t},n(at,[2,42]),n(ft,[2,34],{11:v,12:it,13:k,16:g,17:nt,18:tt,19:d,20:p,21:w,22:y}),n(ft,[2,35],{11:v,12:it,13:k,16:g,17:nt,18:tt,19:d,20:p,21:w,22:y})],defaultActions:{19:[2,1]},parseError:function(n,t){if(t.recoverable)this.trace(n);else throw new Error(n);},parse:function(n){function lt(n){u.length=u.length-2*n;o.length=o.length-n;i.length=i.length-n}var ht=this,u=[0],o=[null],i=[],h=this.table,it="",y=0,rt=0,p=0,w=2,b=1,ct=i.slice.call(arguments,1),t=Object.create(this.lexer),c={yy:{}},g,k,ft,r,a,e,f,ut,l,nt,s,ot,tt,d,v;for(g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(c.yy[g]=this.yy[g]);t.setInput(n,c.yy);c.yy.lexer=t;c.yy.parser=this;typeof t.yylloc=="undefined"&&(t.yylloc={});k=t.yylloc;i.push(k);ft=t.options&&t.options.ranges;this.parseError=typeof c.yy.parseError=="function"?c.yy.parseError:Object.getPrototypeOf(this).parseError;function et(){var n;return n=t.lex()||b,typeof n!="number"&&(n=ht.symbols_[n]||n),n}for(l={};;){if(e=u[u.length-1],this.defaultActions[e]?f=this.defaultActions[e]:((r===null||typeof r=="undefined")&&(r=et()),f=h[e]&&h[e][r]),typeof f=="undefined"||!f.length||!f[0]){v="";function st(n){for(var t=u.length-1,i=0;;){if(w.toString()in h[n])return i;if(n===0||t<2)return!1;t-=2;n=u[t];++i}}if(p)a!==b&&(d=st(e));else{d=st(e);tt=[];for(nt in h[e])this.terminals_[nt]&&nt>w&&tt.push("'"+this.terminals_[nt]+"'");v=t.showPosition?"Parse error on line "+(y+1)+":\n"+t.showPosition()+"\nExpecting "+tt.join(", ")+", got '"+(this.terminals_[r]||r)+"'":"Parse error on line "+(y+1)+": Unexpected "+(r==b?"end of input":"'"+(this.terminals_[r]||r)+"'");this.parseError(v,{text:t.match,token:this.terminals_[r]||r,line:t.yylineno,loc:k,expected:tt,recoverable:d!==!1})}if(p==3){if(r===b||a===b)throw new Error(v||"Parsing halted while starting to recover from another error.");rt=t.yyleng;it=t.yytext;y=t.yylineno;k=t.yylloc;r=et()}if(d===!1)throw new Error(v||"Parsing halted. No suitable error recovery rule available.");lt(d);a=r==w?null:r;r=w;e=u[u.length-1];f=h[e]&&h[e][w];p=3}if(f[0]instanceof Array&&f.length>1)throw new Error("Parse Error: multiple actions possible at state: "+e+", token: "+r);switch(f[0]){case 1:u.push(r);o.push(t.yytext);i.push(t.yylloc);u.push(f[1]);r=null;a?(r=a,a=null):(rt=t.yyleng,it=t.yytext,y=t.yylineno,k=t.yylloc,p>0&&p--);break;case 2:if(s=this.productions_[f[1]][1],l.$=o[o.length-s],l._$={first_line:i[i.length-(s||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(s||1)].first_column,last_column:i[i.length-1].last_column},ft&&(l._$.range=[i[i.length-(s||1)].range[0],i[i.length-1].range[1]]),ut=this.performAction.apply(l,[it,rt,y,c.yy,f[1],o,i].concat(ct)),typeof ut!="undefined")return ut;s&&(u=u.slice(0,-2*s),o=o.slice(0,-1*s),i=i.slice(0,-1*s));u.push(this.productions_[f[1]][0]);o.push(l.$);i.push(l._$);ot=h[u[u.length-2]][u[u.length-1]];u.push(ot);break;case 3:return!0}}return!0}},vt=function(){return{EOF:1,parseError:function(n,t){if(this.yy.parser)this.yy.parser.parseError(n,t);else throw new Error(n);},setInput:function(n,t){return this.yy=t||this.yy||{},this._input=n,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var n=this._input[0],t;return this.yytext+=n,this.yyleng++,this.offset++,this.match+=n,this.matched+=n,t=n.match(/(?:\r\n?|\n).*/g),t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),n},unput:function(n){var i=n.length,t=n.split(/(?:\r\n?|\n)/g),r,u;return this._input=n+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-i),this.offset-=i,r=this.match.split(/(?:\r\n?|\n)/g),this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),t.length-1&&(this.yylineno-=t.length-1),u=this.yylloc.range,this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:t?(t.length===r.length?this.yylloc.first_column:0)+r[r.length-t.length].length-t[0].length:this.yylloc.first_column-i},this.options.ranges&&(this.yylloc.range=[u[0],u[0]+this.yyleng-i]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var n=this.matched.substr(0,this.matched.length-this.match.length);return(n.length>20?"...":"")+n.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var n=this.match;return n.length<20&&(n+=this._input.substr(0,20-n.length)),(n.substr(0,20)+(n.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var n=this.pastInput(),t=new Array(n.length+1).join("-");return n+this.upcomingInput()+"\n"+t+"^"},test_match:function(n,t){var u,i,r,f;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=n[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+n[0].length},this.yytext+=n[0],this.match+=n[0],this.matches=n,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(n[0].length),this.matched+=n[0],u=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),u)return u;if(this._backtrack){for(f in r)this[f]=r[f];return!1}return!1},next:function(){var n,t,r,f,u,i;if(this.done)return this.EOF;for(this._input||(this.done=!0),this._more||(this.yytext="",this.match=""),u=this._currentRules(),i=0;i<u.length;i++)if(r=this._input.match(this.rules[u[i]]),r&&(!t||r[0].length>t[0].length))if(t=r,f=i,this.options.backtrack_lexer){if(n=this.test_match(r,u[i]),n!==!1)return n;if(this._backtrack){t=!1;continue}else return!1}else if(!this.options.flex)break;return t?(n=this.test_match(t,u[f]),n!==!1)?n:!1:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var n=this.next();return n?n:this.lex()},begin:function(n){this.conditionStack.push(n)},popState:function(){var n=this.conditionStack.length-1;return n>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(n){return n=this.conditionStack.length-1-Math.abs(n||0),n>=0?this.conditionStack[n]:"INITIAL"},pushState:function(n){this.begin(n)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(n,t,i,r){var u=r;switch(i){case 1:return 10;case 2:return 10;case 3:return 23;case 4:return 7;case 5:return 8;case 6:return 26;case 7:return 26;case 8:return 26;case 9:return 28;case 10:return 23;case 11:return 32;case 12:return 32;case 13:return 34;case 14:return 29;case 16:return 11;case 17:return" ";case 18:return 33;case 19:return 27;case 20:return 30;case 21:return 31;case 22:return 20;case 23:return 21;case 24:return 19;case 25:return 13;case 26:return 22;case 27:return 14;case 28:return 15;case 29:return 17;case 30:return 16;case 31:return 18;case 32:return'"';case 33:return"'";case 34:return"!";case 35:return 12;case 36:return 35;case 37:return 36;case 38:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],inclusive:!0}}}}();return ot.lexer=vt,st.prototype=ot,ot.Parser=st,new st}(),ruleJS=function(n){"use strict";var t=this,f=document.getElementById(n)||null,r={},o=function(n){var r=function(){},i,t;return r.prototype=Parser.lexer,i=function(){this.lexer=new r;this.yy={}},i.prototype=Parser,t=new i,t.setObj=function(n){t.yy.obj=n},t.yy.parseError=function(n,t){throw{name:"Parser error",message:n,prop:t};},t.yy.handler=n,t},i={errors:[{type:"NULL",output:"#NULL"},{type:"DIV_ZERO",output:"#DIV/0!"},{type:"VALUE",output:"#VALUE!"},{type:"REF",output:"#REF!"},{type:"NAME",output:"#NAME?"},{type:"NUM",output:"#NUM!"},{type:"NOT_AVAILABLE",output:"#N/A!"},{type:"ERROR",output:"#ERROR"},{type:"NEED_UPDATE",output:"#NEED_UPDATE"}],get:function(n){var t=i.errors.filter(function(t){return t.type===n||t.output===n})[0];return t?t.output:null}},s=function(){var n,i;this.data=[];n=["input[type=text]","[data-formula]"];i=function(){document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()};this.getItem=function(n){return t.matrix.data.filter(function(t){return t.id===n})[0]};this.removeItem=function(n){t.matrix.data=t.matrix.data.filter(function(t){return t.id!==n})};this.removeItemsInCol=function(n){t.matrix.data=t.matrix.data.filter(function(t){return t.col!==n})};this.removeItemsInRow=function(n){t.matrix.data=t.matrix.data.filter(function(t){return t.row!==n})};this.removeItemsBelowCol=function(n){t.matrix.data=t.matrix.data.filter(function(t){return t.col<n})};this.removeItemsBelowRow=function(n){t.matrix.data=t.matrix.data.filter(function(t){return t.row<n})};this.updateItem=function(n,i){if(t.utils.isString(n)&&(n=t.matrix.getItem(n)),n&&i)for(var r in i)n[r]&&t.utils.isArray(n[r])?t.utils.isArray(i[r])?i[r].forEach(function(t){n[r].indexOf(t)===-1&&n[r].push(t)}):n[r].indexOf(i[r])===-1&&n[r].push(i[r]):n[r]=i[r]};this.addItem=function(n){var i=n.id,u=t.utils.cellCoords(i),r;return n.row=u.row,n.col=u.col,r=t.matrix.data.filter(function(n){return n.id===i})[0],r?t.matrix.updateItem(r,n):t.matrix.data.push(n),t.matrix.getItem(i)};this.getRefItemsToColumn=function(n){var i=[];return t.matrix.data.length?(t.matrix.data.forEach(function(r){if(r.deps){var u=r.deps.filter(function(i){var r=t.utils.getCellAlphaNum(i).alpha,u=t.utils.toNum(r);return u>=n});u.length>0&&i.indexOf(r.id)===-1&&i.push(r.id)}}),i):i};this.getRefItemsToRow=function(n){var i=[];return t.matrix.data.length?(t.matrix.data.forEach(function(r){if(r.deps){var u=r.deps.filter(function(i){var r=t.utils.getCellAlphaNum(i).num;return r>n});u.length>0&&i.indexOf(r.id)===-1&&i.push(r.id)}}),i):i};this.updateElementItem=function(n,i){var r=n.getAttribute("id"),u=t.matrix.getItem(r);t.matrix.updateItem(u,i)};this.getDependencies=function(n){var u=function(n){var r=t.matrix.data.filter(function(t){if(t.deps)return t.deps.indexOf(n)>-1}),i=[];return r.forEach(function(n){i.indexOf(n.id)===-1&&i.push(n.id)}),i},i=[],r=function(n){var f=u(n);f.length&&f.forEach(function(n){if(i.indexOf(n)===-1){i.push(n);var u=t.matrix.getItem(n);u.deps.length&&r(n)}})};return r(n),i};this.getElementDependencies=function(n){return t.matrix.getDependencies(n.getAttribute("id"))};var o=function(n){var i=t.matrix.getElementDependencies(n),u=n.getAttribute("id");i.forEach(function(n){var i=t.matrix.getItem(n),u;i&&i.formula&&(u=document.getElementById(n),r(i.formula,u))})},r=function(n,i){var r=e(n,i),u=r.result,f=r.error,o=i.nodeName.toUpperCase();return t.matrix.updateElementItem(i,{value:u,error:f}),["INPUT"].indexOf(o)===-1&&(i.innerText=u||f),i.value=u||f,r},u=function(n){var u=n.getAttribute("id"),i=n.getAttribute("data-formula");i&&(t.matrix.addItem({id:u,formula:i}),r(i,n))},s=function(n){var r=n.getAttribute("id");n.addEventListener("dblclick",function(){var i=t.matrix.getItem(r);i&&i.formula&&(i.formulaEdit=!0,n.value="="+i.formula)});n.addEventListener("blur",function(){var i=t.matrix.getItem(r);i&&(i.formulaEdit&&(n.value=i.value||i.error),i.formulaEdit=!1)});n.addEventListener("keyup",function(n){switch(n.keyCode){case 13:case 27:i()}});n.addEventListener("change",function(){t.matrix.removeItem(r);var i=n.value;i[0]==="="&&(n.setAttribute("data-formula",i.substr(1)),u(n));o(n)})};this.depsInFormula=function(n){var i=n.formula,t=n.deps;return t?(t=t.filter(function(n){return i.indexOf(n)!==-1}),t.length>0):!1};this.scan=function(){var t=f.querySelectorAll(n);[].slice.call(t).forEach(function(n){u(n);s(n)})}},h={isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},isNumber:function(n){return Object.prototype.toString.call(n)==="[object Number]"},isString:function(n){return Object.prototype.toString.call(n)==="[object String]"},isFunction:function(n){return Object.prototype.toString.call(n)==="[object Function]"},isUndefined:function(n){return Object.prototype.toString.call(n)==="[object Undefined]"},isNull:function(n){return Object.prototype.toString.call(n)==="[object Null]"},isSet:function(n){return!t.utils.isUndefined(n)&&!t.utils.isNull(n)},isCell:function(n){return n.match(/^[A-Za-z]+[0-9]+/)?!0:!1},getCellAlphaNum:function(n){var t=n.match(/\d+$/),i=n.replace(t,"");return{alpha:i,num:parseInt(t[0],10)}},changeRowIndex:function(n,i){var u=t.utils.getCellAlphaNum(n),f=u.alpha,e=f,r=parseInt(u.num+i,10);return r<1&&(r=1),e+""+r},changeColIndex:function(n,i){var e=t.utils.getCellAlphaNum(n),u=e.alpha,r=t.utils.toChar(parseInt(t.utils.toNum(u)+i,10)),f=e.num,o,s;return r&&r.length!==0||(r="A"),o=u[0]==="$"||!1,s=u[u.length-1]==="$"||!1,r=(o?"$":"")+r,f=(s?"$":"")+f,r+""+f},changeFormula:function(n,i,r){return i||(i=1),n.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(n){var f=t.utils.getCellAlphaNum(n),e=f.alpha,u=f.num;return t.utils.isNumber(r.col)&&(u=t.utils.toNum(e),r.col<=u)?t.utils.changeColIndex(n,i):t.utils.isNumber(r.row)&&r.row<u?t.utils.changeRowIndex(n,i):n})},updateFormula:function(n,i,r){var u,f;return(["left","right"].indexOf(i)!==-1?u="col":["up","down"].indexOf(i)!==-1&&(u="row"),["down","right"].indexOf(i)!==-1?f=r*1:["up","left"].indexOf(i)!==-1&&(f=r*-1),u&&f)?n.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(n){var i=t.utils.getCellAlphaNum(n).alpha,r=i[0]==="$"||!1,e=i[i.length-1]==="$"||!1;return u==="row"&&e?n:u==="col"&&r?n:u==="row"?t.utils.changeRowIndex(n,f):t.utils.changeColIndex(n,f)}):n},toNum:function(n){n=t.utils.clearFormula(n);for(var f="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0,i=0,u=n.length-1;i<n.length;i+=1,u-=1)r+=Math.pow(f.length,u)*(f.indexOf(n[i])+1);return r&&--r,r},toChar:function(n){for(var t="";n>=0;)t=String.fromCharCode(n%26+97)+t,n=Math.floor(n/26)-1;return t.toUpperCase()},cellCoords:function(n){var i=n.match(/\d+$/),r=n.replace(i,"");return{row:parseInt(i[0],10)-1,col:t.utils.toNum(r)}},clearFormula:function(n){return n.replace(/\$/g,"")},translateCellCoords:function(n){return t.utils.toChar(n.col)+""+parseInt(n.row+1,10)},iterateCells:function(n,i,r){var u={index:[],value:[]},s={start:0,end:0},f,e,o,h,c;for(s=i.col>=n.col?{start:n.col,end:i.col}:{start:i.col,end:n.col},f={start:0,end:0},f=i.row>=n.row?{start:n.row,end:i.row}:{start:i.row,end:n.row},e=s.start;e<=s.end;e++)for(o=f.start;o<=f.end;o++)h=t.utils.toChar(e)+(o+1),c=t.helper.cellValue.call(this,h),u.index.push(h),u.value.push(c);return t.utils.isFunction(r)?r.apply(r,[u]):u},sort:function(n){return function(t,i){return(t<i?-1:t>i?1:0)*(n?-1:1)}}},u={SUPPORTED_FORMULAS:["ABS","ACCRINT","ACOS","ACOSH","ACOTH","AND","ARABIC","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOMDIST","BINOMDISTRANGE","BINOMINV","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQDIST","CHISQINV","CODE","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCENORM","CONFIDENCET","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCEP","COVARIANCES","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","ERF","ERFC","EVEN","EXACT","EXPONDIST","FALSE","FDIST","FINV","FISHER","FISHERINV","IF","INT","ISEVEN","ISODD","LN","LOG","LOG10","MAX","MAXA","MEDIAN","MIN","MINA","MOD","NOT","ODD","OR","PI","POWER","ROUND","ROUNDDOWN","ROUNDUP","SIN","SINH","SPLIT","SQRT","SQRTPI","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","TAN","TANH","TRUE","TRUNC","XOR"],number:function(n){switch(typeof n){case"number":return n;case"string":if(!isNaN(n))return n.indexOf(".")>-1?parseFloat(n):parseInt(n,10)}return n},string:function(n){return n.substring(1,n.length-1)},numberInverted:function(n){return this.number(n)*-1},specialMatch:function(n,t,i){var r;switch(n){case"&":r=t.toString()+i.toString()}return r},logicMatch:function(n,t,i){var r;switch(n){case"=":r=t===i;break;case">":r=t>i;break;case"<":r=t<i;break;case">=":r=t>=i;break;case"<=":r=t===i;break;case"<>":r=t!=i;break;case"NOT":r=t!=i}return r},mathMatch:function(n,t,i){var r;if(t=u.number(t),i=u.number(i),isNaN(t)||isNaN(i)){if(t[0]==="="||i[0]==="=")throw Error("NEED_UPDATE");throw Error("VALUE");}switch(n){case"+":r=t+i;break;case"-":r=t-i;break;case"/":if(r=t/i,r==Infinity)throw Error("DIV_ZERO");else if(isNaN(r))throw Error("VALUE");break;case"*":r=t*i;break;case"^":r=Math.pow(t,i)}return r},callFunction:function(n,i){if(n=n.toUpperCase(),i=i||[],t.helper.SUPPORTED_FORMULAS.indexOf(n)>-1&&t.formulas[n])return t.formulas[n].apply(this,i);throw Error("NAME");},callVariable:function(n){n=n||[];var i=n[0];if(i&&(i=i.toUpperCase(),t.formulas[i]))return typeof t.formulas[i]=="function"?t.formulas[i].apply(this,n):t.formulas[i];throw Error("NAME");},cellValue:function(n){var r,s=t.custom.cellValue,f=this,i=t.matrix.getItem(n),e,u,o;if(t.utils.isFunction(s)?(e=t.utils.cellCoords(n),u=t.utils.translateCellCoords({row:f.row,col:f.col}),r=i?i.value:s(e.row,e.col),t.utils.isNull(r)&&(r=0),u&&t.matrix.updateItem(u,{deps:[n]})):(r=i?i.value:document.getElementById(n).value,t.matrix.updateElementItem(f,{deps:[n]})),i&&i.deps&&i.deps.indexOf(u)!==-1)throw Error("REF");if(i&&i.error)throw Error(i.error);if(t.utils.isSet(r))return o=t.helper.number(r),isNaN(o)?r:o;throw Error("NOT_AVAILABLE");},cellRangeValue:function(n,i){var o=t.custom.cellValue,s=t.utils.cellCoords(n),h=t.utils.cellCoords(i),r=this,u=t.utils.iterateCells.call(this,s,h),f=[],e;return t.utils.isFunction(o)?(e=t.utils.translateCellCoords({row:r.row,col:r.col}),t.matrix.updateItem(e,{deps:u.index})):t.matrix.updateElementItem(r,{deps:u.index}),f.push(u.value),f},fixedCellValue:function(n){return n=n.replace(/\$/g,""),t.helper.cellValue.call(this,n)},fixedCellRangeValue:function(n,i){return n=n.replace(/\$/g,""),i=i.replace(/\$/g,""),t.helper.cellRangeValue.call(this,n,i)}},e=function(n,u){var e=null,o=null,f,s,h;try{if(r.setObj(u),e=r.parse(n),u instanceof HTMLElement?f=u.getAttribute("id"):u&&u.id&&(f=u.id),s=t.matrix.getDependencies(f),s.indexOf(f)!==-1){e=null;s.forEach(function(n){t.matrix.updateItem(n,{value:null,error:i.get("REF")})});throw Error("REF");}}catch(c){h=i.get(c.message);o=h?h:i.get("ERROR")}return{error:o,result:e}},c=function(){t=this;r=new o(t);t.formulas=Formula;t.matrix=new s;t.custom={};f&&t.matrix.scan()};return{init:c,version:"0.0.3",utils:h,helper:u,parse:e}};