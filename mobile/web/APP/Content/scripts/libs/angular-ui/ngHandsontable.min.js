document.all&&!document.addEventListener&&(document.createElement("hot-table"),document.createElement("hot-column"),document.createElement("hot-autocomplete"));angular.module("ngHandsontable",["ngHandsontable.services","ngHandsontable.directives"]);angular.module("ngHandsontable.services",[]).factory("settingFactory",[function(){return{containerClassName:"handsontable-container",initializeHandsontable:function(n,t){var i=document.createElement("DIV");return i.className=this.containerClassName,n[0].appendChild(i),new Handsontable(i,t)},updateHandsontableSettings:function(n,t){n&&n.updateSettings(t)},renderHandsontable:function(n){n&&n.render()},setHandsontableSettingsFromScope:function(n,t){var i,u={},r=angular.extend({},t);angular.extend(r,t.settings);for(i in n)n.hasOwnProperty(i)&&typeof r[n[i]]!="undefined"&&(u[n[i]]=r[n[i]]);return u},getScopeDefinition:function(n){for(var i={datarows:"=",settings:"="},t=0,r=n.length;t<r;t++)i[n[t]]="="+n[t].toLowerCase();return i}}}]).factory("autoCompleteFactory",[function(){return{parseAutoComplete:function(n,t,i,r){t.source=function(u,f){var y=n.getSelected()[0],s=[],l=i[y],e,c,o,a,h,v;if(l&&(e=t.optionList,e.object)){if(angular.isArray(e.object))s=e.object;else{for(c=e.object.split("."),o=l;c.length>0;)a=c.shift(),o=o[a];if(r)for(h=0,v=o.length;h<v;h++)s.push(o[h][e.property]);else s=o}f(s)}}}}}]);angular.module("ngHandsontable.directives",[]).directive("hotTable",["settingFactory","autoCompleteFactory","$rootScope","$parse",function(n,t,i,r){var f=Object.keys(Handsontable.DefaultSettings.prototype),e=Object.keys(Handsontable.PluginHooks.hooks),u=f.concat(e);return{restrict:"EA",scope:n.getScopeDefinition(u),controller:["$scope",function(n){this.setColumnSetting=function(t){n.htSettings||(n.htSettings={});n.htSettings.columns||(n.htSettings.columns=[]);n.htSettings.columns.push(t)}}],link:function(f,e,o){var s,a,h,c,l;if(f.htSettings||(f.htSettings={}),f.htSettings.data=f.datarows,angular.extend(f.htSettings,n.setHandsontableSettingsFromScope(u,f)),f.hotInstance=n.initializeHandsontable(e,f.htSettings),f.htSettings.columns){for(s=0,a=f.htSettings.columns.length;s<a;s++)f.htSettings.columns[s].type=="autocomplete"&&(typeof f.htSettings.columns[s].optionList=="string"&&(h={},c=f.htSettings.columns[s].optionList.match(/^\s*(.+)\s+in\s+(.*)\s*$/),c?(h.property=c[1],h.object=c[2]):h.object=h,f.htSettings.columns[s].optionList=h),t.parseAutoComplete(f.hotInstance,f.htSettings.columns[s],f.datarows,!0));f.hotInstance.updateSettings(f.htSettings)}f.htSettings.afterChange=function(){i.$$phase||f.$apply()};l=o.columns;f.$parent.$watch(function(){var n=f.$parent;if(l)return angular.toJson(r(l)(n))},function(){angular.extend(f.htSettings,n.setHandsontableSettingsFromScope(u,f.$parent));n.updateHandsontableSettings(f.hotInstance,f.htSettings)});f.$parent.$watch(function(){var n=f.$parent;return angular.toJson(r(o.datarows)(n))},function(){n.renderHandsontable(f.hotInstance)});f.$watch("datarows",function(t,i){i.length==f.htSettings.minSpareRows&&t.length!=f.htSettings.minSpareRows&&(f.htSettings.data=f.datarows,n.updateHandsontableSettings(f.hotInstance,f.htSettings))})}}}]).directive("hotColumn",[function(){return{restrict:"E",require:"^hotTable",scope:{},controller:["$scope",function(n){this.setColumnOptionList=function(t){n.column||(n.column={});var i={},r=t.match(/^\s*(.+)\s+in\s+(.*)\s*$/);r?(i.property=r[1],i.object=r[2]):i.object=t.split(",");n.column.optionList=i}}],link:function(n,t,i,r){var u={};for(var f in i)i.hasOwnProperty(f)&&f.charAt(0)!=="$"&&typeof u[f]=="undefined"&&(f==="data"?u.data=i[f]:u[f]=n.$eval(i[f]));switch(u.type){case"checkbox":typeof i.checkedtemplate!="undefined"&&(u.checkedTemplate=n.$eval(i.checkedtemplate));typeof i.uncheckedtemplate!="undefined"&&(u.uncheckedTemplate=n.$eval(i.uncheckedtemplate))}typeof i.readonly!="undefined"&&(u.readOnly=!0);n.column||(n.column={});angular.extend(n.column,u);r.setColumnSetting(n.column)}}}]).directive("hotAutocomplete",[function(){return{restrict:"E",scope:!0,require:"^hotColumn",link:function(n,t,i,r){var u=i.datarows;r.setColumnOptionList(u)}}}]);