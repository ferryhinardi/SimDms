/*!
   angular-markdown-text v0.0.1
   (c) 2014 (null) McNull https://github.com/McNull/angular-markdown-text
   License: MIT
*/
(function(n,t){var i=n.module("markdown",[]);i.constant("markdownConfig",{outline:!0,escapeHtml:!1,sanitize:!0,showdown:{extensions:[]}});i.directive("markdown",["markdown","markdownConfig","$http","$templateCache",function(t,i,r,u){function f(n,t,i){return n[t]?n[t]=="true":i}return{restrict:"AE",terminal:!0,compile:function(e,o){var s=n.copy(i),h,c;return s.escapeHtml=f(o,"markdownEscapeHtml",s.escapeHtml),s.outline=f(o,"markdownOutline",s.outline),s.sanitize=f(o,"markdownSanitize",s.sanitize),h=o.markdown||o.markdownModel,c=o.markdownSrc,{pre:function(n,t){t.data("markdown",!0)},post:function(n,i){var f,e;i.parent().inheritedData("markdown")||(c?(f=0,n.$watch(c,function(n){var e=++f;n?r.get(n,{cache:u}).success(function(n){if(e==f){var r=n?t.makeHtml(n,s):"";r!=undefined&&i.html(r)}}).error(function(){e==f&&i.html("")}):i.html("")})):h?n.$watch(h,function(n){var r=n?t.makeHtml(n,s):"";r!=undefined&&i.html(r)}):(e=t.makeHtml(i.html(),s),e!=undefined&&i.html(e)))}}}}}]);i.factory("markdown",["markdownConfig","$injector",function(n,i){function f(){return r=r||new t.converter(n.showdown)}function s(t,i){i=i||n;i.outline&&(t=o(t));i.escapeHtml&&(t=e(t));var r=f().makeHtml(t);if(i.sanitize){if(!u)throw new Error("Missing dependency angular-sanitize.");try{r=u(r)}catch(s){console.log(s);r=undefined}}return r}function e(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(n){var t,i,r;return n&&(n=n.replace(/^\s*\n/,""),t=n.match(/^[ \t]+/),t&&t.length&&(i="^[ \t]{"+t[0].length+"}",r=new RegExp(i,"gm"),n=n.replace(r,""))),n}var r,u;return i.has("$sanitize")&&(u=i.get("$sanitize")),{_converter:f,makeHtml:s,outline:o,escapeHtml:e}}])})(angular,Showdown);