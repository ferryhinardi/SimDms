/*!
(The MIT License)
Copyright (c) 2012-2014 Marcin Warpechowski
Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>
Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
'Software'), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
window.Handsontable={version:"0.20.2",buildDate:"Fri Des 11 2015 17:18:34 GMT+0700 (WIB)"},function(n){if(typeof exports=="object"&&typeof module!="undefined")module.exports=n();else if(typeof define=="function"&&define.amd)define([],n);else{var t;t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this;t.Handsontable=n()}}(function(){return function(n,t,i){return function r(n,t,i){function f(e,s){var c,l,h;if(!t[e]){if(!n[e]){if(c=typeof require=="function"&&require,!s&&c)return c(e,!0);if(o)return o(e,!0);if(u[e]&&typeof window[u[e]]!="undefined")return window[u[e]];l=new Error("Cannot find module '"+e+"'");l.code="MODULE_NOT_FOUND";throw l;}h=t[e]={exports:{}};n[e][0].call(h.exports,function(t){var i=n[e][1][t];return f(i?i:t)},h,h.exports,r,n,t,i)}return t[e].exports}for(var o=typeof require=="function"&&require,u=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","pikaday":"Pikaday"}')||{},e=0;e<i.length;e++)f(i[e]);return f}(n,t,i),function(){return Handsontable}}({1:[function(){"use strict";window.jQuery&&function(n,t,i){t.fn.handsontable=function(n){var u,o,f,s,e,r=this.first(),t=r.data("handsontable");if(typeof n!="string")return e=n||{},t?t.updateSettings(e):(t=new i.Core(r[0],e),r.data("handsontable",t),t.init()),r;if(f=[],arguments.length>1)for(u=1,o=arguments.length;u<o;u++)f.push(arguments[u]);if(t)if(typeof t[n]!="undefined")s=t[n].apply(t,f),n==="destroy"&&r.removeData();else throw new Error("Handsontable do not provide action: "+n);return s}}(window,jQuery,Handsontable)},{}],2:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableBorder:{get:function(){return l}},__esModule:{value:!0}});var f,e,o,s,h,u=(f=n("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}),p=u.getComputedStyle,w=u.getTrimmingContainer,b=u.innerWidth,k=u.innerHeight,c=u.offset,a=u.outerHeight,v=u.outerWidth,d=(e=n("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}).stopImmediatePropagation,g=(o=n("eventManager"),o&&o.__esModule&&o||{"default":o}).EventManager,y=(s=n("cell/coords"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords,r=(h=n("overlay/_base.js"),h&&h.__esModule&&h||{"default":h}).WalkontableOverlay,l=function(n,t){t&&(this.eventManager=new g(n),this.instance=n,this.wot=n,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())};$traceurRuntime.createClass(l,{registerListeners:function(){var n=this,i,u,t,r;for(this.eventManager.addEventListener(document.body,"mousedown",function(){return n.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return n.onMouseUp()}),i=this,u=function(t){i.eventManager.addEventListener(i.main.childNodes[t],"mouseenter",function(i){return n.onMouseEnter(i,n.main.childNodes[t])})},t=0,r=this.main.childNodes.length;t<r;t++)u(t,r)},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDown=!1},onMouseEnter:function(n,t){function f(n){return n.clientY<Math.floor(i.top)?!0:n.clientY>Math.ceil(i.top+i.height)?!0:n.clientX<Math.floor(i.left)?!0:n.clientX>Math.ceil(i.left+i.width)?!0:void 0}function r(n){f(n)&&(u.eventManager.removeEventListener(document.body,"mousemove",r),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){n.preventDefault();d(n);var u=this,i=t.getBoundingClientRect();t.style.display="none";this.eventManager.addEventListener(document.body,"mousemove",r)}},createBorders:function(n){var f,i,u,t,r;for(this.main=document.createElement("div"),f=["top","left","bottom","right","corner"],i=this.main.style,i.position="absolute",i.top=0,i.left=0,u=0;u<5;u++)t=f[u],r=document.createElement("div"),r.className="wtBorder "+(this.settings.className||""),this.settings[t]&&this.settings[t].hide&&(r.className+=" hidden"),i=r.style,i.backgroundColor=this.settings[t]&&this.settings[t].color?this.settings[t].color:n.border.color,i.height=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",i.width=this.settings[t]&&this.settings[t].width?this.settings[t].width+"px":n.border.width+"px",this.main.appendChild(r);this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width=this.cornerDefaultStyle.width;this.cornerStyle.height=this.cornerDefaultStyle.height;this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" ");Handsontable.mobileBrowser&&this.createMultipleSelectorHandles();this.disappear();this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder));this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function(){var u,f,i,n,r,t;this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};u=10;f=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle";this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea";this.selectionHandles.bottomRight.className="bottomRightSelectionHandle";this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea";this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};i={position:"absolute",height:f+"px",width:f+"px","border-radius":parseInt(f/1.5,10)+"px"};for(n in i)i.hasOwnProperty(n)&&(this.selectionHandles.styles.bottomRightHitArea[n]=i[n],this.selectionHandles.styles.topLeftHitArea[n]=i[n]);r={position:"absolute",height:u+"px",width:u+"px","border-radius":parseInt(u/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(t in r)r.hasOwnProperty(t)&&(this.selectionHandles.styles.bottomRight[t]=r[t],this.selectionHandles.styles.topLeft[t]=r[t]);this.main.appendChild(this.selectionHandles.topLeft);this.main.appendChild(this.selectionHandles.bottomRight);this.main.appendChild(this.selectionHandles.topLeftHitArea);this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function(n,t){return this.wot.selections.area.cellRange&&(n!=this.wot.selections.area.cellRange.to.row||t!=this.wot.selections.area.cellRange.to.col)?!0:!1},updateMultipleSelectionHandlesPosition:function(n,t,i,r,u,f){var o=parseInt(this.selectionHandles.styles.topLeft.width,10),e=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(i-o,10)+"px";this.selectionHandles.styles.topLeft.left=parseInt(r-o,10)+"px";this.selectionHandles.styles.topLeftHitArea.top=parseInt(i-e/4*3,10)+"px";this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-e/4*3,10)+"px";this.selectionHandles.styles.bottomRight.top=parseInt(i+f,10)+"px";this.selectionHandles.styles.bottomRight.left=parseInt(r+u,10)+"px";this.selectionHandles.styles.bottomRightHitArea.top=parseInt(i+f-e/4,10)+"px";this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+u-e/4,10)+"px";this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(n,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none");n==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},appear:function(n){var ct,g,e,nt,lt,at,u,vt,f,yt,t,i,s,h,l,d,pt,tt,o,it,rt,ut,ft,et,ot,st,ht,wt,bt;if(!this.disabled){for(o=r.isOverlayTypeOf(this.wot.cloneOverlay,r.CLONE_TOP)||r.isOverlayTypeOf(this.wot.cloneOverlay,r.CLONE_TOP_LEFT_CORNER)?this.wot.getSetting("fixedRowsTop"):r.isOverlayTypeOf(this.wot.cloneOverlay,r.CLONE_BOTTOM)||r.isOverlayTypeOf(this.wot.cloneOverlay,r.CLONE_BOTTOM_LEFT_CORNER)?this.wot.getSetting("fixedRowsBottom"):this.wot.wtTable.getRenderedRowsCount(),it=0;it<o;it++)if(rt=this.wot.wtTable.rowFilter.renderedToSource(it),rt>=n[0]&&rt<=n[2]){s=rt;break}for(ut=o-1;ut>=0;ut--)if(ft=this.wot.wtTable.rowFilter.renderedToSource(ut),ft>=n[0]&&ft<=n[2]){l=ft;break}for(o=this.wot.wtTable.getRenderedColumnsCount(),et=0;et<o;et++)if(ot=this.wot.wtTable.columnFilter.renderedToSource(et),ot>=n[1]&&ot<=n[3]){h=ot;break}for(st=o-1;st>=0;st--)if(ht=this.wot.wtTable.columnFilter.renderedToSource(st),ht>=n[1]&&ht<=n[3]){d=ht;break}if(s===void 0||h===void 0){this.disappear();return}ct=s!==l||h!==d;g=this.wot.wtTable.getCell(new y(s,h));e=ct?this.wot.wtTable.getCell(new y(l,d)):g;nt=c(g);lt=ct?c(e):nt;at=c(this.wot.wtTable.TABLE);vt=nt.top;t=lt.top+a(e)-vt;yt=nt.left;i=lt.left+v(e)-yt;u=vt-at.top-1;f=yt-at.left-1;wt=p(g);parseInt(wt.borderTopWidth,10)>0&&(u+=1,t=t>0?t-1:0);parseInt(wt.borderLeftWidth,10)>0&&(f+=1,i=i>0?i-1:0);this.topStyle.top=u+"px";this.topStyle.left=f+"px";this.topStyle.width=i+"px";this.topStyle.display="block";this.leftStyle.top=u+"px";this.leftStyle.left=f+"px";this.leftStyle.height=t+"px";this.leftStyle.display="block";bt=Math.floor(this.settings.border.width/2);this.bottomStyle.top=u+t-bt+"px";this.bottomStyle.left=f+"px";this.bottomStyle.width=i+"px";this.bottomStyle.display="block";this.rightStyle.top=u+"px";this.rightStyle.left=f+i-bt+"px";this.rightStyle.height=t+1+"px";this.rightStyle.display="block";Handsontable.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(l,d)?this.cornerStyle.display="none":(this.cornerStyle.top=u+t-4+"px",this.cornerStyle.left=f+i-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",pt=w(this.wot.wtTable.TABLE),d===this.wot.getSetting("totalColumns")-1&&(tt=e.offsetLeft+v(e)>=b(pt),tt&&(this.cornerStyle.left=Math.floor(f+i-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)),l===this.wot.getSetting("totalRows")-1&&(tt=e.offsetTop+a(e)>=k(pt),tt&&(this.cornerStyle.top=Math.floor(u+t-3-parseInt(this.cornerDefaultStyle.height)/2)+"px",this.cornerStyle.borderBottomWidth=0)));Handsontable.mobileBrowser&&this.updateMultipleSelectionHandlesPosition(s,h,u,f,i,t)}},disappear:function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none";Handsontable.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},hasSetting:function(n){return typeof n=="function"?n():!!n}},{});window.WalkontableBorder=l},{"cell/coords":5,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,"overlay/_base.js":11}],3:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewportColumnsCalculator:{get:function(){return u}},__esModule:{value:!0}});var r=new WeakMap,u=function(n,t,i,u,f,e,o){r.set(this,{viewportWidth:n,scrollOffset:t,totalColumns:i,columnWidthFn:u,overrideFn:f,onlyFullyVisible:e});this.count=0;this.startColumn=null;this.endColumn=null;this.startPosition=null;this.stretchAllRatio=0;this.stretchLastWidth=0;this.stretch=o;this.totalTargetWidth=0;this.needVerifyLastColumnWidth=!0;this.stretchAllColumnsWidth=[];this.calculate()},f=u;$traceurRuntime.createClass(u,{calculate:function(){for(var h,t=0,c=!0,u=[],f,i=r.get(this),s=i.onlyFullyVisible,l=i.overrideFn,e=i.scrollOffset,a=i.totalColumns,o=i.viewportWidth,n=0;n<a;n++)if(f=this._getColumnWidth(n),t<=e&&!s&&(this.startColumn=n),t>=e&&t+f<=e+o&&(this.startColumn==null&&(this.startColumn=n),this.endColumn=n),u.push(t),t+=f,s||(this.endColumn=n),t>=e+o){c=!1;break}if(this.endColumn===a-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;)if(h=u[this.endColumn]+f-u[this.startColumn-1],(h<=o||!s)&&this.startColumn--,h>o)break;this.startColumn!==null&&l&&l(this);this.startPosition=u[this.startColumn];this.startPosition==void 0&&(this.startPosition=null);this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(n){var t;if(this.stretch!=="none"){var i=0,f,u,o=r.get(this),e=o.totalColumns;for(t=0;t<e;t++)f=this._getColumnWidth(t),i+=f;this.totalTargetWidth=n;u=i-n;this.stretch==="all"&&u<0?(this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):this.stretch==="last"&&n!==Infinity&&(this.stretchLastWidth=-u+this._getColumnWidth(e-1))}},getStretchedColumnWidth:function(n,t){var i=null;return this.stretch==="all"&&this.stretchAllRatio!==0?i=this._getStretchedAllColumnWidth(n,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(i=this._getStretchedLastColumnWidth(n)),i},_getStretchedAllColumnWidth:function(n,t){var u=0,f=r.get(this),e=f.totalColumns,i;if(this.stretchAllColumnsWidth[n]||(this.stretchAllColumnsWidth[n]=Math.round(t*this.stretchAllRatio)),this.stretchAllColumnsWidth.length===e&&this.needVerifyLastColumnWidth){for(this.needVerifyLastColumnWidth=!1,i=0;i<this.stretchAllColumnsWidth.length;i++)u+=this.stretchAllColumnsWidth[i];u!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-u)}return this.stretchAllColumnsWidth[n]},_getStretchedLastColumnWidth:function(n){var t=r.get(this),i=t.totalColumns;return n===i-1?this.stretchLastWidth:null},_getColumnWidth:function(n){var t=r.get(this).columnWidthFn(n);return t===undefined&&(t=f.DEFAULT_WIDTH),t}},{get DEFAULT_WIDTH(){return 50}});window.WalkontableViewportColumnsCalculator=u},{}],4:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewportRowsCalculator:{get:function(){return r}},__esModule:{value:!0}});var u=new WeakMap,r=function(n,t,i,r,f,e,o){u.set(this,{viewportHeight:n,scrollOffset:t,totalRows:i,rowHeightFn:r,overrideFn:f,onlyFullyVisible:e,horizontalScrollbarHeight:o});this.count=0;this.startRow=null;this.endRow=null;this.startPosition=null;this.calculate()},f=r;$traceurRuntime.createClass(r,{calculate:function(){for(var r,l,i=0,a=!0,e=[],n=u.get(this),c=n.onlyFullyVisible,v=n.overrideFn,p=n.rowHeightFn,o=n.scrollOffset,y=n.totalRows,s=n.viewportHeight,h=n.horizontalScrollbarHeight||0,t=0;t<y;t++)if(r=p(t),r===undefined&&(r=f.DEFAULT_HEIGHT),i<=o&&!c&&(this.startRow=t),i>=o&&i+r<=o+s-h&&(this.startRow===null&&(this.startRow=t),this.endRow=t),e.push(i),i+=r,c||(this.endRow=t),i>=o+s-h){a=!1;break}if(this.endRow===y-1&&a)for(this.startRow=this.endRow;this.startRow>0;)if(l=e[this.endRow]+r-e[this.startRow-1],(l<=s-h||!c)&&this.startRow--,l>=s-h)break;this.startRow!==null&&v&&v(this);this.startPosition=e[this.startRow];this.startPosition==void 0&&(this.startPosition=null);this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}});window.WalkontableViewportRowsCalculator=r},{}],5:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableCellCoords:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t){typeof n!="undefined"&&typeof t!="undefined"?(this.row=n,this.col=t):(this.row=null,this.col=null)};$traceurRuntime.createClass(r,{isValid:function(n){return this.row<0||this.col<0?!1:this.row>=n.getSetting("totalRows")||this.col>=n.getSetting("totalColumns")?!1:!0},isEqual:function(n){return n===this?!0:this.row===n.row&&this.col===n.col},isSouthEastOf:function(n){return this.row>=n.row&&this.col>=n.col},isNorthWestOf:function(n){return this.row<=n.row&&this.col<=n.col},isSouthWestOf:function(n){return this.row>=n.row&&this.col<=n.col},isNorthEastOf:function(n){return this.row<=n.row&&this.col>=n.col}},{});window.WalkontableCellCoords=r},{}],6:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableCellRange:{get:function(){return f}},__esModule:{value:!0}});var u,r=(u=n("cell/coords"),u&&u.__esModule&&u||{"default":u}).WalkontableCellCoords,f=function(n,t,i){this.highlight=n;this.from=t;this.to=i},e=f;$traceurRuntime.createClass(f,{isValid:function(n){return this.from.isValid(n)&&this.to.isValid(n)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<0&&(n.row=0),n.col<0&&(n.col=0),t.row<=n.row&&i.row>=n.row&&t.col<=n.col&&i.col>=n.col},includesRange:function(n){return this.includes(n.getTopLeftCorner())&&this.includes(n.getBottomRightCorner())},isEqual:function(n){return Math.min(this.from.row,this.to.row)==Math.min(n.from.row,n.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(n.from.row,n.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(n.from.col,n.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(n.from.col,n.to.col)},overlaps:function(n){return n.isSouthEastOf(this.getTopLeftCorner())&&n.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(n){return this.getTopLeftCorner().isSouthEastOf(n)||this.getBottomRightCorner().isSouthEastOf(n)},isNorthWestOf:function(n){return this.getTopLeftCorner().isNorthWestOf(n)||this.getBottomRightCorner().isNorthWestOf(n)},expand:function(n){var t=this.getTopLeftCorner(),i=this.getBottomRightCorner();return n.row<t.row||n.col<t.col||n.row>i.row||n.col>i.col?(this.from=new r(Math.min(t.row,n.row),Math.min(t.col,n.col)),this.to=new r(Math.max(i.row,n.row),Math.max(i.col,n.col)),!0):!1},expandByRange:function(n){if(this.includesRange(n)||!this.overlaps(n))return!1;var u=this.getTopLeftCorner(),f=this.getBottomRightCorner(),p=this.getTopRightCorner(),w=this.getBottomLeftCorner(),o=n.getTopLeftCorner(),s=n.getBottomRightCorner(),h=Math.min(u.row,o.row),c=Math.min(u.col,o.col),l=Math.max(f.row,s.row),a=Math.max(f.col,s.col),t=new r(h,c),i=new r(l,a),v=new e(t,t,i).isCorner(this.from,n),y=n.isEqual(new e(t,t,i));return v&&!y&&(this.from.col>t.col&&(t.col=a,i.col=c),this.from.row>t.row&&(t.row=l,i.row=h)),this.from=t,this.to=i,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(n){switch(n){case"NW-SE":this.from=this.getTopLeftCorner();this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner();this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner();this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner();this.to=this.getTopRightCorner()}},getTopLeftCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new r(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new r(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(n,t){return t&&t.includes(n)&&(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))?!0:n.isEqual(this.getTopLeftCorner())||n.isEqual(this.getTopRightCorner())||n.isEqual(this.getBottomLeftCorner())||n.isEqual(this.getBottomRightCorner())},getOppositeCorner:function(n,t){if(!(n instanceof r))return!1;if(t&&t.includes(n)){if(this.getTopLeftCorner().isEqual(new r(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new r(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new r(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new r(t.to.row,t.to.col)))return this.getTopLeftCorner()}return n.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():n.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():n.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():n.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(n){if(!this.includesRange(n))return[];var i={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(n.from.row,n.to.row),bottom:Math.max(n.from.row,n.to.row),left:Math.min(n.from.col,n.to.col),right:Math.max(n.from.col,n.to.col)},t=[];return i.top==r.top&&t.push("top"),i.right==r.right&&t.push("right"),i.bottom==r.bottom&&t.push("bottom"),i.left==r.left&&t.push("left"),t},getInner:function(){for(var n,i=this.getTopLeftCorner(),u=this.getBottomRightCorner(),f=[],t=i.row;t<=u.row;t++)for(n=i.col;n<=u.col;n++)this.from.row===t&&this.from.col===n||this.to.row===t&&this.to.col===n||f.push(new r(t,n));return f},getAll:function(){for(var n,t=this.getTopLeftCorner(),i=this.getBottomRightCorner(),f=[],u=t.row;u<=i.row;u++)for(n=t.col;n<=i.col;n++)t.row===u&&t.col===n?f.push(t):i.row===u&&i.col===n?f.push(i):f.push(new r(u,n));return f},forAll:function(n){for(var t,f,r=this.getTopLeftCorner(),u=this.getBottomRightCorner(),i=r.row;i<=u.row;i++)for(t=r.col;t<=u.col;t++)if(f=n(i,t),f===!1)return}},{});window.WalkontableCellRange=f},{"cell/coords":5}],7:[function(n,t,i){"use strict";Object.defineProperties(i,{Walkontable:{get:function(){return k}},__esModule:{value:!0}});var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),rt=b.addClass,ut=b.fastInnerText,ft=b.isVisible,et=b.removeClass,ot=(u=n("helpers/object"),u&&u.__esModule&&u||{"default":u}).objectEach,d=(f=n("helpers/string"),f&&f.__esModule&&f||{"default":f}),g=d.toUpperCaseFirst,st=d.randomString,nt=(e=n("event"),e&&e.__esModule&&e||{"default":e}).WalkontableEvent,ht=(o=n("overlays"),o&&o.__esModule&&o||{"default":o}).WalkontableOverlays,tt=(s=n("scroll"),s&&s.__esModule&&s||{"default":s}).WalkontableScroll,ct=(h=n("settings"),h&&h.__esModule&&h||{"default":h}).WalkontableSettings,it=(c=n("table"),c&&c.__esModule&&c||{"default":c}).WalkontableTable,lt=(l=n("viewport"),l&&l.__esModule&&l||{"default":l}).WalkontableViewport,at=(a=n("overlay/_base.js"),a&&a.__esModule&&a||{"default":a}).WalkontableOverlay,vt=(v=n("overlay/top.js"),v&&v.__esModule&&v||{"default":v}).WalkontableTopOverlay,yt=(y=n("overlay/left.js"),y&&y.__esModule&&y||{"default":y}).WalkontableLeftOverlay,pt=(p=n("overlay/debug.js"),p&&p.__esModule&&p||{"default":p}).WalkontableDebugOverlay,wt=(w=n("overlay/topLeftCorner.js"),w&&w.__esModule&&w||{"default":w}).WalkontableTopLeftCornerOverlay,k=function(n){var i=[],t,r;if(this.guid="wt_"+st(),n.cloneSource?(this.cloneSource=n.cloneSource,this.cloneOverlay=n.cloneOverlay,this.wtSettings=n.cloneSource.wtSettings,this.wtTable=new it(this,n.table,n.wtRootElement),this.wtScroll=new tt(this),this.wtViewport=n.cloneSource.wtViewport,this.wtEvent=new nt(this),this.selections=this.cloneSource.selections):(this.wtSettings=new ct(this,n),this.wtTable=new it(this,n.table),this.wtScroll=new tt(this),this.wtViewport=new lt(this),this.wtEvent=new nt(this),this.selections=this.getSetting("selections"),this.wtOverlays=new ht(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)i.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(n,t){ut(t,i[n])}])}this.drawn=!1;this.drawInterrupted=!1};$traceurRuntime.createClass(k,{draw:function(){var n=arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,n||ft(this.wtTable.TABLE)?this.wtTable.draw(n):this.drawInterrupted=!0,this},getCell:function(n){var f=arguments[1]!==void 0?arguments[1]:!1;if(!f)return this.wtTable.getCell(n);var i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),u=this.wtSettings.getSetting("fixedRowsBottom"),t=this.wtSettings.getSetting("fixedColumnsLeft");if(n.row<r&&n.col<t)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(n);if(n.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(n);if(n.col<t&&n.row>=i-u){if(this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(n)}else{if(n.col<t)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(n);if(n.row>i-u&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(n)}return this.wtTable.getCell(n)},update:function(n,t){return this.wtSettings.update(n,t)},scrollVertical:function(n){return this.wtOverlays.topOverlay.scrollTo(n),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(n){return this.wtOverlays.leftOverlay.scrollTo(n),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(n){return this.wtScroll.scrollViewport(n),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},exportSettingsAsClassNames:function(){var i=this,n=[],t=[];ot({rowHeaders:["array"],columnHeaders:["array"]},function(r,u){r.indexOf("array")>-1&&i.getSetting(u).length&&t.push("ht"+g(u));n.push("ht"+g(u))});et(this.wtTable.wtRootElement.parentNode,n);rt(this.wtTable.wtRootElement.parentNode,t)},getSetting:function(n,t,i,r,u){return this.wtSettings.getSetting(n,t,i,r,u)},hasSetting:function(n){return this.wtSettings.has(n)},destroy:function(){this.wtOverlays.destroy();this.wtEvent.destroy()}},{});window.Walkontable=k},{event:8,"helpers/dom/element":45,"helpers/object":50,"helpers/string":52,"overlay/_base.js":11,"overlay/debug.js":12,"overlay/left.js":13,"overlay/top.js":14,"overlay/topLeftCorner.js":15,overlays:16,scroll:17,settings:19,table:20,viewport:22}],8:[function(n,t,i){"use strict";function s(n){var t=this,i=c(n),u,f;this.instance=n;u=[null,null];this.dblClickTimeout=[null,null];var o=function(n){var i=t.parentCell(n.realTarget);r(n.realTarget,"corner")?t.instance.getSetting("onCellCornerMouseDown",n,n.realTarget):i.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",n,i.coords,i.TD,t.instance);n.button!==2&&i.TD&&(u[0]=i.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){u[0]=null},1e3))},s=function(){t.instance.touchMoving=!0},v,y=function(n){var r=this;i.addEventListener(this,"touchmove",s);t.checkIfTouchMove=setTimeout(function(){if(t.instance.touchMoving===!0){t.instance.touchMoving=void 0;i.removeEventListener("touchmove",s,!1);return}o(n)},30)},l,p=function(n){var r,i;t.instance.hasSetting("onCellMouseOver")&&(r=t.instance.wtTable.TABLE,i=h(n.realTarget,["TD","TH"],r),i&&i!==l&&e(i,r)&&(l=i,t.instance.getSetting("onCellMouseOver",n,t.instance.wtTable.getCoords(i),i,t.instance)))},a=function(n){if(n.button!==2){var i=t.parentCell(n.realTarget);i.TD===u[0]&&i.TD===u[1]?(r(n.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",n,i.coords,i.TD,t.instance):t.instance.getSetting("onCellDblClick",n,i.coords,i.TD,t.instance),u[0]=null,u[1]=null):i.TD===u[0]&&(u[1]=i.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){u[1]=null},500))}},w=function(n){clearTimeout(v);n.preventDefault();a(n)};i.addEventListener(this.instance.wtTable.holder,"mousedown",o);i.addEventListener(this.instance.wtTable.TABLE,"mouseover",p);i.addEventListener(this.instance.wtTable.holder,"mouseup",a);this.instance.wtTable.holder.parentNode.parentNode&&Handsontable.mobileBrowser&&!t.instance.wtTable.isWorkingOnClone()&&(f="."+this.instance.wtTable.holder.parentNode.className.split(" ").join("."),i.addEventListener(this.instance.wtTable.holder,"touchstart",function(n){t.instance.touchApplied=!0;e(n.target,f)&&y.call(n.target,n)}),i.addEventListener(this.instance.wtTable.holder,"touchend",function(n){t.instance.touchApplied=!1;e(n.target,f)&&w.call(n.target,n)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),i.addEventListener(this.instance.wtTable.holder,"scroll",function(){clearTimeout(t.instance.momentumScrolling._timeout);t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll");t.instance.momentumScrolling.ongoing=!0;t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)}));i.addEventListener(window,"resize",function(){t.instance.getSetting("stretchH")!=="none"&&t.instance.draw()});this.destroy=function(){clearTimeout(this.dblClickTimeout[0]);clearTimeout(this.dblClickTimeout[1]);i.destroy()}}Object.defineProperties(i,{WalkontableEvent:{get:function(){return s}},__esModule:{value:!0}});var u,f,o=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),h=o.closest,r=o.hasClass,e=o.isChildOf,c=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).eventManager;s.prototype.parentCell=function(n){var t={},u=this.instance.wtTable.TABLE,i=h(n,["TD","TH"],u);return i&&e(i,u)?(t.coords=this.instance.wtTable.getCoords(i),t.TD=i):r(n,"wtBorder")&&r(n,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):r(n,"wtBorder")&&r(n,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t};window.WalkontableEvent=s},{eventManager:41,"helpers/dom/element":45}],9:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableColumnFilter:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t,i){this.offset=n;this.total=t;this.countTH=i};$traceurRuntime.createClass(r,{offsetted:function(n){return n+this.offset},unOffsetted:function(n){return n-this.offset},renderedToSource:function(n){return this.offsetted(n)},sourceToRendered:function(n){return this.unOffsetted(n)},offsettedTH:function(n){return n-this.countTH},unOffsettedTH:function(n){return n+this.countTH},visibleRowHeadedColumnToSourceColumn:function(n){return this.renderedToSource(this.offsettedTH(n))},sourceColumnToVisibleRowHeadedColumn:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}},{});window.WalkontableColumnFilter=r},{}],10:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableRowFilter:{get:function(){return r}},__esModule:{value:!0}});var r=function(n,t,i){this.offset=n;this.total=t;this.countTH=i};$traceurRuntime.createClass(r,{offsetted:function(n){return n+this.offset},unOffsetted:function(n){return n-this.offset},renderedToSource:function(n){return this.offsetted(n)},sourceToRendered:function(n){return this.unOffsetted(n)},offsettedTH:function(n){return n-this.countTH},unOffsettedTH:function(n){return n+this.countTH},visibleColHeadedRowToSourceRow:function(n){return this.renderedToSource(this.offsettedTH(n))},sourceRowToVisibleColHeadedRow:function(n){return this.unOffsettedTH(this.sourceToRendered(n))}},{});window.WalkontableRowFilter=r},{}],11:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableOverlay:{get:function(){return s}},__esModule:{value:!0}});var u,f,e,h=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),c=h.getScrollableElement,l=h.getTrimmingContainer,a=(f=n("helpers/object"),f&&f.__esModule&&f||{"default":f}).defineGetter,v=(e=n("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager,o={},s=function(n){a(this,"wot",n,{writable:!1});this.instance=this.wot;this.type="";this.TABLE=this.wot.wtTable.TABLE;this.hider=this.wot.wtTable.hider;this.spreader=this.wot.wtTable.spreader;this.holder=this.wot.wtTable.holder;this.wtRootElement=this.wot.wtTable.wtRootElement;this.trimmingContainer=l(this.hider.parentNode.parentNode);this.mainTableScrollableElement=c(this.wot.wtTable.TABLE);this.needFullRender=this.shouldBeRendered();this.areElementSizesAdjusted=!1},r=s;$traceurRuntime.createClass(s,{shouldBeRendered:function(){return!0},makeClone:function(n){if(r.CLONE_TYPES.indexOf(n)===-1)throw new Error('Clone type "'+n+'" is not supported.');var t=document.createElement("DIV"),i=document.createElement("TABLE");return t.className="ht_clone_"+n+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden",i.className=this.wot.wtTable.TABLE.className,t.appendChild(i),this.type=n,this.wot.wtTable.wtRootElement.parentNode.appendChild(t),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:i})},refresh:function(){var t=arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(t);this.needFullRender=n},destroy:function(){v(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[r.CLONE_TOP,r.CLONE_BOTTOM,r.CLONE_LEFT,r.CLONE_TOP_LEFT_CORNER,r.CLONE_BOTTOM_LEFT_CORNER,r.CLONE_DEBUG]},registerOverlay:function(n,t){if(r.CLONE_TYPES.indexOf(n)===-1)throw new Error("Unsupported overlay ("+n+").");o[n]=t},createOverlay:function(n,t){return new o[n](t)},isOverlayTypeOf:function(n,t){return!n||!o[t]?!1:n instanceof o[t]}});window.WalkontableOverlay=s},{eventManager:41,"helpers/dom/element":45,"helpers/object":50}],12:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableDebugOverlay:{get:function(){return f}},__esModule:{value:!0}});var r,u,o=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).addClass,e=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).WalkontableOverlay,f=function(n){$traceurRuntime.superConstructor(s).call(this,n);this.clone=this.makeClone(e.CLONE_DEBUG);this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";o(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},s=f;$traceurRuntime.createClass(f,{},{},e);window.WalkontableDebugOverlay=f;e.registerOverlay(e.CLONE_DEBUG,f)},{_base:11,"helpers/dom/element":45}],13:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableLeftOverlay:{get:function(){return e}},__esModule:{value:!0}});var u,f,r=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),h=r.addClass,s=r.getScrollbarWidth,c=r.getScrollLeft,l=r.getWindowScrollTop,a=r.hasClass,v=r.outerWidth,y=r.removeClass,p=r.setOverlayPosition,o=(f=n("_base"),f&&f.__esModule&&f||{"default":f}).WalkontableOverlay,e=function(n){$traceurRuntime.superConstructor(w).call(this,n);this.clone=this.makeClone(o.CLONE_LEFT)},w=e;$traceurRuntime.createClass(e,{shouldBeRendered:function(){return this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length?!0:!1},resetFixedPosition:function(){var r,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(r=this.clone.wtTable.holder.parentNode,i=0,this.trimmingContainer===window){var u=this.wot.wtTable.hider.getBoundingClientRect(),f=Math.ceil(u.left),e=Math.ceil(u.right),n,t;t=this.wot.wtTable.hider.style.top;t=t===""?0:t;n=f<0&&e-r.offsetWidth>0?-f:0;i=n;n=n+"px";p(r,n,t)}else i=this.getScrollPosition();this.adjustHeaderBordersPosition(i);this.adjustElementsSize()}},setScrollPosition:function(n){this.mainTableScrollableElement===window?window.scrollTo(n,l()):this.mainTableScrollableElement.scrollLeft=n},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(n,t){for(var i=0,r=this.wot.wtSettings.defaultColumnWidth;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n++;return i},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1;(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var i=this.wot.wtTable.holder,r=i.clientHeight===i.offsetHeight?0:s(),u=this.clone.wtTable.holder.parentNode,t=u.style,n;this.trimmingContainer!==window&&(t.height=this.wot.wtViewport.getWorkspaceHeight()-r+"px");this.clone.wtTable.holder.style.height=t.height;n=v(this.clone.wtTable.TABLE);t.width=(n===0?n:n+4)+"px"},adjustRootChildrenSize:function(){var n=s();this.clone.wtTable.hider.style.height=this.hider.style.height;this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height;n===0&&(n=30);this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+n+"px"},applyToDOM:function(){var n=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.left="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.right="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.top=typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":""},scrollTo:function(n,t){var i=this.getTableParentOffset(),f=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=f.wtTable.holder,u=0;t&&r.offsetWidth!==r.clientWidth&&(u=s());t?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),n);i+=u;this.setScrollPosition(i)},getTableParentOffset:function(){return this.trimmingContainer===window?this.wot.wtTable.holderOffset.left:0},getScrollPosition:function(){return c(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(n){var t=this.wot.wtTable.holder.parentNode,r=this.wot.getSetting("rowHeaders"),u=this.wot.getSetting("fixedColumnsLeft"),i;u&&!r.length?h(t,"innerBorderLeft"):!u&&r.length&&(i=a(t,"innerBorderLeft"),n?h(t,"innerBorderLeft"):y(t,"innerBorderLeft"),(!i&&n||i&&!n)&&this.wot.wtOverlays.adjustElementsSize())}},{},o);window.WalkontableLeftOverlay=e;o.registerOverlay(o.CLONE_LEFT,e)},{_base:11,"helpers/dom/element":45}],14:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableTopOverlay:{get:function(){return e}},__esModule:{value:!0}});var u,f,r=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),h=r.addClass,s=r.getScrollbarWidth,c=r.getScrollTop,l=r.getWindowScrollLeft,a=r.hasClass,v=r.outerHeight,y=r.removeClass,p=r.setOverlayPosition,o=(f=n("_base"),f&&f.__esModule&&f||{"default":f}).WalkontableOverlay,e=function(n){$traceurRuntime.superConstructor(w).call(this,n);this.clone=this.makeClone(o.CLONE_TOP)},w=e;$traceurRuntime.createClass(e,{shouldBeRendered:function(){return this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length?!0:!1},resetFixedPosition:function(){var r,i;if(this.needFullRender&&this.wot.wtTable.holder.parentNode){if(r=this.clone.wtTable.holder.parentNode,i=0,this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var u=this.wot.wtTable.hider.getBoundingClientRect(),f=Math.ceil(u.top),e=Math.ceil(u.bottom),n,t;n=this.wot.wtTable.hider.style.left;n=n===""?0:n;t=f<0&&e-r.offsetHeight>0?-f:0;i=t;t=t+"px";p(r,n,t)}else i=this.getScrollPosition();this.adjustHeaderBordersPosition(i);this.adjustElementsSize()}},setScrollPosition:function(n){this.mainTableScrollableElement===window?window.scrollTo(l(),n):this.mainTableScrollableElement.scrollTop=n},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(n,t){for(var r=0,u=this.wot.wtSettings.settings.defaultRowHeight,i;n<t;)i=this.wot.wtTable.getRowHeight(n),r+=i===void 0?u:i,n++;return r},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1;(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),n||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var i=this.wot.wtTable.holder,r=i.clientWidth===i.offsetWidth?0:s(),u=this.clone.wtTable.holder.parentNode,t=u.style,n;this.trimmingContainer!==window&&(t.width=this.wot.wtViewport.getWorkspaceWidth()-r+"px");this.clone.wtTable.holder.style.width=t.width;n=v(this.clone.wtTable.TABLE);t.height=(n===0?n:n+4)+"px"},adjustRootChildrenSize:function(){var n=s();this.clone.wtTable.hider.style.width=this.hider.style.width;this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width;n===0&&(n=30);this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+n+"px"},applyToDOM:function(){var n=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="";this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){this.clone.wtTable.spreader.style.left=typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":""},scrollTo:function(n,t){var i=this.getTableParentOffset(),e=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=e.wtTable.holder,u=0;if(t&&r.offsetHeight!==r.clientHeight&&(u=s()),t){var o=this.wot.getSetting("fixedRowsBottom"),h=this.wot.getSetting("fixedRowsTop"),f=this.wot.getSetting("totalRows");i+=this.sumCellSizes(0,n+1);i-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(f-o,f);i+=1}else i+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),n);i+=u;this.setScrollPosition(i)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return c(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(n){var t,u,i,r;if(this.wot.getSetting("fixedRowsTop")===0&&this.wot.getSetting("columnHeaders").length>0&&(t=this.wot.wtTable.holder.parentNode,u=a(t,"innerBorderTop"),n?h(t,"innerBorderTop"):y(t,"innerBorderTop"),(!u&&n||u&&!n)&&this.wot.wtOverlays.adjustElementsSize()),this.wot.getSetting("rowHeaders").length===0&&(i=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)"),i))for(r=0;r<i.length;r++)i[r].style["border-left-width"]=0}},{},o);window.WalkontableTopOverlay=e;o.registerOverlay(o.CLONE_TOP,e)},{_base:11,"helpers/dom/element":45}],15:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableTopLeftCornerOverlay:{get:function(){return f}},__esModule:{value:!0}});var r,u,o=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),s=o.outerHeight,h=o.outerWidth,c=o.setOverlayPosition,e=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).WalkontableOverlay,f=function(n){$traceurRuntime.superConstructor(l).call(this,n);this.clone=this.makeClone(e.CLONE_TOP_LEFT_CORNER)},l=f;$traceurRuntime.createClass(f,{shouldBeRendered:function(){return(this.wot.getSetting("fixedRowsTop")||this.wot.getSetting("columnHeaders").length)&&(this.wot.getSetting("fixedColumnsLeft")||this.wot.getSetting("rowHeaders").length)?!0:!1},resetFixedPosition:function(){if(this.wot.wtTable.holder.parentNode){var n=this.clone.wtTable.holder.parentNode,i=s(this.clone.wtTable.TABLE),r=h(this.clone.wtTable.TABLE);if(this.trimmingContainer===window){var t=this.wot.wtTable.hider.getBoundingClientRect(),u=Math.ceil(t.top),f=Math.ceil(t.left),l=Math.ceil(t.bottom),a=Math.ceil(t.right),e,o;e=f<0&&a-n.offsetWidth>0?-f+"px":"0";o=u<0&&l-n.offsetHeight>0?-u+"px":"0";c(n,e,o)}n.style.height=(i===0?i:i+4)+"px";n.style.width=(r===0?r:r+4)+"px"}}},{},e);window.WalkontableTopLeftCornerOverlay=f;e.registerOverlay(e.CLONE_TOP_LEFT_CORNER,f)},{_base:11,"helpers/dom/element":45}],16:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableOverlays:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),l=e.getScrollableElement,h=e.getScrollbarWidth,o=e.getScrollLeft,c=e.getScrollTop,a=(u=n("helpers/unicode"),u&&u.__esModule&&u||{"default":u}).isKey,v=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).EventManager,s=function(n){this.wot=n;this.instance=this.wot;this.eventManager=new v(this.wot);this.wot.update("scrollbarWidth",h());this.wot.update("scrollbarHeight",h());this.mainTableScrollableElement=l(this.wot.wtTable.TABLE);this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot);this.bottomOverlay=typeof WalkontableBottomOverlay=="undefined"?{needFullRender:!1}:WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot);this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot);this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot));this.bottomLeftCornerOverlay=this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&typeof WalkontableBottomLeftCornerOverlay!="undefined"?WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot):{needFullRender:!1};this.wot.getSetting("debug")&&(this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot));this.destroyed=!1;this.keyPressed=!1;this.spreaderLastSize={width:null,height:null};this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}};this.verticalScrolling=!1;this.horizontalScrolling=!1;this.delegatedScrollCallback=!1;this.registerListeners()};$traceurRuntime.createClass(s,{refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0);this.verticalScrolling&&this.leftOverlay.onScroll();this.horizontalScrolling&&this.topOverlay.onScroll();this.verticalScrolling=!1;this.horizontalScrolling=!1}},registerListeners:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"keydown",function(t){return n.onKeyDown(t)});this.eventManager.addEventListener(document.documentElement,"keyup",function(){return n.onKeyUp()});this.eventManager.addEventListener(document,"visibilitychange",function(){return n.onKeyUp()});this.eventManager.addEventListener(this.mainTableScrollableElement,"scroll",function(t){return n.onTableScroll(t)});this.topOverlay.needFullRender&&(this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}),this.eventManager.addEventListener(this.topOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}));this.bottomOverlay.needFullRender&&(this.eventManager.addEventListener(this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}),this.eventManager.addEventListener(this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}));this.leftOverlay.needFullRender&&(this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return n.onTableScroll(t)}),this.eventManager.addEventListener(this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return n.onTableScroll(t)}));this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&this.eventManager.addEventListener(window,"wheel",function(t){var i,r=t.wheelDeltaY||t.deltaY,u=t.wheelDeltaX||t.deltaX;n.topOverlay.clone.wtTable.holder.contains(t.realTarget)?i="top":n.bottomOverlay.clone&&n.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?i="bottom":n.leftOverlay.clone.wtTable.holder.contains(t.realTarget)&&(i="left");i=="top"&&r!==0?t.preventDefault():i=="left"&&u!==0?t.preventDefault():i=="bottom"&&r!==0&&t.preventDefault()})},onTableScroll:function(n){Handsontable.mobileBrowser||(!this.keyPressed||this.mainTableScrollableElement===window||n.target.contains(this.mainTableScrollableElement))&&(n.type==="scroll"?this.syncScrollPositions(n):this.translateMouseWheelToScroll(n))},onKeyDown:function(n){this.keyPressed=a(n.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(n){for(var f=this.topOverlay.clone.wtTable.holder,e=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,o=this.leftOverlay.clone.wtTable.holder,r={type:"wheel"},t=n.target,u=n.wheelDeltaY||-1*n.deltaY,s=n.wheelDeltaX||-1*n.deltaX,i;t!=document&&t!=null;){if(t.className.indexOf("wtHolder")>-1){i=t;break}t=t.parentNode}return r.target=i,i==f?this.syncScrollPositions(r,-.2*u):i==e?this.syncScrollPositions(r,-.2*u):i==o&&this.syncScrollPositions(r,-.2*s),!1},syncScrollPositions:function(n){var f=arguments[1]!==void 0?arguments[1]:null;if(!this.destroyed){if(arguments.length===0){this.syncScrollWithMaster();return}var u=this.mainTableScrollableElement,i=n.target,t=0,r=!1,e,s,h,l=!1;this.topOverlay.needFullRender&&(e=this.topOverlay.clone.wtTable.holder);this.bottomOverlay.needFullRender&&(h=this.bottomOverlay.clone.wtTable.holder);this.leftOverlay.needFullRender&&(s=this.leftOverlay.clone.wtTable.holder);i===document&&(i=window);i===u?(t=o(i),this.overlayScrollPositions.master.left!==t&&(this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=t,r=!0,e&&(e.scrollLeft=t,l=this.mainTableScrollableElement!==window),h&&(h.scrollLeft=t,l=this.mainTableScrollableElement!==window)),t=c(i),this.overlayScrollPositions.master.top!==t&&(this.verticalScrolling=!0,this.overlayScrollPositions.master.top=t,r=!0,s&&(s.scrollTop=t,l=this.mainTableScrollableElement!==window))):i===h?(t=o(i),this.overlayScrollPositions.bottom.left!==t&&(this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=t,r=!0,u.scrollLeft=t),f!==null&&(r=!0,u.scrollTop+=f)):i===e?(t=o(i),this.overlayScrollPositions.top.left!==t&&(this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=t,r=!0,u.scrollLeft=t),f!==null&&(r=!0,u.scrollTop+=f)):i===s&&(t=c(i),this.overlayScrollPositions.left.top!==t&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=t,r=!0,u.scrollTop=t),f!==null&&(r=!0,u.scrollLeft+=f));!this.keyPressed&&r&&n.type==="scroll"&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),l&&(this.delegatedScrollCallback=!0))}},syncScrollWithMaster:function(){var n=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n.scrollLeft);this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n.scrollTop)},destroy:function(){this.eventManager.destroy();this.topOverlay.destroy();this.bottomOverlay.clone&&this.bottomOverlay.destroy();this.leftOverlay.destroy();this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy();this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy();this.debug&&this.debug.destroy();this.destroyed=!0},refresh:function(){var n=arguments[0]!==void 0?arguments[0]:!1;if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,i=t.clientWidth,r=t.clientHeight;(i!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height)&&(this.spreaderLastSize.width=i,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(n);this.leftOverlay.refresh(n);this.topOverlay.refresh(n);this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(n);this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(n);this.debug&&this.debug.refresh(n)},adjustElementsSize:function(){var n=arguments[0]!==void 0?arguments[0]:!1,i=this.wot.getSetting("totalColumns"),r=this.wot.getSetting("totalRows"),u=this.wot.wtViewport.getRowHeaderWidth(),f=this.wot.wtViewport.getColumnHeaderHeight(),t=this.wot.wtTable.hider.style;t.width=u+this.leftOverlay.sumCellSizes(0,i)+"px";t.height=f+this.topOverlay.sumCellSizes(0,r)+1+"px";this.topOverlay.adjustElementsSize(n);this.leftOverlay.adjustElementsSize(n);this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(n)},applyToDOM:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize();this.topOverlay.applyToDOM();this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM();this.leftOverlay.applyToDOM()}},{});window.WalkontableOverlays=s},{eventManager:41,"helpers/dom/element":45,"helpers/unicode":53}],17:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableScroll:{get:function(){return r}},__esModule:{value:!0}});var r=function(n){this.wot=n;this.instance=n};$traceurRuntime.createClass(r,{scrollViewport:function(n){if(this.wot.drawn){var t=this.wot.getSetting("totalRows"),i=this.wot.getSetting("totalColumns"),r=this.instance.getSetting("fixedRowsTop"),u=this.instance.getSetting("fixedRowsBottom"),f=this.instance.getSetting("fixedColumnsLeft");if(n.row<0||n.row>t-1)throw new Error("row "+n.row+" does not exist");if(n.col<0||n.col>i-1)throw new Error("column "+n.col+" does not exist");n.row>this.instance.wtTable.getLastVisibleRow()&&n.row<t-u?this.wot.wtOverlays.topOverlay.scrollTo(n.row,!0):n.row>=r&&n.row<this.instance.wtTable.getFirstVisibleRow()&&this.wot.wtOverlays.topOverlay.scrollTo(n.row);n.col>this.instance.wtTable.getLastVisibleColumn()?this.wot.wtOverlays.leftOverlay.scrollTo(n.col,!0):n.col>=f&&n.col<this.instance.wtTable.getFirstVisibleColumn()&&this.wot.wtOverlays.leftOverlay.scrollTo(n.col)}}},{});window.WalkontableScroll=r},{}],18:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableSelection:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e,o=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).addClass,h=(u=n("border"),u&&u.__esModule&&u||{"default":u}).WalkontableBorder,c=(f=n("cell/coords"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords,l=(e=n("cell/range"),e&&e.__esModule&&e||{"default":e}).WalkontableCellRange,s=function(n,t){this.settings=n;this.cellRange=t||null;this.instanceBorders={}};$traceurRuntime.createClass(s,{getBorder:function(n){if(this.instanceBorders[n.guid])return this.instanceBorders[n.guid];this.instanceBorders[n.guid]=new h(n,this.settings)},isEmpty:function(){return this.cellRange===null},add:function(n){this.isEmpty()?this.cellRange=new l(n,n,n):this.cellRange.expand(n)},replace:function(n,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(n))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(n))return this.cellRange.to=t,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var n=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[n.row,n.col,t.row,t.col]},addClassAtCoords:function(n,t,i,r){var u=n.wtTable.getCell(new c(t,i));typeof u=="object"&&o(u,r)},draw:function(n){var h,f,e,s,c;if(this.isEmpty()){this.settings.border&&(h=this.getBorder(n),h&&h.disappear());return}var a=n.wtTable.getRenderedRowsCount(),l=n.wtTable.getRenderedColumnsCount(),t=this.getCorners(),r,i,u;for(f=0;f<l;f++)i=n.wtTable.columnFilter.renderedToSource(f),i>=t[1]&&i<=t[3]&&(u=n.wtTable.getColumnHeader(i),u&&this.settings.highlightColumnClassName&&o(u,this.settings.highlightColumnClassName));for(e=0;e<a;e++)for(r=n.wtTable.rowFilter.renderedToSource(e),r>=t[0]&&r<=t[2]&&(u=n.wtTable.getRowHeader(r),u&&this.settings.highlightRowClassName&&o(u,this.settings.highlightRowClassName)),s=0;s<l;s++)i=n.wtTable.columnFilter.renderedToSource(s),r>=t[0]&&r<=t[2]&&i>=t[1]&&i<=t[3]?this.settings.className&&this.addClassAtCoords(n,r,i,this.settings.className):r>=t[0]&&r<=t[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(n,r,i,this.settings.highlightRowClassName):i>=t[1]&&i<=t[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(n,r,i,this.settings.highlightColumnClassName);n.getSetting("onBeforeDrawBorders",t,this.settings.className);this.settings.border&&(c=this.getBorder(n),c&&c.appear(t))}},{});window.WalkontableSelection=s},{border:2,"cell/coords":5,"cell/range":6,"helpers/dom/element":45}],19:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableSettings:{get:function(){return u}},__esModule:{value:!0}});var r,f=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).fastInnerText,u=function(n,t){var r=this,i;this.wot=n;this.instance=n;this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(n,t,i){var u=r.getSetting("data",n,t);f(i,u===void 0||u===null?"":u)},columnWidth:function(){return},rowHeight:function(){return},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1};this.settings={};for(i in this.defaults)if(this.defaults.hasOwnProperty(i))if(t[i]!==void 0)this.settings[i]=t[i];else if(this.defaults[i]===void 0)throw new Error('A required setting "'+i+'" was not provided');else this.settings[i]=this.defaults[i]};$traceurRuntime.createClass(u,{update:function(n,t){if(t===void 0)for(var i in n)n.hasOwnProperty(i)&&(this.settings[i]=n[i]);else this.settings[n]=t;return this.wot},getSetting:function(n,t,i,r,u){return typeof this.settings[n]=="function"?this.settings[n](t,i,r,u):t!==void 0&&Array.isArray(this.settings[n])?this.settings[n][t]:this.settings[n]},has:function(n){return!!this.settings[n]}},{});window.WalkontableSettings=u},{"helpers/dom/element":45}],20:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableTable:{get:function(){return l}},__esModule:{value:!0}});var u,f,e,o,s,h,r=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),a=r.getStyle,y=r.getTrimmingContainer,c=r.hasClass,p=r.index,v=r.offset,w=r.removeClass,b=r.removeTextNodes,tt=r.overlayContainsElement,k=(f=n("cell/coords"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords,it=(e=n("cell/range"),e&&e.__esModule&&e||{"default":e}).WalkontableCellRange,d=(o=n("filter/column"),o&&o.__esModule&&o||{"default":o}).WalkontableColumnFilter,g=(s=n("filter/row"),s&&s.__esModule&&s||{"default":s}).WalkontableRowFilter,nt=(h=n("tableRenderer"),h&&h.__esModule&&h||{"default":h}).WalkontableTableRenderer,l=function(n,t){this.wot=n;this.instance=this.wot;this.TABLE=t;this.TBODY=null;this.THEAD=null;this.COLGROUP=null;this.tableOffset=0;this.holderOffset=0;b(this.TABLE);this.spreader=this.createSpreader(this.TABLE);this.hider=this.createHider(this.spreader);this.holder=this.createHolder(this.hider);this.wtRootElement=this.holder.parentNode;this.alignOverlaysWithTrimmingContainer();this.fixTableDomTree();this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.rowFilter=null;this.columnFilter=null};$traceurRuntime.createClass(l,{fixTableDomTree:function(){this.TBODY=this.TABLE.querySelector("tbody");this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY));this.THEAD=this.TABLE.querySelector("thead");this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY));this.COLGROUP=this.TABLE.querySelector("colgroup");this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD));this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))},createSpreader:function(n){var i=n.parentNode,t;return i&&i.nodeType===1&&c(i,"wtHolder")||(t=document.createElement("div"),t.className="wtSpreader",i&&i.insertBefore(t,n),t.appendChild(n)),t.style.position="relative",t},createHider:function(n){var t=n.parentNode,i;return t&&t.nodeType===1&&c(t,"wtHolder")||(i=document.createElement("div"),i.className="wtHider",t&&t.insertBefore(i,n),i.appendChild(n)),i},createHolder:function(n){var i=n.parentNode,t;return i&&i.nodeType===1&&c(i,"wtHolder")||(t=document.createElement("div"),t.style.position="relative",t.className="wtHolder",i&&i.insertBefore(t,n),this.isWorkingOnClone()||(t.parentNode.className+="ht_master handsontable"),t.appendChild(n)),t},alignOverlaysWithTrimmingContainer:function(){var n=y(this.wtRootElement);this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative",n===window?(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible"):(this.holder.style.width=a(n,"width"),this.holder.style.height=a(n,"height"),this.holder.style.overflow=""))},isWorkingOnClone:function(){return!!this.wot.cloneSource},draw:function(n){var t=this.instance.getSetting("totalRows"),i,r;return this.isWorkingOnClone()||(this.holderOffset=v(this.holder),n=this.wot.wtViewport.createRenderCalculators(n)),n?(this.isWorkingOnClone()||this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays&&this.wot.wtOverlays.refresh(!0)):(this.tableOffset=this.isWorkingOnClone()?this.wot.cloneSource.wtTable.tableOffset:v(this.TABLE),i=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?0:WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?t-this.wot.getSetting("fixedRowsBottom"):this.wot.wtViewport.rowsRenderCalculator.startRow,r=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?0:this.wot.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new g(i,t,this.wot.getSetting("columnHeaders").length),this.columnFilter=new d(r,this.wot.getSetting("totalColumns"),this.wot.getSetting("rowHeaders").length),this._doDraw(),this.alignOverlaysWithTrimmingContainer()),this.refreshSelections(n),this.isWorkingOnClone()||(this.wot.wtOverlays.topOverlay.resetFixedPosition(),this.wot.wtOverlays.bottomOverlay.clone&&this.wot.wtOverlays.bottomOverlay.resetFixedPosition(),this.wot.wtOverlays.leftOverlay.resetFixedPosition(),this.wot.wtOverlays.topLeftCornerOverlay&&this.wot.wtOverlays.topLeftCornerOverlay.resetFixedPosition(),this.instance.wtOverlays.bottomLeftCornerOverlay&&this.instance.wtOverlays.bottomLeftCornerOverlay.clone&&this.wot.wtOverlays.bottomLeftCornerOverlay.resetFixedPosition()),this.wot.drawn=!0,this},_doDraw:function(){var n=new nt(this);n.render()},removeClassFromCells:function(n){for(var i=this.TABLE.querySelectorAll("."+n),t=0,r=i.length;t<r;t++)w(i[t],n)},refreshSelections:function(n){var r,t,i;if(this.wot.selections){if(r=this.wot.selections.length,n)for(t=0;t<r;t++)this.wot.selections[t].settings.className&&this.removeClassFromCells(this.wot.selections[t].settings.className),this.wot.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[t].settings.highlightRowClassName),this.wot.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[t].settings.highlightColumnClassName);for(i=0;i<r;i++)this.wot.selections[i].draw(this.wot,n)}},getCell:function(n){if(this.isRowBeforeRenderedRows(n.row))return-1;if(this.isRowAfterRenderedRows(n.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n.row)];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n.col)]},getColumnHeader:function(n){var i=arguments[1]!==void 0?arguments[1]:0,t=this.THEAD.childNodes[i];if(t)return t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)]},getRowHeader:function(n){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)];if(t)return t.childNodes[0]},getCoords:function(n){var i=n.parentNode,t=p(i),r;return t=i.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(t):this.rowFilter.renderedToSource(t),r=this.columnFilter.visibleRowHeadedColumnToSourceColumn(n.cellIndex),new k(t,r)},getTrForRow:function(n){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(n)]},getFirstRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function(n){return this.rowFilter.sourceToRendered(n)<0&&n>=0},isRowAfterViewport:function(n){return this.rowFilter.sourceToRendered(n)>this.getLastVisibleRow()},isRowAfterRenderedRows:function(n){return this.rowFilter.sourceToRendered(n)>this.getLastRenderedRow()},isColumnBeforeViewport:function(n){return this.columnFilter.sourceToRendered(n)<0&&n>=0},isColumnAfterViewport:function(n){return this.columnFilter.sourceToRendered(n)>this.getLastVisibleColumn()},isLastRowFullyVisible:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function(){return WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)?this.wot.getSetting("totalColumns"):WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?this.wot.getSetting("fixedColumnsLeft"):this.wot.wtViewport.columnsRenderCalculator.count},getRenderedRowsCount:function(){return WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)?this.wot.getSetting("totalRows"):WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?this.wot.getSetting("fixedRowsTop"):WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?this.instance.getSetting("fixedRowsBottom"):this.wot.wtViewport.rowsRenderCalculator.count},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function(n){var t=this.wot.wtSettings.settings.rowHeight(n),i=this.wot.wtViewport.oversizedRows[n];return i!==void 0&&(t=t===void 0?i:Math.max(t,i)),t},getColumnHeaderHeight:function(n){var t=this.wot.wtSettings.settings.defaultRowHeight,i=this.wot.wtViewport.oversizedColumnHeaders[n];return i!==void 0&&(t=t?Math.max(t,i):i),t},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function(n){var t=this.wot.wtSettings.settings.columnWidth;return typeof t=="function"?t=t(n):typeof t=="object"&&(t=t[n]),t||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function(n){var r=this.getColumnWidth(n),t=[void 0,null].indexOf(r)===-1?r:this.instance.wtSettings.settings.defaultColumnWidth,u=this.wot.wtViewport.columnsRenderCalculator,i;return u&&(i=u.getStretchedColumnWidth(n,t),i&&(t=i)),t}},{});window.WalkontableTable=l},{"cell/coords":5,"cell/range":6,"filter/column":9,"filter/row":10,"helpers/dom/element":45,tableRenderer:21}],21:[function(n,t,i){"use strict";function l(n,t){var i=document.createElement("TH");return t.insertBefore(i,n),t.removeChild(n),i}function a(n,t){var i=document.createElement("TD");return t.insertBefore(i,n),t.removeChild(n),i}Object.defineProperties(i,{WalkontableTableRenderer:{get:function(){return e}},__esModule:{value:!0}});var r,u=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),o=u.addClass,s=u.empty,h=u.getScrollbarWidth,c=u.hasClass,f=u.innerHeight,e=function(n){this.wtTable=n;this.wot=n.instance;this.instance=n.instance;this.rowFilter=n.rowFilter;this.columnFilter=n.columnFilter;this.TABLE=n.TABLE;this.THEAD=n.THEAD;this.TBODY=n.TBODY;this.COLGROUP=n.COLGROUP;this.rowHeaders=[];this.rowHeaderCount=0;this.columnHeaders=[];this.columnHeaderCount=0;this.fixedRowsTop=0;this.fixedRowsBottom=0};$traceurRuntime.createClass(e,{render:function(){var f,e,n,o,s,h;this.wtTable.isWorkingOnClone()||this.wot.getSetting("beforeDraw",!0);this.rowHeaders=this.wot.getSetting("rowHeaders");this.rowHeaderCount=this.rowHeaders.length;this.fixedRowsTop=this.wot.getSetting("fixedRowsTop");this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom");this.columnHeaders=this.wot.getSetting("columnHeaders");this.columnHeaderCount=this.columnHeaders.length;var t=this.wtTable.getRenderedColumnsCount(),i=this.wtTable.getRenderedRowsCount(),c=this.wot.getSetting("totalColumns"),l=this.wot.getSetting("totalRows"),r,u=!1;if((WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),c>0&&(this.adjustAvailableNodes(),u=!0,this.renderColumnHeaders(),this.renderRows(l,i,t),this.wtTable.isWorkingOnClone()||(r=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnHeaderHeights(),this.adjustColumnWidths(t),this.markOversizedColumns()),u||this.adjustAvailableNodes(),this.removeRedundantRows(i),this.wtTable.isWorkingOnClone())WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)&&(h=this.wot.cloneOverlay.instance,this.wot.cloneOverlay.markOversizedFixedBottomRows(),h.wtOverlays.adjustElementsSize());else{if(this.markOversizedRows(),this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM(),r!==this.wot.wtViewport.getWorkspaceWidth())for(this.wot.wtViewport.containerWidth=null,f=this.wtTable.getFirstRenderedColumn(),e=this.wtTable.getLastRenderedColumn(),n=f;n<e;n++)o=this.wtTable.getStretchedColumnWidth(n),s=this.columnFilter.sourceToRendered(n),this.COLGROUP.childNodes[s+this.rowHeaderCount].style.width=o+"px";this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(n,t,i){for(var o,r,f=0,u=this.rowFilter.renderedToSource(f),s=this.wtTable.isWorkingOnClone(),e;u<n&&u>=0;){if(f>1e3&&console.error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars."),t!==void 0&&f===t)break;r=this.getOrCreateTrForRow(f,r);this.renderRowHeaders(u,r);this.adjustColumns(r,i+this.rowHeaderCount);o=this.renderCells(u,r,i);(!s||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM))&&this.resetOversizedRow(u);r.firstChild&&(e=this.wot.wtTable.getRowHeight(u),e?(e--,r.firstChild.style.height=e+"px"):r.firstChild.style.height="");f++;u=this.rowFilter.renderedToSource(f)}},resetOversizedRow:function(n){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[n]&&(this.wot.wtViewport.oversizedRows[n]=void 0)},markOversizedRows:function(){if(!this.wot.getSetting("externalRowCalculator")){var n=this.instance.wtTable.TBODY.childNodes.length,o=n*this.instance.wtSettings.settings.defaultRowHeight,s=f(this.instance.wtTable.TBODY)-1,r,t,i,u,e,h=this.instance.getSetting("totalRows");if(o!==s||this.instance.getSetting("fixedRowsBottom"))while(n)n--,i=this.instance.wtTable.rowFilter.renderedToSource(n),r=this.instance.wtTable.getRowHeight(i),u=this.instance.wtTable.getTrForRow(i),e=u.querySelector("th"),t=e?f(e):f(u)-1,(!r&&this.instance.wtSettings.settings.defaultRowHeight<t||r<t)&&(this.instance.wtViewport.oversizedRows[i]=++t)}},markOversizedColumns:function(){var i=this.wot.getOverlayName(),r,t,n;if(this.columnHeaderCount&&!this.wot.wtViewport.isMarkedOversizedColumn[i]&&!this.wtTable.isWorkingOnClone()){for(r=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(n=-1*this.rowHeaderCount;n<r;n++)this.markIfOversizedColumnHeader(n);this.wot.wtViewport.isMarkedOversizedColumn[i]=!0}},adjustColumnHeaderHeights:function(){for(var r=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,i=this.wot.wtViewport.oversizedColumnHeaders,n=0,u=r.length;n<u;n++)if(i[n]){if(t[n].childNodes.length===0)return;t[n].childNodes[0].style.height=i[n]+"px"}},markIfOversizedColumnHeader:function(n){for(var e=this.wot.wtTable.columnFilter.renderedToSource(n),t=this.columnHeaderCount,o=this.wot.wtSettings.settings.defaultRowHeight,r,u,i;t;)(t--,r=this.wot.wtTable.getColumnHeaderHeight(t),u=this.wot.wtTable.getColumnHeader(e,t),u)&&(i=f(u),(!r&&o<i||r<i)&&(this.wot.wtViewport.oversizedColumnHeaders[t]=i))},renderCells:function(n,t,i){for(var r,f,u=0;u<i;u++)f=this.columnFilter.renderedToSource(u),r=u===0?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(f)]:r.nextSibling,r.nodeName=="TH"&&(r=a(r,t)),c(r,"hide")||(r.className=""),r.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(n,f,r);return r},adjustColumnWidths:function(n){var i=0,f=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=f.wtTable.holder,t,u;for(r.offsetHeight<r.scrollHeight&&(i=h()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-i),t=0;t<n;t++)u=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(t)),this.COLGROUP.childNodes[t+this.rowHeaderCount].style.width=u+"px"},appendToTbody:function(n){this.TBODY.appendChild(n);this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(n,t){var i;return n>=this.wtTable.tbodyChildrenLength?(i=this.createRow(),this.appendToTbody(i)):i=n===0?this.TBODY.firstChild:t.nextSibling,i.className&&i.removeAttribute("class"),i},createRow:function(){for(var n=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)n.appendChild(document.createElement("TH"));return n},renderRowHeader:function(n,t,i){i.className="";i.removeAttribute("style");this.rowHeaders[t](n,i,t)},renderRowHeaders:function(n,t){for(var i=t.firstChild,r=0;r<this.rowHeaderCount;r++)i?i.nodeName=="TD"&&(i=l(i,t)):(i=document.createElement("TH"),t.appendChild(i)),this.renderRowHeader(n,r,i),i=i.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups();this.adjustThead()},renderColumnHeaders:function(){var f=this.wot.getOverlayName(),i,n,r,t,u;if(this.columnHeaderCount)for(i=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(r=this.getTrForColumnHeaders(n),t=-1*this.rowHeaderCount;t<i;t++)u=this.columnFilter.renderedToSource(t),this.renderColumnHeader(n,u,r.childNodes[t+this.rowHeaderCount])},adjustColGroups:function(){for(var n=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<n+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;while(this.wtTable.colgroupChildrenLength>n+this.rowHeaderCount)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&o(this.COLGROUP.childNodes[0],"rowHeader")},adjustThead:function(){var u=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild,t,f,i,r;if(this.columnHeaders.length){for(t=0,f=this.columnHeaders.length;t<f;t++){for(n=this.THEAD.childNodes[t],n||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<u+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;while(this.theadChildrenLength>u+this.rowHeaderCount)n.removeChild(n.lastChild),this.theadChildrenLength--}if(i=this.THEAD.childNodes.length,i>this.columnHeaders.length)for(r=this.columnHeaders.length;r<i;r++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&s(n)},getTrForColumnHeaders:function(n){return this.THEAD.childNodes[n]},renderColumnHeader:function(n,t,i){return i.className="",i.removeAttribute("style"),this.columnHeaders[n](t,i,n)},adjustColumns:function(n,t){for(var i=n.childNodes.length,r;i<t;)r=document.createElement("TD"),n.appendChild(r),i++;while(i>t)n.removeChild(n.lastChild),i--},removeRedundantColumns:function(n){while(this.wtTable.tbodyChildrenLength>n)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{});window.WalkontableTableRenderer=e},{"helpers/dom/element":45}],22:[function(n,t,i){"use strict";Object.defineProperties(i,{WalkontableViewport:{get:function(){return c}},__esModule:{value:!0}});var u,f,e,o,r=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),l=r.getScrollbarWidth,a=r.getScrollTop,v=r.getStyle,y=r.offset,h=r.outerHeight,s=r.outerWidth,p=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).EventManager,w=(e=n("calculator/viewportColumns"),e&&e.__esModule&&e||{"default":e}).WalkontableViewportColumnsCalculator,b=(o=n("calculator/viewportRows"),o&&o.__esModule&&o||{"default":o}).WalkontableViewportRowsCalculator,c=function(n){var t=this;this.wot=n;this.instance=this.wot;this.oversizedRows=[];this.oversizedColumnHeaders=[];this.isMarkedOversizedColumn={};this.clientHeight=0;this.containerWidth=NaN;this.rowHeaderWidth=NaN;this.rowsVisibleCalculator=null;this.columnsVisibleCalculator=null;this.eventManager=new p(this.wot);this.eventManager.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(c,{getWorkspaceHeight:function(){var n=this.instance.wtOverlays.topOverlay.trimmingContainer,i,t=0;return n===window?t=document.documentElement.clientHeight:(i=h(n),t=i>0&&n.clientHeight>0?n.clientHeight:Infinity),t},getWorkspaceWidth:function(){var n,u=this.instance.getSetting("totalColumns"),r=this.instance.wtOverlays.leftOverlay.trimmingContainer,t,f=this.instance.getSetting("stretchH"),i=document.documentElement.offsetWidth;return(n=Handsontable.freezeOverlays?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),r===window&&u>0&&this.sumColumnWidths(0,u-1)>n)?document.documentElement.clientWidth:r!==window&&(t=v(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),t=="scroll"||t=="hidden"||t=="auto")?Math.max(n,r.clientWidth):f!=="none"&&f?n:Math.max(n,s(this.instance.wtTable.TABLE))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(n,t){for(var i=0;n<t;)i+=this.wot.wtTable.getColumnWidth(n),n++;return i},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var i=this.instance.wtTable.holder,t,n;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",i.appendChild(n),t=n.offsetWidth,this.containerWidth=t,i.removeChild(n),t},getWorkspaceOffset:function(){return y(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return h(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return s(this.wot.wtTable.TABLE)||s(this.wot.wtTable.TBODY)||s(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=h(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var n=this.getWorkspaceHeight(),t;return n===Infinity?n:(t=this.getColumnHeaderHeight(),t>0&&(n-=t),n)},getRowHeaderWidth:function(){var t,n,i,r;if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t=this.instance.getSetting("rowHeaders"),t.length)for(n=this.instance.wtTable.TABLE.querySelector("TH"),this.rowHeaderWidth=0,i=0,r=t.length;i<r;i++)n?(this.rowHeaderWidth+=s(n),n=n.nextSibling):this.rowHeaderWidth+=50;else this.rowHeaderWidth=0;return this.rowHeaderWidth},getViewportWidth:function(){var n=this.getWorkspaceWidth(),t;return n===Infinity?n:(t=this.getRowHeaderWidth(),t>0)?n-t:n},createRowsCalculator:function(){var e=arguments[0]!==void 0?arguments[0]:!1,s=this,i,n,r,o,u,t,f;return this.rowHeaderWidth=NaN,i=this.wot.wtSettings.settings.renderAllRows?Infinity:this.getViewportHeight(),n=a(this.wot.wtOverlays.mainTableScrollableElement)-this.wot.wtOverlays.topOverlay.getTableParentOffset(),n<0&&(n=0),r=this.wot.getSetting("fixedRowsTop"),u=this.wot.getSetting("fixedRowsBottom"),f=this.wot.getSetting("totalRows"),r&&(t=this.wot.wtOverlays.topOverlay.sumCellSizes(0,r),n+=t,i-=t),u&&this.wot.wtOverlays.bottomOverlay.clone&&(t=this.wot.wtOverlays.bottomOverlay.sumCellSizes(f-u,f),i-=t),o=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:l(),new b(i,n,this.wot.getSetting("totalRows"),function(n){return s.wot.wtTable.getRowHeight(n)},e?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,e,o)},createColumnsCalculator:function(){var u=arguments[0]!==void 0?arguments[0]:!1,f=this,t=this.getViewportWidth(),n,i,r;return this.columnHeaderHeight=NaN,n=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),n<0&&(n=0),i=this.wot.getSetting("fixedColumnsLeft"),i&&(r=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i),n+=r,t-=r),this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(t-=l()),new w(t,n,this.wot.getSetting("totalColumns"),function(n){return f.wot.wtTable.getColumnWidth(n)},u?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,u,this.wot.getSetting("stretchH"))},createRenderCalculators:function(){var n=arguments[0]!==void 0?arguments[0]:!1,t,i;return n&&(t=this.createRowsCalculator(!0),i=this.createColumnsCalculator(!0),this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)),n||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0);this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(n){return this.rowsVisibleCalculator?n.startRow<this.rowsRenderCalculator.startRow||n.startRow===this.rowsRenderCalculator.startRow&&n.startRow>0?!1:n.endRow>this.rowsRenderCalculator.endRow||n.endRow===this.rowsRenderCalculator.endRow&&n.endRow<this.wot.getSetting("totalRows")-1?!1:!0:!1},areAllProposedVisibleColumnsAlreadyRendered:function(n){return this.columnsVisibleCalculator?n.startColumn<this.columnsRenderCalculator.startColumn||n.startColumn===this.columnsRenderCalculator.startColumn&&n.startColumn>0?!1:n.endColumn>this.columnsRenderCalculator.endColumn||n.endColumn===this.columnsRenderCalculator.endColumn&&n.endColumn<this.wot.getSetting("totalColumns")-1?!1:!0:!1}},{});window.WalkontableViewport=c},{"calculator/viewportColumns":3,"calculator/viewportRows":4,eventManager:41,"helpers/dom/element":45}],23:[function(n){"use strict";var t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,tt,nt;window.Handsontable=function Handsontable(n,t){var i=new Handsontable.Core(n,t||{});return i.init(),i};t=n("shims/classes");t&&t.__esModule&&t||{"default":t};i=n("es6collections");i&&i.__esModule&&i||{"default":i};tt=(r=n("pluginHooks"),r&&r.__esModule&&r||{"default":r}).Hooks;Handsontable.hooks||(Handsontable.hooks=new tt);u=n("core");u&&u.__esModule&&u||{"default":u};f=n("renderers/_cellDecorator");f&&f.__esModule&&f||{"default":f};e=n("cellTypes");e&&e.__esModule&&e||{"default":e};o=n("plugins/jqueryHandsontable");o&&o.__esModule&&o||{"default":o};var g=(s=n("helpers/array"),s&&s.__esModule&&s||{"default":s}),it=(h=n("helpers/browser"),h&&h.__esModule&&h||{"default":h}),rt=(c=n("helpers/data"),c&&c.__esModule&&c||{"default":c}),ut=(l=n("helpers/function"),l&&l.__esModule&&l||{"default":l}),ft=(a=n("helpers/mixed"),a&&a.__esModule&&a||{"default":a}),et=(v=n("helpers/number"),v&&v.__esModule&&v||{"default":v}),ot=(y=n("helpers/object"),y&&y.__esModule&&y||{"default":y}),st=(p=n("helpers/setting"),p&&p.__esModule&&p||{"default":p}),ht=(w=n("helpers/string"),w&&w.__esModule&&w||{"default":w}),ct=(b=n("helpers/unicode"),b&&b.__esModule&&b||{"default":b}),lt=(k=n("helpers/dom/element"),k&&k.__esModule&&k||{"default":k}),at=(d=n("helpers/dom/event"),d&&d.__esModule&&d||{"default":d}),vt=[g,it,rt,ut,ft,et,ot,st,ht,ct],yt=[lt,at];Handsontable.buildDate="Fri Dec 04 2015 11:56:12 GMT+0100 (CET)";Handsontable.packageName="handsontable";Handsontable.version="0.20.2";nt="@@baseVersion";/^@@/.test(nt)||(Handsontable.baseVersion=nt);Handsontable.plugins={};Handsontable.helper={};Handsontable.dom={};Handsontable.Dom=Handsontable.dom;g.arrayEach(vt,function(n){g.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(Handsontable.helper[t]=n[t])})});g.arrayEach(yt,function(n){g.arrayEach(Object.getOwnPropertyNames(n),function(t){t.charAt(0)!=="_"&&(Handsontable.dom[t]=n[t])})})},{cellTypes:24,core:25,es6collections:"es6collections","helpers/array":42,"helpers/browser":43,"helpers/data":44,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/function":47,"helpers/mixed":48,"helpers/number":49,"helpers/object":50,"helpers/setting":51,"helpers/string":52,"helpers/unicode":53,pluginHooks:56,"plugins/jqueryHandsontable":1,"renderers/_cellDecorator":89,"shims/classes":96}],24:[function(n){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut=(r=n("helpers/browser"),r&&r.__esModule&&r||{"default":r}).isMobileBrowser,t=(u=n("editors"),u&&u.__esModule&&u||{"default":u}).getEditorConstructor,i=(f=n("renderers"),f&&f.__esModule&&f||{"default":f}).getRenderer,ft=(e=n("editors/autocompleteEditor"),e&&e.__esModule&&e||{"default":e}).AutocompleteEditor,et=(o=n("editors/checkboxEditor"),o&&o.__esModule&&o||{"default":o}).CheckboxEditor,ot=(s=n("editors/dateEditor"),s&&s.__esModule&&s||{"default":s}).DateEditor,st=(h=n("editors/dropdownEditor"),h&&h.__esModule&&h||{"default":h}).DropdownEditor,ht=(c=n("editors/handsontableEditor"),c&&c.__esModule&&c||{"default":c}).HandsontableEditor,ct=(l=n("editors/mobileTextEditor"),l&&l.__esModule&&l||{"default":l}).MobileTextEditor,lt=(a=n("editors/numericEditor"),a&&a.__esModule&&a||{"default":a}).NumericEditor,at=(v=n("editors/passwordEditor"),v&&v.__esModule&&v||{"default":v}).PasswordEditor,vt=(y=n("editors/selectEditor"),y&&y.__esModule&&y||{"default":y}).SelectEditor,yt=(p=n("editors/textEditor"),p&&p.__esModule&&p||{"default":p}).TextEditor,pt=(w=n("renderers/autocompleteRenderer"),w&&w.__esModule&&w||{"default":w}).AutocompleteRenderer,wt=(b=n("renderers/checkboxRenderer"),b&&b.__esModule&&b||{"default":b}).CheckboxRenderer,bt=(k=n("renderers/htmlRenderer"),k&&k.__esModule&&k||{"default":k}).HtmlRenderer,kt=(d=n("renderers/numericRenderer"),d&&d.__esModule&&d||{"default":d}).NumericRenderer,dt=(g=n("renderers/passwordRenderer"),g&&g.__esModule&&g||{"default":g}).PasswordRenderer,gt=(nt=n("renderers/textRenderer"),nt&&nt.__esModule&&nt||{"default":nt}).TextRenderer,ni=(tt=n("validators/autocompleteValidator"),tt&&tt.__esModule&&tt||{"default":tt}).AutocompleteValidator,ti=(it=n("validators/dateValidator"),it&&it.__esModule&&it||{"default":it}).DateValidator,ii=(rt=n("validators/numericValidator"),rt&&rt.__esModule&&rt||{"default":rt}).NumericValidator;Handsontable.mobileBrowser=ut();Handsontable.AutocompleteCell={editor:t("autocomplete"),renderer:i("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:t("checkbox"),renderer:i("checkbox")};Handsontable.TextCell={editor:Handsontable.mobileBrowser?t("mobile"):t("text"),renderer:i("text")};Handsontable.NumericCell={editor:t("numeric"),renderer:i("numeric"),validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:t("date"),validator:Handsontable.DateValidator,renderer:i("autocomplete")};Handsontable.HandsontableCell={editor:t("handsontable"),renderer:i("autocomplete")};Handsontable.PasswordCell={editor:t("password"),renderer:i("password"),copyable:!1};Handsontable.DropdownCell={editor:t("dropdown"),renderer:i("autocomplete"),validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}}},{editors:29,"editors/autocompleteEditor":31,"editors/checkboxEditor":32,"editors/dateEditor":33,"editors/dropdownEditor":34,"editors/handsontableEditor":35,"editors/mobileTextEditor":36,"editors/numericEditor":37,"editors/passwordEditor":38,"editors/selectEditor":39,"editors/textEditor":40,"helpers/browser":43,renderers:88,"renderers/autocompleteRenderer":90,"renderers/checkboxRenderer":91,"renderers/htmlRenderer":92,"renderers/numericRenderer":93,"renderers/passwordRenderer":94,"renderers/textRenderer":95,"validators/autocompleteValidator":100,"validators/dateValidator":101,"validators/numericValidator":102}],25:[function(n){"use strict";var r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt=(r=n("numeral"),r&&r.__esModule&&r||{"default":r}).default,it=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),st=it.addClass,vt=it.empty,yt=it.isChildOfWebComponentTable,pt=it.removeClass,ht=(f=n("helpers/setting"),f&&f.__esModule&&f||{"default":f}).columnFactory,wt=(e=n("dataMap"),e&&e.__esModule&&e||{"default":e}).DataMap,bt=(o=n("editorManager"),o&&o.__esModule&&o||{"default":o}).EditorManager,kt=(s=n("eventManager"),s&&s.__esModule&&s||{"default":s}).eventManager,rt=(h=n("helpers/object"),h&&h.__esModule&&h||{"default":h}),i=rt.extend,ct=rt.duckSchema,lt=rt.isObjectEquals,dt=rt.deepClone,gt=(c=n("helpers/array"),c&&c.__esModule&&c||{"default":c}).arrayFlatten,ni=(l=n("plugins"),l&&l.__esModule&&l||{"default":l}).getPlugin,ti=(a=n("renderers"),a&&a.__esModule&&a||{"default":a}).getRenderer,ii=(v=n("helpers/string"),v&&v.__esModule&&v||{"default":v}).randomString,ft=(y=n("helpers/number"),y&&y.__esModule&&y||{"default":y}).rangeEach,ri=(p=n("tableView"),p&&p.__esModule&&p||{"default":p}).TableView,ui=(w=n("dataSource"),w&&w.__esModule&&w||{"default":w}).DataSource,et=(b=n("helpers/data"),b&&b.__esModule&&b||{"default":b}),fi=et.translateRowsToColumns,ot=et.cellMethodLookupFactory,ei=et.spreadsheetColumnLabel,t=(k=n("3rdparty/walkontable/src/cell/coords"),k&&k.__esModule&&k||{"default":k}).WalkontableCellCoords,at=(d=n("3rdparty/walkontable/src/cell/range"),d&&d.__esModule&&d||{"default":d}).WalkontableCellRange,si=(g=n("3rdparty/walkontable/src/selection"),g&&g.__esModule&&g||{"default":g}).WalkontableSelection,oi=(nt=n("3rdparty/walkontable/src/calculator/viewportColumns"),nt&&nt.__esModule&&nt||{"default":nt}).WalkontableViewportColumnsCalculator,ut;Handsontable.activeGuid=null;Handsontable.Core=function(n,r){function v(){var n=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++;n=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&n==!1){n=!0;this.onQueueEmpty(this.valid)}}}}function y(n,t,i){function a(){var r;n.length&&(r=Handsontable.hooks.run(u,"beforeChange",n,t),typeof r=="function"?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):r===!1&&n.splice(0,n.length));i()}var o=new v,r,s;for(o.onQueueEmpty=a,r=n.length-1;r>=0;r--)if(n[r]===null)n.splice(r,1);else{var h=n[r][0],c=e.propToCol(n[r][1]),l=u.runHooks("modifyCol",c),f=u.getCellMeta(h,l);f.type==="numeric"&&typeof n[r][3]=="string"&&n[r][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(n[r][3])||f.format)&&(s=n[r][3].length,typeof f.language=="undefined"?tt.language("en"):n[r][3].indexOf(".")===s-3&&n[r][3].indexOf(",")===-1?tt.language("en"):tt.language(f.language),tt.validate(n[r][3])&&(n[r][3]=tt().unformat(n[r][3])));u.getCellValidator(f)&&(o.addValidatorToQueue(),u.validateCell(n[r][3],f,function(t,i){return function(r){if(typeof r!="boolean")throw new Error("Validation error: result is not boolean");r===!1&&i.allowInvalid===!1&&(n.splice(t,1),i.valid=!0,--t);o.removeValidatorFormQueue()}}(r,f),t))}o.checkIfQueueIsEmpty()}function p(n,t){var i=n.length-1;if(!(i<0)){for(;0<=i;i--){if(n[i]===null){n.splice(i,1);continue}if(n[i][2]!=null||n[i][3]!=null){if(f.settings.allowInsertRow)while(n[i][0]>u.countRows()-1)e.createRow();if(u.dataType==="array"&&f.settings.allowInsertColumn)while(e.propToCol(n[i][1])>u.countCols()-1)e.createCol();e.set(n[i][0],n[i][1],n[i][3])}}u.forceFullRender=!0;c.adjustRowsAndCols();Handsontable.hooks.run(u,"beforeChangeRender",n,t);o.refreshBorders(null,!0);u.view.wt.wtOverlays.adjustElementsSize();Handsontable.hooks.run(u,"afterChange",n,t||"edit")}}function w(n,t,i){return typeof n=="object"?n:[[n,t,i]]}function a(n){var t,r,i;if(n.hasOwnProperty("type")){if(r={},typeof n.type=="object")t=n.type;else if(typeof n.type=="string"&&(t=Handsontable.cellTypes[n.type],t===void 0))throw new Error('You declared cell type "'+n.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(i in t)t.hasOwnProperty(i)&&!n.hasOwnProperty(i)&&(r[i]=t[i]);return r}}function d(n){return Handsontable.hooks.run(u,"modifyRow",n)}function g(n){return Handsontable.hooks.run(u,"modifyCol",n)}function nt(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed");}var f,e,h,c,o,l,u=this,s=function(){},k=kt(u),b;i(s.prototype,ut.prototype);i(s.prototype,r);i(s.prototype,a(r));this.rootElement=n;this.isHotTableEnv=yt(this.rootElement);Handsontable.eventManager.isHotTableEnv=this.isHotTableEnv;this.container=document.createElement("DIV");this.renderCall=!1;n.insertBefore(this.container,n.firstChild);this.guid="ht_"+ii();this.rootElement.id&&this.rootElement.id.substring(0,3)!=="ht_"||(this.rootElement.id=this.guid);f={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new s,selRange:null,isPopulated:null,scrollable:null,firstRun:!0};c={alter:function(n,t,i,r,s){var h,v,w,y,a,l,b,p;i=i||1;switch(n){case"insert_row":if(u.getSettings().maxRows===u.countSourceRows())return;h=e.createRow(t,i);h&&(o.isSelected()&&f.selRange.from.row>=t?(f.selRange.from.row=f.selRange.from.row+h,o.transformEnd(h,0)):o.refreshBorders());break;case"insert_col":h=e.createCol(t,i);h&&(Array.isArray(u.getSettings().colHeaders)&&(v=[t,0],v.length+=h,Array.prototype.splice.apply(u.getSettings().colHeaders,v)),o.isSelected()&&f.selRange.from.col>=t?(f.selRange.from.col=f.selRange.from.col+h,o.transformEnd(0,h)):o.refreshBorders());break;case"remove_row":e.removeRow(t,i);f.cellSettings.splice(t,i);w=u.countRows();y=u.getSettings().fixedRowsTop;y>=t+1&&(u.getSettings().fixedRowsTop-=Math.min(i,y-t));a=u.getSettings().fixedRowsBottom;a&&w-a<=t+1&&(u.getSettings().fixedRowsBottom-=Math.min(i,a-t));c.adjustRowsAndCols();o.refreshBorders();break;case"remove_col":for(e.removeCol(t,i),l=0,b=e.getAll().length;l<b;l++)l in f.cellSettings&&f.cellSettings[l].splice(t,i);p=u.getSettings().fixedColumnsLeft;p>=t+1&&(u.getSettings().fixedColumnsLeft-=Math.min(i,p-t));Array.isArray(u.getSettings().colHeaders)&&(typeof t=="undefined"&&(t=-1),u.getSettings().colHeaders.splice(t,i));c.adjustRowsAndCols();o.refreshBorders();break;default:throw new Error('There is no such action "'+n+'"');}s||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var v,y,p,a,c,s,h;if(f.settings.minRows&&(v=u.countRows(),v<f.settings.minRows))for(y=0,p=f.settings.minRows;y<p-v;y++)e.createRow(u.countRows(),1,!0);if(f.settings.minSpareRows&&(a=u.countEmptyRows(!0),a<f.settings.minSpareRows))for(;a<f.settings.minSpareRows&&u.countRows()<f.settings.maxRows;a++)e.createRow(u.countRows(),1,!0);if((f.settings.minCols||f.settings.minSpareCols)&&(c=u.countEmptyCols(!0)),f.settings.minCols&&!f.settings.columns&&u.countCols()<f.settings.minCols)for(;u.countCols()<f.settings.minCols;c++)e.createCol(u.countCols(),1,!0);if(f.settings.minSpareCols&&!f.settings.columns&&u.dataType==="array"&&c<f.settings.minSpareCols)for(;c<f.settings.minSpareCols&&u.countCols()<f.settings.maxCols;c++)e.createCol(u.countCols(),1,!0);if(s=u.countRows(),h=u.countCols(),(s===0||h===0)&&o.deselect(),o.isSelected()){var l=!1,n=f.selRange.from.row,t=f.selRange.from.col,i=f.selRange.to.row,r=f.selRange.to.col;n>s-1?(n=s-1,l=!0,i>n&&(i=n)):i>s-1&&(i=s-1,l=!0,n>i&&(n=i));t>h-1?(t=h-1,l=!0,r>t&&(r=t)):r>h-1&&(r=h-1,l=!0,t>r&&(t=r));l&&u.selectCell(n,t,i,r)}u.view&&u.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(n,t,i,r,e,o,s){var c,a,l,v,ut=[],h={},k,d,ft,et,wt,g,yt,pt;if(a=t.length,a===0)return!1;wt={row:i===null?null:i.row,col:i===null?null:i.col};switch(e){case"shift_down":for(k=i?i.col-n.col+1:0,d=i?i.row-n.row+1:0,t=fi(t),l=0,v=t.length,ft=Math.max(v,k);l<ft;l++)if(l<v){for(c=0,a=t[l].length;c<d-a;c++)t[l].push(t[l][c%a]);t[l].unshift(n.col+l,n.row,0);u.spliceCol.apply(u,t[l])}else t[l%v][0]=n.col+l,u.spliceCol.apply(u,t[l%v]);break;case"shift_right":for(k=i?i.col-n.col+1:0,d=i?i.row-n.row+1:0,c=0,a=t.length,et=Math.max(a,d);c<et;c++)if(c<a){for(l=0,v=t[c].length;l<k-v;l++)t[c].push(t[c][l%v]);t[c].unshift(n.row+c,n.col,0);u.spliceRow.apply(u,t[c])}else t[c%a][0]=n.row+c,u.spliceRow.apply(u,t[c%a]);break;case"overwrite":default:h.row=n.row;h.col=n.col;var bt={row:i&&n?i.row-n.row+1:1,col:i&&n?i.col-n.col+1:1},ot=0,nt=0,w=!0,b,st=function(n){var r=arguments[1]!==void 0?arguments[1]:null,i=t[n%t.length];return r!==null?i[r%i.length]:i},ht=t.length,tt=i?i.row-n.row+1:0;for(a=i?tt:Math.max(ht,tt),c=0;c<a;c++){if(i&&h.row>i.row&&tt>ht||!f.settings.allowInsertRow&&h.row>u.countRows()-1||h.row>=f.settings.maxRows)break;var it=c-ot,at=st(it).length,rt=i?i.col-n.col+1:0;if(v=i?rt:Math.max(at,rt),h.col=n.col,b=u.getCellMeta(h.row,h.col),(r==="paste"||r==="autofill")&&b.skipRowOnPaste){ot++;h.row++;a++;continue}for(nt=0,l=0;l<v;l++){if(i&&h.col>i.col&&rt>at||!f.settings.allowInsertColumn&&h.col>u.countCols()-1||h.col>=f.settings.maxCols)break;if(b=u.getCellMeta(h.row,h.col),(r==="paste"||r==="autofill")&&b.skipColumnOnPaste){nt++;h.col++;v++;continue}if(b.readOnly){h.col++;continue}var vt=l-nt,y=st(it,vt),p=u.getDataAtCell(h.row,h.col),kt={row:it,col:vt};r==="autofill"&&(g=u.runHooks("beforeAutofillInsidePopulate",kt,o,t,s,{},bt),g&&(y=typeof g.value=="undefined"?y:g.value));y!==null&&typeof y=="object"?p===null||typeof p!="object"?w=!1:(yt=ct(p[0]||p),pt=ct(y[0]||y),lt(yt,pt)?y=dt(y):w=!1):p!==null&&typeof p=="object"&&(w=!1);w&&ut.push([h.row,h.col,y]);w=!0;h.col++}h.row++}u.setDataAtCell(ut,null,null,r||"populateFromArray")}}};this.selection=o={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(n,t){u.selection.selectedHeader.rows=n;u.selection.selectedHeader.cols=t},begin:function(){u.selection.inProgress=!0},finish:function(){var n=u.getSelected();Handsontable.hooks.run(u,"afterSelectionEnd",n[0],n[1],n[2],n[3]);Handsontable.hooks.run(u,"afterSelectionEndByProp",n[0],u.colToProp(n[1]),n[2],u.colToProp(n[3]));u.selection.inProgress=!1},isInProgress:function(){return u.selection.inProgress},setRangeStart:function(n,t){Handsontable.hooks.run(u,"beforeSetRangeStart",n);f.selRange=new at(n,n,n);o.setRangeEnd(n,null,t)},setRangeEnd:function(n,i,r){if(f.selRange!==null){var s,c=!1,l=!0,a=u.view.wt.wtTable.getFirstVisibleRow(),v=u.view.wt.wtTable.getFirstVisibleColumn(),h={row:null,col:null};Handsontable.hooks.run(u,"beforeSetRangeEnd",n);u.selection.begin();h.row=n.row<0?a:n.row;h.col=n.col<0?v:n.col;f.selRange.to=new t(h.row,h.col);f.settings.multiSelect||(f.selRange.from=n);u.view.wt.selections.current.clear();s=u.getCellMeta(f.selRange.highlight.row,f.selRange.highlight.col).disableVisualSelection;typeof s=="string"&&(s=[s]);(s===!1||Array.isArray(s)&&s.indexOf("current")===-1)&&u.view.wt.selections.current.add(f.selRange.highlight);u.view.wt.selections.area.clear();(s===!1||Array.isArray(s)&&s.indexOf("area")===-1)&&o.isMultiple()&&(u.view.wt.selections.area.add(f.selRange.from),u.view.wt.selections.area.add(f.selRange.to));(f.settings.currentRowClassName||f.settings.currentColClassName)&&(u.view.wt.selections.highlight.clear(),u.view.wt.selections.highlight.add(f.selRange.from),u.view.wt.selections.highlight.add(f.selRange.to));Handsontable.hooks.run(u,"afterSelection",f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col);Handsontable.hooks.run(u,"afterSelectionByProp",f.selRange.from.row,e.colToProp(f.selRange.from.col),f.selRange.to.row,e.colToProp(f.selRange.to.col));(f.selRange.from.row===0&&f.selRange.to.row===u.countRows()-1&&u.countRows()>1||f.selRange.from.col===0&&f.selRange.to.col===u.countCols()-1&&u.countCols()>1)&&(c=!0);(n.row<0||n.col<0)&&(l=!1);i!==!1&&!c&&l&&(f.selRange.from&&!o.isMultiple()?u.view.scrollViewport(f.selRange.from):u.view.scrollViewport(n));o.refreshBorders(null,r)}},refreshBorders:function(n,t){t||l.destroyEditor(n);u.view.render();o.isSelected()&&!t&&l.prepareEditor()},isMultiple:function(){var n=!(f.selRange.to.col===f.selRange.from.col&&f.selRange.to.row===f.selRange.from.row),t=Handsontable.hooks.run(u,"afterIsMultipleSelection",n);if(n)return t},transformStart:function(n,i,r,e){var s=new t(n,i),a=0,v=0,c,l,h,y;u.runHooks("modifyTransformStart",s);c=u.countRows();l=u.countCols();y=u.getSettings().fixedRowsBottom;f.selRange.highlight.row+n>c-1?r&&f.settings.minSpareRows>0&&!(y&&f.selRange.highlight.row>=c-y-1)?(u.alter("insert_row",c),c=u.countRows()):f.settings.autoWrapCol&&(s.row=1-c,s.col=f.selRange.highlight.col+s.col==l-1?1-l:1):f.settings.autoWrapCol&&f.selRange.highlight.row+s.row<0&&f.selRange.highlight.col+s.col>=0&&(s.row=c-1,s.col=f.selRange.highlight.col+s.col==0?l-1:-1);f.selRange.highlight.col+s.col>l-1?r&&f.settings.minSpareCols>0?(u.alter("insert_col",l),l=u.countCols()):f.settings.autoWrapRow&&(s.row=f.selRange.highlight.row+s.row==c-1?1-c:1,s.col=1-l):f.settings.autoWrapRow&&f.selRange.highlight.col+s.col<0&&f.selRange.highlight.row+s.row>=0&&(s.row=f.selRange.highlight.row+s.row==0?c-1:-1,s.col=l-1);h=new t(f.selRange.highlight.row+s.row,f.selRange.highlight.col+s.col);h.row<0?(a=-1,h.row=0):h.row>0&&h.row>=c&&(a=1,h.row=c-1);h.col<0?(v=-1,h.col=0):h.col>0&&h.col>=l&&(v=1,h.col=l-1);u.runHooks("afterModifyTransformStart",h,a,v);o.setRangeStart(h,e)},transformEnd:function(n,i){var e=new t(n,i),s=0,h=0,c,l,r;u.runHooks("modifyTransformEnd",e);c=u.countRows();l=u.countCols();r=new t(f.selRange.to.row+e.row,f.selRange.to.col+e.col);r.row<0?(s=-1,r.row=0):r.row>0&&r.row>=c&&(s=1,r.row=c-1);r.col<0?(h=-1,r.col=0):r.col>0&&r.col>=l&&(h=1,r.col=l-1);u.runHooks("afterModifyTransformEnd",r,s,h);o.setRangeEnd(r,!0)},isSelected:function(){return f.selRange!==null},inInSelection:function(n){return o.isSelected()?f.selRange.includes(n):!1},deselect:function(){o.isSelected()&&(u.selection.inProgress=!1,f.selRange=null,u.view.wt.selections.current.clear(),u.view.wt.selections.area.clear(),(f.settings.currentRowClassName||f.settings.currentColClassName)&&u.view.wt.selections.highlight.clear(),l.destroyEditor(),o.refreshBorders(),Handsontable.hooks.run(u,"afterDeselect"))},selectAll:function(){f.settings.multiSelect&&(o.setRangeStart(new t(0,0)),o.setRangeEnd(new t(u.countRows()-1,u.countCols()-1),!1))},empty:function(){if(o.isSelected()){for(var i=f.selRange.getTopLeftCorner(),r=f.selRange.getBottomRightCorner(),t,e=[],n=i.row;n<=r.row;n++)for(t=i.col;t<=r.col;t++)u.getCellMeta(n,t).readOnly||e.push([n,t,""]);u.setDataAtCell(e)}}};this.init=function(){h=new ui(u,f.settings.data);Handsontable.hooks.run(u,"beforeInit");Handsontable.mobileBrowser&&st(u.rootElement,"mobile");this.updateSettings(f.settings,!0);this.view=new ri(this);l=new bt(u,f,o,e);this.forceFullRender=!0;Handsontable.hooks.run(u,"init");this.view.render();typeof f.firstRun=="object"&&(Handsontable.hooks.run(u,"afterChange",f.firstRun[0],f.firstRun[1]),f.firstRun=!1);Handsontable.hooks.run(u,"afterInit")};this.validateCell=function(n,t,i,r){function e(n){var r=t.physicalCol,f=t.physicalRow,e=u.getCell(f,r,!0);e&&u.view.wt.wtSettings.settings.cellRenderer(f,r,e);i(n)}var f=u.getCellValidator(t);Object.prototype.toString.call(f)==="[object RegExp]"&&(f=function(n){return function(t,i){i(n.test(t))}}(f));typeof f=="function"?(n=Handsontable.hooks.run(u,"beforeValidate",n,t.row,t.prop,r),u._registerTimeout(setTimeout(function(){f.call(t,n,function(i){i=Handsontable.hooks.run(u,"afterValidate",i,n,t.row,t.prop,r);t.valid=i;e(i);Handsontable.hooks.run(u,"postAfterValidate",i,n,t.row,t.prop,r)})},0))):(t.valid=!0,e(t.valid))};this.setDataAtCell=function(n,t,i,r){for(var f=w(n,t,i),o=[],s,u=0,h=f.length;u<h;u++){if(typeof f[u]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof f[u][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=e.colToProp(f[u][1]);o.push([f[u][0],s,e.get(f[u][0],s),f[u][2]])}r||typeof n!="object"||(r=t);y(o,r,function(){p(o,r)})};this.setDataAtRowProp=function(n,t,i,r){for(var f=w(n,t,i),o=[],u=0,s=f.length;u<s;u++)o.push([f[u][0],f[u][1],e.get(f[u][0],f[u][1]),f[u][2]]);r||typeof n!="object"||(r=t);y(o,r,function(){p(o,r)})};this.listen=function(){Handsontable.activeGuid=u.guid};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===u.guid};this.destroyEditor=function(n){o.refreshBorders(n)};this.populateFromArray=function(n,i,r,u,f,e,o,s,h){var l;if(!(typeof r=="object"&&typeof r[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");return l=typeof u=="number"?new t(u,f):null,c.populateFromArray(new t(n,i),r,l,e,o,s,h)};this.spliceCol=function(){return e.spliceCol.apply(e,arguments)};this.spliceRow=function(){return e.spliceRow.apply(e,arguments)};this.getSelected=function(){if(o.isSelected())return[f.selRange.from.row,f.selRange.from.col,f.selRange.to.row,f.selRange.to.col]};this.getSelectedRange=function(){if(o.isSelected())return f.selRange};this.render=function(){u.view&&(u.renderCall=!0,u.forceFullRender=!0,o.refreshBorders(null,!0))};this.loadData=function(n){function a(){f.cellSettings.length=0}var t,i,o,r,l;if(typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null)for(n=[],i=0,o=f.settings.startRows;i<o;i++){for(t=[],r=0,l=f.settings.startCols;r<l;r++)t.push(null);n.push(t)}else throw new Error("loadData only accepts array of objects or array of arrays ("+typeof n+" given)");f.isPopulated=!1;s.prototype.data=n;u.dataType=Array.isArray(f.settings.dataSchema)||Array.isArray(n[0])?"array":typeof f.settings.dataSchema=="function"?"function":"object";e=new wt(u,f,s);h.data=n;h.dataType=u.dataType;h.colToProp=e.colToProp.bind(e);h.propToCol=e.propToCol.bind(e);a();c.adjustRowsAndCols();Handsontable.hooks.run(u,"afterLoadData",f.firstRun);f.firstRun?f.firstRun=[null,"loadData"]:(Handsontable.hooks.run(u,"afterChange",null,"loadData"),u.render());f.isPopulated=!0};this.getData=function(n,i,r,u){return typeof n=="undefined"?e.getAll():e.getRange(new t(n,i),new t(r,u),e.DESTINATION_RENDERER)};this.getCopyableText=function(n,i,r,u){return e.getCopyableText(new t(n,i),new t(r,u))};this.getCopyableData=function(n,t){return e.getCopyable(n,e.colToProp(t))};this.getSchema=function(){return e.getSchema()};this.updateSettings=function(n,t){var r,y,p,w,v,h,l;if(typeof n.rows!="undefined")throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(typeof n.cols!="undefined")throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(r in n)if(r==="data")continue;else Handsontable.hooks.getRegistered().indexOf(r)>-1?(typeof n[r]=="function"||Array.isArray(n[r]))&&u.addHook(r,n[r]):!t&&n.hasOwnProperty(r)&&(s.prototype[r]=n[r]);if(n.data===void 0&&f.settings.data===void 0?u.loadData(null):n.data!==void 0?u.loadData(n.data):n.columns!==void 0&&e.createMap(),y=u.countCols(),f.cellSettings.length=0,y>0)for(r=0;r<y;r++)f.columnSettings[r]=ht(s,f.columnsSettingConflicts),p=f.columnSettings[r].prototype,s.prototype.columns&&(w=s.prototype.columns[r],i(p,w),i(p,a(w)));if(typeof n.cell!="undefined")for(r in n.cell)n.cell.hasOwnProperty(r)&&(v=n.cell[r],u.setCellMetaObject(v.row,v.col,v));Handsontable.hooks.run(u,"afterCellMetaReset");typeof n.className!="undefined"&&(s.prototype.className&&pt(u.rootElement,s.prototype.className),n.className&&st(u.rootElement,n.className));typeof n.height!="undefined"&&(h=n.height,typeof h=="function"&&(h=h()),u.rootElement.style.height=h+"px");typeof n.width!="undefined"&&(l=n.width,typeof l=="function"&&(l=l()),u.rootElement.style.width=l+"px");h&&(u.rootElement.style.overflow="hidden");t||Handsontable.hooks.run(u,"afterUpdateSettings");c.adjustRowsAndCols();u.view&&!f.firstRun&&(u.forceFullRender=!0,o.refreshBorders(null,!0))};this.getValue=function(){var n=u.getSelected();if(s.prototype.getValue){if(typeof s.prototype.getValue=="function")return s.prototype.getValue.call(u);if(n)return u.getData()[n[0]][s.prototype.getValue]}else if(n)return u.getDataAtCell(n[0],n[1])};this.getSettings=function(){return f.settings};this.clear=function(){o.selectAll();o.empty()};this.alter=function(n,t,i,r,u){c.alter(n,t,i,r,u)};this.getCell=function(n,i,r){return u.view.getCellAtCoords(new t(n,i),r)};this.getCoords=function(n){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,n)};this.colToProp=function(n){return e.colToProp(n)};this.propToCol=function(n){return e.propToCol(n)};this.getDataAtCell=function(n,t){return e.get(n,e.colToProp(t))};this.getDataAtRowProp=function(n,t){return e.get(n,t)};this.getDataAtCol=function(n){var i=[];return i.concat.apply(i,e.getRange(new t(0,n),new t(f.settings.data.length-1,n),e.DESTINATION_RENDERER))};this.getDataAtProp=function(n){var i=[],r;return r=e.getRange(new t(0,e.propToCol(n)),new t(f.settings.data.length-1,e.propToCol(n)),e.DESTINATION_RENDERER),i.concat.apply(i,r)};this.getSourceData=function(n,i,r,u){return n===void 0?h.getData():h.getByRange(new t(n,i),new t(r,u))};this.getSourceDataAtCol=function(n){return h.getAtColumn(n)};this.getSourceDataAtRow=function(n){return h.getAtRow(n)};this.getSourceDataAtCell=function(n,t){return h.getAtCell(n,t)};this.getDataAtRow=function(n){var i=e.getRange(new t(n,0),new t(n,this.countCols()-1),e.DESTINATION_RENDERER);return i[0]};this.getDataType=function(n,t,i,r){var o=this,f=null,u=null,e;return n===void 0&&(n=0,i=this.countRows(),t=0,r=this.countCols()),i===void 0&&(i=n),r===void 0&&(r=t),e="mixed",ft(Math.min(n,i),Math.max(n,i),function(n){var i=!0;return ft(Math.min(t,r),Math.max(t,r),function(t){var r=o.getCellMeta(n,t);return u=r.type,f?i=f===u:f=u,i}),e=i?u:"mixed",i}),e};this.removeCellMeta=function(n,t,i){var r=u.getCellMeta(n,t);r[i]!=undefined&&delete f.cellSettings[n][t][i]};this.setCellMetaObject=function(n,t,i){var r,u;if(typeof i=="object")for(r in i)i.hasOwnProperty(r)&&(u=i[r],this.setCellMeta(n,t,r,u))};this.setCellMeta=function(n,t,i,r){f.cellSettings[n]||(f.cellSettings[n]=[]);f.cellSettings[n][t]||(f.cellSettings[n][t]=new f.columnSettings[t]);f.cellSettings[n][t][i]=r;Handsontable.hooks.run(u,"afterSetCellMeta",n,t,i,r)};this.getCellsMeta=function(){return gt(f.cellSettings)};this.getCellMeta=function(n,t){var h=e.colToProp(t),r,c=n,l=t,o;return n=d(n),t=g(t),f.columnSettings[t]||(f.columnSettings[t]=ht(s,f.columnsSettingConflicts)),f.cellSettings[n]||(f.cellSettings[n]=[]),f.cellSettings[n][t]||(f.cellSettings[n][t]=new f.columnSettings[t]),r=f.cellSettings[n][t],r.row=n,r.col=t,r.physicalRow=c,r.physicalCol=l,r.prop=h,r.instance=u,Handsontable.hooks.run(u,"beforeGetCellMeta",n,t,r),i(r,a(r)),r.cells&&(o=r.cells.call(r,n,t,h),o&&(i(r,o),i(r,a(o)))),Handsontable.hooks.run(u,"afterGetCellMeta",n,t,r),r};this.isColumnModificationAllowed=function(){return!(u.dataType==="object"||u.getSettings().columns)};b=ot("renderer");this.getCellRenderer=function(n,t){var i=b.call(this,n,t);return ti(i)};this.getCellEditor=ot("editor");this.getCellValidator=ot("validator");this.validateCells=function(n){var t=new v,i,r;for(t.onQueueEmpty=n,i=u.countRows()-1;i>=0;){for(r=u.countCols()-1;r>=0;)t.addValidatorToQueue(),u.validateCell(u.getDataAtCell(i,r),u.getCellMeta(i,r),function(n){if(typeof n!="boolean")throw new Error("Validation error: result is not boolean");n===!1&&(t.valid=!1);t.removeValidatorFormQueue()},"validateCells"),r--;i--}t.checkIfQueueIsEmpty()};this.getRowHeader=function(n){var t=f.settings.rowHeaders;return n!==void 0&&(n=Handsontable.hooks.run(u,"modifyRowHeader",n)),n===void 0?(t=[],ft(u.countRows()-1,function(n){t.push(u.getRowHeader(n))})):Array.isArray(t)&&t[n]!==void 0?t=t[n]:typeof t=="function"?t=t(n):t&&typeof t!="string"&&typeof t!="number"&&(t=n+1),t};this.hasRowHeaders=function(){return!!f.settings.rowHeaders};this.hasColHeaders=function(){if(f.settings.colHeaders!==void 0&&f.settings.colHeaders!==null)return!!f.settings.colHeaders;for(var n=0,t=u.countCols();n<t;n++)if(u.getColHeader(n))return!0;return!1};this.getColHeader=function(n){var i,t,r,e;if(n=Handsontable.hooks.run(u,"modifyColHeader",n),n===void 0){for(i=[],t=0,r=u.countCols();t<r;t++)i.push(u.getColHeader(t));return i}return e=n,n=Handsontable.hooks.run(u,"modifyCol",n),f.settings.columns&&f.settings.columns[n]&&f.settings.columns[n].title?f.settings.columns[n].title:Array.isArray(f.settings.colHeaders)&&f.settings.colHeaders[n]!==void 0?f.settings.colHeaders[n]:typeof f.settings.colHeaders=="function"?f.settings.colHeaders(n):f.settings.colHeaders&&typeof f.settings.colHeaders!="string"&&typeof f.settings.colHeaders!="number"?ei(e):f.settings.colHeaders};this._getColWidthFromSettings=function(n){var i=u.getCellMeta(0,n),t=i.width;if((t===void 0||t===f.settings.width)&&(t=i.colWidths),t!==void 0&&t!==null){switch(typeof t){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getColWidth=function(n){var t=u._getColWidthFromSettings(n);return t=Handsontable.hooks.run(u,"modifyColWidth",t,n),t===void 0&&(t=oi.DEFAULT_WIDTH),t};this._getRowHeightFromSettings=function(n){var t=f.settings.rowHeights;if(t!==void 0&&t!==null){switch(typeof t){case"object":t=t[n];break;case"function":t=t(n)}typeof t=="string"&&(t=parseInt(t,10))}return t};this.getRowHeight=function(n){var t=u._getRowHeightFromSettings(n);return Handsontable.hooks.run(u,"modifyRowHeight",t,n)};this.countSourceRows=function(){return u.getSourceData()?u.getSourceData().length:0};this.countRows=function(){return e.getLength()};this.countCols=function(){return u.dataType==="object"||u.dataType==="function"?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:e.colToPropCache.length:u.dataType==="array"?f.settings.columns&&f.settings.columns.length?f.settings.columns.length:f.settings.data&&f.settings.data[0]&&f.settings.data[0].length?f.settings.data[0].length:0:void 0};this.getColspanOffset=function(n,t){var r=0,i;if(u.colspanArray){for(i=0;i<n;i++)r+=u.colspanArray[t][i]-1||0;return r}var r=0,o=u.view.wt.wtTable.THEAD.childNodes.length-t-1,f=u.view.wt.wtTable.THEAD.querySelector("tr:nth-child("+parseInt(o+1,10)+")"),e=u.view.wt.wtSettings.settings.rowHeaders().length;for(i=e;i<e+n;i++)f.childNodes[i].hasAttribute("colspan")&&(r+=parseInt(f.childNodes[i].getAttribute("colspan"),10)-1);return r};this.getHeaderColspan=function(n,t){var f=u.view.wt.wtTable.THEAD.childNodes.length-t-1,e=u.view.wt.wtSettings.settings.rowHeaders().length,i=u.view.wt.wtTable.THEAD.querySelector("tr:nth-child("+parseInt(f+1,10)+")"),r=e+n-u.view.wt.wtViewport.columnsRenderCalculator.startColumn;return i.childNodes[r].hasAttribute("colspan")?parseInt(i.childNodes[r].getAttribute("colspan"),10):0};this.rowOffset=function(){return u.view.wt.wtTable.getFirstRenderedRow()};this.colOffset=function(){return u.view.wt.wtTable.getFirstRenderedColumn()};this.countRenderedRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedRowsCount():-1};this.countVisibleRows=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleRowsCount():-1};this.countRenderedCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getRenderedColumnsCount():-1};this.countVisibleCols=function(){return u.view.wt.drawn?u.view.wt.wtTable.getVisibleColumnsCount():-1};this.countEmptyRows=function(n){for(var t=u.countRows()-1,i=0,r;t>=0;){if(r=Handsontable.hooks.run(this,"modifyRow",t),u.isEmptyRow(r))i++;else if(n)break;t--}return i};this.countEmptyCols=function(n){if(u.countRows()<1)return 0;for(var t=u.countCols()-1,i=0;t>=0;){if(u.isEmptyCol(t))i++;else if(n)break;t--}return i};this.isEmptyRow=function(n){return f.settings.isEmptyRow.call(u,n)};this.isEmptyCol=function(n){return f.settings.isEmptyCol.call(u,n)};this.selectCell=function(n,i,r,e,s,h){var c;return(h=typeof h=="undefined"||h===!0,typeof n!="number"||n<0||n>=u.countRows())?!1:typeof i!="number"||i<0||i>=u.countCols()?!1:typeof r!="undefined"&&(typeof r!="number"||r<0||r>=u.countRows()||typeof e!="number"||e<0||e>=u.countCols())?!1:(c=new t(n,i),f.selRange=new at(c,c,c),h&&u.listen(),typeof r=="undefined"?o.setRangeEnd(f.selRange.from,s):o.setRangeEnd(new t(r,e),s),u.selection.finish(),!0)};this.selectCellByProp=function(){return arguments[1]=e.propToCol(arguments[1]),typeof arguments[3]!="undefined"&&(arguments[3]=e.propToCol(arguments[3])),u.selectCell.apply(u,arguments)};this.deselectCell=function(){o.deselect()};this.destroy=function(){u._clearTimeouts();u.view&&u.view.destroy();h&&h.destroy();h=null;vt(u.rootElement);k.destroy();Handsontable.hooks.run(u,"afterDestroy");Handsontable.hooks.destroy(u);for(var n in u)u.hasOwnProperty(n)&&(typeof u[n]=="function"?u[n]=nt:n!=="guid"&&(u[n]=null));f=null;e=null;c=null;o=null;l=null;u=null;s=null};this.getActiveEditor=function(){return l.getActiveEditor()};this.getPlugin=function(n){return ni(this,n)};this.getInstance=function(){return u};this.addHook=function(n,t){Handsontable.hooks.add(n,t,u)};this.hasHook=function(n){return Handsontable.hooks.has(n,u)};this.addHookOnce=function(n,t){Handsontable.hooks.once(n,t,u)};this.removeHook=function(n,t){Handsontable.hooks.remove(n,t,u)};this.runHooks=function(n,t,i,r,f,e,o){return Handsontable.hooks.run(u,n,t,i,r,f,e,o)};this.timeouts=[];this._registerTimeout=function(n){this.timeouts.push(n)};this._clearTimeouts=function(){for(var n=0,t=this.timeouts.length;n<t;n++)clearTimeout(this.timeouts[n])};this.onPasteCustom=null;this.version=Handsontable.version;Handsontable.hooks.run(u,"construct")};ut=function(){};ut.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(n){for(var t,u,i=0,r=this.countCols();i<r;i++)if(t=this.getDataAtCell(n,i),t!==""&&t!==null&&typeof t!="undefined")return typeof t=="object"?(u=this.getCellMeta(n,i),lt(this.getSchema()[u.prop],t)):!1;return!0},isEmptyCol:function(n){for(var i,t=0,r=this.countRows();t<r;t++)if(i=this.getDataAtCell(t,n),i!==""&&i!==null&&typeof i!="undefined")return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:!1,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,renderAllRows:void 0};Handsontable.DefaultSettings=ut},{"3rdparty/walkontable/src/calculator/viewportColumns":3,"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/selection":18,dataMap:26,dataSource:27,editorManager:28,eventManager:41,"helpers/array":42,"helpers/data":44,"helpers/dom/element":45,"helpers/number":49,"helpers/object":50,"helpers/setting":51,"helpers/string":52,numeral:"numeral",plugins:57,renderers:88,tableView:97}],26:[function(n,t,i){"use strict";function r(n,t,i){this.instance=n;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{};this.createMap()}var p;Object.defineProperties(i,{DataMap:{get:function(){return r}},__esModule:{value:!0}});var u,f,e,o,s,h,c,l=(u=n("SheetClip"),u&&u.__esModule&&u||{"default":u}).default,w=(f=n("helpers/data"),f&&f.__esModule&&f||{"default":f}).cellMethodLookupFactory,b=(e=n("helpers/setting"),e&&e.__esModule&&e||{"default":e}).columnFactory,a=(o=n("helpers/object"),o&&o.__esModule&&o||{"default":o}),k=a.duckSchema,d=a.deepExtend,v=(s=n("helpers/array"),s&&s.__esModule&&s||{"default":s}),y=v.extendArray,g=v.to2dArray,nt=(h=n("helpers/number"),h&&h.__esModule&&h||{"default":h}).rangeEach,tt=(c=n("multiMap"),c&&c.__esModule&&c||{"default":c}).MultiMap;r.prototype.DESTINATION_RENDERER=1;r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;r.prototype.recursiveDuckSchema=function(n){return k(n)};r.prototype.recursiveDuckColumns=function(n,t,i){var u,r;if(typeof t=="undefined"&&(t=0,i=""),typeof n=="object"&&!Array.isArray(n))for(r in n)n.hasOwnProperty(r)&&(n[r]===null?(u=i+r,this.colToPropCache.push(u),this.propToColCache.set(u,t),t++):t=this.recursiveDuckColumns(n[r],t,r+"."));return t};r.prototype.createMap=function(){var n,i,r=this.getSchema(),t;if(typeof r=="undefined")throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");if(this.colToPropCache=[],this.propToColCache=new tt,t=this.instance.getSettings().columns,t)for(n=0,i=t.length;n<i;n++)typeof t[n].data!="undefined"&&(this.colToPropCache[n]=t[n].data,this.propToColCache.set(t[n].data,n));else this.recursiveDuckColumns(r)};r.prototype.colToProp=function(n){return(n=Handsontable.hooks.run(this.instance,"modifyCol",n),this.colToPropCache&&typeof this.colToPropCache[n]!="undefined")?this.colToPropCache[n]:n};r.prototype.propToCol=function(n){var t;return t=typeof this.propToColCache.get(n)=="undefined"?n:this.propToColCache.get(n),Handsontable.hooks.run(this.instance,"modifyCol",t)};r.prototype.getSchema=function(){var n=this.instance.getSettings().dataSchema;return n?typeof n=="function"?n():n:this.duckSchema};r.prototype.createRow=function(n,t,i){var r,s=this.instance.countCols(),u=0,e,o,f;for(t||(t=1),(typeof n!="number"||n>=this.instance.countSourceRows())&&(n=this.instance.countSourceRows()),e=n,o=this.instance.getSettings().maxRows;u<t&&this.instance.countSourceRows()<o;){if(this.instance.dataType==="array")for(r=[],f=0;f<s;f++)r.push(null);else this.instance.dataType==="function"?r=this.instance.getSettings().dataSchema(n):(r={},d(r,this.getSchema()));n===this.instance.countSourceRows()?this.dataSource.push(r):this.dataSource.splice(n,0,r);u++;e++}return Handsontable.hooks.run(this.instance,"afterCreateRow",n,u,i),this.instance.forceFullRender=!0,u};r.prototype.createCol=function(n,t,i){var h,r;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.instance.countSourceRows(),u=this.dataSource,o,f=0,e;for(t||(t=1),e=n,h=this.instance.getSettings().maxCols;f<t&&this.instance.countCols()<h;){if(o=b(this.GridSettings,this.priv.columnsSettingConflicts),typeof n!="number"||n>=this.instance.countCols()){for(r=0;r<s;r++)typeof u[r]=="undefined"&&(u[r]=[]),u[r].push(null);this.priv.columnSettings.push(o)}else{for(r=0;r<s;r++)u[r].splice(e,0,null);this.priv.columnSettings.splice(e,0,o)}f++;e++}return Handsontable.hooks.run(this.instance,"afterCreateCol",n,f,i),this.instance.forceFullRender=!0,f};r.prototype.removeRow=function(n,t){var i,u,r,f;(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countSourceRows()+n)%this.instance.countSourceRows(),i=this.physicalRowsToLogical(n,t),u=Handsontable.hooks.run(this.instance,"beforeRemoveRow",n,t,i),u!==!1)&&(r=this.dataSource,f=r.filter(function(n,t){return i.indexOf(t)==-1}),r.length=0,Array.prototype.push.apply(r,f),Handsontable.hooks.run(this.instance,"afterRemoveRow",n,t,i),this.instance.forceFullRender=!0)};r.prototype.removeCol=function(n,t){var r,u,i,f;if(this.instance.dataType==="object"||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(t||(t=1),typeof n!="number"&&(n=-t),n=(this.instance.countCols()+n)%this.instance.countCols(),r=Handsontable.hooks.run(this.instance,"beforeRemoveCol",n,t),r!==!1){for(u=this.dataSource,i=0,f=this.instance.countSourceRows();i<f;i++)u[i].splice(n,t);this.priv.columnSettings.splice(n,t);Handsontable.hooks.run(this.instance,"afterRemoveCol",n,t);this.instance.forceFullRender=!0}};r.prototype.spliceCol=function(n,t,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],f=this.instance.getDataAtCol(n),e=f.slice(t,t+i),o=f.slice(t+i),u;for(y(r,o),u=0;u<i;)r.push(null),u++;return g(r),this.instance.populateFromArray(t,n,r,null,null,"spliceCol"),e};r.prototype.spliceRow=function(n,t,i){var r=4<=arguments.length?[].slice.call(arguments,3):[],f=this.instance.getSourceDataAtRow(n),e=f.slice(t,t+i),o=f.slice(t+i),u;for(y(r,o),u=0;u<i;)r.push(null),u++;return this.instance.populateFromArray(n,t,[r],null,null,"spliceRow"),e};r.prototype.get=function(n,t){var u,i,r,f;if(n=Handsontable.hooks.run(this.instance,"modifyRow",n),typeof t=="string"&&t.indexOf(".")>-1){if(u=t.split("."),i=this.dataSource[n],!i)return null;for(r=0,f=u.length;r<f;r++)if(i=i[u[r]],typeof i=="undefined")return null;return i}return typeof t=="function"?t(this.dataSource.slice(n,n+1)[0]):this.dataSource[n]&&this.dataSource[n].hasOwnProperty&&this.dataSource[n].hasOwnProperty(t)?this.dataSource[n][t]:null};p=w("copyable",!1);r.prototype.getCopyable=function(n,t){return p.call(this.instance,n,this.propToCol(t))?this.get(n,t):""};r.prototype.set=function(n,t,i,r){var f,e,u,o;if(n=Handsontable.hooks.run(this.instance,"modifyRow",n,r||"datamapGet"),typeof t=="string"&&t.indexOf(".")>-1){for(f=t.split("."),e=this.dataSource[n],u=0,o=f.length-1;u<o;u++)typeof e[f[u]]=="undefined"&&(e[f[u]]={}),e=e[f[u]];e[f[u]]=i}else typeof t=="function"?t(this.dataSource.slice(n,n+1)[0],i):this.dataSource[n][t]=i};r.prototype.physicalRowsToLogical=function(n,t){for(var i=this.instance.countSourceRows(),r=(i+n)%i,u=[],f=t,e;r<i&&f;)e=Handsontable.hooks.run(this.instance,"modifyRow",r),u.push(e),f--,r++;return u};r.prototype.clear=function(){for(var t,n=0;n<this.instance.countSourceRows();n++)for(t=0;t<this.instance.countCols();t++)this.set(n,this.colToProp(t),"")};r.prototype.getLength=function(){var t=this,n=this.instance.countSourceRows();return Handsontable.hooks.has("modifyRow",this.instance)&&nt(this.instance.countSourceRows()-1,function(i){i=Handsontable.hooks.run(t.instance,"modifyRow",i);i===null&&n--}),n};r.prototype.getAll=function(){var n={row:0,col:0},t={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return n.row-t.row==0&&!this.instance.countSourceRows()?[]:this.getRange(n,t,r.prototype.DESTINATION_RENDERER)};r.prototype.getRange=function(n,t,i){var r,o,u,s,h=[],f,c=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,e;for(o=Math.max(n.row,t.row),s=Math.max(n.col,t.col),r=Math.min(n.row,t.row);r<=o;r++){for(f=[],e=Handsontable.hooks.run(this.instance,"modifyRow",r),u=Math.min(n.col,t.col);u<=s;u++){if(e===null)break;f.push(c.call(this,r,this.colToProp(u)))}e!==null&&h.push(f)}return h};r.prototype.getText=function(n,t){return l.stringify(this.getRange(n,t,this.DESTINATION_RENDERER))};r.prototype.getCopyableText=function(n,t){return l.stringify(this.getRange(n,t,this.DESTINATION_CLIPBOARD_GENERATOR))};Handsontable.DataMap=r},{SheetClip:"SheetClip","helpers/array":42,"helpers/data":44,"helpers/number":49,"helpers/object":50,"helpers/setting":51,multiMap:55}],27:[function(n,t,i){"use strict";Object.defineProperties(i,{DataSource:{get:function(){return l}},__esModule:{value:!0}});var r,u,f,e,o,y=(r=n("helpers/data"),r&&r.__esModule&&r||{"default":r}).cellMethodLookupFactory,p=(u=n("helpers/setting"),u&&u.__esModule&&u||{"default":u}).columnFactory,s=(f=n("helpers/object"),f&&f.__esModule&&f||{"default":f}),w=s.duckSchema,b=s.deepExtend,a=s.getProperty,h=(e=n("helpers/array"),e&&e.__esModule&&e||{"default":e}),k=h.extendArray,v=h.arrayEach,c=(o=n("helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach,l=function(n,t){this.hot=n;this.data=t;this.dataType="array";this.colToProp=function(){};this.propToCol=function(){}};$traceurRuntime.createClass(l,{getData:function(){return this.data},getAtColumn:function(n){var i=this,t=[];return v(this.data,function(r){var u=i.colToProp(n);r=typeof u=="string"?a(r,u):r[u];t.push(r)}),t},getAtRow:function(n){return this.data[n]},getAtCell:function(n,t){return this.data[n][this.colToProp(t)]},getByRange:function(n,t){var i=this,e=Math.min(n.row,t.row),r=Math.min(n.col,t.col),o=Math.max(n.row,t.row),u=Math.max(n.col,t.col),f=[];return c(e,o,function(n){var e=i.getAtRow(n),t;i.dataType==="array"?t=e.slice(r,u):i.dataType==="object"&&(t={},c(r,u,function(n){var r=i.colToProp(n);t[r]=e[r]}));f.push(t)}),f},destroy:function(){this.data=null;this.hot=null}},{})},{"helpers/array":42,"helpers/data":44,"helpers/number":49,"helpers/object":50,"helpers/setting":51}],28:[function(n,t,i){"use strict";function v(n,t,i){function o(n){var r=typeof t.settings.enterMoves=="function"?t.settings.enterMoves(event):t.settings.enterMoves;n?i.transformStart(-r.row,-r.col):i.transformStart(r.row,r.col,!0)}function l(n){n?i.transformEnd(-1,0):i.transformStart(-1,0)}function a(n){n?i.transformEnd(1,0):i.transformStart(1,0)}function v(n){n?i.transformEnd(0,1):i.transformStart(0,1)}function d(n){n?i.transformEnd(0,-1):i.transformStart(0,-1)}function g(h){var k,g,nt;if(n.isListening()&&(Handsontable.hooks.run(n,"beforeKeyDown",h),!s)&&!b(h)&&(t.lastKeyCode=h.keyCode,i.isSelected())){if(k=(h.ctrlKey||h.metaKey)&&!h.altKey,f&&!f.isWaiting()&&!y(h.keyCode)&&!p(h.keyCode)&&!k&&!e.isEditorOpened()){e.openEditor("",h);return}g=h.shiftKey?i.setRangeEnd:i.setRangeStart;switch(h.keyCode){case r.A:!e.isEditorOpened()&&k&&(i.selectAll(),h.preventDefault(),u(h));break;case r.ARROW_UP:e.isEditorOpened()&&!f.isWaiting()&&e.closeEditorAndSaveChanges(k);l(h.shiftKey);h.preventDefault();u(h);break;case r.ARROW_DOWN:e.isEditorOpened()&&!f.isWaiting()&&e.closeEditorAndSaveChanges(k);a(h.shiftKey);h.preventDefault();u(h);break;case r.ARROW_RIGHT:e.isEditorOpened()&&!f.isWaiting()&&e.closeEditorAndSaveChanges(k);v(h.shiftKey);h.preventDefault();u(h);break;case r.ARROW_LEFT:e.isEditorOpened()&&!f.isWaiting()&&e.closeEditorAndSaveChanges(k);d(h.shiftKey);h.preventDefault();u(h);break;case r.TAB:nt=typeof t.settings.tabMoves=="function"?t.settings.tabMoves(h):t.settings.tabMoves;h.shiftKey?i.transformStart(-nt.row,-nt.col):i.transformStart(nt.row,nt.col,!0);h.preventDefault();u(h);break;case r.BACKSPACE:case r.DELETE:i.empty(h);e.prepareEditor();h.preventDefault();break;case r.F2:e.openEditor(null,h);f&&f.enableFullEditMode();h.preventDefault();break;case r.ENTER:e.isEditorOpened()?(f&&f.state!==Handsontable.EditorState.WAITING&&e.closeEditorAndSaveChanges(k),o(h.shiftKey)):n.getSettings().enterBeginsEditing?(e.openEditor(null,h),f&&f.enableFullEditMode()):o(h.shiftKey);h.preventDefault();w(h);break;case r.ESCAPE:e.isEditorOpened()&&e.closeEditorAndRestoreOriginalValue(k);h.preventDefault();break;case r.HOME:h.ctrlKey||h.metaKey?g(new c(0,t.selRange.from.col)):g(new c(t.selRange.from.row,0));h.preventDefault();u(h);break;case r.END:h.ctrlKey||h.metaKey?g(new c(n.countRows()-1,t.selRange.from.col)):g(new c(t.selRange.from.row,n.countCols()-1));h.preventDefault();u(h);break;case r.PAGE_UP:i.transformStart(-n.countVisibleRows(),0);h.preventDefault();u(h);break;case r.PAGE_DOWN:i.transformStart(n.countVisibleRows(),0);h.preventDefault();u(h)}}}function nt(){function t(n,t,i){i.nodeName=="TD"&&(e.openEditor(),f&&f.enableFullEditMode())}n.addHook("afterDocumentKeyDown",g);h.addEventListener(document.documentElement,"keydown",function(t){n.runHooks("afterDocumentKeyDown",t)});n.view.wt.update("onCellDblClick",t);n.addHook("afterDestroy",function(){s=!0})}var e=this,s=!1,h,f;h=k(n);this.destroyEditor=function(n){this.closeEditor(n)};this.getActiveEditor=function(){return f};this.prepareEditor=function(){var r,i,s,h,c,u,o;if(f&&f.isWaiting()){this.closeEditor(!1,!1,function(n){n&&e.prepareEditor()});return}r=t.selRange.highlight.row;i=t.selRange.highlight.col;s=n.colToProp(i);h=n.getCell(r,i);c=n.getDataAtCell(r,i);u=n.getCellMeta(r,i);o=n.getCellEditor(u);o?(f=Handsontable.editors.getEditor(o,n),f.prepare(r,i,s,h,c,u)):f=void 0};this.isEditorOpened=function(){return f&&f.isOpened()};this.openEditor=function(n,t){f&&!f.cellProperties.readOnly?f.beginEditing(n,t):f&&f.cellProperties.readOnly&&t&&t.keyCode===r.ENTER&&o()};this.closeEditor=function(n,t,i){f?f.finishEditing(n,t,i):i&&i(!1)};this.closeEditorAndSaveChanges=function(n){return this.closeEditor(!1,n)};this.closeEditorAndRestoreOriginalValue=function(n){return this.closeEditor(!0,n)};nt()}Object.defineProperties(i,{EditorManager:{get:function(){return v}},__esModule:{value:!0}});var f,e,o,s,h,c=(f=n("3rdparty/walkontable/src/cell/coords"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords,l=(e=n("helpers/unicode"),e&&e.__esModule&&e||{"default":e}),r=l.KEY_CODES,y=l.isMetaKey,p=l.isCtrlKey,a=(o=n("helpers/dom/event"),o&&o.__esModule&&o||{"default":o}),u=a.stopPropagation,w=a.stopImmediatePropagation,b=a.isImmediatePropagationStopped,d=(s=n("editors"),s&&s.__esModule&&s||{"default":s}).getEditor,k=(h=n("eventManager"),h&&h.__esModule&&h||{"default":h}).eventManager;Handsontable.EditorManager=v},{"3rdparty/walkontable/src/cell/coords":5,editors:29,eventManager:41,"helpers/dom/event":46,"helpers/unicode":53}],29:[function(n,t,i){"use strict";function h(n){var i,t;t={};i=n;this.getConstructor=function(){return n};this.getInstance=function(n){return n.guid in t||(t[n.guid]=new i(n)),t[n.guid]}}function e(n,t){var i=new h(t);typeof n=="string"&&(u[n]=i,Handsontable.editors[s(n)+"Editor"]=t);f.set(t,i)}function o(n,t){var i;if(typeof n=="function")f.get(n)||e(null,n),i=f.get(n);else if(typeof n=="string")i=u[n];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!i)throw Error('No editor registered under name "'+n+'"');return i.getInstance(t)}function c(n){var t;if(typeof n=="string")t=u[n];else throw Error('Only strings and functions can be passed as "editor" parameter ');if(!t)throw Error('No editor registered under name "'+n+'"');return t.getConstructor()}function l(n){return u[n]?!0:!1}Object.defineProperties(i,{registerEditor:{get:function(){return e}},getEditor:{get:function(){return o}},hasEditor:{get:function(){return l}},getEditorConstructor:{get:function(){return c}},__esModule:{value:!0}});var r,s=(r=n("helpers/string"),r&&r.__esModule&&r||{"default":r}).toUpperCaseFirst,u={},f=new WeakMap;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.registerEditor=e;Handsontable.editors.getEditor=o},{"helpers/string":52}],30:[function(n,t,i){"use strict";function r(n){this.instance=n;this.state=Handsontable.EditorState.VIRGIN;this._opened=!1;this._fullEditMode=!1;this._closeCallback=null;this.init()}Object.defineProperties(i,{BaseEditor:{get:function(){return r}},__esModule:{value:!0}});var u,f,e=(u=n("helpers/mixed"),u&&u.__esModule&&u||{"default":u}).stringify,o=(f=n("3rdparty/walkontable/src/cell/coords"),f&&f.__esModule&&f||{"default":f}).WalkontableCellCoords;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.BaseEditor=r;Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};r.prototype._fireCallbacks=function(n){this._closeCallback&&(this._closeCallback(n),this._closeCallback=null)};r.prototype.init=function(){};r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented");};r.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented");};r.prototype.open=function(){throw Error("Editor open() method unimplemented");};r.prototype.close=function(){throw Error("Editor close() method unimplemented");};r.prototype.prepare=function(n,t,i,r,u,f){this.TD=r;this.row=n;this.col=t;this.prop=i;this.originalValue=u;this.cellProperties=f;this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus();this.state=Handsontable.EditorState.VIRGIN};r.prototype.extend=function(){function t(){n.apply(this,arguments)}function i(n,t){function i(){}return i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n}var n=this.constructor;return i(t,n)};r.prototype.saveValue=function(n,t){var i,r;t?(i=this.instance.getSelected(),i[0]>i[2]&&(r=i[0],i[0]=i[2],i[2]=r),i[1]>i[3]&&(r=i[1],i[1]=i[3],i[3]=r),this.instance.populateFromArray(i[0],i[1],n,i[2],i[3],"edit")):this.instance.populateFromArray(this.row,this.col,n,null,null,"edit")};r.prototype.beginEditing=function(n,t){this.state==Handsontable.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new o(this.row,this.col)),this.instance.view.render(),this.state=Handsontable.EditorState.EDITING,n=typeof n=="string"?n:this.originalValue,this.setValue(e(n)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render())};r.prototype.finishEditing=function(n,t,i){var r=this,f,u;if(i&&(u=this._closeCallback,this._closeCallback=function(n){u&&u(n);i(n)}),!this.isWaiting()){if(this.state==Handsontable.EditorState.VIRGIN){this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));return}if(this.state==Handsontable.EditorState.EDITING){if(n){this.cancelChanges();this.instance.view.render();return}f=this.instance.getSettings().trimWhitespace?[[typeof this.getValue()=="string"?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]];this.state=Handsontable.EditorState.WAITING;this.saveValue(f,t);this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(n){r.state=Handsontable.EditorState.FINISHED;r.discardEditor(n)}):(this.state=Handsontable.EditorState.FINISHED,this.discardEditor(!0))}}};r.prototype.cancelChanges=function(){this.state=Handsontable.EditorState.FINISHED;this.discardEditor()};r.prototype.discardEditor=function(n){this.state===Handsontable.EditorState.FINISHED&&(n===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=Handsontable.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Handsontable.EditorState.VIRGIN,this._fireCallbacks(!0)))};r.prototype.enableFullEditMode=function(){this._fullEditMode=!0};r.prototype.isInFullEditMode=function(){return this._fullEditMode};r.prototype.isOpened=function(){return this._opened};r.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING};r.prototype.checkEditorSection=function(){var t=this.instance.countRows(),n="";return this.row<this.instance.getSettings().fixedRowsTop?n=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=t-this.instance.getSettings().fixedRowsBottom?n=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(n="left"),n}},{"3rdparty/walkontable/src/cell/coords":5,"helpers/mixed":48}],31:[function(n,t,i){"use strict";function g(n){var t,i;if(v=!1,t=this.getActiveEditor(),nt(n.keyCode)||n.keyCode===f.BACKSPACE||n.keyCode===f.DELETE||n.keyCode===f.INSERT){if(i=0,n.keyCode===f.C&&(n.ctrlKey||n.metaKey))return;t.isOpened()||(i+=10);t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value);v=!0},i))}}var v;Object.defineProperties(i,{AutocompleteEditor:{get:function(){return r}},__esModule:{value:!0}});var o,s,h,c,l,a,p=(o=n("helpers/unicode"),o&&o.__esModule&&o||{"default":o}),f=p.KEY_CODES,nt=p.isPrintableChar,w=(s=n("helpers/mixed"),s&&s.__esModule&&s||{"default":s}).stringify,tt=(h=n("helpers/array"),h&&h.__esModule&&h||{"default":h}).pivot,e=(c=n("helpers/dom/element"),c&&c.__esModule&&c||{"default":c}),b=e.addClass,it=e.getCaretPosition,y=e.getScrollbarWidth,rt=e.getSelectionEndPosition,k=e.outerWidth,ut=e.setCaretPosition,d=(l=n("editors"),l&&l.__esModule&&l||{"default":l}),et=d.getEditorConstructor,ft=d.registerEditor,u=(a=n("handsontableEditor"),a&&a.__esModule&&a||{"default":a}).HandsontableEditor,r=u.prototype.extend();r.prototype.init=function(){u.prototype.init.apply(this,arguments);this.query=null;this.choices=[]};r.prototype.createElements=function(){u.prototype.createElements.apply(this,arguments);b(this.htContainer,"autocompleteEditor");b(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};v=!1;r.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",g);u.prototype.prepare.apply(this,arguments)};r.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto";u.prototype.open.apply(this,arguments);this.TEXTAREA_PARENT.style.overflow="";var i=this.htEditor.getInstance(),n=this,t=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible";this.focus();i.updateSettings({colWidths:t?[k(this.TEXTAREA)-2]:void 0,width:t?k(this.TEXTAREA)+y()+2:void 0,afterRenderer:function(t,i,r,u,f){var s=this.getCellMeta(i,r).filteringCaseSensitive===!0,e,o,f=w(f);f&&(e=s?f.indexOf(this.query):f.toLowerCase().indexOf(n.query.toLowerCase()),e!=-1&&(o=f.substr(e,n.query.length),t.innerHTML=f.replace(o,"<strong>"+o+"<\/strong>")))},autoColumnSize:!0,modifyColWidth:function(n,i){var r=this.getPlugin("autoColumnSize").widths;return r[i]&&(n=r[i]),t?n:n+15}});this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=y()+2+"px";v&&(v=!1);n.instance._registerTimeout(setTimeout(function(){n.queryChoices(n.TEXTAREA.value)},0))};r.prototype.close=function(){u.prototype.close.apply(this,arguments)};r.prototype.queryChoices=function(n){var i,t,r,u;this.query=n;typeof this.cellProperties.source=="function"?(i=this,this.cellProperties.source(n,function(n){i.updateChoicesList(n)})):Array.isArray(this.cellProperties.source)?(n&&this.cellProperties.filter!==!1?(r=this.cellProperties.filteringCaseSensitive===!0,u=n.toLowerCase(),t=this.cellProperties.source.filter(function(t){return r?t.indexOf(n)!=-1:t.toLowerCase().indexOf(u)!=-1})):t=this.cellProperties.source,this.updateChoicesList(t)):this.updateChoicesList([])};r.prototype.updateChoicesList=function(n){var e=it(this.TEXTAREA),o=rt(this.TEXTAREA),i=r.sortByRelevance(this.getValue(),n,this.cellProperties.filteringCaseSensitive),u,f,t,s;if(this.cellProperties.filter==!1)u=i[0];else{for(f=[],t=0,s=i.length;t<s;t++)f.push(n[i[t]]);u=0;n=f}this.choices=n;this.htEditor.loadData(tt([n]));this.updateDropdownHeight();this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u);this.instance.listen();this.TEXTAREA.focus();ut(this.TEXTAREA,e,e==o?void 0:o)};r.prototype.updateDropdownHeight=function(){var n=this.htEditor.getColWidth(0)+y()+2,t=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:n});this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()};r.prototype.finishEditing=function(n){n||this.instance.removeHook("beforeKeyDown",g);u.prototype.finishEditing.apply(this,arguments)};r.prototype.highlightBestMatchingChoice=function(n){typeof n=="number"?this.htEditor.selectCell(n,0):this.htEditor.deselectCell()};r.sortByRelevance=function(n,t,i){var e=[],f,h=n.length,o,c,s=[],r,u;if(h===0){for(r=0,u=t.length;r<u;r++)s.push(r);return s}for(r=0,u=t.length;r<u;r++)(f=w(t[r]),o=i?f.indexOf(n):f.toLowerCase().indexOf(n.toLowerCase()),o!=-1)&&(c=f.length-o-h,e.push({baseIndex:r,index:o,charsLeft:c,value:f}));for(e.sort(function(n,t){return t.index===-1?-1:n.index===-1?1:n.index<t.index?-1:t.index<n.index?1:n.index===t.index?n.charsLeft<t.charsLeft?-1:n.charsLeft>t.charsLeft?1:0:void 0}),r=0,u=e.length;r<u;r++)s.push(e[r].baseIndex);return s};r.prototype.getDropdownHeight=function(){var n=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.choices.length>=t?t*n:this.choices.length*n+8};r.prototype.allowKeyEventPropagation=function(n){var i={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},t=!1;return n===f.ARROW_DOWN&&i.row<this.htEditor.countRows()-1&&(t=!0),n===f.ARROW_UP&&i.row>-1&&(t=!0),t};ft("autocomplete",r)},{editors:29,handsontableEditor:35,"helpers/array":42,"helpers/dom/element":45,"helpers/mixed":48,"helpers/unicode":53}],32:[function(n,t,i){"use strict";Object.defineProperties(i,{CheckboxEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,o=(r=n("editors"),r&&r.__esModule&&r||{"default":r}).registerEditor,s=(u=n("_baseEditor"),u&&u.__esModule&&u||{"default":u}).BaseEditor,h=(f=n("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}).hasClass,e=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=e;$traceurRuntime.createClass(e,{beginEditing:function(){var n=this.TD.querySelector('input[type="checkbox"]');h(n,"htBadValue")||n.click()},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},s);o("checkbox",e)},{_baseEditor:30,editors:29,"helpers/dom/element":45}],33:[function(n,t,i){"use strict";var f,r;Object.defineProperties(i,{DateEditor:{get:function(){return f}},__esModule:{value:!0}});var e,o,s,h,c,l,a,v,y,p=(e=n("helpers/dom/element"),e&&e.__esModule&&e||{"default":e}),k=p.addClass,d=p.outerHeight,g=(o=n("helpers/object"),o&&o.__esModule&&o||{"default":o}).deepExtend,nt=(s=n("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager,w=(h=n("editors"),h&&h.__esModule&&h||{"default":h}),ft=w.getEditor,tt=w.registerEditor,it=(c=n("helpers/unicode"),c&&c.__esModule&&c||{"default":c}).isMetaKey,rt=(l=n("helpers/dom/event"),l&&l.__esModule&&l||{"default":l}).stopPropagation,ut=(a=n("textEditor"),a&&a.__esModule&&a||{"default":a}).TextEditor,u=(v=n("moment"),v&&v.__esModule&&v||{"default":v}).default,b=(y=n("pikaday"),y&&y.__esModule&&y||{"default":y}).default;Handsontable.editors=Handsontable.editors||{};Handsontable.editors.DateEditor=f;f=function(n){this.$datePicker=null;this.datePicker=null;this.datePickerStyle=null;this.defaultDateFormat="DD/MM/YYYY";this.isCellEdited=!1;this.parentDestroyed=!1;$traceurRuntime.superConstructor(r).call(this,n)};r=f;$traceurRuntime.createClass(f,{init:function(){var n=this;if(typeof u!="function")throw new Error("You need to include moment.js to your project.");if(typeof b!="function")throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,r.prototype,"init").call(this);this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0;n.destroyElements()})},createElements:function(){$traceurRuntime.superGet(this,r.prototype,"createElements").call(this);this.datePicker=document.createElement("DIV");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=9999;k(this.datePicker,"htDatepickerHolder");document.body.appendChild(this.datePicker);this.$datePicker=new b(this.getDatePickerConfig());var n=new nt(this);n.addEventListener(this.datePicker,"mousedown",function(n){return rt(n)});this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(n,t,i,u,f,e){this._opened=!1;$traceurRuntime.superGet(this,r.prototype,"prepare").call(this,n,t,i,u,f,e)},open:function(){var n=arguments[0]!==void 0?arguments[0]:null;$traceurRuntime.superGet(this,r.prototype,"open").call(this);this.showDatepicker(n)},close:function(){var n=this;this._opened=!1;this.instance._registerTimeout(setTimeout(function(){n.instance.selection.refreshBorders()},0));$traceurRuntime.superGet(this,r.prototype,"close").call(this)},finishEditing:function(){var t=arguments[0]!==void 0?arguments[0]:!1,i=arguments[1]!==void 0?arguments[1]:!1,n;t&&(n=this.originalValue,n!==void 0&&this.setValue(n));this.hideDatepicker();$traceurRuntime.superGet(this,r.prototype,"finishEditing").call(this,t,i)},showDatepicker:function(n){this.$datePicker.config(this.getDatePickerConfig());var r=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,f=this.$datePicker.config(),t,e=this.instance.view.isMouseDown(),o=n?it(n.keyCode):!1;this.datePickerStyle.top=window.pageYOffset+r.top+d(this.TD)+"px";this.datePickerStyle.left=window.pageXOffset+r.left+"px";this.$datePicker._onInputFocus=function(){};f.format=i;this.originalValue?(t=this.originalValue,u(t,i,!0).isValid()&&this.$datePicker.setMoment(u(t,i),!0),o||e||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,f.defaultDate=t,u(t,i,!0).isValid()&&this.$datePicker.setMoment(u(t,i),!0),o||e||this.setValue("")):this.$datePicker.gotoToday();this.datePickerStyle.display="block";this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none";this.$datePicker.hide()},getDatePickerConfig:function(){var t=this,f=this.TEXTAREA,n={},i,r;return this.cellProperties&&this.cellProperties.datePickerConfig&&g(n,this.cellProperties.datePickerConfig),i=n.onSelect,r=n.onClose,n.field=f,n.trigger=f,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(n){isNaN(n.getTime())||(n=u(n).format(t.cellProperties.dateFormat||t.defaultDateFormat));t.setValue(n);t.hideDatepicker();i&&i()},n.onClose=function(){t.parentDestroyed||t.finishEditing(!1);r&&r()},n}},{},ut);tt("date",f)},{editors:29,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/object":50,"helpers/unicode":53,moment:"moment",pikaday:"pikaday",textEditor:40}],34:[function(n,t,i){"use strict";Object.defineProperties(i,{DropdownEditor:{get:function(){return f}},__esModule:{value:!0}});var r,u,e=(r=n("editors"),r&&r.__esModule&&r||{"default":r}),c=e.getEditor,s=e.registerEditor,h=(u=n("autocompleteEditor"),u&&u.__esModule&&u||{"default":u}).AutocompleteEditor,f=function(){$traceurRuntime.superConstructor(o).apply(this,arguments)},o=f;$traceurRuntime.createClass(f,{prepare:function(n,t,i,r,u,f){$traceurRuntime.superGet(this,o.prototype,"prepare").call(this,n,t,i,r,u,f);this.cellProperties.filter=!1;this.cellProperties.strict=!0}},{},h);Handsontable.hooks.add("beforeValidate",function(n,t,i){var r=this.getCellMeta(t,i);r.editor===Handsontable.editors.DropdownEditor&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});s("dropdown",f)},{autocompleteEditor:31,editors:29}],35:[function(n,t,i){"use strict";var l;Object.defineProperties(i,{HandsontableEditor:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,s,h,c,a=(f=n("helpers/unicode"),f&&f.__esModule&&f||{"default":f}).KEY_CODES,p=(e=n("helpers/object"),e&&e.__esModule&&e||{"default":e}).extend,w=(o=n("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}).setCaretPosition,v=(s=n("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),b=v.stopImmediatePropagation,k=v.isImmediatePropagationStopped,y=(h=n("editors"),h&&h.__esModule&&h||{"default":h}),g=y.getEditor,d=y.registerEditor,u=(c=n("textEditor"),c&&c.__esModule&&c||{"default":c}).TextEditor,r=u.prototype.extend();r.prototype.createElements=function(){u.prototype.createElements.apply(this,arguments);var n=document.createElement("DIV");n.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(n);this.htContainer=n;this.assignHooks()};r.prototype.prepare=function(n,t,i,r,f,e){u.prototype.prepare.apply(this,arguments);var o=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(){var n=this.getValue();n!==void 0&&o.setValue(n);o.instance.destroyEditor()}};this.cellProperties.handsontable&&p(s,e.handsontable);this.htOptions=s};l=function(n){var r,t,i,f,u;k(n)||(r=this.getActiveEditor(),t=r.htEditor.getInstance(),n.keyCode==a.ARROW_DOWN?t.getSelected()?(u=t.getSelected()[0],f=t.countRows()-1,i=Math.min(f,u+1)):i=0:n.keyCode==a.ARROW_UP&&t.getSelected()&&(u=t.getSelected()[0],i=u-1),i!==void 0&&(i<0?t.deselectCell():t.selectCell(i,0),t.getData().length&&(n.preventDefault(),b(n),r.instance.listen(),r.TEXTAREA.focus())))};r.prototype.open=function(){this.instance.addHook("beforeKeyDown",l);u.prototype.open.apply(this,arguments);this.htEditor&&this.htEditor.destroy();this.htEditor=new Handsontable(this.htContainer,this.htOptions);this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible");w(this.TEXTAREA,0,this.TEXTAREA.value.length)};r.prototype.close=function(){this.instance.removeHook("beforeKeyDown",l);this.instance.listen();u.prototype.close.apply(this,arguments)};r.prototype.focus=function(){this.instance.listen();u.prototype.focus.apply(this,arguments)};r.prototype.beginEditing=function(){var n=this.instance.getSettings().onBeginEditing;n&&n()===!1||u.prototype.beginEditing.apply(this,arguments)};r.prototype.finishEditing=function(){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();n!==void 0&&this.setValue(n)}return u.prototype.finishEditing.apply(this,arguments)};r.prototype.assignHooks=function(){var n=this;this.instance.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})};d("handsontable",r)},{editors:29,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/object":50,"helpers/unicode":53,textEditor:40}],36:[function(n,t,i){"use strict";Object.defineProperties(i,{MobileTextEditor:{get:function(){return r}},__esModule:{value:!0}});var e,o,s,h,c,l,y=(e=n("helpers/unicode"),e&&e.__esModule&&e||{"default":e}).KEY_CODES,p=(o=n("helpers/dom/event"),o&&o.__esModule&&o||{"default":o}),nt=p.stopImmediatePropagation,tt=p.isImmediatePropagationStopped,u=(s=n("helpers/dom/element"),s&&s.__esModule&&s||{"default":s}),a=u.addClass,it=u.getScrollLeft,rt=u.getScrollTop,ut=u.hasClass,w=u.isChildOf,b=u.offset,k=u.outerHeight,v=u.outerWidth,d=u.removeClass,ft=u.setCaretPosition,g=(h=n("editors"),h&&h.__esModule&&h||{"default":h}),ct=g.getEditor,et=g.registerEditor,ot=(c=n("_baseEditor"),c&&c.__esModule&&c||{"default":c}).BaseEditor,st=(l=n("eventManager"),l&&l.__esModule&&l||{"default":l}).eventManager,r=ot.prototype.extend(),f={},ht=function(){this.controls={};this.controls.leftButton=document.createElement("DIV");this.controls.leftButton.className="leftButton";this.controls.rightButton=document.createElement("DIV");this.controls.rightButton.className="rightButton";this.controls.upButton=document.createElement("DIV");this.controls.upButton.className="upButton";this.controls.downButton=document.createElement("DIV");this.controls.downButton.className="downButton";for(var n in this.controls)this.controls.hasOwnProperty(n)&&this.positionControls.appendChild(this.controls[n])};r.prototype.valueChanged=function(){return this.initValue!=this.getValue()};r.prototype.init=function(){var n=this;this.eventManager=st(this.instance);this.createElements();this.bindEvents();this.instance.addHook("afterDestroy",function(){n.destroy()})};r.prototype.getValue=function(){return this.TEXTAREA.value};r.prototype.setValue=function(n){this.initValue=n;this.TEXTAREA.value=n};r.prototype.createElements=function(){this.editorContainer=document.createElement("DIV");this.editorContainer.className="htMobileEditorContainer";this.cellPointer=document.createElement("DIV");this.cellPointer.className="cellPointer";this.moveHandle=document.createElement("DIV");this.moveHandle.className="moveHandle";this.inputPane=document.createElement("DIV");this.inputPane.className="inputs";this.positionControls=document.createElement("DIV");this.positionControls.className="positionControls";this.TEXTAREA=document.createElement("TEXTAREA");a(this.TEXTAREA,"handsontableInput");this.inputPane.appendChild(this.TEXTAREA);this.editorContainer.appendChild(this.cellPointer);this.editorContainer.appendChild(this.moveHandle);this.editorContainer.appendChild(this.inputPane);this.editorContainer.appendChild(this.positionControls);ht.call(this);document.body.appendChild(this.editorContainer)};r.prototype.onBeforeKeyDown=function(n){var i=this,t=i.getActiveEditor();if(n.target===t.TEXTAREA&&!tt(n))switch(n.keyCode){case y.ENTER:t.close();n.preventDefault();break;case y.BACKSPACE:nt(n)}};r.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown);a(this.editorContainer,"active");d(this.cellPointer,"hidden");this.updateEditorPosition()};r.prototype.focus=function(){this.TEXTAREA.focus();ft(this.TEXTAREA,this.TEXTAREA.value.length)};r.prototype.close=function(){this.TEXTAREA.blur();this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown);d(this.editorContainer,"active")};r.prototype.scrollToView=function(){var n=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(n)};r.prototype.hideCellPointer=function(){ut(this.cellPointer,"hidden")||a(this.cellPointer,"hidden")};r.prototype.updateEditorPosition=function(n,t){var u,i;if(n&&t)n=parseInt(n,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=n+"px";else if(u=this.instance.getSelected(),i=this.instance.getCell(u[0],u[1]),f.cellPointer||(f.cellPointer={height:k(this.cellPointer),width:v(this.cellPointer)}),f.editorContainer||(f.editorContainer={width:v(this.editorContainer)}),i!==undefined){var s=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:it(this.instance.view.wt.wtOverlays.leftOverlay.holder),h=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:rt(this.instance.view.wt.wtOverlays.topOverlay.holder),r=b(i),e=v(i),o={x:s,y:h};this.editorContainer.style.top=parseInt(r.top+k(i)-o.y+f.cellPointer.height,10)+"px";this.editorContainer.style.left=parseInt(window.innerWidth/2-f.editorContainer.width/2,10)+"px";r.left+e/2>parseInt(this.editorContainer.style.left,10)+f.editorContainer.width?this.editorContainer.style.left=window.innerWidth-f.editorContainer.width+"px":r.left+e/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px");this.cellPointer.style.left=parseInt(r.left-f.cellPointer.width/2-b(this.editorContainer).left+e/2-o.x,10)+"px"}};r.prototype.updateEditorData=function(){var n=this.instance.getSelected(),t=this.instance.getDataAtCell(n[0],n[1]);this.row=n[0];this.col=n[1];this.setValue(t);this.updateEditorPosition()};r.prototype.prepareAndSave=function(){var n;if(!this.valueChanged())return!0;n=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]];this.saveValue(n)};r.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(0,-1,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(0,1,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(-1,0,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){n.prepareAndSave();n.instance.selection.transformStart(1,0,null,!0);n.updateEditorData();t.preventDefault()});this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(t.touches.length==1){var i=t.touches[0],r={x:n.editorContainer.offsetLeft,y:n.editorContainer.offsetTop},u={x:i.pageX-r.x,y:i.pageY-r.y};n.eventManager.addEventListener(this,"touchmove",function(t){var i=t.touches[0];n.updateEditorPosition(i.pageX-u.x,i.pageY-u.y);n.hideCellPointer();t.preventDefault()})}});this.eventManager.addEventListener(document.body,"touchend",function(t){w(t.target,n.editorContainer)||w(t.target,n.instance.rootElement)||n.close()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(){n.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&n.hideCellPointer()});this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(){n.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&n.hideCellPointer()})};r.prototype.destroy=function(){this.eventManager.clear();this.editorContainer.parentNode.removeChild(this.editorContainer)};et("mobile",r)},{_baseEditor:30,editors:29,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/unicode":53}],37:[function(n,t,i){"use strict";Object.defineProperties(i,{NumericEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,o=(r=n("numeral"),r&&r.__esModule&&r||{"default":r}).default,s=(u=n("editors"),u&&u.__esModule&&u||{"default":u}),a=s.getEditor,c=s.registerEditor,l=(f=n("textEditor"),f&&f.__esModule&&f||{"default":f}).TextEditor,e=function(){$traceurRuntime.superConstructor(h).apply(this,arguments)},h=e;$traceurRuntime.createClass(e,{beginEditing:function(n){if(typeof n=="undefined"&&this.originalValue){typeof this.cellProperties.language!="undefined"&&o.language(this.cellProperties.language);var t=o.languageData().delimiters.decimal;n=(""+this.originalValue).replace(".",t)}$traceurRuntime.superGet(this,h.prototype,"beginEditing").call(this,n)}},{},l);c("numeric",e)},{editors:29,numeral:"numeral",textEditor:40}],38:[function(n,t,i){"use strict";Object.defineProperties(i,{PasswordEditor:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,h=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).empty,o=(u=n("editors"),u&&u.__esModule&&u||{"default":u}),a=o.getEditor,c=o.registerEditor,l=(f=n("textEditor"),f&&f.__esModule&&f||{"default":f}).TextEditor,e=function(){$traceurRuntime.superConstructor(s).apply(this,arguments)},s=e;$traceurRuntime.createClass(e,{createElements:function(){$traceurRuntime.superGet(this,s.prototype,"createElements").call(this);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;h(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},l);c("password",e)},{editors:29,"helpers/dom/element":45,textEditor:40}],39:[function(n,t,i){"use strict";var l;Object.defineProperties(i,{SelectEditor:{get:function(){return r}},__esModule:{value:!0}});var f,e,o,s,h,u=(f=n("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}),b=u.addClass,k=u.empty,d=u.fastInnerHTML,g=u.getComputedStyle,c=u.getCssTransform,nt=u.getScrollableElement,a=u.offset,tt=u.outerHeight,it=u.outerWidth,rt=u.resetCssTransform,v=(e=n("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}).stopImmediatePropagation,y=(o=n("helpers/unicode"),o&&o.__esModule&&o||{"default":o}).KEY_CODES,p=(s=n("editors"),s&&s.__esModule&&s||{"default":s}),ft=p.getEditor,ut=p.registerEditor,w=(h=n("_baseEditor"),h&&h.__esModule&&h||{"default":h}).BaseEditor,r=w.prototype.extend();r.prototype.init=function(){this.select=document.createElement("SELECT");b(this.select,"htSelectEditor");this.select.style.display="none";this.instance.rootElement.appendChild(this.select);this.registerHooks()};r.prototype.registerHooks=function(){var n=this;this.instance.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){return n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){return n.refreshDimensions()});this.instance.addHook("afterRowResize",function(){return n.refreshDimensions()})};r.prototype.prepare=function(){var n,t,i,r;w.prototype.prepare.apply(this,arguments);n=this.cellProperties.selectOptions;t=typeof n=="function"?this.prepareOptions(n(this.row,this.col,this.prop)):this.prepareOptions(n);k(this.select);for(i in t)t.hasOwnProperty(i)&&(r=document.createElement("OPTION"),r.value=i,d(r,t[i]),this.select.appendChild(r))};r.prototype.prepareOptions=function(n){var i={},t,r;if(Array.isArray(n))for(t=0,r=n.length;t<r;t++)i[n[t]]=n[t];else typeof n=="object"&&(i=n);return i};r.prototype.getValue=function(){return this.select.value};r.prototype.setValue=function(n){this.select.value=n};l=function(n){var u=this,t=u.getActiveEditor(),i,r;switch(n.keyCode){case y.ARROW_UP:i=t.select.selectedIndex-1;i>=0&&(t.select[i].selected=!0);v(n);n.preventDefault();break;case y.ARROW_DOWN:r=t.select.selectedIndex+1;r<=t.select.length-1&&(t.select[r].selected=!0);v(n);n.preventDefault()}};r.prototype.open=function(){this._opened=!0;this.refreshDimensions();this.select.style.display="";this.instance.addHook("beforeKeyDown",l)};r.prototype.close=function(){this._opened=!1;this.select.style.display="none";this.instance.removeHook("beforeKeyDown",l)};r.prototype.focus=function(){this.select.focus()};r.prototype.refreshDimensions=function(){var t,i;if(this.state===Handsontable.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var r=it(this.TD)+1,u=tt(this.TD)+1,f=a(this.TD),e=a(this.instance.rootElement),o=nt(this.TD),s=f.top-e.top-1-(o.scrollTop||0),h=f.left-e.left-1-(o.scrollLeft||0),v=this.checkEditorSection(),n,l=this.instance.getSettings(),y=l.rowHeaders?1:0,p=l.colHeaders?1:0;switch(v){case"top":n=c(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=c(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=c(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=c(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=c(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}this.instance.getSelected()[0]===0&&(s+=1);this.instance.getSelected()[1]===0&&(h+=1);t=this.select.style;n&&n!=-1?t[n[0]]=n[1]:rt(this.select);i=g(this.TD);parseInt(i.borderTopWidth,10)>0&&(u-=1);parseInt(i.borderLeftWidth,10)>0&&(r-=1);t.height=u+"px";t.minWidth=r+"px";t.top=s+"px";t.left=h+"px";t.margin="0px"}};r.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=101;break;case"corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.select.style.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.select.style.zIndex=""}if(n!=-1&&n!=-2)return n};ut("select",r)},{_baseEditor:30,editors:29,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/unicode":53}],40:[function(n,t,i){"use strict";var w;Object.defineProperties(i,{TextEditor:{get:function(){return u}},__esModule:{value:!0}});var o,s,h,c,l,a,v,f=(o=n("helpers/dom/element"),o&&o.__esModule&&o||{"default":o}),b=f.addClass,it=f.getCaretPosition,k=f.getComputedStyle,y=f.getCssTransform,rt=f.getScrollableElement,ut=f.innerWidth,d=f.offset,ft=f.resetCssTransform,g=f.setCaretPosition,et=(s=n("autoResize"),s&&s.__esModule&&s||{"default":s}).default,ot=(h=n("_baseEditor"),h&&h.__esModule&&h||{"default":h}).BaseEditor,st=(c=n("eventManager"),c&&c.__esModule&&c||{"default":c}).eventManager,nt=(l=n("editors"),l&&l.__esModule&&l||{"default":l}),lt=nt.getEditor,ht=nt.registerEditor,r=(a=n("helpers/unicode"),a&&a.__esModule&&a||{"default":a}).KEY_CODES,p=(v=n("helpers/dom/event"),v&&v.__esModule&&v||{"default":v}),tt=p.stopPropagation,e=p.stopImmediatePropagation,ct=p.isImmediatePropagationStopped,u=ot.prototype.extend();u.prototype.init=function(){var n=this;this.createElements();this.eventManager=st(this);this.bindEvents();this.autoResize=et();this.instance.addHook("afterDestroy",function(){n.destroy()})};u.prototype.getValue=function(){return this.TEXTAREA.value};u.prototype.setValue=function(n){this.TEXTAREA.value=n};w=function(n){var h=this,t=h.getActiveEditor(),u,i,o;if(u=(n.ctrlKey||n.metaKey)&&!n.altKey,n.target===t.TEXTAREA&&!ct(n)){if(n.keyCode===17||n.keyCode===224||n.keyCode===91||n.keyCode===93){e(n);return}switch(n.keyCode){case r.ARROW_RIGHT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e(n));break;case r.ARROW_LEFT:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e(n));break;case r.ARROW_UP:case r.ARROW_DOWN:t.isInFullEditMode()&&((t.isWaiting()||t.allowKeyEventPropagation)&&(t.isWaiting()||!t.allowKeyEventPropagation||t.allowKeyEventPropagation(n.keyCode))||e(n));break;case r.ENTER:if(i=t.instance.getSelected(),o=!(i[0]===i[2]&&i[1]===i[3]),u&&!o||n.altKey){if(t.isOpened()){var f=it(t.TEXTAREA),s=t.getValue(),c=s.slice(0,f)+"\n"+s.slice(f);t.setValue(c);g(t.TEXTAREA,f+1)}else t.beginEditing(t.originalValue+"\n");e(n)}n.preventDefault();break;case r.A:case r.X:case r.C:case r.V:u&&e(n);break;case r.BACKSPACE:case r.DELETE:case r.HOME:case r.END:e(n)}[r.ARROW_UP,r.ARROW_RIGHT,r.ARROW_DOWN,r.ARROW_LEFT].indexOf(n.keyCode)===-1&&t.autoResize.resize(String.fromCharCode(n.keyCode))}};u.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",w)};u.prototype.close=function(){this.textareaParentStyle.display="none";this.autoResize.unObserve();document.activeElement===this.TEXTAREA&&this.instance.listen();this.instance.removeHook("beforeKeyDown",w)};u.prototype.focus=function(){this.TEXTAREA.focus();g(this.TEXTAREA,this.TEXTAREA.value.length)};u.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA");b(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");b(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var n=this;this.instance._registerTimeout(setTimeout(function(){n.refreshDimensions()},0))};u.prototype.getEditedCell=function(){var t=this.checkEditorSection(),n;switch(t){case"top":n=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=101;break;case"top-left-corner":n=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":n=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=103;break;case"left":n=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;case"bottom":n=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col});this.textareaParentStyle.zIndex=102;break;default:n=this.instance.getCell(this.row,this.col);this.textareaParentStyle.zIndex=""}if(n!=-1&&n!=-2)return n};u.prototype.refreshDimensions=function(){if(this.state===Handsontable.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close(!0);return}var i=d(this.TD),r=d(this.instance.rootElement),u=rt(this.TD),l=this.instance.countRows(),f=i.top-r.top-1-(u.scrollTop||0),e=i.left-r.left-1-(u.scrollLeft||0),t=this.instance.getSettings(),nt=t.rowHeaders?1:0,a=t.colHeaders?1:0,v=this.checkEditorSection(),o=this.TD.style.backgroundColor,n;switch(v){case"top":n=y(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":n=y(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":n=y(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":n=y(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":n=y(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(a&&this.instance.getSelected()[0]===0||t.fixedRowsBottom&&this.instance.getSelected()[0]===l-t.fixedRowsBottom)&&(f+=1);this.instance.getSelected()[1]===0&&(e+=1);n&&n!=-1?this.textareaParentStyle[n[0]]=n[1]:ft(this.textareaParentStyle);this.textareaParentStyle.top=f+"px";this.textareaParentStyle.left=e+"px";var p=this.TD.offsetTop-this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),w=this.TD.offsetLeft-this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),b=ut(this.TD)-8,s=this.instance.view.maximumVisibleElementWidth(w)-9,g=this.TD.scrollHeight+1,h=Math.max(this.instance.view.maximumVisibleElementHeight(p)-2,23),c=k(this.TD);this.TEXTAREA.style.fontSize=c.fontSize;this.TEXTAREA.style.fontFamily=c.fontFamily;this.TEXTAREA.style.backgroundColor="";this.TEXTAREA.style.backgroundColor=o?o:k(this.TEXTAREA).backgroundColor;this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(g,h),maxHeight:h,minWidth:Math.min(b,s),maxWidth:s},!0);this.textareaParentStyle.display="block"}};u.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(n){tt(n)});this.eventManager.addEventListener(this.TEXTAREA,"paste",function(n){tt(n)});this.instance.addHook("afterScrollHorizontally",function(){n.refreshDimensions()});this.instance.addHook("afterScrollVertically",function(){n.refreshDimensions()});this.instance.addHook("afterColumnResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterRowResize",function(){n.refreshDimensions();n.focus()});this.instance.addHook("afterDestroy",function(){n.eventManager.destroy()})};u.prototype.destroy=function(){this.eventManager.destroy()};ht("text",u)},{_baseEditor:30,autoResize:"autoResize",editors:29,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/unicode":53}],41:[function(n,t,i){"use strict";function l(n,t){var f="HOT-TABLE",e,u,s,r,i;if(t.isTargetWebComponent=!1,t.realTarget=t.target,!Handsontable.eventManager.isHotTableEnv)return t;for(t=o(t),i=t.path?t.path.length:0;i--;){if(t.path[i].nodeName===f)e=!0;else if(e&&t.path[i].shadowRoot){r=t.path[i];break}i!==0||r||(r=t.path[i])}return r||(r=t.target),t.isTargetWebComponent=!0,c()?t.realTarget=t.srcElement||t.toElement:(n instanceof Handsontable.Core||n instanceof Walkontable)&&(n instanceof Handsontable.Core?u=n.view?n.view.wt.wtTable.TABLE:null:n instanceof Walkontable&&(u=n.wtTable.TABLE.parentNode.parentNode),s=h(t.target,[f],u),t.realTarget=s?u.querySelector(f)||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return o(r)},enumerable:!0,configurable:!0}),t}function s(n){return new f(n)}Object.defineProperties(i,{EventManager:{get:function(){return f}},eventManager:{get:function(){return s}},__esModule:{value:!0}});var r,u,e=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),o=e.polymerWrap,h=e.closest,c=(u=n("helpers/browser"),u&&u.__esModule&&u||{"default":u}).isWebComponentSupportedNatively,f=function(){var n=arguments[0]!==void 0?arguments[0]:null;this.context=n||this;this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(f,{addEventListener:function(n,t,i){function r(n){n.target==void 0&&n.srcElement!=void 0&&(n.definePoperty?n.definePoperty("target",{value:n.srcElement}):n.target=n.srcElement);n.preventDefault==void 0&&(n.definePoperty?n.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):n.preventDefault=function(){this.returnValue=!1});n=l(f,n);i.call(this,n)}var u=this,f=this.context;return this.context.eventListeners.push({element:n,event:t,callback:i,callbackProxy:r}),window.addEventListener?n.addEventListener(t,r,!1):n.attachEvent("on"+t,r),Handsontable.countEventManagerListeners++,function(){u.removeEventListener(n,t,i)}},removeEventListener:function(n,t,i){for(var u=this.context.eventListeners.length,r;u--;)if(r=this.context.eventListeners[u],r.event==t&&r.element==n){if(i&&i!=r.callback)continue;this.context.eventListeners.splice(u,1);r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy);Handsontable.countEventManagerListeners--}},clearEvents:function(){var t,n;if(this.context)for(t=this.context.eventListeners.length;t--;)n=this.context.eventListeners[t],n&&this.removeEventListener(n.element,n.event,n.callback)},clear:function(){this.clearEvents()},destroy:function(){this.clearEvents();this.context=null},fireEvent:function(n,t){var i={bubbles:!0,cancelable:t!=="mousemove",view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:undefined},r;document.createEvent?(r=document.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode)):r=document.createEventObject();n.dispatchEvent?n.dispatchEvent(r):n.fireEvent("on"+t,r)}},{});window.Handsontable=window.Handsontable||{};Handsontable.countEventManagerListeners=0;Handsontable.eventManager=s},{"helpers/browser":43,"helpers/dom/element":45}],42:[function(n,t,i){"use strict";function o(n){for(var t=0,i=n.length;t<i;)n[t]=[n[t]],t++}function s(n,t){for(var i=0,r=t.length;i<r;)n.push(t[i]),i++}function h(n){var i=[],u,f,r,t;if(!n||n.length===0||!n[0]||n[0].length===0)return i;for(u=n.length,f=n[0].length,r=0;r<u;r++)for(t=0;t<f;t++)i[t]||(i[t]=[]),i[t][r]=n[r][t];return i}function r(n,t,i,r){var u=-1,f=n.length;for(r&&f&&(i=n[++u]);++u<f;)i=t(i,n[u],u,n);return i}function c(n,t){for(var i=-1,f=n.length,e=-1,u=[],r;++i<f;)r=n[i],t(r,i,n)&&(u[++e]=r);return u}function l(n,t){for(var i=-1,f=n.length,e=-1,r=[],u;++i<f;)u=n[i],r[++e]=t(u,i,n);return r}function u(n,t){for(var i=-1,r=n.length;++i<r;)if(t(n[i],i,n)===!1)break;return n}function f(n){return r(n,function(n,t){return n+t},0)}function a(n){return r(n,function(n,t){return n>t?n:t},Array.isArray(n)?n[0]:void 0)}function v(n){return r(n,function(n,t){return n<t?n:t},Array.isArray(n)?n[0]:void 0)}function y(n){return n.length?f(n)/n.length:0}function e(n){return r(n,function(n,t){return n.concat(Array.isArray(t)?e(t):t)},[])}function p(n){var t=[];return u(n,function(n){t.indexOf(n)===-1&&t.push(n)}),t}Object.defineProperties(i,{to2dArray:{get:function(){return o}},extendArray:{get:function(){return s}},pivot:{get:function(){return h}},arrayReduce:{get:function(){return r}},arrayFilter:{get:function(){return c}},arrayMap:{get:function(){return l}},arrayEach:{get:function(){return u}},arraySum:{get:function(){return f}},arrayMax:{get:function(){return a}},arrayMin:{get:function(){return v}},arrayAvg:{get:function(){return y}},arrayFlatten:{get:function(){return e}},arrayUnique:{get:function(){return p}},__esModule:{value:!0}})},{}],43:[function(n,t,i){"use strict";function s(){return u}function h(){return f}function c(){return e}function l(){return o}function a(n){return n||(n=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)}function v(){return"ontouchstart"in window}function y(){var n=document.createElement("div");return n.createShadowRoot&&n.createShadowRoot.toString().match(/\[native code\]/)?!0:!1}function p(){var n=document.createElement("TABLE"),t,i;n.style.borderSpacing=0;n.style.borderWidth=0;n.style.padding=0;t=document.createElement("TBODY");n.appendChild(t);t.appendChild(document.createElement("TR"));t.firstChild.appendChild(document.createElement("TD"));t.firstChild.firstChild.innerHTML="<tr><td>t<br>t<\/td><\/tr>";i=document.createElement("CAPTION");i.innerHTML="c<br>c<br>c<br>c";i.style.padding=0;i.style.margin=0;n.insertBefore(i,t);document.body.appendChild(n);r=n.offsetHeight<2*n.lastChild.offsetHeight;document.body.removeChild(n)}function w(){return r===void 0&&p(),r}var u,f,e,o,r;Object.defineProperties(i,{isIE8:{get:function(){return s}},isIE9:{get:function(){return h}},isSafari:{get:function(){return c}},isChrome:{get:function(){return l}},isMobileBrowser:{get:function(){return a}},isTouchSupported:{get:function(){return v}},isWebComponentSupportedNatively:{get:function(){return y}},hasCaptionProblem:{get:function(){return w}},__esModule:{value:!0}});u=!document.createTextNode("test").textContent;f=!!document.documentMode;e=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);o=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},{}],44:[function(n,t,i){"use strict";function u(n){for(var t=n+1,i="",r;t>0;)r=(t-1)%26,i=String.fromCharCode(65+r)+i,t=parseInt((t-r)/26,10);return i}function e(n,t){var f,i,r,e;for(n=typeof n=="number"?n:100,t=typeof t=="number"?t:4,f=[],i=0;i<n;i++){for(e=[],r=0;r<t;r++)e.push(u(r)+(i+1));f.push(e)}return f}function o(n,t){var f,r,i,e;for(n=typeof n=="number"?n:100,t=typeof t=="number"?t:4,f=[],r=0;r<n;r++){for(e={},i=0;i<t;i++)e["prop"+i]=u(i)+(r+1);f.push(e)}return f}function s(n,t){for(var r,u=[],i,f=0;f<n;f++){for(i=[],r=0;r<t;r++)i.push("");u.push(i)}return u}function h(n){for(var t,f,r=[],e=0,i=0,u=n.length;i<u;i++)for(t=0,f=n[i].length;t<f;t++)t==e&&(r.push([]),e++),r[t].push(n[i][t]);return r}function c(n,t){function i(n){var t=Handsontable.cellTypes[n];if(typeof t=="undefined")throw new Error('You declared cell type "'+n+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t=typeof t=="undefined"?!0:t,function(r,u){return function e(r){if(r){if(r.hasOwnProperty(n)&&r[n]!==void 0)return r[n];if(r.hasOwnProperty("type")&&r.type){var u;if(typeof r.type!="string")throw new Error("Cell type must be a string ");if(u=i(r.type),u.hasOwnProperty(n))return u[n];if(t)return}}else return;return e(f(r))}(typeof r=="number"?this.getCellMeta(r,u):r)}}Object.defineProperties(i,{spreadsheetColumnLabel:{get:function(){return u}},createSpreadsheetData:{get:function(){return e}},createSpreadsheetObjectData:{get:function(){return o}},createEmptySpreadsheetData:{get:function(){return s}},translateRowsToColumns:{get:function(){return h}},cellMethodLookupFactory:{get:function(){return c}},__esModule:{value:!0}});var r,f=(r=n("object"),r&&r.__esModule&&r||{"default":r}).getPrototypeOf},{object:50}],45:[function(n,t,i){"use strict";function vt(n,t,i){while(n!=null&&n!==i){if(n.nodeType===Node.ELEMENT_NODE&&(t.indexOf(n.nodeName)>-1||t.indexOf(n)>-1))return n;n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return null}function yt(n,t){var i=n.parentNode,r=[];for(typeof t=="string"?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);i!=null;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function pt(n){function r(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName===u.toUpperCase()}for(var u="hot-table",i=!1,t=k(n);t!=null;){if(r(t)){i=!0;break}else if(t.host&&t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=r(t.host),i)break;t=t.host}t=t.parentNode}return i}function k(n){return typeof Polymer!="undefined"&&typeof wrap=="function"?wrap(n):n}function d(n){return typeof Polymer!="undefined"&&typeof unwrap=="function"?unwrap(n):n}function wt(n){var t=0;if(n.previousSibling)while(n=n.previousSibling)++t;return t}function bt(n,t){var i=document.querySelector(".ht_clone_"+n);return i?i.contains(t):null}function nt(n){var t=0,i=[];if(!n||!n.length)return i;while(n[t])i.push(n[t]),t++;return i}function kt(n,t){return c(n,t)}function dt(n,t){return l(n,t)}function gt(n,t){return a(n,t)}function tt(n,t){var r,i;if(n.nodeType===3)t.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1)for(r=n.childNodes,i=r.length-1;i>=0;i--)tt(r[i],n)}function it(n){for(var t;t=n.lastChild;)n.removeChild(t)}function ni(n,t){y.test(t)?n.innerHTML=t:ut(n,t)}function ut(n,t){var i=n.firstChild;i&&i.nodeType===3&&i.nextSibling===null?rt?i.textContent=t:i.data=t:(it(n),n.appendChild(document.createTextNode(t)))}function p(n){for(var t=n;d(t)!==document.documentElement;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return p(t.host.impl);if(t.host)return p(t.host);throw new Error("Lost in Web Components world");}else return!1;else if(t.style.display==="none")return!1;t=t.parentNode}return!0}function ti(n){var i,r,u,t,f;if(t=document.documentElement,b()&&n.firstChild&&n.firstChild.nodeName==="CAPTION")return f=n.getBoundingClientRect(),{top:f.top+(window.pageYOffset||t.scrollTop)-(t.clientTop||0),left:f.left+(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0)};for(i=n.offsetLeft,r=n.offsetTop,u=n;n=n.offsetParent;){if(n===document.body)break;i+=n.offsetLeft;r+=n.offsetTop;u=n}return u&&u.style.position==="fixed"&&(i+=window.pageXOffset||t.scrollLeft,r+=window.pageYOffset||t.scrollTop),{left:i,top:r}}function ft(){var n=window.scrollY;return n===void 0&&(n=document.documentElement.scrollTop),n}function et(){var n=window.scrollX;return n===void 0&&(n=document.documentElement.scrollLeft),n}function ii(n){return n===window?ft():n.scrollTop}function ri(n){return n===window?et():n.scrollLeft}function ui(n){for(var t=n.parentNode,i=["auto","scroll"],r,e,o,u="",f="",s="",h="";t&&t.style&&document.body!==t;){if((r=t.style.overflow,e=t.style.overflowX,o=t.style.overflowY,r=="scroll"||e=="scroll"||o=="scroll")||window.getComputedStyle&&(u=window.getComputedStyle(t),f=u.getPropertyValue("overflow"),s=u.getPropertyValue("overflow-y"),h=u.getPropertyValue("overflow-x"),f==="scroll"||h==="scroll"||s==="scroll")||t.clientHeight<=t.scrollHeight&&(i.indexOf(o)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(s)!==-1)||t.clientWidth<=t.scrollWidth&&(i.indexOf(e)!==-1||i.indexOf(r)!==-1||i.indexOf(f)!==-1||i.indexOf(h)!==-1))return t;t=t.parentNode}return window}function fi(n){for(var t=n.parentNode,i;t&&t.style&&document.body!==t;){if(t.style.overflow!=="visible"&&t.style.overflow!==""||window.getComputedStyle&&(i=window.getComputedStyle(t),i.getPropertyValue("overflow")!=="visible"&&i.getPropertyValue("overflow")!==""))return t;t=t.parentNode}return window}function ei(n,t){if(n){if(n===window)return t==="width"?window.innerWidth+"px":t==="height"?window.innerHeight+"px":void 0}else return;var r=n.style[t],i;return r!==""&&r!==void 0?r:(i=ot(n),i[t]!==""&&i[t]!==void 0)?i[t]:void 0}function ot(n){return n.currentStyle||document.defaultView.getComputedStyle(n)}function oi(n){return n.offsetWidth}function si(n){return b()&&n.firstChild&&n.firstChild.nodeName==="CAPTION"?n.offsetHeight+n.firstChild.offsetHeight:n.offsetHeight}function hi(n){return n.clientHeight||n.innerHeight}function ci(n){return n.clientWidth||n.innerWidth}function li(n,t,i){window.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)}function ai(n,t,i){window.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent("on"+t,i)}function vi(n){var i,t,r;return n.selectionStart?n.selectionStart:document.selection?(n.focus(),i=document.selection.createRange(),i==null)?0:(t=n.createTextRange(),r=t.duplicate(),t.moveToBookmark(i.getBookmark()),r.setEndPoint("EndToStart",t),r.text.length):0}function yi(n){var t,i;return n.selectionEnd?n.selectionEnd:document.selection?(t=document.selection.createRange(),t==null)?0:(i=n.createTextRange(),i.text.indexOf(t.text)+t.text.length):void 0}function pi(){var n="";return window.getSelection?n=window.getSelection().toString():document.selection&&document.selection.type!=="Control"&&(n=document.selection.createRange().text),n}function wi(n,t,i){var u,f,r;if(i===void 0&&(i=t),n.setSelectionRange){n.focus();try{n.setSelectionRange(t,i)}catch(e){u=n.parentNode;f=u.style.display;u.style.display="block";n.setSelectionRange(t,i);u.style.display=f}}else n.createTextRange&&(r=n.createTextRange(),r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r.select())}function bi(){var t=document.createElement("p"),n,r,i;return t.style.width="100%",t.style.height="200px",n=document.createElement("div"),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),(document.body||document.documentElement).appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r==i&&(i=n.clientWidth),(document.body||document.documentElement).removeChild(n),r-i}function ki(){return w===void 0&&(w=bi()),w}function di(n,t,i){ct()||lt()?(n.style.top=i,n.style.left=t):at()?n.style["-webkit-transform"]="translate3d("+t+","+i+",0)":n.style.transform="translate3d("+t+","+i+",0)"}function gi(n){var t;return n.style.transform&&(t=n.style.transform)!==""?["transform",t]:n.style["-webkit-transform"]&&(t=n.style["-webkit-transform"])!==""?["-webkit-transform",t]:-1}function nr(n){n.transform&&n.transform!==""?n.transform="":n["-webkit-transform"]&&n["-webkit-transform"]!==""&&(n["-webkit-transform"]="")}function st(n){return["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true"}function tr(n){return st(n)&&n.className.indexOf("handsontableInput")==-1&&n.className.indexOf("copyPaste")==-1}function ir(n){return f.call(window,n)}function rr(n){h.call(window,n)}var g,c,l,a,v,o,y,rt,w,r;Object.defineProperties(i,{closest:{get:function(){return vt}},isChildOf:{get:function(){return yt}},isChildOfWebComponentTable:{get:function(){return pt}},polymerWrap:{get:function(){return k}},polymerUnwrap:{get:function(){return d}},index:{get:function(){return wt}},overlayContainsElement:{get:function(){return bt}},hasClass:{get:function(){return kt}},addClass:{get:function(){return dt}},removeClass:{get:function(){return gt}},removeTextNodes:{get:function(){return tt}},empty:{get:function(){return it}},HTML_CHARACTERS:{get:function(){return y}},fastInnerHTML:{get:function(){return ni}},fastInnerText:{get:function(){return ut}},isVisible:{get:function(){return p}},offset:{get:function(){return ti}},getWindowScrollTop:{get:function(){return ft}},getWindowScrollLeft:{get:function(){return et}},getScrollTop:{get:function(){return ii}},getScrollLeft:{get:function(){return ri}},getScrollableElement:{get:function(){return ui}},getTrimmingContainer:{get:function(){return fi}},getStyle:{get:function(){return ei}},getComputedStyle:{get:function(){return ot}},outerWidth:{get:function(){return oi}},outerHeight:{get:function(){return si}},innerHeight:{get:function(){return hi}},innerWidth:{get:function(){return ci}},addEvent:{get:function(){return li}},removeEvent:{get:function(){return ai}},getCaretPosition:{get:function(){return vi}},getSelectionEndPosition:{get:function(){return yi}},getSelectionText:{get:function(){return pi}},setCaretPosition:{get:function(){return wi}},getScrollbarWidth:{get:function(){return ki}},setOverlayPosition:{get:function(){return di}},getCssTransform:{get:function(){return gi}},resetCssTransform:{get:function(){return nr}},isInput:{get:function(){return st}},isOutsideInput:{get:function(){return tr}},requestAnimationFrame:{get:function(){return ir}},cancelAnimationFrame:{get:function(){return rr}},__esModule:{value:!0}});var u,e=(u=n("../browser"),u&&u.__esModule&&u||{"default":u}),ct=e.isIE8,lt=e.isIE9,at=e.isSafari,b=e.hasCaptionProblem;g=document.documentElement.classList?!0:!1;g?(v=function(){var n=document.createElement("div");return n.classList.add("test","test2"),n.classList.contains("test2")}(),c=function(n,t){return t===""?!1:n.classList.contains(t)},l=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=nt(t),v)n.classList.add.apply(n.classList,t);else while(t&&t[i])n.classList.add(t[i]),i++},a=function(n,t){var i=0;if(typeof t=="string"&&(t=t.split(" ")),t=nt(t),v)n.classList.remove.apply(n.classList,t);else while(t&&t[i])n.classList.remove(t[i]),i++}):(o=function(n){return new RegExp("(\\s|^)"+n+"(\\s|$)")},c=function(n,t){return n.className.match(o(t))?!0:!1},l=function(n,t){var r=0,i=n.className;if(typeof t=="string"&&(t=t.split(" ")),i==="")i=t.join(" ");else while(t&&t[r])o(t[r]).test(i)||(i+=" "+t[r]),r++;n.className=i},a=function(n,t){var r=0,i=n.className;for(typeof t=="string"&&(t=t.split(" "));t&&t[r];)i=i.replace(o(t[r])," ").trim(),r++;n.className!==i&&(n.className=i)});y=/(<(.*)>|&(.*);)/;rt=document.createTextNode("test").textContent?!0:!1;var ht=0,s=["ms","moz","webkit","o"],f=window.requestAnimationFrame,h=window.cancelAnimationFrame;for(r=0;r<s.length&&!f;++r)f=window[s[r]+"RequestAnimationFrame"],h=window[s[r]+"CancelAnimationFrame"]||window[s[r]+"CancelRequestAnimationFrame"];f||(f=function(n){var t=(new Date).getTime(),i=Math.max(0,16-(t-ht)),r=window.setTimeout(function(){n(t+i)},i);return ht=t+i,r});h||(h=function(n){clearTimeout(n)})},{"../browser":43}],46:[function(n,t,i){"use strict";function r(n){n.isImmediatePropagationEnabled=!1;n.cancelBubble=!0}function u(n){return n.isImmediatePropagationEnabled===!1}function f(n){typeof n.stopPropagation=="function"?n.stopPropagation():n.cancelBubble=!0}function e(n){if(n.pageX)return n.pageX;var t=getWindowScrollLeft();return n.clientX+t}function o(n){if(n.pageY)return n.pageY;var t=getWindowScrollTop();return n.clientY+t}Object.defineProperties(i,{stopImmediatePropagation:{get:function(){return r}},isImmediatePropagationStopped:{get:function(){return u}},stopPropagation:{get:function(){return f}},pageX:{get:function(){return e}},pageY:{get:function(){return o}},__esModule:{value:!0}})},{}],47:[function(n,t,i){"use strict";function u(n,t){return function(){return n.apply(t,arguments)}}function r(n){function f(){var h=this,f=arguments,e=Date.now(),o=!1,s;return i.lastCallThrottled=!0,t||(t=e,o=!0),s=u-(e-t),o?(i.lastCallThrottled=!1,n.apply(this,f)):(r&&clearTimeout(r),r=setTimeout(function(){i.lastCallThrottled=!1;n.apply(h,f);t=0;r=void 0},s)),i}var u=arguments[1]!==void 0?arguments[1]:200,t=0,i={lastCallThrottled:!0},r=null;return f}function f(n){function o(){t=i}function u(){return t?(t--,n.apply(this,arguments)):e.apply(this,arguments)}var f=arguments[1]!==void 0?arguments[1]:200,i=arguments[2]!==void 0?arguments[2]:10,e=r(n,f),t=i;return u.clearHits=o,u}Object.defineProperties(i,{proxy:{get:function(){return u}},throttle:{get:function(){return r}},throttleAfterHits:{get:function(){return f}},__esModule:{value:!0}})},{}],48:[function(n,t,i){"use strict";function r(n){switch(typeof n){case"string":case"number":return n+"";case"object":return n===null?"":n.toString();case"undefined":return"";default:return n.toString()}}Object.defineProperties(i,{stringify:{get:function(){return r}},__esModule:{value:!0}})},{}],49:[function(n,t,i){"use strict";function r(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?n.length?n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):!1:t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):!1}function u(n,t,i){var r=-1;for(typeof t=="function"?(i=t,t=n):r=n-1;++r<=t;)if(i(r)===!1)break}function f(n,t,i){var r=n+1;for(typeof t=="function"&&(i=t,t=0);--r>=t;)if(i(r)===!1)break}function e(n,t){return t=parseInt(t.toString().replace("%",""),10),parseInt(n*t/100)}Object.defineProperties(i,{isNumeric:{get:function(){return r}},rangeEach:{get:function(){return u}},rangeEachReverse:{get:function(){return f}},valueAccordingPercent:{get:function(){return e}},__esModule:{value:!0}})},{}],50:[function(n,t,i){"use strict";function f(n){var t;return Array.isArray(n)?t=[]:(t={},r(n,function(n,i){t[i]=n&&typeof n=="object"&&!Array.isArray(n)?f(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?[f(n[0])]:[]:null})),t}function c(n,t){return t.prototype.constructor=t,n.prototype=new t,n.prototype.constructor=n,n}function l(n,t){return r(t,function(t,i){n[i]=t}),n}function e(n,t){r(t,function(i,r){t[r]&&typeof t[r]=="object"?(n[r]||(n[r]=Array.isArray(t[r])?[]:{}),e(n[r],t[r])):n[r]=t[r]})}function o(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function a(n){var t={};return r(n,function(n,i){t[i]=n}),t}function v(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return n.MIXINS||(n.MIXINS=[]),h(i,function(t){n.MIXINS.push(t.MIXIN_NAME);r(t,function(t,i){if(n.prototype[i]!==void 0)throw new Error("Mixin conflict. Property '"+i+"' already exist and cannot be overwritten.");if(typeof t=="function")n.prototype[i]=t;else{var r=function(n,t){n="_"+n;var i=function(n){return(Array.isArray(n)||s(n))&&(n=o(n)),n};return function(){return this[n]===void 0&&(this[n]=i(t)),this[n]}},u=function(n){return n="_"+n,function(t){this[n]=t}};Object.defineProperty(n.prototype,i,{get:r(i,t),set:u(i),configurable:!0})}})}),n}function y(n,t){return JSON.stringify(n)===JSON.stringify(t)}function s(n){return Object.prototype.toString.call(n)=="[object Object]"}function p(n){var i,r,t;return typeof n.__proto__=="object"?i=n.__proto__:(t=n.constructor,typeof n.constructor=="function"&&(r=t,delete n.constructor&&(t=n.constructor,n.constructor=r)),i=t?t.prototype:null),i}function w(n,t,i,r){r.value=i;r.writable=r.writable!==!1;r.enumerable=r.enumerable!==!1;r.configurable=r.configurable!==!1;Object.defineProperty(n,t,r)}function r(n,t){for(var i in n)if((!n.hasOwnProperty||n.hasOwnProperty&&n.hasOwnProperty(i))&&t(n[i],i,n)===!1)break;return n}function b(n,t){var u=t.split("."),i=n;return r(u,function(n){return i=i[n],i===void 0?(i=void 0,!1):void 0}),i}Object.defineProperties(i,{duckSchema:{get:function(){return f}},inherit:{get:function(){return c}},extend:{get:function(){return l}},deepExtend:{get:function(){return e}},deepClone:{get:function(){return o}},clone:{get:function(){return a}},mixin:{get:function(){return v}},isObjectEquals:{get:function(){return y}},isObject:{get:function(){return s}},getPrototypeOf:{get:function(){return p}},defineGetter:{get:function(){return w}},objectEach:{get:function(){return r}},getProperty:{get:function(){return b}},__esModule:{value:!0}});var u,h=(u=n("array"),u&&u.__esModule&&u||{"default":u}).arrayEach},{array:42}],51:[function(n,t,i){"use strict";function f(n,t){function i(){}u(i,n);for(var r=0,f=t.length;r<f;r++)i.prototype[t[r]]=void 0;return i}Object.defineProperties(i,{columnFactory:{get:function(){return f}},__esModule:{value:!0}});var r,u=(r=n("object"),r&&r.__esModule&&r||{"default":r}).inherit},{object:50}],52:[function(n,t,i){"use strict";function o(n){return n[0].toUpperCase()+n.substr(1)}function s(n,t){var i=!0;return f(t.length-1,function(r){if(n.charAt(r)!==t.charAt(r))return i=!1,!1}),i}function h(n,t){var i=!0,r=t.length-1,u=n.length-1;return f(r,function(f){var e=u-f,o=r-f;if(n.charAt(e)!==t.charAt(o))return i=!1,!1}),i}function c(){for(var i,r,u,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(i=[],r=t.length;r--;)u=e(t[r]).toLowerCase(),i.indexOf(u)===-1&&i.push(u);return i.length===1}function l(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function a(n){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(n)}function v(n){var t=arguments[1]!==void 0?arguments[1]:{};return(n+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(n,i){return n.charAt(0)==="\\"?n.substr(1,n.length-1):t[i]===void 0?"":t[i]})}function y(n,t){var i=arguments[2]!==void 0?arguments[2]:" ",u;if(n=n+"",n.length>=t)return n;i=String(i);u=i.length;u||(i=" ");var e=t-n.length,o=Math.ceil(e/i.length),r="";return f(o,function(){r+=i}),r=r.slice(0,e),r+n}Object.defineProperties(i,{toUpperCaseFirst:{get:function(){return o}},startsWith:{get:function(){return s}},endsWith:{get:function(){return h}},equalsIgnoreCase:{get:function(){return c}},randomString:{get:function(){return l}},isPercentValue:{get:function(){return a}},substitute:{get:function(){return v}},padStart:{get:function(){return y}},__esModule:{value:!0}});var r,u,e=(r=n("mixed"),r&&r.__esModule&&r||{"default":r}).stringify,f=(u=n("number"),u&&u.__esModule&&u||{"default":u}).rangeEach},{mixed:48,number:49}],53:[function(n,t,i){"use strict";function e(n){return n==32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function o(n){var t=[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT];return t.indexOf(n)!==-1}function s(n){return[r.CONTROL_LEFT,224,r.COMMAND_LEFT,r.COMMAND_RIGHT].indexOf(n)!==-1}function h(n,t){var u=t.split("|"),i=!1;return f(u,function(t){if(n===r[t])return i=!0,!1}),i}Object.defineProperties(i,{KEY_CODES:{get:function(){return r}},isPrintableChar:{get:function(){return e}},isMetaKey:{get:function(){return o}},isCtrlKey:{get:function(){return s}},isKey:{get:function(){return h}},__esModule:{value:!0}});var u,f=(u=n("array"),u&&u.__esModule&&u||{"default":u}).arrayEach,r={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},{array:42}],54:[function(n,t,i){"use strict";Object.defineProperties(i,{localHooks:{get:function(){return f}},__esModule:{value:!0}});var r,u,e=(r=n("helpers/array"),r&&r.__esModule&&r||{"default":r}).arrayEach,o=(u=n("helpers/object"),u&&u.__esModule&&u||{"default":u}).defineGetter,f={_localHooks:Object.create(null),addLocalHook:function(n,t){this._localHooks[n]||(this._localHooks[n]=[]);this._localHooks[n].push(t)},runLocalHooks:function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];r=this;this._localHooks[n]&&e(this._localHooks[n],function(n){return n.apply(r,i)})},clearLocalHooks:function(){this._localHooks={}}};o(f,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});Handsontable.utils=Handsontable.utils||{};Handsontable.utils.localHooks=f},{"helpers/array":42,"helpers/object":50}],55:[function(n,t,i){"use strict";function r(){function t(n){return n!==null&&!r(n)&&(typeof n=="string"||typeof n=="number")}function i(n){return n!==null&&(typeof n=="object"||typeof n=="function")}function r(n){return n!==n}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(r){return t(r)?n.arrayMap[r]:i(r)?n.weakMap.get(r):void 0},set:function(r,u){if(t(r))n.arrayMap[r]=u;else if(i(r))n.weakMap.set(r,u);else throw new Error("Invalid key type");},"delete":function(r){t(r)?delete n.arrayMap[r]:i(r)&&n.weakMap.delete(r)}}}Object.defineProperties(i,{MultiMap:{get:function(){return r}},__esModule:{value:!0}});window.MultiMap=r},{}],56:[function(n,t,i){"use strict";Object.defineProperties(i,{Hooks:{get:function(){return o}},__esModule:{value:!0}});var u,f,r=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","afterCreateCol","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","construct","init","modifyCol","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","afterAutofillApplyValues","modifyCopyableRange","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize"],e=(u=n("helpers/array"),u&&u.__esModule&&u||{"default":u}).arrayEach,s=(f=n("helpers/object"),f&&f.__esModule&&f||{"default":f}).objectEach,o=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(o,{createEmptyBucket:function(){var n=Object.create(null);return e(r,function(t){return n[t]=[]}),n},getBucket:function(){var n=arguments[0]!==void 0?arguments[0]:null;return n?(n.pluginHookBucket||(n.pluginHookBucket=this.createEmptyBucket()),n.pluginHookBucket):this.globalBucket},add:function(n,t){var r=arguments[2]!==void 0?arguments[2]:null,u=this,i;return Array.isArray(t)?e(t,function(t){return u.add(n,t,r)}):(i=this.getBucket(r),typeof i[n]=="undefined"&&(this.register(n),i[n]=[]),t.skip=!1,i[n].indexOf(t)===-1&&i[n].push(t)),this},once:function(n,t){var i=arguments[2]!==void 0?arguments[2]:null,r=this;Array.isArray(t)?e(t,function(t){return r.once(n,t,i)}):(t.runOnce=!0,this.add(n,t,i))},remove:function(n,t){var r=arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(r);return typeof i[n]!="undefined"&&i[n].indexOf(t)>=0?(t.skip=!0,!0):!1},has:function(n){var i=arguments[1]!==void 0?arguments[1]:null,t=this.getBucket(i);return t[n]!==void 0&&t[n].length?!0:!1},run:function(n,t,i,r,u,f,e,o){var s=this.globalBucket[t],c=-1,y=s?s.length:0,a,v;if(y)while(++c<y)s[c]&&!s[c].skip&&(a=s[c].call(n,i,r,u,f,e,o),a!==void 0&&(i=a),s[c]&&s[c].runOnce&&this.remove(t,s[c]));var h=this.getBucket(n)[t],l=-1,p=h?h.length:0;if(p)while(++l<p)h[l]&&!h[l].skip&&(v=h[l].call(n,i,r,u,f,e,o),v!==void 0&&(i=v),h[l]&&h[l].runOnce&&this.remove(t,h[l],n));return i},destroy:function(){var n=arguments[0]!==void 0?arguments[0]:null;s(this.getBucket(n),function(n,t,i){return i[t].length=0})},register:function(n){this.isRegistered(n)||r.push(n)},deregister:function(n){this.isRegistered(n)&&r.splice(r.indexOf(n),1)},isRegistered:function(n){return r.indexOf(n)>=0},getRegistered:function(){return r}},{});Handsontable.utils=Handsontable.utils||{};Handsontable.utils.Hooks=o},{"helpers/array":42,"helpers/object":50}],57:[function(n,t,i){"use strict";function s(n,t){n=o(n);Handsontable.plugins[n]=t;Handsontable.hooks.add("construct",function(){var i;r.has(this)||r.set(this,{});i=r.get(this);i[n]||(i[n]=new t(this))});Handsontable.hooks.add("afterDestroy",function(){if(r.has(this)){var n=r.get(this);e(n,function(n){return n.destroy()});r.delete(this)}})}function h(n,t){if(typeof t!="string")throw Error('Only strings can be passed as "plugin" parameter');var i=o(t);if(r.has(n)&&r.get(n)[i])return r.get(n)[i]}function c(n){return r.has(n)?Object.keys(r.get(n)):[]}function l(n,t){var i=null;return r.has(n)&&e(r.get(n),function(n,r){n===t&&(i=r)}),i}Object.defineProperties(i,{registerPlugin:{get:function(){return s}},getPlugin:{get:function(){return h}},getRegistredPluginNames:{get:function(){return c}},getPluginName:{get:function(){return l}},__esModule:{value:!0}});var u,f,e=(u=n("helpers/object"),u&&u.__esModule&&u||{"default":u}).objectEach,o=(f=n("helpers/string"),f&&f.__esModule&&f||{"default":f}).toUpperCaseFirst,r=new WeakMap;Handsontable.plugins=Handsontable.plugins||{};Handsontable.plugins.utils=Handsontable.plugins.utils||{};Handsontable.plugins.registerPlugin=s},{"helpers/object":50,"helpers/string":52}],58:[function(n,t,i){"use strict";var v;Object.defineProperties(i,{"default":{get:function(){return v}},__esModule:{value:!0}});var f,e,o,h=(f=n("helpers/object"),f&&f.__esModule&&f||{"default":f}),y=h.defineGetter,c=h.objectEach,l=(e=n("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayEach,a=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}),p=a.getRegistredPluginNames,w=a.getPluginName,u=new WeakMap,r=null,s=function(n){var t=this;y(this,"hot",n,{writable:!1});u.set(this,{hooks:{}});r=null;this.pluginName=null;this.pluginsInitializedCallbacks=[];this.isPluginsReady=!1;this.enabled=!1;this.initialized=!1;this.hot.addHook("afterPluginsInitialized",function(){return t.onAfterPluginsInitialized()});this.hot.addHook("afterUpdateSettings",function(){return t.onUpdateSettings()});this.hot.addHook("beforeInit",function(){return t.init()})};$traceurRuntime.createClass(s,{init:function(){this.pluginName=w(this.hot,this);this.isEnabled&&this.isEnabled()&&this.enablePlugin();r||(r=p(this.hot));r.indexOf(this.pluginName)>=0&&r.splice(r.indexOf(this.pluginName),1);r.length||this.hot.runHooks("afterPluginsInitialized");this.initialized=!0},enablePlugin:function(){this.enabled=!0},disablePlugin:function(){this.eventManager&&this.eventManager.clear();this.clearHooks();this.enabled=!1},addHook:function(n,t){var i=u.get(this).hooks[n]=u.get(this).hooks[n]||[];this.hot.addHook(n,t);i.push(t);u.get(this).hooks[n]=i},removeHooks:function(n){var t=this;l(u.get(this).hooks[n]||[],function(i){t.hot.removeHook(n,i)})},clearHooks:function(){var t=this,n=u.get(this).hooks;c(n,function(n,i){return t.removeHooks(i)});n.length=0},callOnPluginsReady:function(n){this.isPluginsReady?n():this.pluginsInitializedCallbacks.push(n)},onAfterPluginsInitialized:function(){l(this.pluginsInitializedCallbacks,function(n){return n()});this.pluginsInitializedCallbacks.length=0;this.isPluginsReady=!0},onUpdateSettings:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())},updatePlugin:function(){},destroy:function(){var n=this;this.eventManager&&this.eventManager.destroy();this.clearHooks();c(this,function(t,i){i!=="hot"&&(n[i]=null)});delete this.hot}},{});v=s;Handsontable.plugins.BasePlugin=s},{"helpers/array":42,"helpers/object":50,plugins:57}],59:[function(n,t,i){"use strict";Object.defineProperties(i,{AutoColumnSize:{get:function(){return y}},__esModule:{value:!0}});var u,f,e,o,s,h,c,l,a,v,g=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).default,w=(f=n("helpers/array"),f&&f.__esModule&&f||{"default":f}),nt=w.arrayEach,tt=w.arrayFilter,p=(e=n("helpers/dom/element"),e&&e.__esModule&&e||{"default":e}),b=p.cancelAnimationFrame,it=p.requestAnimationFrame,rt=p.isVisible,ut=(o=n("utils/ghostTable"),o&&o.__esModule&&o||{"default":o}).GhostTable,k=(s=n("helpers/object"),s&&s.__esModule&&s||{"default":s}),ft=k.isObject,at=k.objectEach,d=(h=n("helpers/number"),h&&h.__esModule&&h||{"default":h}),et=d.valueAccordingPercent,ot=d.rangeEach,st=(c=n("plugins"),c&&c.__esModule&&c||{"default":c}).registerPlugin,ht=(l=n("utils/samplesGenerator"),l&&l.__esModule&&l||{"default":l}).SamplesGenerator,ct=(a=n("helpers/string"),a&&a.__esModule&&a||{"default":a}).isPercentValue,lt=(v=n("3rdparty/walkontable/src/calculator/viewportColumns"),v&&v.__esModule&&v||{"default":v}).WalkontableViewportColumnsCalculator,y=function(n){var t=this;$traceurRuntime.superConstructor(r).call(this,n);this.widths=[];this.ghostTable=new ut(this.hot);this.samplesGenerator=new ht(function(n,i){return t.hot.getDataAtCell(n,i)});this.firstCalculation=!0;this.inProgress=!1;this.addHook("beforeColumnResize",function(n,i,r){return t.onBeforeColumnResize(n,i,r)})},r=y;$traceurRuntime.createClass(y,{isEnabled:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths},enablePlugin:function(){var n=this;this.enabled||(this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,i){return n.getColumnWidth(i,t)}),$traceurRuntime.superGet(this,r.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,r.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function(){var n=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments[2]!==void 0?arguments[2]:!1,i=this;typeof n=="number"&&(n={from:n,to:n});typeof t=="number"&&(t={from:t,to:t});ot(n.from,n.to,function(n){if(r||i.widths[n]===void 0&&!i.hot._getColWidthFromSettings(n)){var u=i.samplesGenerator.generateColumnSamples(n,t);u.forEach(function(n,t){return i.ghostTable.addColumn(t,n)})}});this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(n,t){return i.widths[n]=t}),this.ghostTable.clean())},calculateAllColumnsWidth:function(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=this,t=0,i=this.hot.countCols()-1,u=null,f;this.inProgress=!0;f=function(){if(!n.hot){b(u);n.inProgress=!1;return}n.calculateColumnsWidth({from:t,to:Math.min(t+r.CALCULATION_STEP,i)},e);t=t+r.CALCULATION_STEP+1;t<i?u=it(f):(b(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},e),this.firstCalculation=!1,t=this.getSyncCalculationLimit()+1);t<i?f():this.inProgress=!1},recalculateAllColumnsWidth:function(){this.hot.view&&rt(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())},getSyncCalculationLimit:function(){var n=r.SYNC_CALCULATION_LIMIT,t=this.hot.countCols()-1;return ft(this.hot.getSettings().autoColumnSize)&&(n=this.hot.getSettings().autoColumnSize.syncLimit,n=ct(n)?et(t,n):n>>0),Math.min(n,t)},getColumnWidth:function(n){var i=arguments[1],r=arguments[2]!==void 0?arguments[2]:!0,t=i;return t===void 0&&(t=this.widths[n],r&&typeof t=="number"&&(t=Math.max(t,lt.DEFAULT_WIDTH))),t},getFirstVisibleColumn:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getFirstVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getFirstRenderedColumn():-1},getLastVisibleColumn:function(){var n=this.hot.view.wt;return n.wtViewport.columnsVisibleCalculator?n.wtTable.getLastVisibleColumn():n.wtViewport.columnsRenderCalculator?n.wtTable.getLastRenderedColumn():-1},clearCache:function(){this.widths.length=0},isNeedRecalculate:function(){return tt(this.widths,function(n){return n===void 0}).length?!0:!1},onBeforeRender:function(){var n=this.hot.renderCall;this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,n);this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()},onAfterLoadData:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)},onBeforeChange:function(n){var t=this;nt(n,function(n){return t.widths[n[1]]=void 0})},onBeforeColumnResize:function(n,t,i){return i&&(this.calculateColumnsWidth(n,void 0,!0),t=this.getColumnWidth(n,void 0,!1)),t},destroy:function(){this.ghostTable.clean();$traceurRuntime.superGet(this,r.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},g);st("autoColumnSize",y)},{"3rdparty/walkontable/src/calculator/viewportColumns":3,_base:58,"helpers/array":42,"helpers/dom/element":45,"helpers/number":49,"helpers/object":50,"helpers/string":52,plugins:57,"utils/ghostTable":98,"utils/samplesGenerator":99}],60:[function(n,t,i){"use strict";Object.defineProperties(i,{AutoRowSize:{get:function(){return v}},__esModule:{value:!0}});var u,f,e,o,s,h,c,l,a,nt=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).default,p=(f=n("helpers/array"),f&&f.__esModule&&f||{"default":f}),ht=p.arrayEach,tt=p.arrayFilter,y=(e=n("helpers/dom/element"),e&&e.__esModule&&e||{"default":e}),w=y.cancelAnimationFrame,it=y.requestAnimationFrame,rt=y.isVisible,ut=(o=n("utils/ghostTable"),o&&o.__esModule&&o||{"default":o}).GhostTable,b=(s=n("helpers/object"),s&&s.__esModule&&s||{"default":s}),k=b.isObject,ct=b.objectEach,d=(h=n("helpers/number"),h&&h.__esModule&&h||{"default":h}),ft=d.valueAccordingPercent,g=d.rangeEach,et=(c=n("plugins"),c&&c.__esModule&&c||{"default":c}).registerPlugin,ot=(l=n("utils/samplesGenerator"),l&&l.__esModule&&l||{"default":l}).SamplesGenerator,st=(a=n("helpers/string"),a&&a.__esModule&&a||{"default":a}).isPercentValue,v=function(n){var t=this;$traceurRuntime.superConstructor(r).call(this,n);this.heights=[];this.ghostTable=new ut(this.hot);this.samplesGenerator=new ot(function(n,i){return t.hot.getDataAtCell(n,i)});this.firstCalculation=!0;this.inProgress=!1;this.addHook("beforeRowResize",function(n,i,r){return t.onBeforeRowResize(n,i,r)})},r=v;$traceurRuntime.createClass(v,{isEnabled:function(){return this.hot.getSettings().autoRowSize===!0||k(this.hot.getSettings().autoRowSize)},enablePlugin:function(){var n=this;this.enabled||(this.addHook("afterLoadData",function(){return n.onAfterLoadData()}),this.addHook("beforeChange",function(t){return n.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return n.clearCache()}),this.addHook("beforeRender",function(t){return n.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,i){return n.onBeforeRowMove(t,i)}),this.addHook("modifyRowHeight",function(t,i){return n.getRowHeight(i,t)}),$traceurRuntime.superGet(this,r.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,r.prototype,"disablePlugin").call(this)},calculateRowsHeight:function(){var n=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments[2]!==void 0?arguments[2]:!1,i=this;typeof n=="number"&&(n={from:n,to:n});typeof t=="number"&&(t={from:t,to:t});g(n.from,n.to,function(n){if(r||i.heights[n]===void 0){var u=i.samplesGenerator.generateRowSamples(n,t);u.forEach(function(n,t){return i.ghostTable.addRow(t,n)})}});this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(n,t){return i.heights[n]=t}),this.ghostTable.clean())},calculateAllRowsHeight:function(){var e=arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=this,t=0,i=this.hot.countRows()-1,u=null,f;this.inProgress=!0;f=function(){if(!n.hot){w(u);n.inProgress=!1;return}n.calculateRowsHeight({from:t,to:Math.min(t+r.CALCULATION_STEP,i)},e);t=t+r.CALCULATION_STEP+1;t<i?u=it(f):(w(u),n.inProgress=!1,n.hot.view.wt.wtOverlays.adjustElementsSize(!0),n.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&n.hot.view.wt.wtOverlays.leftOverlay.clone.draw())};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},e),this.firstCalculation=!1,t=this.getSyncCalculationLimit()+1);t<i?f():this.inProgress=!1},recalculateAllRowsHeight:function(){rt(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())},getSyncCalculationLimit:function(){var n=r.SYNC_CALCULATION_LIMIT,t=this.hot.countRows()-1;return k(this.hot.getSettings().autoRowSize)&&(n=this.hot.getSettings().autoRowSize.syncLimit,n=st(n)?ft(t,n):n>>0),Math.min(n,t)},getRowHeight:function(n){var t=arguments[1],i=t;return this.heights[n]!==void 0&&this.heights[n]>(t||0)&&(i=this.heights[n]),i},getFirstVisibleRow:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1},getLastVisibleRow:function(){var n=this.hot.view.wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1},clearCache:function(){this.heights.length=0},clearCacheByRange:function(n){var t=this;typeof n=="number"&&(n={from:n,to:n});g(Math.min(n.from,n.to),Math.max(n.from,n.to),function(n){return t.heights[n]=void 0})},isNeedRecalculate:function(){return tt(this.heights,function(n){return n===void 0}).length?!0:!1},onBeforeRender:function(){var n=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,n);this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()},onBeforeRowMove:function(n,t){this.clearCacheByRange({from:n,to:t});this.calculateAllRowsHeight()},onBeforeRowResize:function(n,t,i){return i&&(this.calculateRowsHeight(n,void 0,!0),t=this.getRowHeight(n)),t},onAfterLoadData:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)},onBeforeChange:function(n){var t=null;n.length===1?t=n[0][0]:n.length>1&&(t={from:n[0][0],to:n[n.length-1][0]});t!==null&&this.clearCacheByRange(t)},destroy:function(){this.ghostTable.clean();$traceurRuntime.superGet(this,r.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},nt);et("autoRowSize",v)},{_base:58,"helpers/array":42,"helpers/dom/element":45,"helpers/number":49,"helpers/object":50,"helpers/string":52,plugins:57,"utils/ghostTable":98,"utils/samplesGenerator":99}],61:[function(n,t,i){"use strict";function y(n,t,i,r){var l=i.length,a=i?i[0].length:0,c=[],e=[],v,y,u,f,h,o,s;if(v=t.row-n.row,y=t.col-n.col,["down","up"].indexOf(r)!==-1){for(o=0;o<=y;o++)u=parseInt(i[0][o],10),f=parseInt(i[l-1][o],10),h=(r==="down"?f-u:u-f)/(l-1)||0,e.push(h);c.push(e)}if(["right","left"].indexOf(r)!==-1)for(s=0;s<=v;s++)u=parseInt(i[s][0],10),f=parseInt(i[s][a-1],10),h=(r==="right"?f-u:u-f)/(a-1)||0,e=[],e.push(h),c.push(e);return c}function u(n){function e(){if(!n.autofill)return!0;n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,i=!1)}function o(n){var i,r;if(!t.instance.autofill)return!1;i=c(t.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+l(t.instance.table);r=c(t.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+a(t.instance.table);t.addingStarted===!1&&t.instance.autofill.handle.isDragged>0&&n.clientY>i&&n.clientX<=r?(t.instance.mouseDragOutside=!0,t.addingStarted=!0):t.instance.mouseDragOutside=!1;t.instance.mouseDragOutside&&setTimeout(function(){t.addingStarted=!1;t.instance.alter("insert_row")},200)}var t=this,i=!1,u,f,r;this.instance=n;this.addingStarted=!1;r=v(n);r.addEventListener(document,"mouseup",e);r.addEventListener(document,"mousemove",o);u=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown;this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(t){n.autofill.handle.isDragged=1;i=!0;u(t)};f=this.instance.view.wt.wtSettings.settings.onCellMouseOver;this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(t,r,u,e){n.autofill&&i&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(r),n.autofill.checkIfNewRowNeeded());f(t,r,u,e)};this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}Object.defineProperties(i,{Autofill:{get:function(){return u}},__esModule:{value:!0}});var f,e,o,s,h=(f=n("helpers/dom/element"),f&&f.__esModule&&f||{"default":f}),c=h.offset,l=h.outerHeight,a=h.outerWidth,v=(e=n("eventManager"),e&&e.__esModule&&e||{"default":e}).eventManager,p=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin,r=(s=n("3rdparty/walkontable/src/cell/coords"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords;u.prototype.init=function(){this.handle={}};u.prototype.disable=function(){this.handle.disabled=!0};u.prototype.selectAdjacent=function(){var n,i,t,f,u;n=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();i=this.instance.getData();n:for(t=n[2]+1;t<this.instance.countRows();t++){for(u=n[1];u<=n[3];u++)if(i[t][u])break n;!i[t][n[1]-1]&&!i[t][n[3]+1]||(f=t)}f&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new r(n[0],n[1])),this.instance.view.wt.selections.fill.add(new r(f,n[3])),this.apply())};u.prototype.apply=function(){var n,t,i,u,o,f,s,e;(this.handle.isDragged=0,this.instance.view.wt.selections.fill.isEmpty())||(n=this.instance.view.wt.selections.fill.getCorners(),this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),Handsontable.hooks.run(this.instance,"afterAutofillApplyValues",t,n),n[0]===t[0]&&n[1]<t[1]?(f="left",i=new r(n[0],n[1]),u=new r(n[2],t[1]-1)):n[0]===t[0]&&n[3]>t[3]?(f="right",i=new r(n[0],t[3]+1),u=new r(n[2],n[3])):n[0]<t[0]&&n[1]===t[1]?(f="up",i=new r(n[0],n[1]),u=new r(t[0]-1,n[3])):n[2]>t[2]&&n[1]===t[1]&&(f="down",i=new r(t[2]+1,n[1]),u=new r(n[2],n[3])),i&&i.row>-1&&i.col>-1?(e={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},o=this.instance.getData(e.from.row,e.from.col,e.to.row,e.to.col),s=y(i,u,o,f),Handsontable.hooks.run(this.instance,"beforeAutofill",i,u,o),this.instance.populateFromArray(i.row,i.col,o,u.row,u.col,"autofill",null,f,s),this.instance.selection.setRangeStart(new r(n[0],n[1])),this.instance.selection.setRangeEnd(new r(n[2],n[3]))):this.instance.selection.refreshBorders())};u.prototype.showBorder=function(n){var i=this.instance.getSelectedRange().getTopLeftCorner(),t=this.instance.getSelectedRange().getBottomRightCorner();if(this.instance.getSettings().fillHandle!=="horizontal"&&(t.row<n.row||i.row>n.row))n=new r(n.row,t.col);else if(this.instance.getSettings().fillHandle!=="vertical")n=new r(t.row,n.col);else return;this.instance.view.wt.selections.fill.clear();this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from);this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to);this.instance.view.wt.selections.fill.add(n);this.instance.view.render()};u.prototype.checkIfNewRowNeeded=function(){var n,t,i=this.instance.countRows(),r=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&(t=this.instance.getSelected(),n=this.instance.view.wt.selections.fill.getCorners(),t[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){r.instance.alter("insert_row");r.addingStarted=!1},200))))};Handsontable.hooks.add("afterInit",function(){var n=new u(this);typeof this.getSettings().fillHandle!="undefined"&&(n.handle&&this.getSettings().fillHandle===!1?n.disable():n.handle||this.getSettings().fillHandle===!1||(this.autofill=n,this.autofill.init()))});Handsontable.Autofill=u},{"3rdparty/walkontable/src/cell/coords":5,eventManager:41,"helpers/dom/element":45,plugins:57}],62:[function(n,t,i){"use strict";var h,c;Object.defineProperties(i,{ColumnSorting:{get:function(){return h}},__esModule:{value:!0}});var r,u,f,e,o,s=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),l=s.addClass,p=s.closest,w=s.hasClass,b=s.index,v=s.removeClass,a=(u=n("helpers/array"),u&&u.__esModule&&u||{"default":u}),tt=a.arrayEach,y=a.arrayMap,k=a.arrayReduce,d=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).eventManager,g=(e=n("_base"),e&&e.__esModule&&e||{"default":e}).default,nt=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;Handsontable.hooks.register("beforeColumnSort");Handsontable.hooks.register("afterColumnSort");h=function(n){$traceurRuntime.superConstructor(c).call(this,n);this.sortIndicators=[]};c=h;$traceurRuntime.createClass(h,{isEnabled:function(){return!!this.hot.getSettings().columnSorting},enablePlugin:function(){var n=this,t;this.enabled||(t=this,this.hot.sortIndex=[],this.hot.sort=function(){var n=Array.prototype.slice.call(arguments);return t.sortByColumn.apply(t,n)},typeof this.hot.getSettings().observeChanges=="undefined"&&this.enableObserveChangesPlugin(),this.bindColumnSortingAfterClick(),this.addHook("afterTrimRow",function(){return n.sort()}),this.addHook("afterUntrimRow",function(){return n.sort()}),this.addHook("modifyRow",function(t){return n.translateRow(t)}),this.addHook("afterUpdateSettings",function(){return n.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(t,i){return n.getColHeader(t,i)}),this.addHook("afterCreateRow",function(){t.afterCreateRow.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){t.afterRemoveRow.apply(t,arguments)}),this.addHook("afterInit",function(){return n.sortBySettings()}),this.addHook("afterLoadData",function(){n.hot.sortIndex=[];n.hot.view&&n.sortBySettings()}),this.hot.view&&this.sortBySettings(),$traceurRuntime.superGet(this,c.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.hot.sort=void 0;$traceurRuntime.superGet(this,c.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function(){this.sortBySettings()},sortBySettings:function(){var r=this.hot.getSettings().columnSorting,n=this.loadSortingState(),t,i;typeof n=="undefined"?(t=r.column,i=r.sortOrder):(t=n.sortColumn,i=n.sortOrder);this.sortByColumn(t,i)},setSortingColumn:function(n,t){if(typeof n=="undefined"){this.hot.sortColumn=void 0;this.hot.sortOrder=void 0;return}this.hot.sortOrder=this.hot.sortColumn===n&&typeof t=="undefined"?this.hot.sortOrder===!1?void 0:!this.hot.sortOrder:typeof t=="undefined"?!0:t;this.hot.sortColumn=n},sortByColumn:function(n,t){(this.setSortingColumn(n,t),typeof this.hot.sortColumn!="undefined")&&(Handsontable.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.sort(),this.hot.render(),this.saveSortingState(),Handsontable.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder))},saveSortingState:function(){var n={};typeof this.hot.sortColumn!="undefined"&&(n.sortColumn=this.hot.sortColumn);typeof this.hot.sortOrder!="undefined"&&(n.sortOrder=this.hot.sortOrder);(n.hasOwnProperty("sortColumn")||n.hasOwnProperty("sortOrder"))&&Handsontable.hooks.run(this.hot,"persistentStateSave","columnSorting",n)},loadSortingState:function(){var n={};return Handsontable.hooks.run(this.hot,"persistentStateLoad","columnSorting",n),n.value},bindColumnSortingAfterClick:function(){function i(){var t=n.hot.view.TBODY.querySelector("tr"),i=1;return t&&(i=t.querySelectorAll("th").length),i}function r(t){var r=p(t,"TH");return n.hot.view.wt.wtTable.getFirstRenderedColumn()+b(r)-i()}if(!this.bindedSortEvent){var t=d(this.hot),n=this;this.bindedSortEvent=!0;t.addEventListener(this.hot.rootElement,"click",function(t){if(w(t.target,"columnSorting")){var i=r(t.target);if(i===this.lastSortedColumn)switch(n.hot.sortOrder){case void 0:n.sortOrderClass="ascending";break;case!0:n.sortOrderClass="descending";break;case!1:n.sortOrderClass=void 0}else n.sortOrderClass="ascending";this.lastSortedColumn=i;n.sortByColumn(i)}})}},enableObserveChangesPlugin:function(){var n=this;this.hot._registerTimeout(setTimeout(function(){n.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(n){return function(t,i){return(typeof t[1]=="string"&&(t[1]=t[1].toLowerCase()),typeof i[1]=="string"&&(i[1]=i[1].toLowerCase()),t[1]===i[1])?0:t[1]===null||t[1]===""?1:i[1]===null||i[1]===""?-1:isNaN(t[1])&&!isNaN(i[1])?n?1:-1:!isNaN(t[1])&&isNaN(i[1])?n?-1:1:t[1]<i[1]?n?-1:1:t[1]>i[1]?n?1:-1:0}},dateSort:function(n){return function(t,i){if(t[1]===i[1])return 0;if(t[1]===null||t[1]==="")return 1;if(i[1]===null||i[1]==="")return-1;var r=new Date(t[1]),u=new Date(i[1]);return r<u?n?-1:1:r>u?n?1:-1:0}},sort:function(){var t,i,r,u,n;if(typeof this.hot.sortOrder=="undefined"){this.hot.sortIndex.length=0;return}for(this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0,r=this.hot.colOffset(),n=0,u=this.hot.countRows()-this.hot.getSettings().minSpareRows;n<u;n++)this.hot.sortIndex.push([n,this.hot.getDataAtCell(n,this.hot.sortColumn+r)]);t=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=t.sortIndicator;switch(t.type){case"date":i=this.dateSort;break;default:i=this.defaultSort}for(this.hot.sortIndex.sort(i(this.hot.sortOrder)),n=this.hot.sortIndex.length;n<this.hot.countRows();n++)this.hot.sortIndex.push([n,this.hot.getDataAtCell(n,this.hot.sortColumn+r)]);this.hot.sortingEnabled=!0},translateRow:function(n){return this.hot.sortingEnabled&&typeof this.hot.sortOrder!="undefined"&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[n]?this.hot.sortIndex[n][0]:n},untranslateRow:function(n){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==n)return t},getColHeader:function(n,t){var i=t.querySelector(".colHeader"),f=t.getAttribute("colspan"),u=t.parentNode.parentNode.childNodes,r=Array.prototype.indexOf.call(u,t.parentNode);(r=r-u.length,i)&&(this.hot.getSettings().columnSorting&&n>=0&&r===-1&&l(i,"columnSorting"),v(i,"descending"),v(i,"ascending"),this.sortIndicators[n]&&n===this.hot.sortColumn&&(this.sortOrderClass==="ascending"?l(i,"ascending"):this.sortOrderClass==="descending"&&l(i,"descending")))},isSorted:function(){return typeof this.hot.sortColumn!="undefined"},afterCreateRow:function(n,t){var i;if(this.isSorted()){for(i=0;i<this.hot.sortIndex.length;i++)this.hot.sortIndex[i][0]>=n&&(this.hot.sortIndex[i][0]+=t);for(i=0;i<t;i++)this.hot.sortIndex.splice(n+i,0,[n+i,this.hot.getSourceData()[n+i][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(n,t){function r(n){return k(i,function(t,i){return n>i&&t++,t},0)}if(this.isSorted()){var i=this.hot.sortIndex.splice(n,t);i=y(i,function(n){return n[0]});this.hot.sortIndex=y(this.hot.sortIndex,function(n){var t=r(n[0]);return t&&(n[0]-=t),n});this.saveSortingState()}}},{},g);nt("columnSorting",h)},{_base:58,eventManager:41,"helpers/array":42,"helpers/dom/element":45,plugins:57}],63:[function(n,t,i){"use strict";Object.defineProperties(i,{CommentEditor:{get:function(){return e}},__esModule:{value:!0}});var r,f=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).addClass,e=function(){this.editor=this.createEditor();this.editorStyle=this.editor.style;this.editorStyle.position="absolute";this.editorStyle.zIndex=100;this.hide()},u=e;$traceurRuntime.createClass(e,{setPosition:function(n,t){this.editorStyle.left=n+"px";this.editorStyle.top=t+"px"},show:function(){this.editorStyle.display="block"},hide:function(){this.editorStyle.display="none"},isVisible:function(){return this.editorStyle.display==="block"},setValue:function(){var n=arguments[0]!==void 0?arguments[0]:"";n=n||"";this.getInputElement().value=n},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var n=document.querySelector("."+u.CLASS_EDITOR_CONTAINER),t,i;return n||(n=document.createElement("div"),f(n,u.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),t=document.createElement("div"),f(t,u.CLASS_EDITOR),i=document.createElement("textarea"),f(i,u.CLASS_INPUT),t.appendChild(i),n.appendChild(t),t},getInputElement:function(){return this.editor.querySelector("."+u.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor);this.editor=null;this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":45}],64:[function(n,t,i){"use strict";Object.defineProperties(i,{Comments:{get:function(){return l}},__esModule:{value:!0}});var u,f,e,o,s,h,r=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),w=r.addClass,b=r.closest,v=r.getWindowScrollLeft,y=r.getWindowScrollTop,k=r.hasClass,d=r.offset,g=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).EventManager,c=(e=n("3rdparty/walkontable/src/cell/coords"),e&&e.__esModule&&e||{"default":e}).WalkontableCellCoords,p=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}),nt=p.registerPlugin,rt=p.getPlugin,tt=(s=n("_base"),s&&s.__esModule&&s||{"default":s}).default,it=(h=n("commentEditor"),h&&h.__esModule&&h||{"default":h}).CommentEditor,l=function(n){$traceurRuntime.superConstructor(a).call(this,n);this.editor=null;this.eventManager=null;this.range={};this.mouseDown=!1;this.contextMenuEvent=!1;this.timer=null},a=l;$traceurRuntime.createClass(l,{isEnabled:function(){return this.hot.getSettings().comments},enablePlugin:function(){var n=this;this.enabled||(this.editor||(this.editor=new it),this.eventManager||(this.eventManager=new g(this)),this.addHook("afterContextMenuDefaultOptions",function(t){return n.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,i,r,u,f,e){return n.onAfterRenderer(t,e)}),this.addHook("afterScrollHorizontally",function(){return n.refreshEditorPosition()}),this.addHook("afterScrollVertically",function(){return n.refreshEditorPosition()}),this.addHook("afterColumnResize",function(){return n.refreshEditorPosition()}),this.addHook("afterRowResize",function(){return n.refreshEditorPosition()}),this.registerListeners(),$traceurRuntime.superGet(this,a.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,a.prototype,"disablePlugin").call(this)},registerListeners:function(){var n=this;this.eventManager.addEventListener(document,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(document,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(document,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(document,"mouseup",function(t){return n.onMouseUp(t)});this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return n.onEditorBlur(t)})},setRange:function(n){this.range=n},clearRange:function(){this.range={}},targetIsCellWithComment:function(n){return k(n.target,"htCommentCell")&&b(n.target,[this.hot.rootElement])?!0:!1},targetIsCommentTextArea:function(n){return this.editor.getInputElement()===n.target},saveComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.editor.getValue(),t=this.range.from.row,i=this.range.from.col;this.hot.setCellMeta(t,i,"comment",n);this.hot.render()},saveCommentAtCell:function(n,t){this.setRange({from:new c(n,t)});this.saveComment()},removeComment:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.removeCellMeta(this.range.from.row,this.range.from.col,"comment");this.hot.render();this.hide()},removeCommentAtCell:function(n,t){this.setRange({from:new c(n,t)});this.removeComment()},show:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditorPosition(!0),this.editor.setValue(n.comment||""),this.editor.show(),!0},showAtCell:function(n,t){return this.setRange({from:new c(n,t)}),this.show()},hide:function(){this.editor.hide()},refreshEditorPosition:function(){var h=arguments[0]!==void 0?arguments[0]:!1;if(h||this.range.from&&this.editor.isVisible()){var c=this.hot.view.wt.wtTable.getCell(this.range.from),e=d(c),l=this.hot.getColWidth(this.range.from.col),i=e.top,r=e.left,o=0,s=0;this.hot.view.wt.wtViewport.hasVerticalScroll()&&(i=i-this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition(),o=20);this.hot.view.wt.wtViewport.hasHorizontalScroll()&&(r=r-this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition(),s=20);var u=r+l,f=i,n=this.hot.view.wt.wtTable.holder.getBoundingClientRect(),t={left:n.left+v()+s,right:n.right+v()-15,top:n.top+y()+o,bottom:n.bottom+y()};u<=t.left||u>t.right||f<=t.top||f>t.bottom?this.hide():this.editor.setPosition(u,f)}},onMouseDown:function(n){(this.mouseDown=!0,this.hot.view&&this.hot.view.wt)&&(this.contextMenuEvent||this.targetIsCommentTextArea(n)||this.targetIsCellWithComment(n)||this.hide(),this.contextMenuEvent=!1)},onMouseOver:function(n){if(!this.mouseDown&&!this.editor.isFocused())if(this.targetIsCellWithComment(n)){var t=this.hot.view.wt.wtTable.getCoords(n.target),i={from:new c(t.row,t.col)};this.setRange(i);this.show()}else this.targetIsCommentTextArea(n)||this.editor.isFocused()||this.hide()},onMouseMove:function(n){var t=this;this.targetIsCommentTextArea(n)&&(this.mouseDown=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.mouseDown=!1},200))},onMouseUp:function(){this.mouseDown=!1},onAfterRenderer:function(n,t){t.comment&&w(n,t.commentedCellClassName)},onEditorBlur:function(){this.saveComment()},checkSelectionCommentsConsistency:function(){var i=this.hot.getSelectedRange(),n,t;return i?(n=!1,t=i.from,this.hot.getCellMeta(t.row,t.col).comment&&(n=!0),n):!1},onContextMenuAddComment:function(){var n=this,t=this.hot.getSelectedRange();this.contextMenuEvent=!0;this.setRange({from:t.from});this.show();setTimeout(function(){n.hot&&(n.hot.deselectCell(),n.editor.focus())},10)},onContextMenuRemoveComment:function(n,t){this.contextMenuEvent=!0;this.removeCommentAtCell(t.start.row,t.start.col)},addToContextMenu:function(n){var t=this;n.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return this.getSelected()?!1:!0}},{key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(n,i){return t.onContextMenuRemoveComment(n,i)},disabled:function(){return!t.checkSelectionCommentsConsistency()}})},destroy:function(){this.editor&&this.editor.destroy();$traceurRuntime.superGet(this,a.prototype,"destroy").call(this)}},{},tt);nt("comments",l)},{"3rdparty/walkontable/src/cell/coords":5,_base:58,commentEditor:63,eventManager:41,"helpers/dom/element":45,plugins:57}],65:[function(n,t,i){"use strict";function e(n,t){var i;return u(t,function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===n)return i=t,!1}),i}Object.defineProperties(i,{CommandExecutor:{get:function(){return f}},__esModule:{value:!0}});var r,u=(r=n("helpers/array"),r&&r.__esModule&&r||{"default":r}).arrayEach,f=function(n){this.hot=n;this.commands={};this.commonCallback=null};$traceurRuntime.createClass(f,{registerCommand:function(n,t){this.commands[n]=t},setCommonCallback:function(n){this.commonCallback=n},execute:function(n){for(var h,r,s,t,o,f=[],i=1;i<arguments.length;i++)f[i-1]=arguments[i];if(h=this,r=n.split(":"),n=r[0],s=r.length===2?r[1]:null,t=this.commands[n],!t)throw new Error("Menu command '"+n+"' not exists.");(s&&t.submenu&&(t=e(s,t.submenu.items)),t.disabled!==!0)&&(typeof t.disabled!="function"||t.disabled.call(this.hot)!==!0)&&(t.hasOwnProperty("submenu")||(o=[],typeof t.callback=="function"&&o.push(t.callback),typeof this.commonCallback=="function"&&o.push(this.commonCallback),f.unshift(r.join(":")),u(o,function(n){return n.apply(h.hot,f)})))}},{})},{"helpers/array":42}],66:[function(n,t,i){"use strict";Object.defineProperties(i,{ContextMenu:{get:function(){return w}},__esModule:{value:!0}});var f,e,o,s,h,c,l,a,v,y,p,g=(f=n("_base"),f&&f.__esModule&&f||{"default":f}).default,nt=(e=n("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayEach,tt=(o=n("commandExecutor"),o&&o.__esModule&&o||{"default":o}).CommandExecutor,it=(s=n("eventManager"),s&&s.__esModule&&s||{"default":s}).EventManager,k=(h=n("helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).hasClass,rt=(c=n("itemsFactory"),c&&c.__esModule&&c||{"default":c}).ItemsFactory,ut=(l=n("menu"),l&&l.__esModule&&l||{"default":l}).Menu,d=(a=n("helpers/object"),a&&a.__esModule&&a||{"default":a}),bt=d.objectEach,kt=d.mixin,ft=(v=n("plugins"),v&&v.__esModule&&v||{"default":v}).registerPlugin,et=(y=n("helpers/dom/event"),y&&y.__esModule&&y||{"default":y}).stopPropagation,r=(p=n("predefinedItems"),p&&p.__esModule&&p||{"default":p}),ot=r.ROW_ABOVE,st=r.ROW_BELOW,ht=r.COLUMN_LEFT,ct=r.COLUMN_RIGHT,lt=r.REMOVE_ROW,at=r.REMOVE_COLUMN,vt=r.UNDO,yt=r.REDO,pt=r.READ_ONLY,wt=r.ALIGNMENT,u=r.SEPARATOR,dt=r.predefinedItems,w=function(n){$traceurRuntime.superConstructor(b).call(this,n);this.eventManager=new it(this);this.commandExecutor=new tt(this.hot);this.itemsFactory=null;this.menu=null},b=w;$traceurRuntime.createClass(w,{isEnabled:function(){return this.hot.getSettings().contextMenu},enablePlugin:function(){var n=this,t,i;this.enabled||(this.itemsFactory=new rt(this.hot,b.DEFAULT_ITEMS),t=this.hot.getSettings().contextMenu,i={items:this.itemsFactory.getVisibleItems(t)},this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),$traceurRuntime.superGet(this,b.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){n.hot.runHooks("afterContextMenuDefaultOptions",i);n.itemsFactory.setPredefinedItems(i.items);var r=n.itemsFactory.getVisibleItems(t);n.menu=new ut(n.hot,{className:"htContextMenu",keepInViewport:!0});n.menu.setMenuItems(r);n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()});n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()});n.menu.addLocalHook("executeCommand",function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return n.executeCommand.apply(n,i)});nt(r,function(t){return n.commandExecutor.registerCommand(t.key,t)})}))},disablePlugin:function(){this.close();this.menu&&(this.menu.destroy(),this.menu=null);$traceurRuntime.superGet(this,b.prototype,"disablePlugin").call(this)},registerEvents:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return n.onContextMenu(t)})},open:function(n){this.menu&&(this.menu.open(),this.menu.setPosition(n),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,Handsontable.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.commandExecutor.execute.apply(this.commandExecutor,t)},onContextMenu:function(n){function e(n){return n.nodeName==="TD"||n.parentNode.nodeName==="TD"}var i=this.hot.getSettings(),r=i.rowHeaders,u=i.colHeaders,t=n.realTarget,f;if(this.close(),n.preventDefault(),et(n),r||u){if(r&&u&&(f=t.parentNode.querySelectorAll(".cornerHeader").length>0,f))return}else if(!e(t)&&!(k(t,"current")&&k(t,"wtBorder")))return;this.open(n)},onMenuAfterOpen:function(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function(){this.hot.listen();this.hot.runHooks("afterContextMenuHide",this)},destroy:function(){this.close();this.menu&&this.menu.destroy();$traceurRuntime.superGet(this,b.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[ot,st,u,ht,ct,u,lt,at,u,vt,yt,u,pt,u,wt]}},g);w.SEPARATOR={name:u};Handsontable.hooks.register("afterContextMenuDefaultOptions");Handsontable.hooks.register("afterContextMenuShow");Handsontable.hooks.register("afterContextMenuHide");Handsontable.hooks.register("afterContextMenuExecute");ft("contextMenu",w)},{_base:58,commandExecutor:65,eventManager:41,"helpers/array":42,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/object":50,itemsFactory:68,menu:69,plugins:57,predefinedItems:70}],67:[function(n,t,i){"use strict";Object.defineProperties(i,{Cursor:{get:function(){return f}},__esModule:{value:!0}});var r,u,e=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),s=e.getWindowScrollLeft,h=e.getWindowScrollTop,o=(u=n("helpers/dom/event"),u&&u.__esModule&&u||{"default":u}),c=o.pageX,l=o.pageY,f=function(n){var f=h(),e=s(),t,o,i,a,v,y,r,u;this.type=this.getSourceType(n);this.type==="literal"?(t=parseInt(n.top,10),i=parseInt(n.left,10),r=n.height,u=n.width):this.type==="event"&&(t=parseInt(l(n),10),i=parseInt(c(n),10),r=n.target.clientHeight,u=n.target.clientWidth);o=t-f;a=i-e;v=f;y=e;this.top=t;this.topRelative=o;this.left=i;this.leftRelative=a;this.scrollTop=v;this.scrollLeft=y;this.cellHeight=r;this.cellWidth=u};$traceurRuntime.createClass(f,{getSourceType:function(n){var t="literal";return n instanceof Event&&(t="event"),t},fitsAbove:function(n){return this.topRelative>=n.offsetHeight},fitsBelow:function(n){var t=arguments[1]!==void 0?arguments[1]:window.innerHeight;return this.topRelative+n.offsetHeight<=t},fitsOnRight:function(n){var t=arguments[1]!==void 0?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+n.offsetWidth<=t},fitsOnLeft:function(n){return this.leftRelative>=n.offsetWidth}},{});Handsontable.plugins.utils=Handsontable.plugins.utils||{};Handsontable.plugins.utils.Cursor=f},{"helpers/dom/element":45,"helpers/dom/event":46}],68:[function(n,t,i){"use strict";function v(){var n=arguments[0]!==void 0?arguments[0]:null,r=arguments[1]!==void 0?arguments[1]:[],i=arguments[2]!==void 0?arguments[2]:{},t=[];return n&&n.items?n=n.items:Array.isArray(n)||(n=r),h(n)?s(n,function(n,r){var u=i[typeof n=="string"?n:r];u||(u=n);h(n)?l(u,n):typeof u=="string"&&(u={name:u});u.key===void 0&&(u.key=r);t.push(u)}):y(n,function(n,r){var u=i[n];!u&&p.indexOf(n)>=0||(u||(u={name:n,key:r+""}),h(n)&&l(u,n),u.key===void 0&&(u.key=r),t.push(u))}),t[0].name===e&&t.shift(),t}Object.defineProperties(i,{ItemsFactory:{get:function(){return a}},__esModule:{value:!0}});var r,u,f,o=(r=n("helpers/object"),r&&r.__esModule&&r||{"default":r}),s=o.objectEach,h=o.isObject,l=o.extend,y=(u=n("helpers/array"),u&&u.__esModule&&u||{"default":u}).arrayEach,c=(f=n("predefinedItems"),f&&f.__esModule&&f||{"default":f}),e=c.SEPARATOR,p=c.ITEMS,w=c.predefinedItems,a=function(n){var t=arguments[1]!==void 0?arguments[1]:null;this.hot=n;this.predefinedItems=w();this.defaultOrderPattern=t};$traceurRuntime.createClass(a,{setPredefinedItems:function(n){var i=this,t={};this.defaultOrderPattern.length=0;s(n,function(n,r){var u="";n.name===e?(t[e]=n,u=e):isNaN(parseInt(r,10))?(n.key=n.key===void 0?r:n.key,t[r]=n,u=n.key):(t[n.key]=n,u=n.key);i.defaultOrderPattern.push(u)});this.predefinedItems=t},getVisibleItems:function(){var t=arguments[0]!==void 0?arguments[0]:null,i=this,n={};return s(this.predefinedItems,function(t,r){t.hidden&&(!t.hidden||t.hidden.apply(i.hot))||(n[r]=t)}),v(t,this.defaultOrderPattern,n)},getItems:function(){var n=arguments[0]!==void 0?arguments[0]:null;return v(n,this.defaultOrderPattern,this.predefinedItems)}},{})},{"helpers/array":42,"helpers/object":50,predefinedItems:70}],69:[function(n,t,i){"use strict";Object.defineProperties(i,{Menu:{get:function(){return tt}},__esModule:{value:!0}});var e,o,s,h,c,l,a,v,y,p,r=(e=n("helpers/dom/element"),e&&e.__esModule&&e||{"default":e}),u=r.addClass,ot=r.empty,st=r.fastInnerHTML,kt=r.getComputedStyle,ht=r.getScrollbarWidth,dt=r.getWindowScrollLeft,gt=r.getWindowScrollTop,ni=r.hasClass,it=r.isChildOf,rt=r.removeClass,ut=(o=n("helpers/array"),o&&o.__esModule&&o||{"default":o}).arrayEach,ct=(s=n("cursor"),s&&s.__esModule&&s||{"default":s}).Cursor,lt=(h=n("eventManager"),h&&h.__esModule&&h||{"default":h}).EventManager,b=(c=n("helpers/object"),c&&c.__esModule&&c||{"default":c}),ti=b.extend,ii=b.isObject,ri=b.objectEach,at=b.mixin,w=(l=n("utils"),l&&l.__esModule&&l||{"default":l}),k=w.isSeparator,d=w.isDisabled,g=w.isSelectionDisabled,vt=w.hasSubMenu,yt=w.normalizeSelection,f=(a=n("helpers/unicode"),a&&a.__esModule&&a||{"default":a}).KEY_CODES,pt=(v=n("mixins/localHooks"),v&&v.__esModule&&v||{"default":v}).localHooks,ft=(y=n("predefinedItems"),y&&y.__esModule&&y||{"default":y}),et=ft.SEPARATOR,ui=ft.predefinedItems,nt=(p=n("helpers/dom/event"),p&&p.__esModule&&p||{"default":p}),fi=nt.stopPropagation,wt=nt.stopImmediatePropagation,ei=nt.pageX,oi=nt.pageY,tt=function(n){var t=arguments[1]!==void 0?arguments[1]:{parent:null,name:null,className:"",keepInViewport:!0};this.hot=n;this.options=t;this.eventManager=new lt(this);this.container=this.createContainer(this.options.name);this.hotMenu=null;this.hotSubMenus={};this.parentMenu=this.options.parent||null;this.menuItems=null;this.origOutsideClickDeselects=null;this._afterScrollCallback=null;this.registerEvents()},bt=tt;$traceurRuntime.createClass(tt,{registerEvents:function(){var n=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return n.onDocumentMouseDown(t)})},setMenuItems:function(n){this.menuItems=n},isSubMenu:function(){return this.parentMenu!==null},open:function(){var n=this,t;this.container.removeAttribute("style");this.container.style.display="block";t={data:this.menuItems,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,i,r,u,f,e){return n.menuItemRenderer(t,i,r,u,f,e)}}],renderAllRows:!0,fragmentSelection:"cell",beforeKeyDown:function(t){return n.onBeforeKeyDown(t)},afterOnCellMouseOver:function(t,i){return n.openSubMenu(i.row)}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1;this.hotMenu=new Handsontable.Core(this.container,t);this.hotMenu.addHook("afterInit",function(){return n.onAfterInit()});this.hotMenu.init();this.hotMenu.listen();this.blockMainTableCallbacks();this.runLocalHooks("afterOpen")},close:function(){var n=arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(n&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose")))},openSubMenu:function(n){var r=this.hotMenu.getCell(n,0),i,t;return(this.closeAllSubMenus(),!r||!vt(r))?!1:(i=this.hotMenu.getSourceDataAtRow(n),t=new bt(this.hot,{parent:this,name:i.name,className:this.options.className}),t.setMenuItems(i.submenu.items),t.open(),t.setPosition(r.getBoundingClientRect()),this.hotSubMenus[i.key]=t,t)},closeSubMenu:function(n){var t=this.hotMenu.getSourceDataAtRow(n),i=this.hotSubMenus[t.key];i&&(i.destroy(),delete this.hotSubMenus[t.key])},closeAllSubMenus:function(){var n=this;ut(this.hotMenu.getData(),function(t,i){return n.closeSubMenu(i)})},isAllSubMenusClosed:function(){return Object.keys(this.hotSubMenus).length===0},destroy:function(){this.clearLocalHooks();this.close();this.parentMenu=null;this.eventManager.destroy()},isOpened:function(){return this.hotMenu!==null},executeCommand:function(n){var t,i,r;this.isOpened()&&this.hotMenu.getSelected()&&(t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]),this.runLocalHooks("select",t,n),t.isCommand!==!1)&&(i=this.hot.getSelectedRange(),r=i?yt(i):{},this.runLocalHooks("executeCommand",t.key,r,n),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,n),this.close(!0))},setPosition:function(n){var t=new ct(n);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))},setPositionAboveCursor:function(n){var t=n.top-this.container.offsetHeight;this.isSubMenu()&&(t=window.scrollY+n.top+n.cellHeight-this.container.offsetHeight+3);this.container.style.top=t+"px"},setPositionBelowCursor:function(n){var t=n.top-1;this.isSubMenu()&&(t=n.top+window.scrollY-1);this.container.style.top=t+"px"},setPositionOnRightOfCursor:function(n){var t;t=this.isSubMenu()?window.scrollX+1+n.left+n.cellWidth:1+n.left;this.container.style.left=t+"px"},setPositionOnLeftOfCursor:function(n){this.container.style.left=n.left-this.container.offsetWidth+ht()+4+"px"},selectFirstCell:function(){var n=this.hotMenu.getCell(0,0);k(n)||d(n)||g(n)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)},selectLastCell:function(){var n=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(n,0);k(t)||d(t)||g(t)?this.selectPrevCell(n,0):this.hotMenu.selectCell(n,0)},selectNextCell:function(n,t){var i=n+1,r=i<this.hotMenu.countRows()?this.hotMenu.getCell(i,t):null;r&&(k(r)||d(r)||g(r)?this.selectNextCell(i,t):this.hotMenu.selectCell(i,t))},selectPrevCell:function(n,t){var i=n-1,r=i>=0?this.hotMenu.getCell(i,t):null;r&&(k(r)||d(r)||g(r)?this.selectPrevCell(i,t):this.hotMenu.selectCell(i,t))},menuItemRenderer:function(n,t,i,r,f,e){var c=this,s=n.getSourceDataAtRow(i),o=document.createElement("div"),a=function(n){return n.hasOwnProperty("submenu")},v=function(n){return new RegExp(et,"i").test(n.name)},y=function(n){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(c.hot)===!0},p=function(n){return typeof n.hidden=="function"&&n.hidden.call(c.hot)===!0},h=function(n){return n.disableSelection},l=p(s);typeof e=="function"&&(e=e.call(this.hot));ot(t);u(o,"htItemWrapper");t.appendChild(o);v(s)?u(t,"htSeparator"):l||typeof s.renderer!="function"?st(o,e):(u(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(n,o,i,r,f,e)));l?t.parentNode&&u(t.parentNode,"htHidden"):y(s)?(u(t,"htDisabled"),this.eventManager.addEventListener(o,"mouseenter",function(){return n.deselectCell()})):h(s)?(u(t,"htSelectionDisabled"),this.eventManager.addEventListener(o,"mouseenter",function(){return n.deselectCell()})):a(s)?(u(t,"htSubmenu"),h(s)?this.eventManager.addEventListener(o,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(o,"mouseenter",function(){return n.selectCell(i,r,void 0,void 0,void 0,!1)})):(rt(t,"htSubmenu"),rt(t,"htDisabled"),h(s)?this.eventManager.addEventListener(o,"mouseenter",function(){return n.deselectCell()}):this.eventManager.addEventListener(o,"mouseenter",function(){return n.selectCell(i,r,void 0,void 0,void 0,!1)}))},createContainer:function(){var n=arguments[0]!==void 0?arguments[0]:null,t;return n&&(n=n.replace(/ /g,"_"),n=this.options.className+"Sub_"+n),t=n?document.querySelector("."+this.options.className+"."+n):document.querySelector("."+this.options.className),t||(t=document.createElement("div"),u(t,"htMenu "+this.options.className),n&&u(t,n),document.getElementsByTagName("body")[0].appendChild(t)),t},blockMainTableCallbacks:function(){this._afterScrollCallback=function(){};this.hot.addHook("afterScrollVertically",this._afterScrollCallback);this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},onBeforeKeyDown:function(n){var t=this.hotMenu.getSelected(),i=!1,r;switch(n.keyCode){case f.ESCAPE:this.close();i=!0;break;case f.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?i=!0:(this.executeCommand(n),this.close(!0)));break;case f.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell();i=!0;break;case f.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell();i=!0;break;case f.ARROW_RIGHT:t&&(r=this.openSubMenu(t[0]),r&&r.selectFirstCell());i=!0;break;case f.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),i=!0)}i&&(n.preventDefault(),wt(n))},onAfterInit:function(){var i=this.hotMenu.getSettings().data,r=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,u=parseInt(r.width,10),t=0;ut(i,function(n){return t+=n.name===et?1:26});n.width=u+22+"px";n.height=t+4+"px"},onDocumentMouseDown:function(n){this.isOpened()&&(this.container&&it(n.target,this.container)&&this.executeCommand(n),(this.isAllSubMenusClosed()||this.isSubMenu())&&!it(n.target,".htMenu")&&it(n.target,document)&&this.close(!0))}},{});at(tt,pt)},{cursor:67,eventManager:41,"helpers/array":42,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/object":50,"helpers/unicode":53,"mixins/localHooks":54,predefinedItems:70,utils:71}],70:[function(n,t,i){"use strict";function ht(){var n={};return ot(ut,function(t,i){return n[i]=st(t)}),n}function ct(n,t){et.indexOf(n)===-1&&(ut[n]=t)}var r,ut;Object.defineProperties(i,{ROW_ABOVE:{get:function(){return p}},ROW_BELOW:{get:function(){return w}},COLUMN_LEFT:{get:function(){return b}},COLUMN_RIGHT:{get:function(){return k}},CLEAR_COLUMN:{get:function(){return d}},REMOVE_ROW:{get:function(){return g}},REMOVE_COLUMN:{get:function(){return nt}},UNDO:{get:function(){return tt}},REDO:{get:function(){return it}},READ_ONLY:{get:function(){return rt}},ALIGNMENT:{get:function(){return u}},SEPARATOR:{get:function(){return y}},ITEMS:{get:function(){return et}},predefinedItems:{get:function(){return ht}},addItem:{get:function(){return ct}},__esModule:{value:!0}});var c,l,a,ft=(c=n("helpers/object"),c&&c.__esModule&&c||{"default":c}),ot=ft.objectEach,st=ft.clone,lt=(l=n("helpers/number"),l&&l.__esModule&&l||{"default":l}).rangeEach,v=(a=n("utils"),a&&a.__esModule&&a||{"default":a}),o=v.align,s=v.getAlignmentClasses,h=v.getValidSelection,f=v.checkSelectionConsistency,e=v.markLabelAsSelected,p="row_above",w="row_below",b="col_left",k="col_right",d="clear_column",g="remove_row",nt="remove_col",tt="undo",it="redo",rt="make_read_only",u="alignment",y="---------",et=[p,w,b,k,d,g,nt,tt,it,rt,u,y];ut=(r={},Object.defineProperty(r,y,{value:{name:y},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,p,{value:{key:p,name:"Insert row above",callback:function(n,t){this.alter("insert_row",t.start.row)},disabled:function(){var n=h(this),t,i;return n?(t=this.countRows(),i=[0,n[1],t-1,n[1]],i.join(",")===n.join(",")&&t>1):!0},hidden:function(){return!this.getSettings().allowInsertRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,w,{value:{key:w,name:"Insert row below",callback:function(n,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var n=h(this),t,i;return n?(t=this.countRows(),i=[0,n[1],t-1,n[1]],i.join(",")===n.join(",")&&t>1):!0},hidden:function(){return!this.getSettings().allowInsertRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,b,{value:{key:b,name:"Insert column on the left",callback:function(n,t){this.alter("insert_col",t.start.col)},disabled:function(){var n=h(this),t,i;return n?this.isColumnModificationAllowed()?(t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(","),n[1]<0||this.countCols()>=this.getSettings().maxCols||i):!0:!0},hidden:function(){return!this.getSettings().allowInsertColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,k,{value:{key:k,name:"Insert column on the right",callback:function(n,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var n=h(this),t,i;return n?this.isColumnModificationAllowed()?(t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(","),n[1]<0||this.countCols()>=this.getSettings().maxCols||i):!0:!0},hidden:function(){return!this.getSettings().allowInsertColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,d,{value:{key:d,name:"Clear column",callback:function(n,t){var i=t.start.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(t.start.row,t.end.row),i)},disabled:function(){var n=h(this),t,i;return n?(t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(","),n[1]<0||this.countCols()>=this.getSettings().maxCols||i):!0}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,g,{value:{key:g,name:"Remove row",callback:function(n,t){var i=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,i)},disabled:function(){var n=h(this),t;return n?(t=[0,n[1],this.countRows()-1,n[1]],t.join(",")===n.join(",")):!0},hidden:function(){return!this.getSettings().allowRemoveRow}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,nt,{value:{key:nt,name:"Remove column",callback:function(n,t){var i=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,i)},disabled:function(){var n=h(this),t,i;return n?this.isColumnModificationAllowed()?(t=[n[0],0,n[0],this.countCols()-1],i=t.join(",")==n.join(","),n[1]<0||i):!0:!0},hidden:function(){return!this.getSettings().allowRemoveColumn}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,tt,{value:{key:tt,name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,it,{value:{key:it,name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,rt,{value:{key:rt,name:function(){var t=this,n="Read only",i=f(this.getSelectedRange(),function(n,i){return t.getCellMeta(n,i).readOnly});return i&&(n=e(n)),n},callback:function(){var n=this,t=this.getSelectedRange(),i=f(t,function(t,i){return n.getCellMeta(t,i).readOnly});t.forAll(function(t,r){n.getCellMeta(t,r).readOnly=i?!1:!0});this.render()},disabled:function(){return this.getSelectedRange()?!1:!0}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,u,{value:{key:u,name:"Alignment",disabled:function(){return this.getSelectedRange()?!1:!0},submenu:{items:[{key:u+":left",name:function(){var t=this,n="Left",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htLeft")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{key:u+":center",name:function(){var t=this,n="Center",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htCenter")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{key:u+":right",name:function(){var t=this,n="Right",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htRight")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{key:u+":justify",name:function(){var t=this,n="Justify",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htJustify")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{name:y},{key:u+":top",name:function(){var t=this,n="Top",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htTop")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{key:u+":middle",name:function(){var t=this,n="Middle",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htMiddle")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1},{key:u+":bottom",name:function(){var t=this,n="Bottom",i=f(this.getSelectedRange(),function(n,i){var r=t.getCellMeta(n,i).className;if(r&&r.indexOf("htBottom")!==-1)return!0});return i&&(n=e(n)),n},callback:function(){var t=this,n=this.getSelectedRange(),u=s(n,function(n,i){return t.getCellMeta(n,i).className}),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",u,n,i,r);o(n,i,r,function(n,i){return t.getCellMeta(n,i)});this.render()},disabled:!1}]}},configurable:!0,enumerable:!0,writable:!0}),r)},{"helpers/number":49,"helpers/object":50,utils:71}],71:[function(n,t,i){"use strict";function s(n){return{start:n.getTopLeftCorner(),end:n.getBottomRightCorner()}}function h(n){return u(n,"htSeparator")}function c(n){return u(n,"htSubmenu")}function l(n){return u(n,"htDisabled")}function a(n){return u(n,"htSelectionDisabled")}function v(n){var t=n.getSelected();return t?t[0]<0?null:n.countRows()>=n.getSettings().maxRows?null:t:null}function f(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),n+(" "+t))}function e(n,t){return n.indexOf(t)!=-1?n:(n=n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),n+(" "+t))}function y(n,t){for(var r,u={},i=n.from.row;i<=n.to.row;i++)for(r=n.from.col;r<=n.to.col;r++)u[i]||(u[i]=[]),u[i][r]=t(i,r);return u}function p(n,t,i,r){var u,f;if(n.from.row==n.to.row&&n.from.col==n.to.col)o(n.from.row,n.from.col,t,i,r);else for(u=n.from.row;u<=n.to.row;u++)for(f=n.from.col;f<=n.to.col;f++)o(u,f,t,i,r)}function o(n,t,i,r,u){var o=u(n,t),s=r;o.className&&(s=i==="vertical"?f(o.className,r):e(o.className,r));o.className=s}function w(n,t){var i=!1;return n&&n.forAll(function(n,r){if(t(n,r))return i=!0,!1}),i}function b(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n}Object.defineProperties(i,{normalizeSelection:{get:function(){return s}},isSeparator:{get:function(){return h}},hasSubMenu:{get:function(){return c}},isDisabled:{get:function(){return l}},isSelectionDisabled:{get:function(){return a}},getValidSelection:{get:function(){return v}},prepareVerticalAlignClass:{get:function(){return f}},prepareHorizontalAlignClass:{get:function(){return e}},getAlignmentClasses:{get:function(){return y}},align:{get:function(){return p}},checkSelectionConsistency:{get:function(){return w}},markLabelAsSelected:{get:function(){return b}},__esModule:{value:!0}});var r,u=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).hasClass},{"helpers/dom/element":45}],72:[function(n,t,i){"use strict";Object.defineProperties(i,{ContextMenuCopyPaste:{get:function(){return h}},__esModule:{value:!0}});var r,u,f,e,o,s,a=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}).removeClass,v=(u=n("helpers/array"),u&&u.__esModule&&u||{"default":u}).arrayEach,y=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).EventManager,p=(e=n("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin,w=(o=n("_base"),o&&o.__esModule&&o||{"default":o}).default,c=(s=n("zeroclipboard"),s&&s.__esModule&&s||{"default":s}).default,h=function(n){$traceurRuntime.superConstructor(l).call(this,n);this.eventManager=new y(this);this.swfPath=null;this.outsideClickDeselectsCache=null},l=h;$traceurRuntime.createClass(h,{isEnabled:function(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function(){var n=this;if(!this.enabled){typeof this.hot.getSettings().contextMenuCopyPaste=="object"&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath);typeof c=="undefined"&&console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(t){typeof navigator.mimeTypes["application/x-shockwave-flash"]=="undefined"&&console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.swfPath&&c.config({swfPath:this.swfPath});this.hot.addHook("afterContextMenuShow",function(){return n.onAfterContextMenuShow()});this.hot.addHook("afterContextMenuDefaultOptions",function(t){return n.onAfterContextMenuDefaultOptions(t)});this.registerEvents();$traceurRuntime.superGet(this,l.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,l.prototype,"disablePlugin").call(this)},registerEvents:function(){var n=this;this.eventManager.addEventListener(document,"mouseenter",function(){return n.removeCurrentClass()});this.eventManager.addEventListener(document,"mouseleave",function(){return n.removeZeroClipboardClass()})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function(n){n.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},Handsontable.plugins.ContextMenu.SEPARATOR)},onAfterContextMenuShow:function(){var n=this,t=this.hot.getPlugin("contextMenu"),i=t.menu.hotMenu.getSourceData();v(i,function(i,r){if(i.key==="copy"){var u=new c(t.menu.hotMenu.getCell(r,0));u.off();u.on("copy",function(t){var i=t.clipboardData;i.setData("text/plain",n.getCopyValue());n.hot.getSettings().outsideClickDeselects=n.outsideClickDeselectsCache});return!1}})},removeCurrentClass:function(){var t=this.hot.getPlugin("contextMenu"),n;t.menu.isOpened()&&(n=t.menu.hotMenu.rootElement.querySelector("td.current"),n&&a(n,"current"));this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects;this.hot.getSettings().outsideClickDeselects=!1},removeZeroClipboardClass:function(){var t=this.hot.getPlugin("contextMenu"),n;t.menu.isOpened()&&(n=t.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover"),n&&a(n,"zeroclipboard-is-hover"));this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache}},{},w);p("contextMenuCopyPaste",h)},{_base:58,eventManager:41,"helpers/array":42,"helpers/dom/element":45,plugins:57,zeroclipboard:"zeroclipboard"}],73:[function(n,t,i){"use strict";function nt(n){function r(){n.isListening()&&n.selection.empty()}function i(t){var l,i,r,u,o,h,s,c,f,e,a,v;n.isListening()&&n.selection.isSelected()&&(l=t,i=b.parse(l),r=n.getSelected(),u=new w(r[0],r[1]),o=new w(r[2],r[3]),h=new st(u,u,o),s=h.getTopLeftCorner(),c=h.getBottomRightCorner(),f=s,e=new w(Math.max(c.row,i.length-1+s.row),Math.max(c.col,i[0].length-1+s.col)),a=o.row-u.row>=i.length-1,v=o.col-u.col>=i[0].length-1,n.addHookOnce("afterChange",function(t){var u=t?t.length:0,i,r;u&&(i={row:0,col:0},r=-1,y(t,function(n,f){var e=u>f+1?t[f+1]:null;e&&(a||(i.row=i.row+Math.max(e[0]-n[0]-1,0)),!v&&n[1]>r&&(r=n[1],i.col=i.col+Math.max(e[1]-n[1]-1,0)))}),n.selectCell(f.row,f.col,e.row+i.row,e.col+i.col))}),n.populateFromArray(f.row,f.col,i,e.row,e.col,"paste",n.getSettings().pasteMode))}function u(i){if(n.getSelected()&&(!n.getActiveEditor()||!n.getActiveEditor().isOpened())&&!et(i)){if(ut(i.keyCode)){if(n.getSettings().fragmentSelection&&ot())return;t.setCopyableText();ft(i);return}var r=(i.ctrlKey||i.metaKey)&&!i.altKey;i.keyCode==rt.A&&r&&n._registerTimeout(setTimeout(p(t.setCopyableText,t),0))}}var t=this;this.copyPasteInstance=it();this.copyPasteInstance.onCut(r);this.copyPasteInstance.onPaste(i);this.onPaste=i;n.addHook("beforeKeyDown",u);this.destroy=function(){this.copyPasteInstance&&(this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.destroy(),this.copyPasteInstance=null);n.removeHook("beforeKeyDown",u)};n.addHook("afterDestroy",p(this.destroy,this));this.triggerPaste=p(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=p(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var e=n.getSettings(),o=e.copyRowsLimit,s=e.copyColsLimit,h=n.getSelectedRange(),c=h.getTopLeftCorner(),l=h.getBottomRightCorner(),i=c.row,r=c.col,u=l.row,f=l.col,a=Math.min(u,i+o-1),v=Math.min(f,r+s-1),t=[],y;t.push({startRow:i,startCol:r,endRow:a,endCol:v});t=Handsontable.hooks.run(n,"modifyCopyableRange",t);y=this.getRangedCopyableData(t);n.copyPaste.copyPasteInstance.copyable(y);(u!==a||f!==v)&&Handsontable.hooks.run(n,"afterCopyLimit",u-i+1,f-r+1,o,s)};this.getRangedCopyableData=function(t){var u=[],i=[],r=[];return y(t,function(n){d(n.startRow,n.endRow,function(n){i.indexOf(n)===-1&&i.push(n)});d(n.startCol,n.endCol,function(n){r.indexOf(n)===-1&&r.push(n)})}),y(i,function(t){var i=[];y(r,function(r){i.push(n.getCopyableData(t,r))});u.push(i)}),b.stringify(u)}}function tt(){var n=this,t=n.getSettings().copyPaste!==!1;t&&!n.copyPaste?n.copyPaste=new nt(n):!t&&n.copyPaste&&(n.copyPaste.destroy(),n.copyPaste=null)}Object.defineProperties(i,{CopyPastePlugin:{get:function(){return nt}},__esModule:{value:!0}});var r,u,f,e,o,s,h,c,l,a,v,it=(r=n("copyPaste"),r&&r.__esModule&&r||{"default":r}).default,b=(u=n("SheetClip"),u&&u.__esModule&&u||{"default":u}).default,k=(f=n("helpers/unicode"),f&&f.__esModule&&f||{"default":f}),rt=k.KEY_CODES,ut=k.isCtrlKey,y=(e=n("helpers/array"),e&&e.__esModule&&e||{"default":e}).arrayEach,d=(o=n("helpers/number"),o&&o.__esModule&&o||{"default":o}).rangeEach,g=(s=n("helpers/dom/event"),s&&s.__esModule&&s||{"default":s}),ft=g.stopImmediatePropagation,et=g.isImmediatePropagationStopped,ot=(h=n("helpers/dom/element"),h&&h.__esModule&&h||{"default":h}).getSelectionText,p=(c=n("helpers/function"),c&&c.__esModule&&c||{"default":c}).proxy,ht=(l=n("plugins"),l&&l.__esModule&&l||{"default":l}).registerPlugin,w=(a=n("3rdparty/walkontable/src/cell/coords"),a&&a.__esModule&&a||{"default":a}).WalkontableCellCoords,st=(v=n("3rdparty/walkontable/src/cell/range"),v&&v.__esModule&&v||{"default":v}).WalkontableCellRange;Handsontable.hooks.add("afterInit",tt);Handsontable.hooks.add("afterUpdateSettings",tt);Handsontable.hooks.register("afterCopyLimit");Handsontable.hooks.register("modifyCopyableRange")},{"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,SheetClip:"SheetClip",copyPaste:"copyPaste","helpers/array":42,"helpers/dom/element":45,"helpers/dom/event":46,"helpers/function":47,"helpers/number":49,"helpers/unicode":53,plugins:57}],74:[function(n){"use strict";function v(){}var i,r,u,et=(i=n("plugins"),i&&i.__esModule&&i||{"default":i}).registerPlugin,w=(r=n("3rdparty/walkontable/src/cell/range"),r&&r.__esModule&&r||{"default":r}).WalkontableCellRange,b=(u=n("3rdparty/walkontable/src/selection"),u&&u.__esModule&&u||{"default":u}).WalkontableSelection,f,k=function(n){return typeof n=="boolean"&&n===!0?!0:typeof n=="object"&&n.length>0?!0:!1},d=function(){k(this.getSettings().customBorders)&&(this.customBorders||(f=this,this.customBorders=new v))},g=function(n){for(var t=0;t<f.view.wt.selections.length;t++)if(f.view.wt.selections[t].settings.className==n)return t;return-1},c=function(n){var t={row:n.row,col:n.col},i=new b(n,new w(t,t,t)),r=g(n.className);r>=0?f.view.wt.selections[r]=i:f.view.wt.selections.push(i)},nt=function(n,t,i){var r=a(n,t);r=ut(r,i);this.setCellMeta(n,t,"borders",r);c(r)},tt=function(n){for(var i,r,f,t=n.range,u=t.from.row;u<=t.to.row;u++)for(i=t.from.col;i<=t.to.col;i++)r=a(u,i),f=0,u==t.from.row&&(f++,n.hasOwnProperty("top")&&(r.top=n.top)),u==t.to.row&&(f++,n.hasOwnProperty("bottom")&&(r.bottom=n.bottom)),i==t.from.col&&(f++,n.hasOwnProperty("left")&&(r.left=n.left)),i==t.to.col&&(f++,n.hasOwnProperty("right")&&(r.right=n.right)),f>0&&(this.setCellMeta(u,i,"borders",r),c(r))},l=function(n,t){return"border_row"+n+"col"+t},it=function(){return{width:1,color:"#000"}},e=function(){return{hide:!0}},rt=function(){return{width:1,color:"#000",cornerVisible:!1}},a=function(n,t){return{className:l(n,t),border:rt(),row:n,col:t,top:e(),right:e(),bottom:e(),left:e()}},ut=function(n,t){return t.hasOwnProperty("border")&&(n.border=t.border),t.hasOwnProperty("top")&&(n.top=t.top),t.hasOwnProperty("right")&&(n.right=t.right),t.hasOwnProperty("bottom")&&(n.bottom=t.bottom),t.hasOwnProperty("left")&&(n.left=t.left),n},y=function(n){for(var r,i=document.querySelectorAll("."+n),t=0;t<i.length;t++)i[t]&&i[t].nodeName!="TD"&&(r=i[t].parentNode,r.parentNode&&r.parentNode.removeChild(r))},p=function(n,t){var i=l(n,t);y(i);this.removeCellMeta(n,t,"borders")},o=function(n,t,i,r){var u=this.getCellMeta(n,t).borders,f;u&&u.border!=undefined||(u=a(n,t));u[i]=r?e():it();this.setCellMeta(n,t,"borders",u);f=l(n,t);y(f);c(u);this.render()},s=function(n,t,i){var r,u,f,e,s,h;if(n.from.row==n.to.row&&n.from.col==n.to.col)t=="noBorders"?p.call(this,n.from.row,n.from.col):o.call(this,n.from.row,n.from.col,t,i);else switch(t){case"noBorders":for(r=n.from.col;r<=n.to.col;r++)for(u=n.from.row;u<=n.to.row;u++)p.call(this,u,r);break;case"top":for(f=n.from.col;f<=n.to.col;f++)o.call(this,n.from.row,f,t,i);break;case"right":for(e=n.from.row;e<=n.to.row;e++)o.call(this,e,n.to.col,t);break;case"bottom":for(s=n.from.col;s<=n.to.col;s++)o.call(this,n.to.row,s,t);break;case"left":for(h=n.from.row;h<=n.to.row;h++)o.call(this,h,n.from.col,t)}},t=function(n,t){var i=!1;return n.getSelectedRange().forAll(function(r,u){var f=n.getCellMeta(r,u).borders;if(f)if(t){if(!f[t].hasOwnProperty("hide"))return i=!0,!1}else return i=!0,!1}),i},h=function(n){return'<span class="selected">'+String.fromCharCode(10003)+"<\/span>"+n},ft=function(n){this.getSettings().customBorders&&(n.items.push(Handsontable.plugins.ContextMenu.SEPARATOR),n.items.push({key:"borders",name:"Borders",submenu:{items:[{key:"borders:top",name:function(){var n="Top",i=t(this,"top");return i&&(n=h(n)),n},callback:function(){var n=t(this,"top");s.call(this,this.getSelectedRange(),"top",n)},disabled:!1},{key:"borders:right",name:function(){var n="Right",i=t(this,"right");return i&&(n=h(n)),n},callback:function(){var n=t(this,"right");s.call(this,this.getSelectedRange(),"right",n)},disabled:!1},{key:"borders:bottom",name:function(){var n="Bottom",i=t(this,"bottom");return i&&(n=h(n)),n},callback:function(){var n=t(this,"bottom");s.call(this,this.getSelectedRange(),"bottom",n)},disabled:!1},{key:"borders:left",name:function(){var n="Left",i=t(this,"left");return i&&(n=h(n)),n},callback:function(){var n=t(this,"left");s.call(this,this.getSelectedRange(),"left",n)},disabled:!1},{key:"borders:no_borders",name:"Remove border(s)",callback:function(){s.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!t(this)}}]}}))};Handsontable.hooks.add("beforeInit",d);Handsontable.hooks.add("afterContextMenuDefaultOptions",ft);Handsontable.hooks.add("afterInit",function(){var t=this.getSettings().customBorders,n;if(t){for(n=0;n<t.length;n++)t[n].range?tt.call(this,t[n]):nt.call(this,t[n].row,t[n].col,t[n]);this.render();this.view.wt.draw(!0)}});Handsontable.CustomBorders=v},{"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/selection":18,plugins:57}],75:[function(n,t,i){"use strict";function r(){this.boundaries=null;this.callback=null}var u,f,o,h,e,s;Object.defineProperties(i,{DragToScroll:{get:function(){return r}},__esModule:{value:!0}});o=(u=n("eventManager"),u&&u.__esModule&&u||{"default":u}).eventManager;h=(f=n("plugins"),f&&f.__esModule&&f||{"default":f}).registerPlugin;Handsontable.plugins.DragToScroll=r;r.prototype.setBoundaries=function(n){this.boundaries=n};r.prototype.setCallback=function(n){this.callback=n};r.prototype.check=function(n,t){var i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom);n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right);this.callback(i,r)};s=function(n){n.dragToScrollListening=!1;var t=n.view.wt.wtTable.holder;(e=new r,t!==window)&&(e.setBoundaries(t.getBoundingClientRect()),e.setCallback(function(n,i){n<0?t.scrollLeft-=50:n>0&&(t.scrollLeft+=50);i<0?t.scrollTop-=20:i>0&&(t.scrollTop+=20)}),n.dragToScrollListening=!0)};Handsontable.hooks.add("afterInit",function(){var n=this,t=o(this);t.addEventListener(document,"mouseup",function(){n.dragToScrollListening=!1});t.addEventListener(document,"mousemove",function(t){n.dragToScrollListening&&e.check(t.clientX,t.clientY)})});Handsontable.hooks.add("afterDestroy",function(){o(this).clear()});Handsontable.hooks.add("afterOnCellMouseDown",function(){s(this)});Handsontable.hooks.add("afterOnCellCornerMouseDown",function(){s(this)});Handsontable.plugins.DragToScroll=r},{eventManager:41,plugins:57}],76:[function(n,t,i){"use strict";Object.defineProperties(i,{ManualColumnFreeze:{get:function(){return f}},__esModule:{value:!0}});var r,u,o=(r=n("_base"),r&&r.__esModule&&r||{"default":r}).default,s=(u=n("plugins"),u&&u.__esModule&&u||{"default":u}).registerPlugin,f=function(n){$traceurRuntime.superConstructor(e).call(this,n)},e=f;$traceurRuntime.createClass(f,{isEnabled:function(){return!!this.hot.getSettings().manualColumnFreeze},enablePlugin:function(){var n=this;this.enabled||(this.addHook("modifyCol",function(t){return n.onModifyCol(t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return n.addContextMenuEntry(t)}),$traceurRuntime.superGet(this,e.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,e.prototype,"disablePlugin").call(this)},init:function(){$traceurRuntime.superGet(this,e.prototype,"init").call(this);typeof this.hot.manualColumnPositionsPluginUsages=="undefined"?this.hot.manualColumnPositionsPluginUsages=["manualColumnFreeze"]:this.hot.manualColumnPositionsPluginUsages.push("manualColumnFreeze");this.fixedColumnsCount=this.hot.getSettings().fixedColumnsLeft},onModifyCol:function(n){return this.hot.manualColumnPositionsPluginUsages.length>1?n:this.getModifiedColumnIndex(n)},getModifiedColumnIndex:function(n){return this.hot.manualColumnPositions[n]},addContextMenuEntry:function(n){var t=this;n.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){var n=t.hot.getSelected()[1];return n>t.fixedColumnsCount-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var n=t.hot.getSelected();return n[1]!==n[3]},callback:function(){var n=t.hot.getSelected()[1];n>t.fixedColumnsCount-1?t.freezeColumn(n):t.unfreezeColumn(n)}})},freezeColumn:function(n){if(!(n<=this.fixedColumnsCount-1)){var t=this.getModifiedColumnIndex(n)||n;this.checkPositionData(t);this.modifyColumnOrder(t,n,null,"freeze");this.addFixedColumn();this.hot.view.wt.wtOverlays.leftOverlay.refresh();this.hot.view.wt.wtOverlays.adjustElementsSize()}},unfreezeColumn:function(n){if(!(n>this.fixedColumnsCount-1)){var i=this.getBestColumnReturnPosition(n),t=this.getModifiedColumnIndex(n)||n;this.checkPositionData(t);this.modifyColumnOrder(t,n,i,"unfreeze");this.removeFixedColumn();this.hot.view.wt.wtOverlays.leftOverlay.refresh();this.hot.view.wt.wtOverlays.adjustElementsSize()}},addFixedColumn:function(){this.hot.updateSettings({fixedColumnsLeft:this.fixedColumnsCount+1});this.fixedColumnsCount++},removeFixedColumn:function(){this.hot.updateSettings({fixedColumnsLeft:this.fixedColumnsCount-1});this.fixedColumnsCount--},checkPositionData:function(n){this.hot.manualColumnPositions&&this.hot.manualColumnPositions.length!==0||this.hot.manualColumnPositions||(this.hot.manualColumnPositions=[]);n?this.hot.manualColumnPositions[n]||this.createPositionData(n+1):this.createPositionData(this.hot.countCols())},createPositionData:function(n){if(this.hot.manualColumnPositions.length<n)for(var t=this.hot.manualColumnPositions.length;t<n;t++)this.hot.manualColumnPositions[t]=t},modifyColumnOrder:function(n,t,i,r){i==null&&(i=n);r==="freeze"?this.hot.manualColumnPositions.splice(this.fixedColumnsCount,0,this.hot.manualColumnPositions.splice(t,1)[0]):r==="unfreeze"&&this.hot.manualColumnPositions.splice(i,0,this.hot.manualColumnPositions.splice(t,1)[0])},getBestColumnReturnPosition:function(n){for(var t=this.fixedColumnsCount,i=this.getModifiedColumnIndex(t),r=this.getModifiedColumnIndex(n);i<r;)t++,i=this.getModifiedColumnIndex(t);return t-1}},{},o);s("manualColumnFreeze",f)},{_base:58,plugins:57}],77:[function(n,t,i){"use strict";function v(){function b(t){var i,r;l=this;e=t;i=this.view.wt.wtTable.getCoords(t).col;i>=0&&(o=i,r=e.getBoundingClientRect(),f=r.left,n.style.top=r.top+"px",n.style.left=f+"px",l.rootElement.appendChild(n))}function tt(t,i){var r=t.getBoundingClientRect();n.style.left=i>0?r.left+r.width-6+"px":r.left+"px"}function it(){var i=this,r;h(n,"active");h(t,"active");r=e.getBoundingClientRect();t.style.width=r.width+"px";t.style.height=i.view.maximumVisibleElementHeight(0)+"px";t.style.top=n.style.top;t.style.left=f+"px";i.rootElement.appendChild(t)}function rt(n){t.style.left=f+n+"px"}function ut(){c(n,"active");c(t,"active")}var u,i,s,f,o,l,e,n=document.createElement("DIV"),t=document.createElement("DIV"),r=p(this),v,w;n.className="manualColumnMover";t.className="manualColumnMoverGuide";v=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualColumnPositions",n.manualColumnPositions)};w=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualColumnPositions",n),n.value};var k=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="THEAD"?!0:(n=n.parentNode,k(n)):!1},d=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:d(n.parentNode):null},ft=function(){var n=this,t;r.addEventListener(n.rootElement,"mouseover",function(r){var f,e;k(r.target)&&(f=d(r.target),f&&(t?(e=n.view.wt.wtTable.getCoords(f).col,e>=0&&(i=e,tt(r.target,i-u))):b.call(n,f)))});r.addEventListener(n.rootElement,"mousedown",function(r){y(r.target,"manualColumnMover")&&(s=a(r),it.call(n),t=n,u=o,i=o)});r.addEventListener(window,"mousemove",function(n){t&&rt(a(n)-s)});r.addEventListener(window,"mouseup",function(){t&&(ut(),t=!1,nt(n.manualColumnPositions,n.countCols()),n.manualColumnPositions.splice(i,0,n.manualColumnPositions.splice(u,1)[0]),Handsontable.hooks.run(n,"beforeColumnMove",u,i),n.forceFullRender=!0,n.view.render(),v.call(n),Handsontable.hooks.run(n,"afterColumnMove",u,i),b.call(n,e))});n.addHook("afterDestroy",g)},g=function(){r.clear()},nt=function(n,t){if(n.length<t)for(var i=n.length;i<t;i++)n[i]=i};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(n){var t=this,e=!!this.getSettings().manualColumnMove,i,u,f;e?(i=this.getSettings().manualColumnMove,u=w.call(t),this.manualColumnPositions=typeof u!="undefined"?u:Array.isArray(i)?i:[],(n==="afterInit"||n==="afterUpdateSettings"&&r.context.eventListeners.length===0)&&(typeof t.manualColumnPositionsPluginUsages=="undefined"?t.manualColumnPositionsPluginUsages=["manualColumnMove"]:t.manualColumnPositionsPluginUsages.push("manualColumnMove"),ft.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))):(f=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1,f>-1&&(g.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[f]=void 0))};this.modifyCol=function(n){return this.getSettings().manualColumnMove?(typeof this.manualColumnPositions[n]=="undefined"&&nt(this.manualColumnPositions,n+1),this.manualColumnPositions[n]):n};this.afterRemoveCol=function(n,t){if(this.getSettings().manualColumnMove){var r,i=this.manualColumnPositions;r=i.splice(n,t);i=i.map(function(n){for(var i=n,t=0;t<r.length;t++)n>r[t]&&i--;return i});this.manualColumnPositions=i}};this.afterCreateCol=function(n,t){var i,r,u;if(this.getSettings().manualColumnMove&&(i=this.manualColumnPositions,i.length)){for(r=[],u=0;u<t;u++)r.push(n+u);n>=i.length?i.concat(r):(i=i.map(function(i){return i>=n?i+t:i}),i.splice.apply(i,[n,0].concat(r)));this.manualColumnPositions=i}}}var r;Object.defineProperties(i,{ManualColumnMove:{get:function(){return v}},__esModule:{value:!0}});var u,f,e,o,s=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),h=s.addClass,y=s.hasClass,c=s.removeClass,p=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).eventManager,l=(e=n("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}),a=l.pageX,w=l.pageY,b=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin;r=new v;Handsontable.hooks.add("beforeInit",r.beforeInit);Handsontable.hooks.add("afterInit",function(){r.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){r.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyCol",r.modifyCol);Handsontable.hooks.add("afterRemoveCol",r.afterRemoveCol);Handsontable.hooks.add("afterCreateCol",r.afterCreateCol);Handsontable.hooks.register("beforeColumnMove");Handsontable.hooks.register("afterColumnMove")},{eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,plugins:57}],78:[function(n,t,i){"use strict";Object.defineProperties(i,{ManualColumnResize:{get:function(){return h}},__esModule:{value:!0}});var r,u,f,e,o,p=(r=n("_base.js"),r&&r.__esModule&&r||{"default":r}).default,c=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),s=c.addClass,w=c.hasClass,a=c.removeClass,b=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).eventManager,v=(e=n("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}),y=v.pageX,d=v.pageY,k=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin,h=function(n){$traceurRuntime.superConstructor(l).call(this,n);this.currentTH=null;this.currentCol=null;this.currentWidth=null;this.newSize=null;this.startY=null;this.startWidth=null;this.startOffset=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=b(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualColumnWidths=[];s(this.handle,"manualColumnResizer");s(this.guide,"manualColumnResizerGuide")},l=h;$traceurRuntime.createClass(h,{isEnabled:function(){return this.hot.getSettings().manualColumnResize},enablePlugin:function(){var i=this,n,t;this.enabled||(this.manualColumnWidths=[],n=this.hot.getSettings().manualColumnResize,t=this.loadManualColumnWidths(),this.addHook("modifyColWidth",function(n,t){return i.onModifyColWidth(n,t)}),this.manualColumnWidths=typeof t!="undefined"?t:Array.isArray(n)?n:[],Handsontable.hooks.register("beforeColumnResize"),Handsontable.hooks.register("afterColumnResize"),this.bindEvents(),$traceurRuntime.superGet(this,l.prototype,"enablePlugin").call(this))},updatePlugin:function(){var n=this.hot.getSettings().manualColumnResize;this.manualColumnWidths=Array.isArray(n)?n:[]},disablePlugin:function(){$traceurRuntime.superGet(this,l.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",n),n.value},setupHandlePosition:function(n){var i,t;this.currentTH=n;i=this.hot.view.wt.wtTable.getCoords(n).col;i>=0&&(t=this.currentTH.getBoundingClientRect(),this.currentCol=i,this.startOffset=t.left-6,this.startWidth=parseInt(t.width,10),this.handle.style.top=t.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.hot.rootElement.appendChild(this.handle))},refreshHandlePosition:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function(){s(this.handle,"active");s(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=this.handle.style.left;this.guide.style.height=this.hot.view.maximumVisibleElementHeight(0)+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function(){a(this.handle,"active");a(this.guide,"active")},checkIfColumnHeader:function(n){return n.tagName!="BODY"?n.parentNode.tagName=="THEAD"?!0:(n=n.parentNode,this.checkIfColumnHeader(n)):!1},getTHFromTargetElement:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null},onMouseOver:function(n){var t,i;if(this.checkIfColumnHeader(n.target)){if(t=this.getTHFromTargetElement(n.target),!t)return;i=t.getAttribute("colspan");t&&(i===null||i===1)&&(this.pressed||this.setupHandlePosition(t))}},afterMouseDownTimeout:function(){if(this.dblclick>=2){var n=this.hot.runHooks("beforeColumnResize",this.currentCol,this.newSize,!0);n!==void 0&&(this.newSize=n);this.setManualSize(this.currentCol,this.newSize);this.hot.forceFullRender=!0;this.hot.view.render();this.hot.view.wt.wtOverlays.adjustElementsSize(!0);this.hot.runHooks("afterColumnResize",this.currentCol,this.newSize,!0)}this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function(n){var t=this;w(n.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=y(n),this.newSize=this.startWidth)},onMouseMove:function(n){this.pressed&&(this.currentWidth=this.startWidth+(y(n)-this.startX),this.newSize=this.setManualSize(this.currentCol,this.currentWidth),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(){this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth&&(this.hot.runHooks("beforeColumnResize",this.currentCol,this.newSize),this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.currentCol,this.newSize)),this.setupHandlePosition(this.currentTH))},bindEvents:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})},setManualSize:function(n,t){return t=Math.max(t,20),n=this.hot.runHooks("modifyCol",n),this.manualColumnWidths[n]=t,t},onModifyColWidth:function(n,t){return this.enabled&&(t=this.hot.runHooks("modifyCol",t),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:n}},{},p);k("manualColumnResize",h)},{"_base.js":58,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,plugins:57}],79:[function(n,t,i){"use strict";function v(){function w(t){var u=this,i,r;e=t;i=this.view.wt.wtTable.getCoords(t).row;i>=0&&(o=i,r=e.getBoundingClientRect(),f=r.top,n.style.top=f+"px",n.style.left=r.left+"px",u.rootElement.appendChild(n))}function nt(t,i){var r=t.getBoundingClientRect();n.style.top=i>0?r.top+r.height-6+"px":r.top+"px"}function tt(){var i=this,r;h(n,"active");h(t,"active");r=e.getBoundingClientRect();t.style.width=i.view.maximumVisibleElementWidth(0)+"px";t.style.height=r.height+"px";t.style.top=f+"px";t.style.left=n.style.left;i.rootElement.appendChild(t)}function it(n){t.style.top=f+n+"px"}function rt(){c(n,"active");c(t,"active")}var u,i,s,f,o,e,n=document.createElement("DIV"),t=document.createElement("DIV"),r=p(this),l,v;n.className="manualRowMover";t.className="manualRowMoverGuide";l=function(){var n=this;Handsontable.hooks.run(n,"persistentStateSave","manualRowPositions",n.manualRowPositions)};v=function(){var t=this,n={};return Handsontable.hooks.run(t,"persistentStateLoad","manualRowPositions",n),n.value};var b=function(n){return n.tagName!="BODY"?n.parentNode.tagName=="TBODY"?!0:(n=n.parentNode,b(n)):!1},k=function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:k(n.parentNode):null},ut=function(){var n=this,t;r.addEventListener(n.rootElement,"mouseover",function(r){if(b(r.target)){var f=k(r.target);f&&(t?(i=n.view.wt.wtTable.getCoords(f).row,nt(f,i-u)):w.call(n,f))}});r.addEventListener(n.rootElement,"mousedown",function(r){y(r.target,"manualRowMover")&&(s=a(r),tt.call(n),t=n,u=o,i=o)});r.addEventListener(window,"mousemove",function(n){t&&it(a(n)-s)});r.addEventListener(window,"mouseup",function(){t&&(rt(),t=!1,g(n.manualRowPositions,n.countRows()),n.manualRowPositions.splice(i,0,n.manualRowPositions.splice(u,1)[0]),Handsontable.hooks.run(n,"beforeRowMove",u,i),n.forceFullRender=!0,n.view.render(),l.call(n),Handsontable.hooks.run(n,"afterRowMove",u,i),w.call(n,e))});n.addHook("afterDestroy",d)},d=function(){r.clear()},g=function(n,t){if(n.length<t)for(var i=n.length;i<t;i++)n[i]=i};this.beforeInit=function(){this.manualRowPositions=[]};this.init=function(n){var t=this,e=!!t.getSettings().manualRowMove,i,u,f;e?(i=t.getSettings().manualRowMove,u=v.call(t),typeof t.manualRowPositionsPluginUsages=="undefined"?t.manualRowPositionsPluginUsages=["manualColumnMove"]:t.manualRowPositionsPluginUsages.push("manualColumnMove"),this.manualRowPositions=typeof u!="undefined"?u:Array.isArray(i)?i:[],(n==="afterInit"||n==="afterUpdateSettings"&&r.context.eventListeners.length===0)&&(ut.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))):(f=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1,f>-1&&(d.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[f]=void 0))};this.modifyRow=function(n){var t=this;return t.getSettings().manualRowMove?(typeof t.manualRowPositions[n]=="undefined"&&g(this.manualRowPositions,n+1),t.manualRowPositions[n]):n}}var o;Object.defineProperties(i,{ManualRowMove:{get:function(){return v}},__esModule:{value:!0}});var r,u,f,e,s=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),h=s.addClass,y=s.hasClass,c=s.removeClass,p=(u=n("eventManager"),u&&u.__esModule&&u||{"default":u}).eventManager,l=(f=n("helpers/dom/event"),f&&f.__esModule&&f||{"default":f}),w=l.pageX,a=l.pageY,b=(e=n("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin;o=new v;Handsontable.hooks.add("beforeInit",o.beforeInit);Handsontable.hooks.add("afterInit",function(){o.init.call(this,"afterInit")});Handsontable.hooks.add("afterUpdateSettings",function(){o.init.call(this,"afterUpdateSettings")});Handsontable.hooks.add("modifyRow",o.modifyRow);Handsontable.hooks.register("beforeRowMove");Handsontable.hooks.register("afterRowMove")},{eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,plugins:57}],80:[function(n,t,i){"use strict";Object.defineProperties(i,{ManualRowResize:{get:function(){return h}},__esModule:{value:!0}});var r,u,f,e,o,p=(r=n("_base.js"),r&&r.__esModule&&r||{"default":r}).default,c=(u=n("helpers/dom/element"),u&&u.__esModule&&u||{"default":u}),s=c.addClass,w=c.hasClass,a=c.removeClass,b=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).eventManager,v=(e=n("helpers/dom/event"),e&&e.__esModule&&e||{"default":e}),d=v.pageX,y=v.pageY,k=(o=n("plugins"),o&&o.__esModule&&o||{"default":o}).registerPlugin,h=function(n){$traceurRuntime.superConstructor(l).call(this,n);this.currentTH=null;this.currentRow=null;this.currentHeight=null;this.newSize=null;this.startY=null;this.startHeight=null;this.startOffset=null;this.handle=document.createElement("DIV");this.guide=document.createElement("DIV");this.eventManager=b(this);this.pressed=null;this.dblclick=0;this.autoresizeTimeout=null;this.manualRowHeights=[];s(this.handle,"manualRowResizer");s(this.guide,"manualRowResizerGuide")},l=h;$traceurRuntime.createClass(h,{isEnabled:function(){return this.hot.getSettings().manualRowResize},enablePlugin:function(){var i=this,n,t;this.enabled||(this.manualRowHeights=[],n=this.hot.getSettings().manualRowResize,t=this.loadManualRowHeights(),this.manualRowHeights=typeof t!="undefined"?t:Array.isArray(n)?n:[],this.addHook("modifyRowHeight",function(n,t){return i.onModifyRowHeight(n,t)}),Handsontable.hooks.register("beforeRowResize"),Handsontable.hooks.register("afterRowResize"),this.bindEvents(),$traceurRuntime.superGet(this,l.prototype,"enablePlugin").call(this))},updatePlugin:function(){var n=this.hot.getSettings().manualRowResize;this.manualRowHeights=Array.isArray(n)?n:[]},disablePlugin:function(){$traceurRuntime.superGet(this,l.prototype,"disablePlugin").call(this)},saveManualRowHeights:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",n),n.value},setupHandlePosition:function(n){var i,t;this.currentTH=n;i=this.hot.view.wt.wtTable.getCoords(n).row;i>=0&&(t=this.currentTH.getBoundingClientRect(),this.currentRow=i,this.startOffset=t.top-6,this.startHeight=parseInt(t.height,10),this.handle.style.left=t.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.hot.rootElement.appendChild(this.handle))},refreshHandlePosition:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function(){s(this.handle,"active");s(this.guide,"active");this.guide.style.top=this.handle.style.top;this.guide.style.left=this.handle.style.left;this.guide.style.width=this.hot.view.maximumVisibleElementWidth(0)+"px";this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function(){a(this.handle,"active");a(this.guide,"active")},checkIfRowHeader:function(n){return n.tagName!="BODY"?n.parentNode.tagName=="TBODY"?!0:(n=n.parentNode,this.checkIfRowHeader(n)):!1},getTHFromTargetElement:function(n){return n.tagName!="TABLE"?n.tagName=="TH"?n:this.getTHFromTargetElement(n.parentNode):null},onMouseOver:function(n){if(this.checkIfRowHeader(n.target)){var t=this.getTHFromTargetElement(n.target);t&&(this.pressed||this.setupHandlePosition(t))}},afterMouseDownTimeout:function(){if(this.dblclick>=2){var n=this.hot.runHooks("beforeRowResize",this.currentRow,this.newSize,!0);n!==void 0&&(this.newSize=n);this.setManualSize(this.currentRow,this.newSize);this.hot.forceFullRender=!0;this.hot.view.render();this.hot.view.wt.wtOverlays.adjustElementsSize(!0);this.hot.runHooks("afterRowResize",this.currentRow,this.newSize,!0)}this.dblclick=0;this.autoresizeTimeout=null},onMouseDown:function(n){var t=this;w(n.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,this.autoresizeTimeout==null&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=y(n),this.newSize=this.startHeight)},onMouseMove:function(n){this.pressed&&(this.currentHeight=this.startHeight+(y(n)-this.startY),this.newSize=this.setManualSize(this.currentRow,this.currentHeight),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(){this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight&&(this.hot.runHooks("beforeRowResize",this.currentRow,this.newSize),this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.currentRow,this.newSize)),this.setupHandlePosition(this.currentTH))},bindEvents:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return n.onMouseOver(t)});this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return n.onMouseDown(t)});this.eventManager.addEventListener(window,"mousemove",function(t){return n.onMouseMove(t)});this.eventManager.addEventListener(window,"mouseup",function(t){return n.onMouseUp(t)})},setManualSize:function(n,t){return n=this.hot.runHooks("modifyRow",n),this.manualRowHeights[n]=t,t},onModifyRowHeight:function(n,t){var r,u,i;return this.enabled&&(r=this.hot.getPlugin("autoRowSize"),u=r?r.heights[t]:null,t=this.hot.runHooks("modifyRow",t),i=this.manualRowHeights[t],i!==void 0&&(i===u||i>(n||0)))?i:n}},{},p);k("manualRowResize",h)},{"_base.js":58,eventManager:41,"helpers/dom/element":45,"helpers/dom/event":46,plugins:57}],81:[function(n,t,i){"use strict";function l(){var n=[];return n.getInfo=function(n,t){for(var i=0,r=this.length;i<r;i++)if(this[i].row<=n&&this[i].row+this[i].rowspan-1>=n&&this[i].col<=t&&this[i].col+this[i].colspan-1>=t)return this[i]},n.setInfo=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t].row===n.row&&this[t].col===n.col){this[t]=n;return}this.push(n)},n.removeInfo=function(n,t){for(var i=0,r=this.length;i<r;i++)if(this[i].row===n&&this[i].col===t){this.splice(i,1);break}},n}function u(n){if(this.mergedCellInfoCollection=new l,Array.isArray(n))for(var t=0,i=n.length;t<i;t++)this.mergedCellInfoCollection.setInfo(n[t])}function et(n){var i=this.getSettings().mergeCells,t;i&&!this.selection.isMultiple()&&(t=this.mergeCells.mergedCellInfoCollection.getInfo(n[0],n[1]),t&&(n[0]=t.row,n[1]=t.col,n[2]=t.row+t.rowspan-1,n[3]=t.col+t.colspan-1))}function ot(n,t){this.mergeCells&&this.mergeCells.shiftCollection("right",n,t)}function st(n,t){this.mergeCells&&this.mergeCells.shiftCollection("left",n,t)}function ht(n,t){this.mergeCells&&this.mergeCells.shiftCollection("down",n,t)}function ct(n,t){this.mergeCells&&this.mergeCells.shiftCollection("up",n,t)}Object.defineProperties(i,{MergeCells:{get:function(){return u}},__esModule:{value:!0}});var e,o,s,h,c,lt=(e=n("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin,p=(o=n("helpers/dom/event"),o&&o.__esModule&&o||{"default":o}).stopImmediatePropagation,r=(s=n("3rdparty/walkontable/src/cell/coords"),s&&s.__esModule&&s||{"default":s}).WalkontableCellCoords,f=(h=n("3rdparty/walkontable/src/cell/range"),h&&h.__esModule&&h||{"default":h}).WalkontableCellRange,w=(c=n("3rdparty/walkontable/src/table"),c&&c.__esModule&&c||{"default":c}).WalkontableTable;u.prototype.canMergeRange=function(n){return!n.isSingle()};u.prototype.mergeRange=function(n){if(this.canMergeRange(n)){var i=n.getTopLeftCorner(),r=n.getBottomRightCorner(),t={};t.row=i.row;t.col=i.col;t.rowspan=r.row-i.row+1;t.colspan=r.col-i.col+1;this.mergedCellInfoCollection.setInfo(t)}};u.prototype.mergeOrUnmergeSelection=function(n){var t=this.mergedCellInfoCollection.getInfo(n.from.row,n.from.col);t?this.unmergeSelection(n.from):this.mergeSelection(n)};u.prototype.mergeSelection=function(n){this.mergeRange(n)};u.prototype.unmergeSelection=function(n){var t=this.mergedCellInfoCollection.getInfo(n.row,n.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)};u.prototype.applySpanProperties=function(n,t,i){var r=this.mergedCellInfoCollection.getInfo(t,i);r?r.row===t&&r.col===i?(n.setAttribute("rowspan",r.rowspan),n.setAttribute("colspan",r.colspan)):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"))};u.prototype.modifyTransform=function(n,t,i){var nt=function(n,t){return t.row>=n.row&&t.row<=n.row+n.rowspan-1?!0:!1},tt=function(n,t){return t.col>=n.col&&t.col<=n.col+n.colspan-1?!0:!1},it=function(n){return new r(t.to.row+n.row,t.to.col+n.col)},u={row:i.row,col:i.col},s,e,rt,l,a,w,c,y,v;if(n=="modifyTransformStart"){for(this.lastDesiredCoords||(this.lastDesiredCoords=new r(null,null)),s=new r(t.highlight.row,t.highlight.col),e=this.mergedCellInfoCollection.getInfo(s.row,s.col),c=0,y=this.mergedCellInfoCollection.length;c<y;c++)if(l=this.mergedCellInfoCollection[c],l=new r(l.row+l.rowspan-1,l.col+l.colspan-1),t.includes(l)){rt=!0;break}if(e){var p=new r(e.row,e.col),k=new r(e.row+e.rowspan-1,e.col+e.colspan-1),ut=new f(p,p,k);ut.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new r(null,null));u.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-s.row:u.row;u.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-s.col:u.col;i.row>0?u.row=e.row+e.rowspan-1-s.row+i.row:i.row<0&&(u.row=s.row-e.row+i.row);i.col>0?u.col=e.col+e.colspan-1-s.col+i.col:i.col<0&&(u.col=s.col-e.col+i.col)}a=new r(t.highlight.row+u.row,t.highlight.col+u.col);w=this.mergedCellInfoCollection.getInfo(a.row,a.col);w&&(this.lastDesiredCoords=a,u={row:w.row-s.row,col:w.col-s.col})}else if(n=="modifyTransformEnd")for(c=0,y=this.mergedCellInfoCollection.length;c<y;c++){var o=this.mergedCellInfoCollection[c],p=new r(o.row,o.col),k=new r(o.row+o.rowspan-1,o.col+o.colspan-1),h=new f(p,p,k),b=t.getBordersSharedWith(h);h.isEqual(t)?t.setDirection("NW-SE"):b.length>0&&(v=t.highlight.isEqual(h.from),b.indexOf("top")>-1?t.to.isSouthEastOf(h.from)&&v?t.setDirection("NW-SE"):t.to.isSouthWestOf(h.from)&&v&&t.setDirection("NE-SW"):b.indexOf("bottom")>-1&&(t.to.isNorthEastOf(h.from)&&v?t.setDirection("SW-NE"):t.to.isNorthWestOf(h.from)&&v&&t.setDirection("SE-NW")));var a=it(u),d=nt(o,a),g=tt(o,a);t.includesRange(h)&&(h.includes(a)||d||g)&&(d&&(u.row<0?u.row-=o.rowspan-1:u.row>0&&(u.row+=o.rowspan-1)),g&&(u.col<0?u.col-=o.colspan-1:u.col>0&&(u.col+=o.colspan-1)))}u.row!==0&&(i.row=u.row);u.col!==0&&(i.col=u.col)};u.prototype.shiftCollection=function(n,t){var i=[0,0],u,r;switch(n){case"right":i[0]+=1;break;case"left":i[0]-=1;break;case"down":i[1]+=1;break;case"up":i[1]-=1}for(u=0;u<this.mergedCellInfoCollection.length;u++)r=this.mergedCellInfoCollection[u],n==="right"||n==="left"?t<=r.col&&(r.col+=i[0]):t<=r.row&&(r.row+=i[1])};var b=function(){var n=this,t=n.getSettings().mergeCells;t&&(n.mergeCells||(n.mergeCells=new u(t)))},k=function(){var n=this;n.mergeCells&&(n.view.wt.wtTable.getCell=function(t){if(n.getSettings().mergeCells){var i=n.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);i&&(t=i)}return w.prototype.getCell.call(this,t)})},d=function(){var n=this,t=n.getSettings().mergeCells,i,r;if(t)if(n.mergeCells){if(n.mergeCells.mergedCellInfoCollection=new l,Array.isArray(t))for(i=0,r=t.length;i<r;i++)n.mergeCells.mergedCellInfoCollection.setInfo(t[i])}else n.mergeCells=new u(t);else n.mergeCells&&(n.mergeCells.mergedCellInfoCollection=new l)},g=function(n){if(this.mergeCells){var t=(n.ctrlKey||n.metaKey)&&!n.altKey;t&&n.keyCode===77&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),p(n))}},nt=function(n){this.getSettings().mergeCells&&(n.items.push(Handsontable.plugins.ContextMenu.SEPARATOR),n.items.push({key:"mergeCells",name:function(){var n=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(n[0],n[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange());this.render()},disabled:function(){return!1}}))},tt=function(n,t,i){this.mergeCells&&this.mergeCells.applySpanProperties(n,t,i)},y=function(n){return function(t){var f=this.getSettings().mergeCells,i,u,r;f&&(i=this.getSelectedRange(),this.mergeCells.modifyTransform(n,i,t),n==="modifyTransformEnd"&&(u=this.countRows(),r=this.countCols(),i.from.row<0?i.from.row=0:i.from.row>0&&i.from.row>=u&&(i.from.row=i.from-1),i.from.col<0?i.from.col=0:i.from.col>0&&i.from.col>=r&&(i.from.col=r-1)))}},it=function(n){var o,t,u,e,s;if(this.lastDesiredCoords=null,o=this.getSettings().mergeCells,o){t=this.getSelectedRange();t.highlight=new r(t.highlight.row,t.highlight.col);t.to=n;u=!1;do for(u=!1,e=0,s=this.mergeCells.mergedCellInfoCollection.length;e<s;e++){var i=this.mergeCells.mergedCellInfoCollection[e],h=new r(i.row,i.col),c=new r(i.row+i.rowspan-1,i.col+i.colspan-1),l=new f(h,h,c);t.expandByRange(l)&&(n.row=t.to.row,n.col=t.to.col,u=!0)}while(u)}},rt=function(n,t){var h,e,c;if(t&&t=="area"&&(h=this.getSettings().mergeCells,h)){var i=this.getSelectedRange(),o=new f(i.from,i.from,i.from),s=new f(i.to,i.to,i.to);for(e=0,c=this.mergeCells.mergedCellInfoCollection.length;e<c;e++){var u=this.mergeCells.mergedCellInfoCollection[e],l=new r(u.row,u.col),v=new r(u.row+u.rowspan-1,u.col+u.colspan-1),a=new f(l,l,v);o.expandByRange(a)&&(n[0]=o.from.row,n[1]=o.from.col);s.expandByRange(a)&&(n[2]=s.from.row,n[3]=s.from.col)}}},ut=function(n,t,i){var u=this.getSettings().mergeCells,r;u&&(r=this.mergeCells.mergedCellInfoCollection.getInfo(n,t),r&&(r.row!=n||r.col!=t)&&(i.copyable=!1))},a=function(n){var f=this.getSettings().mergeCells,u,t,i,r;if(f)for(u=this.countCols(),i=0;i<u;i++){if(t=this.mergeCells.mergedCellInfoCollection.getInfo(n.startRow,i),t&&t.row<n.startRow)return n.startRow=t.row,a.call(this,n);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(n.endRow,i),t&&(r=t.row+t.rowspan-1,r>n.endRow))return n.endRow=r,a.call(this,n)}},v=function(n){var f=this.getSettings().mergeCells,u,t,i,r;if(f)for(u=this.countRows(),i=0;i<u;i++){if(t=this.mergeCells.mergedCellInfoCollection.getInfo(i,n.startColumn),t&&t.col<n.startColumn)return n.startColumn=t.col,v.call(this,n);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(i,n.endColumn),t&&(r=t.col+t.colspan-1,r>n.endColumn))return n.endColumn=r,v.call(this,n)}},ft=function(n){var t,r,i;if(n&&this.mergeCells){t=this.mergeCells.mergedCellInfoCollection;r=this.getSelectedRange();for(i in t)if(r.highlight.row==t[i].row&&r.highlight.col==t[i].col&&r.to.row==t[i].row+t[i].rowspan-1&&r.to.col==t[i].col+t[i].colspan-1)return!1}return n};Handsontable.hooks.add("beforeInit",b);Handsontable.hooks.add("afterInit",k);Handsontable.hooks.add("afterUpdateSettings",d);Handsontable.hooks.add("beforeKeyDown",g);Handsontable.hooks.add("modifyTransformStart",y("modifyTransformStart"));Handsontable.hooks.add("modifyTransformEnd",y("modifyTransformEnd"));Handsontable.hooks.add("beforeSetRangeEnd",it);Handsontable.hooks.add("beforeDrawBorders",rt);Handsontable.hooks.add("afterIsMultipleSelection",ft);Handsontable.hooks.add("afterRenderer",tt);Handsontable.hooks.add("afterContextMenuDefaultOptions",nt);Handsontable.hooks.add("afterGetCellMeta",ut);Handsontable.hooks.add("afterViewportRowCalculatorOverride",a);Handsontable.hooks.add("afterViewportColumnCalculatorOverride",v);Handsontable.hooks.add("afterAutofillApplyValues",et);Handsontable.hooks.add("afterCreateCol",ot);Handsontable.hooks.add("afterRemoveCol",st);Handsontable.hooks.add("afterCreateRow",ht);Handsontable.hooks.add("afterRemoveRow",ct);Handsontable.MergeCells=u},{"3rdparty/walkontable/src/cell/coords":5,"3rdparty/walkontable/src/cell/range":6,"3rdparty/walkontable/src/table":20,"helpers/dom/event":46,plugins:57}],82:[function(n,t,i){"use strict";Object.defineProperties(i,{MultipleSelectionHandles:{get:function(){return s}},__esModule:{value:!0}});var r,u,f,e,h=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),l=h.getWindowScrollTop,o=h.hasClass,a=h.getWindowScrollLeft,v=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).default,y=(f=n("eventManager"),f&&f.__esModule&&f||{"default":f}).EventManager,p=(e=n("plugins"),e&&e.__esModule&&e||{"default":e}).registerPlugin,s=function(n){$traceurRuntime.superConstructor(c).call(this,n);this.dragged=[];this.eventManager=null;this.lastSetCell=null},c=s;$traceurRuntime.createClass(s,{isEnabled:function(){return Handsontable.mobileBrowser},enablePlugin:function(){this.enabled||(this.eventManager||(this.eventManager=new y(this)),this.registerListeners(),$traceurRuntime.superGet(this,c.prototype,"enablePlugin").call(this))},registerListeners:function(){function t(t){if(n.dragged.length===1)return n.dragged.splice(0,n.dragged.length),!0;var i=n.dragged.indexOf(t);if(i==-1)return!1;i===0?n.dragged=n.dragged.slice(0,1):i==1&&(n.dragged=n.dragged.slice(-1))}var n=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(t){var i;return o(t.target,"topLeftSelectionHandle-HitArea")?(i=n.hot.getSelectedRange(),n.dragged.push("topLeft"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):o(t.target,"bottomRightSelectionHandle-HitArea")?(i=n.hot.getSelectedRange(),n.dragged.push("bottomRight"),n.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(i){return o(i.target,"topLeftSelectionHandle-HitArea")?(t.call(n,"topLeft"),n.touchStartRange=void 0,i.preventDefault(),!1):o(i.target,"bottomRightSelectionHandle-HitArea")?(t.call(n,"bottomRight"),n.touchStartRange=void 0,i.preventDefault(),!1):void 0});this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(t){var h=l(),c=a(),i,r,u,e,o,s,f;n.dragged.length!==0&&(i=document.elementFromPoint(t.touches[0].screenX-c,t.touches[0].screenY-h),i&&i!==n.lastSetCell)&&((i.nodeName=="TD"||i.nodeName=="TH")&&(r=n.hot.getCoords(i),r.col==-1&&(r.col=0),u=n.hot.getSelectedRange(),e=u.getWidth(),o=u.getHeight(),s=u.getDirection(),e==1&&o==1&&n.hot.selection.setRangeEnd(r),f=n.getCurrentRangeCoords(u,r,n.touchStartRange.direction,s,n.dragged[0]),f.start!==null&&n.hot.selection.setRangeStart(f.start),n.hot.selection.setRangeEnd(f.end),n.lastSetCell=i),t.preventDefault())})},getCurrentRangeCoords:function(n,t,i,r,u){var e=n.getTopLeftCorner(),o=n.getBottomRightCorner(),s=n.getBottomLeftCorner(),h=n.getTopRightCorner(),f={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":f=u=="topLeft"?{start:new WalkontableCellCoords(t.row,n.highlight.col),end:new WalkontableCellCoords(s.row,t.col)}:{start:new WalkontableCellCoords(n.highlight.row,t.col),end:new WalkontableCellCoords(t.row,e.col)};break;case"SE-NW":u=="bottomRight"&&(f={start:new WalkontableCellCoords(o.row,t.col),end:new WalkontableCellCoords(t.row,e.col)})}break;case"NW-SE":switch(r){case"NE-SW":u=="topLeft"?f={start:t,end:s}:f.end=t;break;case"NW-SE":u=="topLeft"?f={start:t,end:o}:f.end=t;break;case"SE-NW":u=="topLeft"?f={start:t,end:e}:f.end=t;break;case"SW-NE":u=="topLeft"?f={start:t,end:h}:f.end=t}break;case"SW-NE":switch(r){case"NW-SE":f=u=="bottomRight"?{start:new WalkontableCellCoords(t.row,e.col),end:new WalkontableCellCoords(s.row,t.col)}:{start:new WalkontableCellCoords(e.row,t.col),end:new WalkontableCellCoords(t.row,o.col)};break;case"SW-NE":f=u=="topLeft"?{start:new WalkontableCellCoords(n.highlight.row,t.col),end:new WalkontableCellCoords(t.row,o.col)}:{start:new WalkontableCellCoords(t.row,e.col),end:new WalkontableCellCoords(e.row,t.col)};break;case"SE-NW":u=="bottomRight"?f={start:new WalkontableCellCoords(t.row,h.col),end:new WalkontableCellCoords(e.row,t.col)}:u=="topLeft"&&(f={start:s,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":u=="topLeft"&&(f.end=t);break;case"SE-NW":u=="topLeft"?f.end=t:f={start:t,end:e}}}return f},isDragged:function(){return this.dragged.length>0}},{},v);p("multipleSelectionHandles",s)},{_base:58,eventManager:41,"helpers/dom/element":45,plugins:57}],83:[function(n,t,i){"use strict";function h(){}function s(){var n=this,t=n.getSettings().observeChanges;t?(n.observer&&e.call(n),c.call(n),v.call(n)):t||e.call(n)}function c(){var n=this;n.observeChangesActive=!0;n.pauseObservingChanges=function(){n.observeChangesActive=!1};n.resumeObservingChanges=function(){n.observeChangesActive=!0};n.observedData=n.getSourceData();n.observer=o.observe(n.observedData,function(t){n.observeChangesActive&&(l.call(n,t),n.render());n.runHooks("afterChangesObserved")})}function l(n){function s(n){var t;return t=c(n),h(t)}function h(n){var t=[];return n.filter(function(n){var i=e(n.path);if(["add","remove"].indexOf(n.op)!=-1&&!isNaN(i.col)){if(t.indexOf(i.col)!=-1)return!1;t.push(i.col)}return!0})}function c(n){return n.filter(function(n){return!/[/]length/ig.test(n.path)})}function e(n){var t=n.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var r,t,i=this,f=s(n),u=0,o=f.length;u<o;u++){r=f[u];t=e(r.path);switch(r.op){case"add":isNaN(t.col)?i.runHooks("afterCreateRow",t.row):i.runHooks("afterCreateCol",t.col);break;case"remove":isNaN(t.col)?i.runHooks("afterRemoveRow",t.row,1):i.runHooks("afterRemoveCol",t.col,1);break;case"replace":i.runHooks("afterChange",[t.row,t.col,null,r.value],"external")}}}function e(){var n=this;n.observer&&(a.call(n),y.call(n))}function a(){var n=this;o.unobserve(n.observedData,n.observer);delete n.observedData;delete n.observeChangesActive;delete n.pauseObservingChanges;delete n.resumeObservingChanges}function v(){var n=this;n.addHook("afterDestroy",e);n.addHook("afterCreateRow",r);n.addHook("afterRemoveRow",r);n.addHook("afterCreateCol",r);n.addHook("afterRemoveCol",r);n.addHook("afterChange",function(n,t){t!="loadData"&&r.call(this)})}function y(){var n=this;n.removeHook("afterDestroy",e);n.removeHook("afterCreateRow",r);n.removeHook("afterRemoveRow",r);n.removeHook("afterCreateCol",r);n.removeHook("afterRemoveCol",r);n.removeHook("afterChange",r)}function r(){var n=this;n.pauseObservingChanges();n.addHookOnce("afterChangesObserved",function(){n.resumeObservingChanges()})}Object.defineProperties(i,{ObserveChanges:{get:function(){return h}},__esModule:{value:!0}});var u,f,p=(u=n("plugins"),u&&u.__esModule&&u||{"default":u}).registerPlugin,o=(f=n("jsonpatch"),f&&f.__esModule&&f||{"default":f}).default;Handsontable.hooks.add("afterLoadData",s);Handsontable.hooks.add("afterUpdateSettings",s);Handsontable.hooks.register("afterChangesObserved")},{jsonpatch:"jsonpatch",plugins:57}],84:[function(n,t,i){"use strict";function o(n){var t,i=function(){window.localStorage[n+"__persistentStateKeys"]=JSON.stringify(t)},r=function(){var i=window.localStorage[n+"__persistentStateKeys"],r=typeof i=="string"?JSON.parse(i):void 0;t=r?r:[]},u=function(){t=[];i()};r();this.saveValue=function(r,u){window.localStorage[n+"_"+r]=JSON.stringify(u);t.indexOf(r)==-1&&(t.push(r),i())};this.loadValue=function(t,i){t=typeof t=="undefined"?i:t;var r=window.localStorage[n+"_"+t];if(typeof r!="undefined")return JSON.parse(r)};this.reset=function(t){window.localStorage.removeItem(n+"_"+t)};this.resetAll=function(){for(var i=0;i<t.length;i++)window.localStorage.removeItem(n+"_"+t[i]);u()}}function f(){function r(){var i=this;for(var t in n)n.hasOwnProperty(t)&&i.addHook(t,n[t])}function u(){var i=this;for(var t in n)n.hasOwnProperty(t)&&i.removeHook(t,n[t])}var t=this,n,i;this.init=function(){var n=this,i=n.getSettings().persistentState;if(t.enabled=!!i,!t.enabled){u.call(n);return}n.storage||(n.storage=new o(n.rootElement.id));n.resetState=t.resetValue;r.call(n)};this.saveValue=function(n,t){var i=this;i.storage.saveValue(n,t)};this.loadValue=function(n,t){var i=this;t.value=i.storage.loadValue(n)};this.resetValue=function(n){var t=this;typeof n=="undefined"?t.storage.resetAll():t.storage.reset(n)};n={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};for(i in n)n.hasOwnProperty(i)&&Handsontable.hooks.register(i)}var r,e,u;Object.defineProperties(i,{HandsontablePersistentState:{get:function(){return f}},__esModule:{value:!0}});e=(r=n("plugins"),r&&r.__esModule&&r||{"default":r}).registerPlugin;u=new f;Handsontable.hooks.add("beforeInit",u.init);Handsontable.hooks.add("afterUpdateSettings",u.init)},{plugins:57}],85:[function(n){"use strict";function e(){var n=this,t=!!n.getSettings().search;t?n.search=new Handsontable.Search(n):delete n.search}var t,i,r=(t=n("helpers/dom/element"),t&&t.__esModule&&t||{"default":t}),o=r.addClass,s=r.removeClass,u=(i=n("renderers"),i&&i.__esModule&&i||{"default":i}),h=u.registerRenderer,c=u.getRenderer,f;Handsontable.Search=function(n){this.query=function(t,i,r){var a=n.countRows(),v=n.countCols(),o=[],u,f,l;for(i||(i=Handsontable.Search.global.getDefaultCallback()),r||(r=Handsontable.Search.global.getDefaultQueryMethod()),u=0;u<a;u++)for(f=0;f<v;f++){var e=n.getDataAtCell(u,f),s=n.getCellMeta(u,f),h=s.search.callback||i,y=s.search.queryMethod||r,c=y(t,e);c&&(l={row:u,col:f,data:e},o.push(l));h&&h(n,u,f,e,c)}return o}};Handsontable.Search.DEFAULT_CALLBACK=function(n,t,i,r,u){n.getCellMeta(t,i).isSearchResult=u};Handsontable.Search.DEFAULT_QUERY_METHOD=function(n,t){return typeof n=="undefined"||n==null||!n.toLowerCase||n.length===0?!1:typeof t=="undefined"||t==null?!1:t.toString().toLowerCase().indexOf(n.toLowerCase())!=-1};Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult";Handsontable.Search.global=function(){var n=Handsontable.Search.DEFAULT_CALLBACK,t=Handsontable.Search.DEFAULT_QUERY_METHOD,i=Handsontable.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return n},setDefaultCallback:function(t){n=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(n){t=n},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(n){i=n}}}();Handsontable.SearchCellDecorator=function(n,t,i,r,u,f,e){var h=e.search!==null&&typeof e.search=="object"&&e.search.searchResultClass||Handsontable.Search.global.getDefaultSearchResultClass();e.isSearchResult?o(t,h):s(t,h)};f=c("base");h("base",function(){f.apply(this,arguments);Handsontable.SearchCellDecorator.apply(this,arguments)});Handsontable.hooks.add("afterInit",e);Handsontable.hooks.add("afterUpdateSettings",e)},{"helpers/dom/element":45,renderers:88}],86:[function(n,t,i){"use strict";Object.defineProperties(i,{TouchScroll:{get:function(){return e}},__esModule:{value:!0}});var r,u,f,o=(r=n("helpers/dom/element"),r&&r.__esModule&&r||{"default":r}),s=o.addClass,h=o.removeClass,c=(u=n("_base"),u&&u.__esModule&&u||{"default":u}).default,l=(f=n("plugins"),f&&f.__esModule&&f||{"default":f}).registerPlugin,e=function(n){var t=this;$traceurRuntime.superConstructor(a).call(this,n);this.hot.addHook("afterInit",function(){return t.afterInit()});this.hot.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()});this.scrollbars=[];this.clones=[]},a=e;$traceurRuntime.createClass(e,{afterInit:function(){this.registerEvents();this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var n=this;this.hot.addHookOnce("afterRender",function(){var t=n.hot.view.wt.wtOverlays;n.scrollbars=[];n.scrollbars.push(t.topOverlay);t.bottomOverlay.clone&&n.scrollbars.push(t.bottomOverlay);n.scrollbars.push(t.leftOverlay);t.topLeftCornerOverlay&&n.scrollbars.push(t.topLeftCornerOverlay);t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&n.scrollbars.push(t.bottomLeftCornerOverlay);n.clones=[];t.topOverlay.needFullRender&&n.clones.push(t.topOverlay.clone.wtTable.holder.parentNode);t.bottomOverlay.needFullRender&&n.clones.push(t.bottomOverlay.clone.wtTable.holder.parentNode);t.leftOverlay.needFullRender&&n.clones.push(t.leftOverlay.clone.wtTable.holder.parentNode);t.topLeftCornerOverlay&&n.clones.push(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode);t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&n.clones.push(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var n=this;this.hot.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()});this.hot.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){Handsontable.freezeOverlays=!0;for(var n=0,t=this.clones.length;n<t;n++)s(this.clones[n],"hide-tween")},onAfterMomentumScroll:function(){var r,t,u,i,f,n,e;for(Handsontable.freezeOverlays=!1,r=this,t=0,u=this.clones.length;t<u;t++)h(this.clones[t],"hide-tween");for(i=0,f=this.clones.length;i<f;i++)s(this.clones[i],"show-tween");for(setTimeout(function(){for(var n=0,t=r.clones.length;n<t;n++)h(r.clones[n],"show-tween")},400),n=0,e=this.scrollbars.length;n<e;n++)this.scrollbars[n].refresh(),this.scrollbars[n].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},c);l("touchScroll",e)},{_base:58,"helpers/dom/element":45,plugins:57}],87:[function(n){"use strict";var t,i,u=(t=n("helpers/object"),t&&t.__esModule&&t||{"default":t}),r=u.inherit,f=u.deepClone,e=(i=n("helpers/dom/event"),i&&i.__esModule&&i||{"default":i}).stopImmediatePropagation;Handsontable.UndoRedo=function(n){var t=this;this.instance=n;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=!1;n.addHook("afterChange",function(n){if(n){var i=new Handsontable.UndoRedo.ChangeAction(n);t.done(i)}});n.addHook("afterCreateRow",function(n,i,r){if(!r){var u=new Handsontable.UndoRedo.CreateRowAction(n,i);t.done(u)}});n.addHook("beforeRemoveRow",function(n,i){var r=t.instance.getSourceData(),u,f;n=(r.length+n)%r.length;u=r.slice(n,n+i);f=new Handsontable.UndoRedo.RemoveRowAction(n,u);t.done(f)});n.addHook("afterCreateCol",function(n,i,r){if(!r){var u=new Handsontable.UndoRedo.CreateColumnAction(n,i);t.done(u)}});n.addHook("beforeRemoveCol",function(i,r){var e=t.instance.getSourceData(),f,u,o,s,h;for(i=(t.instance.countCols()+i)%t.instance.countCols(),f=[],u=0,o=e.length;u<o;u++)f[u]=e[u].slice(i,i+r);Array.isArray(n.getSettings().colHeaders)&&(s=n.getSettings().colHeaders.slice(i,i+f.length));h=new Handsontable.UndoRedo.RemoveColumnAction(i,f,s);t.done(h)});n.addHook("beforeCellAlignment",function(n,i,r,u){var f=new Handsontable.UndoRedo.CellAlignmentAction(n,i,r,u);t.done(f)})};Handsontable.UndoRedo.prototype.done=function(n){this.ignoreNewActions||(this.doneActions.push(n),this.undoneActions.length=0)};Handsontable.UndoRedo.prototype.undo=function(){var n,t;this.isUndoAvailable()&&(n=this.doneActions.pop(),this.ignoreNewActions=!0,t=this,n.undo(this.instance,function(){t.ignoreNewActions=!1;t.undoneActions.push(n)}))};Handsontable.UndoRedo.prototype.redo=function(){var n,t;this.isRedoAvailable()&&(n=this.undoneActions.pop(),this.ignoreNewActions=!0,t=this,n.redo(this.instance,function(){t.ignoreNewActions=!1;t.doneActions.push(n)}))};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(n){this.changes=n};r(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(n,t){for(var r=f(this.changes),e=n.countEmptyRows(!0),o=n.countEmptyCols(!0),i=0,u=r.length;i<u;i++)r[i].splice(3,1);for(n.addHookOnce("afterChange",t),n.setDataAtRowProp(r,null,null,"undo"),i=0,u=r.length;i<u;i++)n.getSettings().minSpareRows&&r[i][0]+1+n.getSettings().minSpareRows===n.countRows()&&e==n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(r[i][0]+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&r[i][1]+1+n.getSettings().minSpareCols===n.countCols()&&o==n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(r[i][1]+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(n,t){for(var i=f(this.changes),r=0,u=i.length;r<u;r++)i[r].splice(2,1);n.addHookOnce("afterChange",t);n.setDataAtRowProp(i,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(n,t){this.index=n;this.amount=t};r(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(n,t){var i=n.countRows(),r=n.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r);n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateRow",t);n.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(n,t){this.index=n;this.data=t};r(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(n,t){var i=[this.index,0];Array.prototype.push.apply(i,this.data);Array.prototype.splice.apply(n.getSourceData(),i);n.addHookOnce("afterRender",t);n.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveRow",t);n.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(n,t){this.index=n;this.amount=t};r(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterCreateCol",t);n.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.CellAlignmentAction=function(n,t,i,r){this.stateBefore=n;this.range=t;this.type=i;this.alignment=r};Handsontable.UndoRedo.CellAlignmentAction.prototype.undo=function(n,t){var i,r;if(n.getPlugin("contextMenu").isEnabled()){for(i=this.range.from.row;i<=this.range.to.row;i++)for(r=this.range.from.col;r<=this.range.to.col;r++)n.setCellMeta(i,r,"className",this.stateBefore[i][r]||" htLeft");n.addHookOnce("afterRender",t);n.render()}};Handsontable.UndoRedo.CellAlignmentAction.prototype.redo=function(n,t){n.getPlugin("contextMenu").isEnabled()&&(n.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),n.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),n.addHookOnce("afterRender",t),n.render())};Handsontable.UndoRedo.RemoveColumnAction=function(n,t,i){this.index=n;this.data=t;this.amount=this.data[0].length;this.headers=i};r(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(n,t){for(var u,i,r=0,f=n.getSourceData().length;r<f;r++)u=n.getSourceDataAtRow(r),i=[this.index,0],Array.prototype.push.apply(i,this.data[r]),Array.prototype.splice.apply(u,i);typeof this.headers!="undefined"&&(i=[this.index,0],Array.prototype.push.apply(i,this.headers),Array.prototype.splice.apply(n.getSettings().colHeaders,i));n.addHookOnce("afterRender",t);n.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(n,t){n.addHookOnce("afterRemoveCol",t);n.alter("remove_col",this.index,this.amount)}}]})});
//# sourceMappingURL=handsontable.full.min.js.map
