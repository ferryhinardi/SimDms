function JL(n){if(!n)return JL.__;Array.prototype.reduce||(Array.prototype.reduce=function(n,t){for(var r=t,i=0;i<this.length;i++)r=n(r,this[i],i,this);return r});var t="";return("."+n).split(".").reduce(function(n,i){t?t+="."+i:t=i;var r=n["__"+t];return r===undefined&&(JL.Logger.prototype=n,r=new JL.Logger(t),n["__"+t]=r),r},JL.__)}var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},JL,exports,define;(function(n){function t(n,t,i){if(t[n]!==undefined){if(t[n]===null){delete i[n];return}i[n]=t[n]}}function c(t){if(!(n.enabled==null)&&!n.enabled||!(n.maxMessages==null)&&n.maxMessages<1)return!1;try{if(t.userAgentRegex&&!new RegExp(t.userAgentRegex).test(navigator.userAgent))return!1}catch(i){}try{if(t.ipRegex&&n.clientIP&&!new RegExp(t.ipRegex).test(n.clientIP))return!1}catch(i){}return!0}function l(n,t){try{if(n.disallow&&new RegExp(n.disallow).test(t))return!1}catch(i){}return!0}function a(n){return typeof n=="function"?n instanceof RegExp?n.toString():n():n}function v(n){var t=a(n),r;switch(typeof t){case"string":return new i(t,null,t);case"number":return r=t.toString(),new i(r,null,r);case"boolean":return r=t.toString(),new i(r,null,r);case"undefined":return new i("undefined",null,"undefined");case"object":return t instanceof RegExp||t instanceof String||t instanceof Number||t instanceof Boolean?(r=t.toString(),new i(r,null,r)):new i(null,t,JSON.stringify(t));default:return new i("unknown",null,"unknown")}}function g(n){return t("enabled",n,this),t("maxMessages",n,this),t("defaultAjaxUrl",n,this),t("clientIP",n,this),t("requestId",n,this),t("defaultBeforeSend",n,this),this}function nt(){return-2147483648}function y(){return 1e3}function p(){return 2e3}function w(){return 3e3}function b(){return 4e3}function k(){return 5e3}function e(){return 6e3}function tt(){return 2147483647}function it(n){return n<=1e3?"trace":n<=2e3?"debug":n<=3e3?"info":n<=4e3?"warn":n<=5e3?"error":"fatal"}function rt(n){return new u(n)}function ut(n){return new f(n)}var i,o,s,r,u,f,d,h;n.enabled;n.maxMessages;n.defaultAjaxUrl;n.clientIP;n.defaultBeforeSend;n.requestId="";i=function(){function n(n,t,i){this.msg=n;this.meta=t;this.finalString=i}return n}();n.setOptions=g;n.getAllLevel=nt;n.getTraceLevel=y;n.getDebugLevel=p;n.getInfoLevel=w;n.getWarnLevel=b;n.getErrorLevel=k;n.getFatalLevel=e;n.getOffLevel=tt;o=function(){function n(n,t){this.inner=t;this.name="JL.Exception";this.message=v(n).finalString}return n}();n.Exception=o;o.prototype=new Error;s=function(){function n(n,t,i,r){this.l=n;this.m=t;this.n=i;this.t=r}return n}();n.LogItem=s;r=function(){function i(t,i){this.appenderName=t;this.sendLogItems=i;this.level=n.getTraceLevel();this.sendWithBufferLevel=2147483647;this.storeInBufferLevel=-2147483648;this.bufferSize=0;this.batchSize=1;this.buffer=[];this.batchBuffer=[]}return i.prototype.setOptions=function(n){return t("level",n,this),t("ipRegex",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("sendWithBufferLevel",n,this),t("storeInBufferLevel",n,this),t("bufferSize",n,this),t("batchSize",n,this),this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize),this},i.prototype.log=function(n,t,i,r,u,f,e){var o;if(c(this)&&l(this,f)&&!(u<this.storeInBufferLevel)){if(o=new s(u,f,e,(new Date).getTime()),u<this.level){this.bufferSize>0&&(this.buffer.push(o),this.buffer.length>this.bufferSize&&this.buffer.shift());return}if(u<this.sendWithBufferLevel?this.batchBuffer.push(o):(this.buffer.length&&(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(o)),this.batchBuffer.length>=this.batchSize){this.sendBatch();return}}},i.prototype.sendBatch=function(){this.batchBuffer.length!=0&&(n.maxMessages!=null&&n.maxMessages<1||(n.maxMessages==null||(n.maxMessages-=this.batchBuffer.length),this.sendLogItems(this.batchBuffer),this.batchBuffer.length=0))},i}();n.Appender=r;u=function(i){function r(n){i.call(this,n,r.prototype.sendLogItemsAjax)}return __extends(r,i),r.prototype.setOptions=function(n){return t("url",n,this),t("beforeSend",n,this),i.prototype.setOptions.call(this,n),this},r.prototype.sendLogItemsAjax=function(t){var r,u,i;try{r="/jsnlog.logger";n.defaultAjaxUrl==null||(r=n.defaultAjaxUrl);this.url&&(r=this.url);u=JSON.stringify({r:n.requestId,lg:t});i=new XMLHttpRequest;i.open("POST",r);typeof this.beforeSend=="function"?this.beforeSend(i):typeof n.defaultBeforeSend=="function"&&n.defaultBeforeSend(i);i.setRequestHeader("Content-Type","application/json");i.setRequestHeader("JSNLog-RequestId",n.requestId);i.send(u)}catch(f){}},r}(r);n.AjaxAppender=u;f=function(t){function i(n){t.call(this,n,i.prototype.sendLogItemsConsole)}return __extends(i,t),i.prototype.clog=function(n){console.log(n)},i.prototype.cerror=function(n){console.error?console.error(n):this.clog(n)},i.prototype.cwarn=function(n){console.warn?console.warn(n):this.clog(n)},i.prototype.cinfo=function(n){console.info?console.info(n):this.clog(n)},i.prototype.cdebug=function(n){console.debug?console.debug(n):this.cinfo(n)},i.prototype.sendLogItemsConsole=function(t){var u,i,r;try{if(!console)return;for(u=0;u<t.length;++u)i=t[u],r=i.n+": "+i.m,typeof window=="undefined"&&(r=new Date(i.t)+" | "+r),i.l<=n.getDebugLevel()?this.cdebug(r):i.l<=n.getInfoLevel()?this.cinfo(r):i.l<=n.getWarnLevel()?this.cwarn(r):this.cerror(r)}catch(f){}},i}(r);n.ConsoleAppender=f;d=function(){function n(n){this.loggerName=n;this.seenRegexes=[]}return n.prototype.setOptions=function(n){return t("level",n,this),t("userAgentRegex",n,this),t("disallow",n,this),t("ipRegex",n,this),t("appenders",n,this),t("onceOnly",n,this),this.seenRegexes=[],this},n.prototype.buildExceptionObject=function(n){var t={};return n.stack?t.stack=n.stack:t.e=n,n.message&&(t.message=n.message),n.name&&(t.name=n.name),n.data&&(t.data=n.data),n.inner&&(t.inner=this.buildExceptionObject(n.inner)),t},n.prototype.log=function(n,t,i){var r=0,u,f;if(!this.appenders)return this;if(n>=this.level&&c(this)&&(i?(f=this.buildExceptionObject(i),f.logData=a(t)):f=t,u=v(f),l(this,u.finalString))){if(this.onceOnly)for(r=this.onceOnly.length-1;r>=0;){if(new RegExp(this.onceOnly[r]).test(u.finalString)){if(this.seenRegexes[r])return this;this.seenRegexes[r]=!0}r--}for(u.meta=u.meta||{},u.meta.loggerName=this.loggerName,r=this.appenders.length-1;r>=0;)this.appenders[r].log(it(n),u.msg,u.meta,function(){},n,u.finalString,this.loggerName),r--}return this},n.prototype.trace=function(n){return this.log(y(),n)},n.prototype.debug=function(n){return this.log(p(),n)},n.prototype.info=function(n){return this.log(w(),n)},n.prototype.warn=function(n){return this.log(b(),n)},n.prototype.error=function(n){return this.log(k(),n)},n.prototype.fatal=function(n){return this.log(e(),n)},n.prototype.fatalException=function(n,t){return this.log(e(),n,t)},n}();n.Logger=d;n.createAjaxAppender=rt;n.createConsoleAppender=ut;h=new u("");typeof window=="undefined"&&(h=new f(""));n.__=new n.Logger("");n.__.setOptions({level:n.getDebugLevel(),appenders:[h]})})(JL||(JL={}));typeof exports!="undefined"&&(exports.JL=JL);typeof define=="function"&&define.amd&&define("jsnlog",[],function(){return JL});typeof __jsnlog_configure=="function"&&__jsnlog_configure(JL);