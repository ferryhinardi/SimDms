var chatboxManager=function(){var i=function(n){$.extend(chatbox_config,n)},r=function(){},n=function(){return(chatbox_config.width+chatbox_config.gap)*showList.length},u=function(n){var i=showList.indexOf(n),t;if(i!=-1)for(showList.splice(i,1),diff=chatbox_config.width+chatbox_config.gap,t=i;t<showList.length;t++)offset=$("#"+showList[t]).chatbox("option","offset"),$("#"+showList[t]).chatbox("option","offset",offset-diff);else alert("NOTE: Id missing from array: "+n)},f=function(i,r){var o=showList.indexOf(i),s=boxList.indexOf(i),e,f;o!=-1||(s!=-1?($("#"+i).chatbox("option","offset",n()),e=$("#"+i).chatbox("option","boxManager"),e.toggleBox(),showList.push(i)):(f=document.createElement("div"),f.setAttribute("id",i),$(f).chatbox({id:i,user:r,title:'<i title="'+r.status+'"><\/i>'+r.first_name+" "+r.last_name,hidden:!1,offset:n(),width:chatbox_config.width,status:r.status,alertmsg:r.alertmsg,alertshow:r.alertshow,messageSent:t,boxClosed:u}),boxList.push(i),showList.push(i),nameList.push(r.first_name)))},e=function(n,t,i){var r=boxList.indexOf(n);chatbox_config.messageSent(nameList[r],i)},t=function(n,t,i){$("#chatlog").doesExist()&&$("#chatlog").append("You said to <b>"+t.first_name+" "+t.last_name+":<\/b> "+i+"<br/>").effect("highlight",{},500);$("#"+n).chatbox("option","boxManager").addMsg("Me",i)};return{init:i,addBox:f,delBox:r,dispatch:t}}();$("a[data-chat-id]:not(.offline)").click(function(n){var t=$(this),i=t.attr("data-chat-id"),r=t.attr("data-chat-fname"),u=t.attr("data-chat-lname"),f=t.attr("data-chat-status")||"online",e=t.attr("data-chat-alertmsg"),o=t.attr("data-chat-alertshow")||!1;chatboxManager.addBox(i,{title:"username"+i,first_name:r,last_name:u,status:f,alertmsg:e,alertshow:o});n.preventDefault()});