angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position"]).directive("datetimePicker",["$compile","$parse","$document","$position","dateFilter","dateParser","datepickerPopupConfig",function(n,t,i,r,u,f,e){return{restrict:"A",require:"ngModel",scope:{isOpen:"=?",enableDate:"=?",enableTime:"=?",todayText:"@",nowText:"@",dateText:"@",timeText:"@",clearText:"@",closeText:"@",dateDisabled:"&"},link:function(o,s,h,c){function w(n){return n.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()})}function g(n){if(n){if(angular.isDate(n)&&!isNaN(n))return c.$setValidity("date",!0),n;if(angular.isString(n)){var t=f.parse(n,p)||new Date(n);return isNaN(t)?(c.$setValidity("date",!1),undefined):(c.$setValidity("date",!0),t)}return c.$setValidity("date",!1),undefined}return c.$setValidity("date",!0),null}var p,nt=angular.isDefined(h.closeOnDateSelection)?o.$parent.$eval(h.closeOnDateSelection):e.closeOnDateSelection,k=angular.isDefined(h.datepickerAppendToBody)?o.$parent.$eval(h.datepickerAppendToBody):e.appendToBody,l,a,d,v,b,y;o.showButtonBar=angular.isDefined(h.showButtonBar)?o.$parent.$eval(h.showButtonBar):e.showButtonBar;o.enableDate=!(o.enableDate==!1);o.enableTime=!(o.enableTime==!1);o.showPicker=o.enableDate?"date":"time";o.todayText=o.todayText||"Today";o.nowText=o.nowText||"Now";o.clearText=o.clearText||"Clear";o.closeText=o.closeText||"Close";o.dateText=o.dateText||"Date";o.timeText=o.timeText||"Time";o.getText=function(n){return o[n+"Text"]||e[n+"Text"]};h.$observe("datetimePicker",function(n){p=n||e.datepickerPopup;c.$render()});l=angular.element('<div datetime-picker-popup><div collapse="showPicker == \'time\'"><div datepicker><\/div><\/div><div collapse="showPicker == \'date\'"><div timepicker style="margin:0 auto"><\/div><\/div><\/div>');l.attr({"ng-model":"date","ng-change":"dateSelection()"});a=angular.element(l.children()[0].children[0]);h.datepickerOptions&&angular.forEach(o.$parent.$eval(h.datepickerOptions),function(n,t){a.attr(w(t),n)});d=angular.element(l.children()[1].children[0]);h.timepickerOptions&&angular.forEach(o.$parent.$eval(h.timepickerOptions),function(n,t){d.attr(w(t),n)});o.watchData={};angular.forEach(["minDate","maxDate","datepickerMode"],function(n){var i,r;h[n]&&(i=t(h[n]),o.$parent.$watch(i,function(t){o.watchData[n]=t}),a.attr(w(n),"watchData."+n),n==="datepickerMode"&&(r=i.assign,o.$watch("watchData."+n,function(n,t){n!==t&&r(o.$parent,n)})))});h.dateDisabled&&a.attr("date-disabled","dateDisabled({ date: date, mode: mode })");c.$parsers.unshift(g);o.dateSelection=function(n){angular.isDefined(n)&&(o.date=n);c.$setViewValue(o.date);c.$render();nt&&o.showPicker!="time"&&(o.isOpen=!1,s[0].focus())};s.bind("input change keyup",function(){o.$apply(function(){o.date=c.$modelValue})});c.$render=function(){var n=c.$viewValue?u(c.$viewValue,p):"";s.val(n);o.date=g(c.$modelValue)};v=function(n){o.isOpen&&n.target!==s[0]&&o.$apply(function(){o.isOpen=!1})};b=function(n){o.keydown(n)};s.bind("keydown",b);o.keydown=function(n){n.which===27?(n.preventDefault(),n.stopPropagation(),o.close()):n.which!==40||o.isOpen||(o.isOpen=!0)};o.$watch("isOpen",function(n){n?(o.$broadcast("datepicker.focus"),o.position=k?r.offset(s):r.position(s),o.position.top=o.position.top+s.prop("offsetHeight"),i.bind("click",v)):i.unbind("click",v)});o.select=function(n){var t,i;n==="today"?(t=new Date,angular.isDate(c.$modelValue)?(n=new Date(c.$modelValue),n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())):n=new Date(t.setHours(0,0,0,0))):n==="now"&&(angular.isDate(c.$modelValue)?(i=new Date,n=new Date(c.$modelValue),n.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):n=new Date);o.dateSelection(n)};o.close=function(){o.isOpen=!1;s[0].focus()};o.changePicker=function(n){o.showPicker=n};y=n(l)(o);l.remove();k?i.find("body").append(y):s.after(y);o.$on("$destroy",function(){y.remove();s.unbind("keydown",b);i.unbind("click",v)})}}}]).directive("datetimePickerPopup",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datetime-picker.html",link:function(n,t){t.bind("click",function(n){n.preventDefault();n.stopPropagation()})}}});angular.module("ui.bootstrap.datetimepicker").run(["$templateCache",function(n){"use strict";n.put("template/datetime-picker.html",'<ul class="dropdown-menu dropdown-menu-right" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', right: position.right+\'px\'}" style=left:inherit ng-keydown=keydown($event)><li style="padding:0 5px 5px 5px" class=datetime-picker><div ng-transclude><\/div><\/li><li ng-if=showButtonBar style=padding:5px><span class="btn-group pull-left" style=margin-right:10px><button ng-if="showPicker == \'date\'" type=button class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'today\') }}<\/button> <button ng-if="showPicker == \'time\'" type=button class="btn btn-sm btn-info" ng-click="select(\'now\')">{{ getText(\'now\') }}<\/button> <button type=button class="btn btn-sm btn-danger" ng-click=select(null)>{{ getText(\'clear\') }}<\/button><\/span> <span class="btn-group pull-right"><button ng-if="showPicker == \'date\' && enableTime" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'time\')">{{ getText(\'time\')}}<\/button> <button ng-if="showPicker == \'time\' && enableDate" type=button class="btn btn-sm btn-default" ng-click="changePicker(\'date\')">{{ getText(\'date\')}}<\/button> <button type=button class="btn btn-sm btn-success" ng-click=close()>{{ getText(\'close\') }}<\/button><\/span><\/li><\/ul>')}]);