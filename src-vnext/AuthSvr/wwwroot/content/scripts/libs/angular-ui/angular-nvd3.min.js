(function(){"use strict";angular.module("nvd3",[]).directive("nvd3",["nvd3Utils",function(n){return{restrict:"AE",scope:{data:"=",options:"=",api:"=?",events:"=?",config:"=?"},link:function(t,i){function e(n,i){n&&i&&angular.forEach(n,function(r,u){u==="dispatch"?((i[u]===undefined||i[u]===null)&&t._config.extended&&(i[u]={}),f(r,i[u])):["scatter","defined","options","axis","rangeBand","rangeBands","_options","_inherited","_d3options","_calls"].indexOf(u)<0&&(i[u]===undefined||i[u]===null?t._config.extended&&(i[u]=r()):n[u](i[u]))})}function f(n,i){n&&i&&angular.forEach(n,function(r,u){if(i[u]===undefined||i[u]===null)t._config.extended&&(i[u]=r.on);else n.on(u+"._",i[u])})}function r(r){var u=n.deepExtend(s(r),t.options[r]||{}),f;t._config.extended&&(t.options[r]=u);f=angular.element("<div><\/div>").html(u.html||"").addClass(r).addClass(u.className).removeAttr("style").css(u.css);u.html||f.text(u.text);u.enable&&(r==="title"?i.prepend(f):r==="subtitle"?i.find(".title").after(f):r==="caption"&&i.append(f))}function o(){var r=n.deepExtend(h(),t.options.styles||{});t._config.extended&&(t.options.styles=r);angular.forEach(r.classes,function(n,t){n?i.addClass(t):i.removeClass(t)});i.removeAttr("style").css(r.css)}function s(n){switch(n){case"title":return{enable:!1,text:"Write Your Title",className:"h4",css:{width:t.options.chart.width+"px",textAlign:"center"}};case"subtitle":return{enable:!1,text:"Write Your Subtitle",css:{width:t.options.chart.width+"px",textAlign:"center"}};case"caption":return{enable:!1,text:"Figure 1. Write Your Caption text.",css:{width:t.options.chart.width+"px",textAlign:"center"}}}}function h(){return{classes:{"with-3d-shadow":!0,"with-transitions":!0,gallery:!1},css:{}}}var u={extended:!1,visible:!0,disabled:!1,autorefresh:!0,refreshDataOnly:!1,deepWatchData:!0,debounce:10};t._config=angular.extend(u,t.config);t.api={refresh:function(){t.api.updateWithOptions(t.options)},update:function(){t.chart.update()},updateWithOptions:function(n){(t.api.clearElement(),angular.isDefined(n)!==!1)&&t._config.visible&&(t.chart=nv.models[n.chart.type](),t.chart.id=Math.random().toString(36).substr(2,15),angular.forEach(t.chart,function(i,r){["options","_options","_inherited","_d3options","state","id","resizeHandler"].indexOf(r)>=0||(r==="dispatch"?((n.chart[r]===undefined||n.chart[r]===null)&&t._config.extended&&(n.chart[r]={}),f(t.chart[r],n.chart[r])):["lines","lines1","lines2","bars","bars1","bars2","stack1","stack2","stacked","multibar","discretebar","pie","scatter","bullet","sparkline","legend","distX","distY","xAxis","x2Axis","yAxis","yAxis1","yAxis2","y1Axis","y2Axis","y3Axis","y4Axis","interactiveLayer","controls"].indexOf(r)>=0?((n.chart[r]===undefined||n.chart[r]===null)&&t._config.extended&&(n.chart[r]={}),e(t.chart[r],n.chart[r],n.chart.type)):(r==="xTickFormat"||r==="yTickFormat")&&n.chart.type==="lineWithFocusChart"||(n.chart[r]===undefined||n.chart[r]===null?t._config.extended&&(n.chart[r]=i()):t.chart[r](n.chart[r])))}),t.api.updateWithData(t.data),(n.title||t._config.extended)&&r("title"),(n.subtitle||t._config.extended)&&r("subtitle"),(n.caption||t._config.extended)&&r("caption"),(n.styles||t._config.extended)&&o(),nv.addGraph(function(){return t.chart.resizeHandler=nv.utils.windowResize(function(){t.chart.update()}),t.chart},n.chart.callback))},updateWithData:function(n){n&&(t.options.chart.transitionDuration=+t.options.chart.transitionDuration||250,d3.select(i[0]).select("svg").remove(),d3.select(i[0]).append("svg").attr("height",t.options.chart.height).attr("width",t.options.chart.width||"100%").datum(n).transition().duration(t.options.chart.transitionDuration).call(t.chart))},clearElement:function(){if(i.find(".title").remove(),i.find(".subtitle").remove(),i.find(".caption").remove(),i.empty(),t.chart){t.chart.resizeHandler&&t.chart.resizeHandler.clear();for(var n=0;n<nv.graphs.length;n++)nv.graphs[n].id===t.chart.id&&nv.graphs.splice(n,1)}t.chart=null;nv.tooltip.cleanup()},getScope:function(){return t}};t.$watch("options",n.debounce(function(){!t._config.disabled&&t._config.autorefresh&&t.api.refresh()},t._config.debounce,!0),!0);t.$watch("data",function(n,i){n!==i&&t.chart&&!t._config.disabled&&t._config.autorefresh&&(t._config.refreshDataOnly?t.chart.update():t.api.refresh())},t._config.deepWatchData);t.$watch("config",function(n,i){n!==i&&(t._config=angular.extend(u,n),t.api.refresh())},!0);angular.forEach(t.events,function(n,i){t.$on(i,function(i){return n(i,t)})});i.on("$destroy",function(){t.api.clearElement()})}}}]).factory("nvd3Utils",function(){return{debounce:function(n,t,i){var r;return function(){var u=this,f=arguments,e=function(){r=null;i||n.apply(u,f)},o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(u,f)}},deepExtend:function(n){var t=this;return angular.forEach(arguments,function(i){i!==n&&angular.forEach(i,function(i,r){n[r]&&n[r].constructor&&n[r].constructor===Object?t.deepExtend(n[r],i):n[r]=i})}),n}}})})();