(function(){function t(n,t,i,r,_,u,f){var e=[],s=2.5066282746310002,h=[undefined,0,1,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,1,2,3,4,5,6,0],c=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],o=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],undefined,undefined,undefined,[0],[1],[2],[3],[4],[5],[6]],l=function(n){for(var t in n)_.isArray(n[t])&&(n[t]=Formula.FLATTEN(n[t]));return n};return Formula.UNIQUE=function(){return _.unique(arguments)},Formula.FLATTEN=function(){return _.flatten(arguments)},Formula.FUNCTION=function(){var n=Array.prototype.slice.call(arguments),t=n[n.length-1],i=t.replace(/(\w+)\(/g,function(){return"Formulae."+arguments[0]});return n[n.length-1]="return "+i+";",i!==t&&n.unshift("Formulae"),Function.apply(null,n)},Formula.MOMENT=function(n,t){return r(n).format(t)},Formula.MOMENTADD=function(n,t,i){return r(n).add(t,i)},Formula.MOMENTDIFF=function(n,t,i){return r(t).diff(r.utc(n),i)},Formula.MOMENTSUB=function(n,t,i){return r(n).subtract(t,i)},Formula.MOMENTUTC=function(n,t){return r.utc(n).format(t)},Formula.MOMENTUTCADD=function(n,t,i){return r.utc(n).add(t,i)},Formula.MOMENTUTCDIFF=function(n,t,i){return r.utc(t).diff(r.utc(n),i)},Formula.MOMENTUTCSUB=function(n,t,i){return r.utc(n).subtract(t,i)},Formula.MOMENTUNIX=function(n){return r.unix(n).toDate()},Formula.MOMENTFORMAT=function(n,t){return r(n).format(t)},Formula.MOMENTISLEAPYEAR=function(n,t){return r(n,t).isLeapYear()},Formula.MOMENTISDST=function(n,t){return r(n,t).isDST()},Formula.MOMENTSTARTOF=function(n,t,i){return r(n,i).startOf(t).toDate()},Formula.MOMENTENDOF=function(n,t,i){return r(n,i).endOf(t).toDate()},Formula.MOMENTISAFTER=function(n,t,i){return r(n,i).isAfter(r(t,i))},Formula.MOMENTISBEFORE=function(n,t,i){return r(n,i).isBefore(r(t,i))},Formula.INTERVAL=function(n){var e=Math.floor(n/94608e4),t,i,r,u,f;return n=n%94608e4,t=Math.floor(n/2592e3),n=n%2592e3,i=Math.floor(n/86400),n=n%86400,r=Math.floor(n/3600),n=n%3600,u=Math.floor(n/60),n=n%60,f=n,e=e>0?e+"Y":"",t=t>0?t+"M":"",i=i>0?i+"D":"",r=r>0?r+"H":"",u=u>0?u+"M":"",f=f>0?f+"S":"","P"+e+t+i+"T"+r+u+f},Formula.ARGSCONCAT=function(n){for(var t=[],i=0;i<n.length;i++)t=t.concat(n[i]);return t},Formula.ARGSTOARRAY=function(n){return Array.prototype.slice.call(n,0)},Formula.CLEANFLOAT=function(n){var t=Math.pow(10,14);return Math.round(n*t)/t},Formula.COUNTIN=function(n,t){for(var r=0,i=0;i<n.length;i++)n[i]===t&&r++;return r},Formula.FINDFIELD=function(n,t){for(var r=null,i=0;i<n.length;i++)if(n[i][0]===t){r=i;break}return r==null?"#VALUE!":r},Formula.FINDRESULTINDEX=function(database,criteria){for(var columnResultIndexes,rowResultIndexes,j,k,maxCriteriaLength=criteria[0].length,i=1;i<criteria.length;i++)criteria[i].length>maxCriteriaLength&&(maxCriteriaLength=criteria[i].length);for(columnResultIndexes=[],i=1;i<maxCriteriaLength;i++){for(rowResultIndexes=[],j=0;j<criteria.length;j++)if(!(criteria[j].length<maxCriteriaLength)){var criteriaTitle=criteria[j][0],criteriaIndex=Formula.FINDFIELD(database,criteriaTitle),criteriaValues=_.rest(database[criteriaIndex]),count=0,singleResultIndexes=[];for(k=0;k<criteriaValues.length;k++)eval(criteriaValues[k]+criteria[j][i])&&(singleResultIndexes[count++]=k);rowResultIndexes[j]=singleResultIndexes}columnResultIndexes[i-1]=_.intersection.apply(_,rowResultIndexes)}return _.union.apply(_,columnResultIndexes)},Formula.DAVERAGE=function(n,t,i){var r,u,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(r=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=0,f=0;f<r.length;f++)e+=u[r[f]];return Formula.IF(r.length===0,"#DIV/0!",e/r.length)},Formula.DCOUNT=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.COUNT(e)},Formula.DCOUNTA=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.COUNTA(e)},Formula.DGET=function(n,t,i){var r,u,f;return isNaN(t)&&typeof t!="string"?"#VALUE!":(r=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(f=Formula.FINDFIELD(n,t),u=_.rest(n[f])):u=_.rest(n[t]),r.length===0)?"#VALUE!":r.length>1?"#NUM!":u[r[0]]},Formula.DMAX=function(n,t,i){var u,r,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(u=Formula.FINDRESULTINDEX(n,i),r=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),r=_.rest(n[o])):r=_.rest(n[t]),e=r[u[0]],f=1;f<u.length;f++)e<r[u[f]]&&(e=r[u[f]]);return e},Formula.DMIN=function(n,t,i){var u,r,o,e,f;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(u=Formula.FINDRESULTINDEX(n,i),r=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),r=_.rest(n[o])):r=_.rest(n[t]),e=r[u[0]],f=1;f<u.length;f++)e>r[u[f]]&&(e=r[u[f]]);return e},Formula.DPRODUCT=function(n,t,i){var e,f,s,u,r,o;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(s=Formula.FINDFIELD(n,t),f=_.rest(n[s])):f=_.rest(n[t]),u=[],r=0;r<e.length;r++)u[r]=f[e[r]];for(u=_.compact(u),o=1,r=0;r<u.length;r++)o*=u[r];return o},Formula.DSTDEV=function(n,t,i){var e,f,o,r,u;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),f=_.rest(n[o])):f=_.rest(n[t]),r=[],u=0;u<e.length;u++)r[u]=f[e[u]];return r=_.compact(r),Formula.STDEVS(r)},Formula.DSTDEVP=function(n,t,i){var e,f,o,r,u;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(e=Formula.FINDRESULTINDEX(n,i),f=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),f=_.rest(n[o])):f=_.rest(n[t]),r=[],u=0;u<e.length;u++)r[u]=f[e[u]];return r=_.compact(r),Formula.STDEVP(r)},Formula.DSUM=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.SUM(e)},Formula.DVAR=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.VARS(e)},Formula.DVARP=function(n,t,i){var f,u,o,e,r;if(isNaN(t)&&typeof t!="string")return"#VALUE!";for(f=Formula.FINDRESULTINDEX(n,i),u=[],typeof t=="string"?(o=Formula.FINDFIELD(n,t),u=_.rest(n[o])):u=_.rest(n[t]),e=[],r=0;r<f.length;r++)e[r]=u[f[r]];return Formula.VARP(e)},Formula.GETJSON=function(n){var t=new XMLHttpRequest;return t.open("GET",n,!1),t.send(null),t.status===200?JSON.parse(t.responseText):void 0},Formula.DATE=function(){if(!arguments.length)return new Date;if(arguments.length===1)return new Date(arguments[0]);var n=arguments;return n[1]=n[1]-1,new(Date.bind.apply(Date,[Date].concat([].splice.call(n,0))))},Formula.DATEVALUE=function(n){return Math.ceil((r(n)-r("1900-1-1"))/864e5)+2},Formula.DAY=function(n){return new Date(n).getDate()},Formula.DAYS=function(n,t){return r(new Date(n)).diff(r(new Date(t)),"days")},Formula.DAYS360=function(n,t,i){var e=r(new Date(n)),o=r(new Date(t)),s=31,h=31,u=e.date(),f=o.date();return i?(u=u===31?30:u,f=f===31?30:f):(e.month()===1&&(s=e.daysInMonth()),o.month()===1&&(h=o.daysInMonth()),u=u===s?30:u,(u===30||u===s)&&(f=f===h?30:f)),360*(o.year()-e.year())+30*(o.month()-e.month())+(f-u)},Formula.EDATE=function(n,t){return r(new Date(n)).add("months",t).toDate()},Formula.EOMONTH=function(n,t){var i=r(new Date(n)).add("months",t);return new Date(i.year(),i.month(),i.daysInMonth())},Formula.FROMNOW=function(n,t){return r(new Date(n)).fromNow(t)},Formula.HOUR=function(n){return n<=1?Math.floor(24*n):new Date(n).getHours()},Formula.MINUTE=function(n){return n<=1?Math.floor(1440*n)-60*Math.floor(24*n):new Date(n).getMinutes()},Formula.ISOWEEKNUM=function(n){return r(new Date(n)).format("w")},Formula.MONTH=function(n){return new Date(n).getMonth()+1},Formula.NETWORKDAYS=function(n,t,i){return Formula.NETWORKDAYSINTL(n,t,1,i)},Formula.NETWORKDAYSINTL=function(n,t,i,u){var y=typeof i=="undefined"?1:i,l=o[y],a=r(n),p=r(t),v=p.diff(a,"days")+1,e=v,s=a,h=[],f,c;if(typeof u!="undefined")for(f=0;f<u.length;f++)h[f]=r(new Date(u[f])).format("MM-DD-YYYY");if(!l.length&&!h.length)return e;for(c=0;c<v;)l.indexOf(parseInt(s.format("d"),10))>=0?e--:h.indexOf(s.format("MM-DD-YYYY"))>=0&&e--,s=s.add("days",1),c++;return e},Formula.NOW=function(){return new Date},Formula.SECOND=function(n){return new Date(n).getSeconds()},Formula.TIME=function(n,t,i){return(3600*n+60*t+i)/86400},Formula.TIMEVALUE=function(n){var t=new Date(n);return(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},Formula.TODAY=Formula.NOW,Formula.WEEKDAY=function(n,t){var i=r(new Date(n)).format("d"),u=typeof t=="undefined"?1:t;return c[u][i]},Formula.WEEKNUM=function(n,t){var f=r(new Date(n)),e=r(new Date(f.year(),0,1)),o=typeof t=="undefined"?1:t,i=h[o],u=e.format("d"),s=u<i?i-u+1:u-i;return o===21?Formula.ISOWEEKNUM(n):Math.floor(f.diff(e.subtract("days",s),"days")/7)+1},Formula.WORKDAY=function(n,t,i){return Formula.WORKDAYINTL(n,t,1,i)},Formula.WORKDAYINTL=function(n,t,i,u){var l=typeof i=="undefined"?1:i,a=o[l],v=r(new Date(n)),f=v,h="",c=[],e,s;if(typeof u!="undefined")for(e=0;e<u.length;e++)c[e]=r(new Date(u[e])).format("MM-DD-YYYY");for(s=0;s<t;)f=f.add("days",1),h=f.format("d"),a.indexOf(parseInt(h,10))<0&&c.indexOf(f.format("MM-DD-YYYY"))<0&&s++;return f.toDate()},Formula.YEAR=function(n){return new Date(n).getFullYear()},Formula.YEARFRAC=function(n,t,i){var u,f,v,a;if(i=typeof i=="undefined"?0:i,u=r(new Date(n)),f=r(new Date(t)),!u.isValid()||!f.isValid())return"#VALUE!";if([0,1,2,3,4].indexOf(i)===-1)return"#NUM!";if(u===f)return 0;u.diff(f)>0&&(f=r(new Date(n)),u=r(new Date(t)));var s=u.year(),c=u.month(),e=u.date(),h=f.year(),l=f.month(),o=f.date();switch(i){case 0:return e===31&&o===31?(e=30,o=30):e===31?e=30:e===30&&o===31?o=30:c===1&&l===1&&u.daysInMonth()===e&&f.daysInMonth()===o?(e=30,o=30):c===1&&u.daysInMonth()===e&&(e=30),(o+l*30+h*360-(e+c*30+s*360))/360;case 1:if(v=function(n,t){var u=r(new Date(n.year(),2,1)),i;return r([n.year()]).isLeapYear()&&n.diff(u)<0&&t.diff(u)>=0?!0:(i=r(new Date(t.year(),2,1)),r([t.year()]).isLeapYear()&&t.diff(i)>=0&&n.diff(i)<0)?!0:!1},a=365,s===h||s+1===h&&(c>l||c===l&&e>=o))return s===h&&r([s]).isLeapYear()?a=366:(v(u,f)||l===1&&o===29)&&(a=366),f.diff(u,"days")/a;var y=h-s+1,p=r(new Date(h+1,0,1)).diff(r(new Date(s,0,1)),"days"),w=p/y;return f.diff(u,"days")/w;case 2:return f.diff(u,"days")/360;case 3:return f.diff(u,"days")/365;case 4:return e===31&&(e=30),o===31&&(o=30),(o+l*30+h*360-(e+c*30+s*360))/360}},Formula.BESSELI=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function r(r){return r<=3.75?n(t,r*r/(3.75*3.75)):Math.exp(Math.abs(r))/Math.sqrt(Math.abs(r))*n(i,3.75/Math.abs(r))}function e(t){return t<3.75?t*n(u,t*t/(3.75*3.75)):(t<0?-1:1)*Math.exp(Math.abs(t))/Math.sqrt(Math.abs(t))*n(f,3.75/Math.abs(t))}var t=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),i=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),u=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,.00032411].reverse(),f=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function o(n,t){if(t=Math.round(t),t===0)return r(n);if(t===1)return e(n);if(t<0)throw"BESSELI Order ("+t+") must be nonnegative";if(Math.abs(n)===0)return 0;var u,f,l=2/Math.abs(n),h,s,i,c;for(h=2*Math.round((t+Math.round(Math.sqrt(40*t)))/2),s=u=0,i=1,f=h;f>0;f--)c=f*l*i+s,s=i,i=c,Math.abs(i)>1e10&&(i*=1e-10,s*=1e-10,u*=1e-10),f===t&&(u=s);return u*=o(n,0)/i,n<0&&t%2?-u:u}}(),Formula.BESSELJ=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function i(i){var c,s,h,r=i*i,l=Math.abs(i)-.785398164;return Math.abs(i)<8?(s=n(u,r),h=n(f,r),c=s/h):(r=64/r,s=n(e,r),h=n(o,r),c=Math.sqrt(t/Math.abs(i))*(Math.cos(l)*s-Math.sin(l)*h*8/Math.abs(i))),c}function r(i){var u,f,e,r=i*i,o=Math.abs(i)-2.356194491;return Math.abs(i)<8?(f=i*n(s,r),e=n(h,r),u=f/e):(r=64/r,f=n(c,r),e=n(l,r),u=Math.sqrt(t/Math.abs(i))*(Math.cos(o)*f-Math.sin(o)*e*8/Math.abs(i)),i<0&&(u=-u)),u}function a(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}var u=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),f=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),o=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse(),t=.636619772,s=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),h=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),c=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),l=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return function(n,t){if(t=Math.round(t),t===0)return i(Math.abs(n));if(t===1)return r(Math.abs(n));if(t<0)throw"BESSELJ: Order ("+t+") must be nonnegative";if(Math.abs(n)===0)return 0;var f,o,v=2/Math.abs(n),c,h,e,s,u,l;if(Math.abs(n)>t)f=a(n,t,i(Math.abs(n)),r(Math.abs(n)),-1);else{for(c=2*Math.floor((t+Math.floor(Math.sqrt(40*t)))/2),h=0,s=f=e=0,u=1,o=c;o>0;o--)l=o*v*u-s,s=u,u=l,Math.abs(u)>1e10&&(u*=1e-10,s*=1e-10,f*=1e-10,e*=1e-10),h&&(e+=u),h=!h,o===t&&(f=s);e=2*e-u;f/=e}return n<0&&t%2?-f:f}}(),Formula.BESSELK=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function r(r){return r<=2?-Math.log(r/2)*Formula.BESSELI(r,0)+n(t,r*r/4):Math.exp(-r)/Math.sqrt(r)*n(i,2/r)}function e(t){return t<=2?Math.log(t/2)*Formula.BESSELI(t,1)+1/t*n(u,t*t/4):Math.exp(-t)/Math.sqrt(t)*n(f,2/t)}function o(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}function s(n,t,i,r,u){return function(f,e){if(e===0)return n(f);if(e===1)return t(f);if(e<0)throw i+": Order ("+e+") must be nonnegative";if(r===1&&f===0)throw i+": Undefined when x == 0";if(r===2&&f<=0)throw i+": Undefined when x <= 0";var s=n(f),h=t(f);return o(f,e,s,h,u)}}var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,.0001075,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,.00053208].reverse(),u=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),f=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-.00068245].reverse();return s(r,e,"BESSELK",2,1)}(),Formula.BESSELY=function(){function n(n,t){return n.reduce(function(n,i){return t*n+i},0)}function e(e){var c,s,h,o=e*e,l=e-.785398164;return e<8?(s=n(i,o),h=n(r,o),c=s/h+t*Formula.BESSELJ(e,0)*Math.log(e)):(o=64/o,s=n(u,o),h=n(f,o),c=Math.sqrt(t/e)*(Math.sin(l)*s+Math.cos(l)*h*8/e)),c}function l(i){var e,u,f,r=i*i,l=i-2.356194491;return i<8?(u=i*n(o,r),f=n(s,r),e=u/f+t*(Formula.BESSELJ(i,1)*Math.log(i)-1/i)):(r=64/r,u=n(h,r),f=n(c,r),e=Math.sqrt(t/i)*(Math.sin(l)*u+Math.cos(l)*f*8/i)),e}function a(n,t,i,r,u){var e,o,f;if(u||(u=-1),e=2/n,t===0)return i;if(t===1)return r;for(f=1;f!==t;++f)o=r*f*e+u*i,i=r,r=o;return r}function v(n,t,i,r,u){return function(f,e){if(e===0)return n(f);if(e===1)return t(f);if(e<0)throw i+": Order ("+e+") must be nonnegative";if(r===1&&f===0)throw i+": Undefined when x == 0";if(r===2&&f<=0)throw i+": Undefined when x <= 0";var o=n(f),s=t(f);return a(f,e,o,s,u)}}var i=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),r=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),u=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),f=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),t=.636619772,o=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),s=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();return v(e,l,"BESSELY",1,-1)}(),Formula.VALIDBIN=function(n){return/^[01]{1,10}$/.test(n)},Formula.BIN2DEC=function(n){if(!Formula.VALIDBIN(n))return"#NUM!";var i=parseInt(n,2),t=n.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:i},Formula.BIN2HEX=function(n,t){var r,i;return Formula.VALIDBIN(n)?(r=n.toString(),r.length===10&&r.substring(0,1)==="1")?(0xfffffffe00+parseInt(r.substring(1),2)).toString(16):(i=parseInt(n,2).toString(16),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.BIN2OCT=function(n,t){var r,i;return Formula.VALIDBIN(n)?(r=n.toString(),r.length===10&&r.substring(0,1)==="1")?(1073741312+parseInt(r.substring(1),2)).toString(8):(i=parseInt(n,2).toString(8),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.BITAND=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n&t},Formula.BITLSHIFT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0?"#NUM!":Math.floor(n)!==n?"#NUM!":n>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?n<<t:n>>-t},Formula.BITOR=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n|t},Formula.BITRSHIFT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0?"#NUM!":Math.floor(n)!==n?"#NUM!":n>0xffffffffffff?"#NUM!":Math.abs(t)>53?"#NUM!":t>=0?n>>t:n<<-t},Formula.BITXOR=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<0||t<0?"#NUM!":Math.floor(n)!==n||Math.floor(t)!==t?"#NUM!":n>0xffffffffffff||t>0xffffffffffff?"#NUM!":n^t},Formula.COMPLEX=function(n,t,i){if(isNaN(n)||isNaN(t)||(i=typeof i=="undefined"?"i":i,i!=="i"&&i!=="j"))return"#VALUE!";if(n===0&&t===0)return 0;if(n===0)return t===1?i:t.toString()+i;if(t===0)return n.toString();var r=t>0?"+":"";return n.toString()+r+(t===1?i:t.toString()+i)},Formula.CONVERT=function(n,t,i){var u,w,a,e,b,v,o;if(isNaN(n))return"#VALUE!";var r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,.0001],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,.00064516],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,.0001],["stokes","St",null,"kinematic_viscosity",!1,!1,.0001],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],k={Yi:["yobi",80,1208925819614629174706176,"Yi","yotta"],Zi:["zebi",70,1180591620717411303424,"Zi","zetta"],Ei:["exbi",60,1152921504606846976,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},d={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,h=null,c=t,l=i,y=1,p=1,f;for(u=0;u<r.length;u++)f=r[u][2]===null?[]:r[u][2],(r[u][1]===c||f.indexOf(c)>=0)&&(s=r[u]),(r[u][1]===l||f.indexOf(l)>=0)&&(h=r[u]);if(s===null)for(w=k[t.substring(0,2)],a=d[t.substring(0,1)],t.substring(0,2)==="da"&&(a=["dekao",10,"da"]),w?(y=w[2],c=t.substring(2)):a&&(y=a[1],c=t.substring(a[2].length)),e=0;e<r.length;e++)f=r[e][2]===null?[]:r[e][2],(r[e][1]===c||f.indexOf(c)>=0)&&(s=r[e]);if(h===null)for(b=k[i.substring(0,2)],v=d[i.substring(0,1)],i.substring(0,2)==="da"&&(v=["dekao",10,"da"]),b?(p=b[2],l=i.substring(2)):v&&(p=v[1],l=i.substring(v[2].length)),o=0;o<r.length;o++)f=r[o][2]===null?[]:r[o][2],(r[o][1]===l||f.indexOf(l)>=0)&&(h=r[o]);return s===null||h===null?"#N/A":s[3]!==h[3]?"#N/A":n*s[6]*y/(h[6]*p)},Formula.DEC2BIN=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return"#NUM!";if(n<0)return"1"+u.repeat("0",9-(512+n).toString(2).length)+(512+n).toString(2);var i=parseInt(n,10).toString(2);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")},Formula.DEC2HEX=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return"#NUM!";if(n<0)return(1099511627776+n).toString(16);var i=parseInt(n,10).toString(16);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")},Formula.DEC2OCT=function(n,t){if(isNaN(n))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return"#NUM!";if(n<0)return(1073741824+n).toString(8);var i=parseInt(n,10).toString(8);return typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")},Formula.DELTA=function(n,t){return(t=typeof t=="undefined"?0:t,isNaN(n)||isNaN(t))?"#VALUE!":n===t?1:0},Formula.ERF=function(n,t){return(t=typeof t=="undefined"?0:t,isNaN(n)||isNaN(t))?"#VALUE!":i.erf(n)},Formula.ERFC=function(n){return isNaN(n)?"#VALUE!":i.erfc(n)},Formula.ERFCPRECISE=function(){return},Formula.ERFPRECISE=function(){return},Formula.GESTEP=function(n,t){return(t=typeof t=="undefined"?0:t,isNaN(n)||isNaN(t))?"#VALUE!":n>=t?1:0},Formula.HEX2BIN=function(n,t){var f,i,r;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(f=n.length===10&&n.substring(0,1).toLowerCase()==="f"?!0:!1,i=f?parseInt(n,16)-1099511627776:parseInt(n,16),i<-512||i>511)?"#NUM!":f?"1"+u.repeat("0",9-(512+i).toString(2).length)+(512+i).toString(2):(r=i.toString(2),typeof t=="undefined"?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=r.length?u.repeat("0",t-r.length)+r:"#NUM!")):"#NUM!"},Formula.HEX2DEC=function(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return"#NUM!";var t=parseInt(n,16);return t>=549755813888?t-1099511627776:t},Formula.HEX2OCT=function(n,t){var i,r;return/^[0-9A-Fa-f]{1,10}$/.test(n)?(i=parseInt(n,16),i>536870911&&i<0xffe0000000)?"#NUM!":i>=0xffe0000000?(i-0xffc0000000).toString(8):(r=i.toString(8),typeof t=="undefined"?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=r.length?u.repeat("0",t-r.length)+r:"#NUM!")):"#NUM!"},Formula.IMABS=function(n){var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Math.sqrt(Math.pow(t,2)+Math.pow(i,2))},Formula.IMAGINARY=function(n){var t,i,r,u;return n===0||n==="0"?0:["i","j"].indexOf(n)>=0?1:(n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j"),t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),r=n.substring(n.length-1,n.length),u=r==="i"||r==="j",t>=0||i>=0?u?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?"#NUM!":Number(n.substring(t+1,n.length-1)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?"#NUM!":-Number(n.substring(i+1,n.length-1)):"#NUM!":u?isNaN(n.substring(0,n.length-1))?"#NUM!":n.substring(0,n.length-1):isNaN(n)?"#NUM!":0)},Formula.IMARGUMENT=function(n){var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":t===0&&i===0?"#DIV/0!":t===0&&i>0?Math.PI/2:t===0&&i<0?-Math.PI/2:i===0&&t>0?0:i===0&&t<0?-Math.PI:t>0?Math.atan(i/t):t<0&&i>=0?Math.atan(i/t)+Math.PI:Math.atan(i/t)-Math.PI},Formula.IMCONJUGATE=function(n){var r=Formula.IMREAL(n),i=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",r==="#NUM!"||i==="#NUM!")?"#NUM!":i!==0?Formula.COMPLEX(r,-i,t):n},Formula.IMCOS=function(n){if(n===!0||n===!1)return"#VALUE!";var r=Formula.IMREAL(n),t=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",r==="#NUM!"||t==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMCOSH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),r=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",t==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMCOT=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV(Formula.IMCOS(n),Formula.IMSIN(n))},Formula.IMCSC=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMSIN(n))},Formula.IMCSCH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMSINH(n))},Formula.IMDIV=function(n,t){var u=Formula.IMREAL(n),f=Formula.IMAGINARY(n),i=Formula.IMREAL(t),r=Formula.IMAGINARY(t),s=n.substring(n.length-1),h=n.substring(n.length-1),e="i",o;return(s==="j"?e="j":h==="j"&&(e="j"),u==="#NUM!"||f==="#NUM!"||i==="#NUM!"||r==="#NUM!")?"#NUM!":i===0&&r===0?"#NUM!":(o=i*i+r*r,Formula.COMPLEX((u*i+f*r)/o,(f*i-u*r)/o,e))},Formula.IMEXP=function(n){var u=Formula.IMREAL(n),i=Formula.IMAGINARY(n),t=n.substring(n.length-1),r;return(t=t==="i"||t==="j"?t:"i",u==="#NUM!"||i==="#NUM!")?"#NUM!":(r=Math.exp(u),Formula.COMPLEX(r*Math.cos(i),r*Math.sin(i),t))},Formula.IMLN=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r)),Math.atan(r/i),t)},Formula.IMLOG10=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r))/Math.log(10),Math.atan(r/i)/Math.log(10),t)},Formula.IMLOG2=function(n){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),t=n.substring(n.length-1);return(t=t==="i"||t==="j"?t:"i",i==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.log(Math.sqrt(i*i+r*r))/Math.log(2),Math.atan(r/i)/Math.log(2),t)},Formula.IMPOWER=function(n,t){var r,u;if(isNaN(t))return"#VALUE!";var f=Formula.IMREAL(n),e=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",f==="#NUM!"||e==="#NUM!")?"#NUM!":(r=Math.pow(Formula.IMABS(n),t),u=Formula.IMARGUMENT(n),Formula.COMPLEX(r*Math.cos(t*u),r*Math.sin(t*u),i))},Formula.IMPRODUCT=function(){for(var n=arguments[0],t=1;t<arguments.length;t++){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),u=Formula.IMREAL(arguments[t]),f=Formula.IMAGINARY(arguments[t]);if(i==="#NUM!"||r==="#NUM!"||u==="#NUM!"||f==="#NUM!")return"#NUM!";n=Formula.COMPLEX(i*u-r*f,i*f+r*u)}return n},Formula.IMREAL=function(n){var t,i,r,u;return n===0||n==="0"?0:["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0?0:(t=n.indexOf("+"),i=n.indexOf("-"),t===0&&(t=n.indexOf("+",1)),i===0&&(i=n.indexOf("-",1)),r=n.substring(n.length-1,n.length),u=r==="i"||r==="j",t>=0||i>=0?u?t>=0?isNaN(n.substring(0,t))||isNaN(n.substring(t+1,n.length-1))?"#NUM!":Number(n.substring(0,t)):isNaN(n.substring(0,i))||isNaN(n.substring(i+1,n.length-1))?"#NUM!":Number(n.substring(0,i)):"#NUM!":u?isNaN(n.substring(0,n.length-1))?"#NUM!":0:isNaN(n)?"#NUM!":n)},Formula.IMSEC=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMCOS(n))},Formula.IMSECH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV("1",Formula.IMCOSH(n))},Formula.IMSIN=function(n){if(n===!0||n===!1)return"#VALUE!";var r=Formula.IMREAL(n),t=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",r==="#NUM!"||t==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,i)},Formula.IMSINH=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),r=Formula.IMAGINARY(n),i=n.substring(n.length-1);return(i=i==="i"||i==="j"?i:"i",t==="#NUM!"||r==="#NUM!")?"#NUM!":Formula.COMPLEX(Math.cos(r)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(r)*(Math.exp(t)+Math.exp(-t))/2,i)},Formula.IMSQRT=function(n){var u=Formula.IMREAL(n),f=Formula.IMAGINARY(n),t=n.substring(n.length-1),i,r;return(t=t==="i"||t==="j"?t:"i",u==="#NUM!"||f==="#NUM!")?"#NUM!":(i=Math.sqrt(Formula.IMABS(n)),r=Formula.IMARGUMENT(n),Formula.COMPLEX(i*Math.cos(r/2),i*Math.sin(r/2),t))},Formula.IMSUB=function(n,t){var r=Formula.IMREAL(n),u=Formula.IMAGINARY(n),f=Formula.IMREAL(t),e=Formula.IMAGINARY(t),o=n.substring(n.length-1),s=n.substring(n.length-1),i="i";return(o==="j"?i="j":s==="j"&&(i="j"),r==="#NUM!"||u==="#NUM!"||f==="#NUM!"||e==="#NUM!")?"#NUM!":Formula.COMPLEX(r-f,u-e,i)},Formula.IMSUM=function(){for(var n=arguments[0],t=1;t<arguments.length;t++){var i=Formula.IMREAL(n),r=Formula.IMAGINARY(n),u=Formula.IMREAL(arguments[t]),f=Formula.IMAGINARY(arguments[t]);if(i==="#NUM!"||r==="#NUM!"||u==="#NUM!"||f==="#NUM!")return"#NUM!";n=Formula.COMPLEX(i+u,r+f)}return n},Formula.IMTAN=function(n){if(n===!0||n===!1)return"#VALUE!";var t=Formula.IMREAL(n),i=Formula.IMAGINARY(n);return t==="#NUM!"||i==="#NUM!"?"#NUM!":Formula.IMDIV(Formula.IMSIN(n),Formula.IMCOS(n))},Formula.OCT2BIN=function(n,t){var f,i,r;return/^[0-7]{1,10}$/.test(n)?(f=n.length===10&&n.substring(0,1)==="7"?!0:!1,i=f?parseInt(n,8)-1073741824:parseInt(n,8),i<-512||i>511)?"#NUM!":f?"1"+u.repeat("0",9-(512+i).toString(2).length)+(512+i).toString(2):(r=i.toString(2),typeof t=="undefined"?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=r.length?u.repeat("0",t-r.length)+r:"#NUM!")):"#NUM!"},Formula.OCT2DEC=function(n){if(!/^[0-7]{1,10}$/.test(n))return"#NUM!";var t=parseInt(n,8);return t>=536870912?t-1073741824:t},Formula.OCT2HEX=function(n,t){var r,i;return/^[0-7]{1,10}$/.test(n)?(r=parseInt(n,8),r>=536870912)?"ff"+(r+3221225472).toString(16):(i=r.toString(16),typeof t=="undefined"?i:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t),t>=i.length?u.repeat("0",t-i.length)+i:"#NUM!")):"#NUM!"},Formula.ACCRINT=function(n,t,i,u,f,e,o,s){if(!r(n).isValid()||!r(t).isValid()||!r(i).isValid())return"#VALUE!";if(u<=0||f<=0||[1,2,4].indexOf(e)===-1||[0,1,2,3,4].indexOf(o)===-1||r(n).diff(r(i))>=0)return"#NUM!";f=typeof f=="undefined"?0:f;o=typeof o=="undefined"?0:o;s=typeof s=="undefined"?!0:s;var h=0;switch(o){case 0:h=Formula.YEARFRAC(n,i,o);break;case 1:h=Formula.YEARFRAC(n,i,o);break;case 2:h=Formula.YEARFRAC(n,i,o);break;case 3:h=Formula.YEARFRAC(n,i,o);break;case 4:h=Formula.YEARFRAC(n,i,o)}return f*u*h},Formula.ACCRINTM=function(){return},Formula.AMORDEGRC=function(){return},Formula.AMORLINC=function(){return},Formula.COUPDAYBS=function(){return},Formula.COUPDAYS=function(){return},Formula.COUPDAYSNC=function(){return},Formula.COUPNCD=function(){return},Formula.COUPNUM=function(){return},Formula.COUPPCD=function(){return},Formula.CUMIPMT=function(rate,periods,value,start,end,type){var payment,interest,i;if((rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)||start<1||end<1||start>end||type!==0&&type!==1)return"#NUM!";for(payment=Formula.PMT(rate,periods,value,0,type),interest=0,start===1&&type===0&&(interest=-value,start++),i=start;i<=end;i++)interest+=type===1?Formula.FV(rate,i-2,payment,value,1)-payment:Formula.FV(rate,i-1,payment,value,0);return interest*rate},Formula.CUMPRINC=function(rate,periods,value,start,end,type){var payment,principal,i;if((rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)||start<1||end<1||start>end||type!==0&&type!==1)return"#NUM!";for(payment=Formula.PMT(rate,periods,value,0,type),principal=0,start===1&&(principal=type===0?payment+value*rate:payment,start++),i=start;i<=end;i++)principal+=type>0?payment-(Formula.FV(rate,i-2,payment,value,1)-payment)*rate:payment-Formula.FV(rate,i-1,payment,value,0)*rate;return principal},Formula.DB=function(n,t,i,r,u){var s;if(u=typeof u=="undefined"?12:u,isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)||isNaN(u))return"#VALUE!";if(n<0||t<0||i<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(u)===-1||r>i)return"#NUM!";if(t>=n)return 0;var f=(1-Math.pow(t/n,1/i)).toFixed(3),h=n*f*u/12,e=h,o=0,c=r===i?i-1:r;for(s=2;s<=c;s++)o=(n-e)*f,e+=o;return r===1?h:r===i?(n-e)*f:o},Formula.DDB=function(n,t,i,r,u){var f,e,o;if(u=typeof u=="undefined"?2:u,isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)||isNaN(u))return"#VALUE!";if(n<0||t<0||i<0||r<0||u<=0||r>i)return"#NUM!";if(t>=n)return 0;for(f=0,e=0,o=1;o<=r;o++)e=Math.min((n-f)*(u/i),n-t-f),f+=e;return e},Formula.DISC=function(){return},Formula.DOLLARDE=function(n,t){var i,r;return isNaN(n)||isNaN(t)?"#VALUE!":t<0?"#NUM!":t>=0&&t<1?"#DIV/0!":(t=parseInt(t,10),i=parseInt(n,10),i+=n%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t,r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1),Math.round(i*r)/r)},Formula.DOLLARFR=function(n,t){if(isNaN(n)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(t>=0&&t<1)return"#DIV/0!";t=parseInt(t,10);var i=parseInt(n,10);return i+n%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},Formula.DURATION=function(){return},Formula.EFFECT=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<=0||t<1?"#NUM!":(t=parseInt(t,10),Math.pow(1+n/t,t)-1)},Formula.FV=function(rate,periods,payment,value,type){var result,term;return type=typeof type=="undefined"?0:type,rate=eval(rate),rate===0?result=value+payment*periods:(term=Math.pow(1+rate,periods),result=type===1?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate),-result},Formula.FVSCHEDULE=function(n,t){for(var r=n,i=0;i<t.length;i++){if(isNaN(t[i]))return"#VALUE!";r*=1+t[i]}return r},Formula.INTRATE=function(){return},Formula.IPMT=function(rate,period,periods,present,future,type){type=typeof type=="undefined"?0:type;rate=eval(rate);periods=eval(periods);var payment=Formula.PMT(rate,periods,present,future,type),interest;return interest=period===1?type===1?0:-present:type===1?Formula.FV(rate,period-2,payment,present,1)-payment:Formula.FV(rate,period-1,payment,present,0),interest*rate},Formula.IRR=function(n,t){var i;n=Formula.FLATTEN(n);var a=function(n,t,i){for(var f=i+1,u=n[0],r=1;r<n.length;r++)u+=n[r]/Math.pow(f,(t[r]-t[0])/365);return u},v=function(n,t,i){for(var u,e=i+1,f=0,r=1;r<n.length;r++)u=(t[r]-t[0])/365,f-=u*n[r]/Math.pow(e,u+1);return f},u=[],s=!1,h=!1;for(i=0;i<n.length;i++)u[i]=i===0?0:u[i-1]+365,n[i]>0&&(s=!0),n[i]<0&&(h=!0);if(!s||!h)return"#NUM!";t=typeof t=="undefined"?.1:t;var r=t,c=1e-10,f,l,e,y=0,o=!0;do e=a(n,u,r),f=r-e/v(n,u,r),l=Math.abs(f-r),r=f,o=l>c&&Math.abs(e)>c;while(o&&++y<50);return o?"#NUM!":r},Formula.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},Formula.MDURATION=function(){return},Formula.MIRR=function(n,t,i){for(var o,s,u=n.length,f=[],e=[],r=0;r<u;r++)n[r]<0?f.push(n[r]):e.push(n[r]);return o=-Formula.NPV(i,e)*Math.pow(1+i,u-1),s=Formula.NPV(t,f)*(1+t),Math.pow(o/s,1/(u-1))-1},Formula.NOMINAL=function(n,t){return isNaN(n)||isNaN(t)?"#VALUE!":n<=0||t<1?"#NUM!":(t=parseInt(t,10),(Math.pow(n+1,1/t)-1)*t)},Formula.NPER=function(rate,payment,present,future,type){type=typeof type=="undefined"?0:type;future=typeof future=="undefined"?0:future;rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},Formula.NPV=function(){for(var u,r,t,n=[],i=0;i<arguments.length;i++)n=n.concat(arguments[i]);for(u=n[0],r=0,t=1;t<n.length;t++)r+=n[t]/Math.pow(1+u,t);return r},Formula.ODDFPRICE=function(){return},Formula.ODDFYIELD=function(){return},Formula.ODDLPRICE=function(){return},Formula.ODDLYIELD=function(){return},Formula.PDURATION=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":n<=0?"#NUM!":(Math.log(i)-Math.log(t))/Math.log(1+n)},Formula.PMT=function(rate,periods,present,future,type){var result,term;return type=typeof type=="undefined"?0:type,rate=eval(rate),periods=eval(periods),rate===0?result=(present+future)/periods:(term=Math.pow(1+rate,periods),result=type===1?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)),-result},Formula.PPMT=function(n,t,i,r,u,f){return Formula.PMT(n,i,r,u,f)-Formula.IPMT(n,t,i,r,u,f)},Formula.PRICE=function(){return},Formula.PRICEDISC=function(){return},Formula.PRICEMAT=function(){return},Formula.PV=function(rate,periods,payment,future,type){return type=typeof type=="undefined"?0:type,rate=eval(rate),periods=eval(periods),rate===0?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},Formula.RATE=function(periods,payment,present,future,type,guess){guess=typeof guess=="undefined"?.01:guess;future=typeof future=="undefined"?0:future;type=typeof type=="undefined"?0:type;periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,Math.abs(rate)<epsMax?y=present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),y=present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},Formula.RECEIVED=function(){return},Formula.RRI=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":n===0||t===0?"#NUM!":Math.pow(i/t,1/n)-1},Formula.SLN=function(n,t,i){return isNaN(n)||isNaN(t)||isNaN(i)?"#VALUE!":i===0?"#NUM!":(n-t)/i},Formula.SYD=function(n,t,i,r){return isNaN(n)||isNaN(t)||isNaN(i)||isNaN(r)?"#VALUE!":i===0?"#NUM!":r<1||r>i?"#NUM!":(r=parseInt(r,10),(n-t)*(i-r+1)*2/(i*(i+1)))},Formula.TBILLEQ=function(n,t,i){return!r(n).isValid()||!r(t).isValid()?"#VALUE!":i<=0?"#NUM!":r(n).diff(r(t))>0?"#NUM!":r(t).diff(r(n),"years")>1?"#NUM!":365*i/(360-i*Formula.DAYS360(n,t))},Formula.TBILLPRICE=function(n,t,i){return!r(n).isValid()||!r(t).isValid()?"#VALUE!":i<=0?"#NUM!":r(n).diff(r(t))>0?"#NUM!":r(t).diff(r(n),"years")>1?"#NUM!":100*(1-i*Formula.DAYS360(n,t)/360)},Formula.TBILLYIELD=function(n,t,i){return!r(n).isValid()||!r(t).isValid()?"#VALUE!":i<=0?"#NUM!":r(n).diff(r(t))>0?"#NUM!":r(t).diff(r(n),"years")>1?"#NUM!":(100-i)*360/(i*Formula.DAYS360(n,t))},Formula.VDB=function(){return},Formula.XIRR=function(n,t,i){for(var v=function(n,t,i){for(var e=i+1,f=n[0],u=1;u<n.length;u++)f+=n[u]/Math.pow(e,r(t[u]).diff(r(t[0]),"days")/365);return f},y=function(n,t,i){for(var f,o=i+1,e=0,u=1;u<n.length;u++)f=r(t[u]).diff(r(t[0]),"days")/365,e-=f*n[u]/Math.pow(o,f+1);return e},h=!1,c=!1,f=0;f<n.length;f++)n[f]>0&&(h=!0),n[f]<0&&(c=!0);if(!h||!c)return"#NUM!";i=i||.1;var u=i,l=1e-10,e,a,o,p=0,s=!0;do o=v(n,t,u),e=u-o/y(n,t,u),a=Math.abs(e-u),u=e,s=a>l&&Math.abs(o)>l;while(s&&++p<50);return s?"#NUM!":u},Formula.XNPV=function(n,t,i){for(var f=0,u=0;u<t.length;u++)f+=t[u]/Math.pow(1+n,r(i[u]).diff(r(i[0]),"days")/365);return f},Formula.YIELD=function(){return},Formula.YIELDDISC=function(){return},Formula.YIELDMAT=function(){},Formula.ISNUMBER=function(n){return!isNaN(parseFloat(n))&&isFinite(n)?!0:!1},Formula.AND=function(){for(var t=!0,n=0;n<arguments.length;n++)arguments[n]||(t=!1);return t},Formula.FALSE=function(){return!1},Formula.SWITCH=function(){var t,n;if(arguments.length>0){var e=arguments[0],i=arguments.length-1,r=Math.floor(i/2),u=!1,f=i%2==0?null:arguments[arguments.length-1];if(r)for(n=0;n<r;n++)if(e===arguments[n*2+1]){t=arguments[n*2+2];u=!0;break}!u&&f&&(t=f)}return t},Formula.IF=function(n,t,i){return n?t:i},Formula.IFNA=function(n,t){return n==="#N/A"?t:n},Formula.NOT=function(n){return!n},Formula.OR=function(){for(var t=!1,n=0;n<arguments.length;n++)arguments[n]&&(t=!0);return t},Formula.TRUE=function(){return!0},Formula.XOR=function(){for(var t=0,n=0;n<arguments.length;n++)arguments[n]&&t++;return Math.floor(Math.abs(t))&1?!0:!1},Formula.REFERENCE=function(n,t){try{var r=t.split("."),i=n;return _(r).forEach(function(n){if(n[n.length-1]==="]"){var t=n.indexOf("["),r=n.substring(t+1,n.length-1);i=i[n.substring(0,t)][r]}else i=i[n]}),i}catch(u){return}},Formula.ABS=function(n){return Math.abs(n)},Formula.ACOS=function(n){return Math.acos(n)},Formula.ACOSH=function(n){return Math.log(n+Math.sqrt(n*n-1))},Formula.ACOT=function(n){return Math.atan(1/n)},Formula.ACOTH=function(n){return.5*Math.log((n+1)/(n-1))},Formula.AGGREGATE=function(n){for(var i=[],t=2;t<arguments.length;t++)switch(n){case 1:i[t-2]=Formula.AVERAGE(arguments[t]);break;case 2:i[t-2]=Formula.COUNT(arguments[t]);break;case 3:i[t-2]=Formula.COUNTA(arguments[t]);break;case 4:i[t-2]=Formula.MAX(arguments[t]);break;case 5:i[t-2]=Formula.MIN(arguments[t]);break;case 6:i[t-2]=Formula.PRODUCT(arguments[t]);break;case 7:i[t-2]=Formula.STDEVS(arguments[t]);break;case 8:i[t-2]=Formula.STDEVP(arguments[t]);break;case 9:i[t-2]=Formula.SUM(arguments[t]);break;case 10:i[t-2]=Formula.VARS(arguments[t]);break;case 11:i[t-2]=Formula.VARP(arguments[t]);break;case 12:i[t-2]=Formula.MEDIAN(arguments[t]);break;case 13:i[t-2]=Formula.MODESNGL(arguments[t]);break;case 14:i[t-2]=Formula.LARGE(arguments[t]);break;case 15:i[t-2]=Formula.SMALL(arguments[t]);break;case 16:i[t-2]=Formula.PERCENTILEINC(arguments[t]);break;case 17:i[t-2]=Formula.QUARTILEINC(arguments[t]);break;case 18:i[t-2]=Formula.PERCENTILEEXC(arguments[t]);break;case 19:i[t-2]=Formula.QUARTILEEXC(arguments[t])}return i},Formula.ARABIC=function(n){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))throw new Error("Incorrect roman number");var t=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(n){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[n]}),t},Formula.ASIN=function(n){return Math.asin(n)},Formula.ASINH=function(n){return Math.log(n+Math.sqrt(n*n+1))},Formula.ATAN=function(n){return Math.atan(n)},Formula.ATAN2=function(n,t){return Math.atan2(n,t)},Formula.ATANH=function(n){return Math.log((1+n)/(1-n))/2},Formula.BASE=function(n,t,i){i=typeof i=="undefined"?0:i;var r=n.toString(t);return new Array(Math.max(i+1-r.length,0)).join("0")+r},Formula.CEILING=function(n,t,i){if(t===0)return 0;t=typeof t=="undefined"?1:Math.abs(t);i=typeof i=="undefined"?0:i;var r=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.ceil(n/t)*t,r):i===0?-Formula.ROUND(Math.floor(Math.abs(n)/t)*t,r):-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,r)},Formula.CEILINGMATH=Formula.CEILING,Formula.CEILINGPRECISE=Formula.CEILING,Formula.COMBIN=function(n,t){return Formula.FACT(n)/(Formula.FACT(t)*Formula.FACT(n-t))},Formula.COMBINA=function(n,t){return n===0&&t===0?1:Formula.COMBIN(n+t-1,n-1)},Formula.COS=Math.cos,Formula.COSH=function(n){return(Math.exp(n)+Math.exp(-n))/2},Formula.COT=function(n){return 1/Math.tan(n)},Formula.COTH=function(n){var t=Math.exp(2*n);return(t+1)/(t-1)},Formula.CSC=function(n){return 1/Math.sin(n)},Formula.CSCH=function(n){return 2/(Math.exp(n)-Math.exp(-n))},Formula.DECIMAL=function(n,t){return parseInt(n,t)},Formula.DEGREES=function(n){return n*180/Math.PI},Formula.EVEN=function(n){return Formula.CEILING(n,-2,-1)},Formula.EXP=Math.exp,Formula.FACT=function(n){var t=Math.floor(n);return t===0||t===1?1:e[t]>0?e[t]:(e[t]=Formula.FACT(t-1)*t,e[t])},Formula.FACTDOUBLE=function(n){var t=Math.floor(n);return t<=0?1:t*Formula.FACTDOUBLE(t-2)},Formula.FLOOR=function(n,t,i){if(t===0)return 0;t=t?Math.abs(t):1;var r=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.floor(n/t)*t,r):i===0||typeof i=="undefined"?-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,r):-Formula.ROUND(Math.floor(Math.abs(n)/t)*t,r)},Formula.FLOORMATH=Formula.FLOOR,Formula.FLOORPRECISE=function(n,t){if(t===0)return 0;t=t?Math.abs(t):1;var i=-Math.floor(Math.log(t)/Math.log(10));return n>=0?Formula.ROUND(Math.round(n/t)*t,i):-Formula.ROUND(Math.ceil(Math.abs(n)/t)*t,i)},Formula.GCD=function(){for(var r,t,i=arguments.length-1,n=arguments[i];i;)for(t=arguments[--i];r=t%n;t=n,n=r);return n},Formula.INT=function(n){return Math.floor(n)},Formula.ISEVEN=function(n){return Math.floor(Math.abs(n))&1?!1:!0},Formula.ISOCEILING=Formula.CEILING,Formula.ISODD=function(n){return Math.floor(Math.abs(n))&1?!0:!1},Formula.LCM=function(){for(var r=Formula.ARGSTOARRAY(arguments),n,u,t,i,f=1;(t=r.pop())!==undefined;)while(t>1){if(t%2){for(n=3,u=Math.floor(Math.sqrt(t));n<=u&&t%n;n+=2);i=n<=u?n:t}else i=2;for(t/=i,f*=i,n=r.length;n;r[--n]%i==0&&(r[n]/=i)==1&&r.splice(n,1));}return f},Formula.LN=function(n){return Math.log(n)},Formula.LOG=function(n,t){return t=typeof t=="undefined"?10:t,Math.log(n)/Math.log(t)},Formula.LOG10=function(n){return Math.log(n)/Math.log(10)},Formula.MDETERM=n.det,Formula.MINVERSE=n.inv,Formula.MMULT=n.dot,Formula.MOD=function(n,t){var i=Math.abs(n%t);return t>0?i:-i},Formula.MROUND=function(n,t){if(n*t<0)throw new Error("Number and multiple must have the same sign.");return Math.round(n/t)*t},Formula.MULTINOMIAL=function(){for(var t=0,i=1,n=0;n<arguments.length;n++)t+=arguments[n],i*=Formula.FACT(arguments[n]);return Formula.FACT(t)/i},Formula.MUNIT=n.identity,Formula.ODD=function(n){var t=Math.ceil(Math.abs(n));return t=t&1?t:t+1,n>0?t:-t},Formula.E=function(){return Math.E},Formula.PI=function(){return Math.PI},Formula.POWER=function(n,t){var i=Math.pow(n,t);return isNaN(i)?"#NUM!":i},Formula.PRODUCT=function(){for(var t=1,n=0;n<arguments.length;n++)t*=arguments[n];return t},Formula.QUOTIENT=function(n,t){return(n/t).toFixed(0)},Formula.RADIANS=function(n){return n*Math.PI/180},Formula.RAND=function(){return Math.random()},Formula.RANDBETWEEN=function(n,t){return n+Math.ceil((t-n+1)*Math.random())-1},Formula.ROUND=function(n,t){return Math.round(n*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDDOWN=function(n,t){var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.ROUNDUP=function(n,t){var i=n>0?1:-1;return i*Math.ceil(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.SERIESSUM=function(n,t,i,r){for(var f=r[0]*Math.pow(n,t),u=1;u<r.length;u++)f+=r[u]*Math.pow(n,t+u*i);return f},Formula.SEC=function(n){return 1/Math.cos(n)},Formula.SECH=function(n){return 2/(Math.exp(n)+Math.exp(-n))},Formula.SIGN=function(n){return n<0?-1:n===0?0:1},Formula.SIN=Math.sin,Formula.SINH=function(n){return(Math.exp(n)-Math.exp(-n))/2},Formula.SQRT=Math.sqrt,Formula.SQRTPI=function(n){return Math.sqrt(n*Math.PI)},Formula.SUBTOTAL=function(n){for(var i=[],t=1;t<arguments.length;t++)switch(n){case 1:i[t-1]=Formula.AVERAGE(arguments[t]);break;case 2:i[t-1]=Formula.COUNT(arguments[t]);break;case 3:i[t-1]=Formula.COUNTA(arguments[t]);break;case 4:i[t-1]=Formula.MAX(arguments[t]);break;case 5:i[t-1]=Formula.MIN(arguments[t]);break;case 6:i[t-1]=Formula.PRODUCT(arguments[t]);break;case 7:i[t-1]=Formula.STDEV(arguments[t]);break;case 8:i[t-1]=Formula.STDEVP(arguments[t]);break;case 9:i[t-1]=Formula.SUM(arguments[t]);break;case 10:i[t-1]=Formula.VAR(arguments[t]);break;case 11:i[t-1]=Formula.VARP(arguments[t])}return i},Formula.SUM=function(){for(var i,t=Formula.FLATTEN(arguments),r=0,n=0;n<t.length;n++)if(t[n]instanceof Array)for(i=0;i<t[n].length;i++)r+=Formula.ISNUMBER(t[n][i])?t[n][i]:0;else r+=Formula.ISNUMBER(t[n])?t[n]:0;return r},Formula.SUMIF=function(range,criteria){var result,i;for(range=Formula.FLATTEN(range),result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},Formula.SUMIFS=function(){for(var fit,j,criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},Formula.SUMPRODUCT=function(){for(var t,r,i,f=arguments.length+1,u=0,n=0;n<arguments[0].length;n++)for(t=0;t<arguments[0][n].length;t++){for(r=1,i=1;i<f;i++)r*=arguments[i-1][n][t];u+=r}return u},Formula.SUMSQ=function(){for(var t=Formula.FLATTEN(arguments),i=0,n=0;n<t.length;n++)i+=Formula.ISNUMBER(t[n])?t[n]*t[n]:0;return i},Formula.SUMX2MY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=n[i]*n[i]-t[i]*t[i];return r},Formula.SUMX2PY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=n[i]*n[i]+t[i]*t[i];return r},Formula.SUMXMY2=function(n,t){var r=0,i;for(n=Formula.FLATTEN(n),t=Formula.FLATTEN(t),i=0;i<n.length;i++)r+=Math.pow(n[i]-t[i],2);return r},Formula.TAN=function(n){return Math.tan(n)},Formula.TANH=function(n){var t=Math.exp(2*n);return(t-1)/(t+1)},Formula.TRUNC=function(n,t){t=typeof t=="undefined"?0:t;var i=n>0?1:-1;return i*Math.floor(Math.abs(n)*Math.pow(10,t))/Math.pow(10,t)},Formula.AVEDEV=function(){var n=Formula.FLATTEN(arguments);return i.sum(i(n).subtract(i.mean(n)).abs()[0])/n.length},Formula.AVERAGE=function(){for(var t=Formula.NUMBERS(Formula.FLATTEN(arguments)),u=t.length,i=0,r=0,n=0;n<u;n++)i+=t[n],r+=1;return i/r},Formula.AVERAGEA=function(){for(var n,r=Formula.FLATTEN(arguments),f=r.length,t=0,u=0,i=0;i<f;i++)n=r[i],typeof n=="number"&&(t+=n),n===!0&&t++,n!==null&&u++;return t/u},Formula.AVERAGEIF=function(range,criteria,average_range){var average_count,result,i;for(average_range=average_range||range,range=Formula.FLATTEN(range),average_range=Formula.FLATTEN(average_range),average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},Formula.AVERAGEIFS=function(){for(var condition,j,average,args=Formula.ARGSTOARRAY(arguments),criteria=(args.length-1)/2,range=Formula.FLATTEN(args[0]),count=0,result=0,i=0;i<range.length;i++){for(condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}return average=result/count,isNaN(average)?0:average},Formula.BETADIST=function(n,t,r,u,f,e){return f=typeof f=="undefined"?0:f,e=typeof e=="undefined"?1:e,n=(n-f)/(e-f),u?i.beta.cdf(n,t,r):i.beta.pdf(n,t,r)},Formula.BETAINV=function(n,t,r,u,f){return u=typeof u=="undefined"?0:u,f=typeof f=="undefined"?1:f,i.beta.inv(n,t,r)*(f-u)+u},Formula.BINOMDIST=function(n,t,r,u){return u?i.binomial.cdf(n,t,r):i.binomial.pdf(n,t,r)},Formula.BINOMDISTRANGE=function(n,t,i,r){var f,u;for(r=typeof r=="undefined"?i:r,f=0,u=i;u<=r;u++)f+=Formula.COMBIN(n,u)*Math.pow(t,u)*Math.pow(1-t,n-u);return f},Formula.BINOMINV=function(n,t,r){for(var u=0;u<=n;){if(i.binomial.cdf(u,n,t)>=r)return u;u++}},Formula.CHISQDIST=function(n,t,r){return r?i.chisquare.cdf(n,t):i.chisquare.pdf(n,t)},Formula.CHISQDISTRT=function(){return},Formula.CHISQINV=function(n,t){return i.chisquare.inv(n,t)},Formula.CHISQINVRT=function(){return},Formula.CHISQTEST=function(){return},Formula.CONFIDENCENORM=function(n,t,r){return i.normalci(1,n,t,r)[1]-1},Formula.CONFIDENCET=function(n,t,r){return i.tci(1,n,t,r)[1]-1},Formula.CORREL=function(){return i.corrcoeff.apply(this,arguments)},Formula.COUNT=function(){var n=Formula.NUMBERS(Formula.FLATTEN(arguments));return n.length},Formula.COUNTA=function(){var n=Formula.FLATTEN(arguments);return n.length-Formula.COUNTBLANK(n)},Formula.COUNTBLANK=function(){for(var i=Formula.FLATTEN(arguments),r=0,n,t=0;t<i.length;t++)n=i[t],n!==null&&n!==""&&n||r++;return r},Formula.COUNTIF=function(n,t){var r,i;for(n=Formula.FLATTEN(n),r=0,i=0;i<n.length;i++)n[i].match(new RegExp(t))&&r++;return r},Formula.COUNTIFS=function(){for(var fit,j,criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},Formula.COUNTUNIQUE=function(){return _.uniq(Formula.FLATTEN(arguments)).length},Formula.COVARIANCEP=function(n,t){var r;n=Formula.FLATTEN(n);t=Formula.FLATTEN(t);var e=i.mean(n),o=i.mean(t),u=0,f=n.length;for(r=0;r<f;r++)u+=(n[r]-e)*(t[r]-o);return u/f},Formula.COVARIANCES=function(){return i.covariance.apply(this,l(arguments))},Formula.DEVSQ=function(){for(var n=Formula.ARGSCONCAT(arguments),u=i.mean(n),r=0,t=0;t<n.length;t++)r+=Math.pow(n[t]-u,2);return r},Formula.EXPONDIST=function(n,t,r){return r?i.exponential.cdf(n,t):i.exponential.pdf(n,t)},Formula.FDIST=function(n,t,r,u){return u?i.centralF.cdf(n,t,r):i.centralF.pdf(n,t,r)},Formula.FDISTRT=function(){return},Formula.FINV=function(n,t,r){return n<=0||n>1?"#NUM!":i.centralF.inv(1-n,t,r)},Formula.FINVRT=function(){return},Formula.FTEST=function(){return},Formula.FISHER=function(n){return Math.log((1+n)/(1-n))/2},Formula.FISHERINV=function(n){var t=Math.exp(2*n);return(t-1)/(t+1)},Formula.FORECAST=function(n,t,r){var u,e,c;r=Formula.FLATTEN(r);t=Formula.FLATTEN(t);var f=i.mean(r),o=i.mean(t),l=r.length,s=0,h=0;for(u=0;u<l;u++)s+=(r[u]-f)*(t[u]-o),h+=Math.pow(r[u]-f,2);return e=s/h,c=o-e*f,c+e*n},Formula.FREQUENCY=function(n,t){for(var r,e=n.length,u=t.length,f=[],i=0;i<=u;i++)for(f[i]=0,r=0;r<e;r++)i===0?n[r]<=t[0]&&(f[0]+=1):i<u?n[r]>t[i-1]&&n[r]<=t[i]&&(f[i]+=1):i===u&&n[r]>t[u-1]&&(f[u]+=1);return f},Formula.GAMMA=function(){return i.gammafn.apply(this,arguments)},Formula.GAMMADIST=function(){return},Formula.GAMMAINV=function(){return},Formula.GAMMALN=function(){return i.gammaln.apply(this,arguments)},Formula.GAMMALNPRECISE=function(){return},Formula.GAUSS=function(n){return i.normal.cdf(n,0,1)-.5},Formula.GEOMEAN=function(){return i.geomean(Formula.ARGSCONCAT(arguments))},Formula.GROWTH=function(n,t,i,r){var u,o,a,l,v,y;if(typeof t=="undefined")for(t=[],u=1;u<=n.length;u++)t.push(u);if(typeof i=="undefined")for(i=[],u=1;u<=n.length;u++)i.push(u);typeof r=="undefined"&&(r=!0);var e=n.length,f=0,s=0,h=0,c=0;for(u=0;u<e;u++)o=t[u],a=Math.log(n[u]),f+=o,s+=a,h+=o*a,c+=o*o;for(f/=e,s/=e,h/=e,c/=e,r?(l=(h-f*s)/(c-f*f),v=s-l*f):(l=h/c,v=0),y=[],u=0;u<i.length;u++)y.push(Math.exp(v+l*i[u]));return y},Formula.HARMEAN=function(){for(var t=Formula.ARGSCONCAT(arguments),i=t.length,r=0,n=0;n<i;n++)r+=1/t[n];return i/r},Formula.HYPGEOMDIST=function(n,t,i,r,u){function f(n,t,i,r){return Formula.COMBIN(i,n)*Formula.COMBIN(r-i,t-n)/Formula.COMBIN(r,t)}function e(n,t,i,r){for(var e=0,u=0;u<=n;u++)e+=f(u,t,i,r);return e}return u?e(n,t,i,r):f(n,t,i,r)},Formula.INTERCEPT=function(n,t){return Formula.FORECAST(0,n,t)},Formula.KURT=function(){for(var t=Formula.ARGSCONCAT(arguments),f=i.mean(t),n=t.length,r=0,u=0;u<n;u++)r+=Math.pow(t[u]-f,4);return r=r/Math.pow(i.stdev(t,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},Formula.LARGE=function(n,t){return n.sort(function(n,t){return t-n})[t-1]},Formula.LINEST=function(n,t){for(var f,h,u=i.mean(t),e=i.mean(n),c=t.length,o=0,s=0,r=0;r<c;r++)o+=(t[r]-u)*(n[r]-e),s+=Math.pow(t[r]-u,2);return f=o/s,h=e-f*u,[f,h]},Formula.LOGEST=function(){return},Formula.LOGNORMDIST=function(n,t,r,u){return u?i.lognormal.cdf(n,t,r):i.lognormal.pdf(n,t,r)},Formula.LOGNORMINV=function(n,t,r){return i.lognormal.inv(n,t,r)},Formula.MAX=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,i=r>0?n[0]:0,t=0;t<r;t++)i=n[t]>i&&n[t]!==!0&&n[t]!==!1?n[t]:i;return i},Formula.MAXA=function(){var n=Formula.FLATTEN(arguments);return n.length>0?Math.max.apply(Math,n):0},Formula.MEDIAN=function(){return i.median(Formula.FLATTEN(arguments))},Formula.MIN=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,i=r>0?n[0]:0,t=0;t<r;t++)i=n[t]<i&&n[t]!==!0&&n[t]!==!1?n[t]:i;return i},Formula.MINA=function(){var n=Formula.FLATTEN(arguments);return n.length>0?Math.min.apply(Math,n):0},Formula.MODEMULT=function(){for(var f=Formula.ARGSCONCAT(arguments),e=f.length,t={},i=[],r=0,n,u=0;u<e;u++)n=f[u],t[n]=t[n]?t[n]+1:1,t[n]>r&&(r=t[n],i=[]),t[n]===r&&(i[i.length]=n);return i},Formula.MODESNGL=function(){return Formula.MODEMULT(Formula.ARGSCONCAT(arguments)).sort(function(n,t){return n-t})[0]},Formula.NEGBINOMDIST=function(n,t,r,u){return u?i.negbin.cdf(n,t,r):i.negbin.pdf(n,t,r)},Formula.NORMDIST=function(n,t,r,u){return isNaN(n)||isNaN(t)||isNaN(r)?"#VALUE!":r<=0?"#NUM!":u?i.normal.cdf(n,t,r):i.normal.pdf(n,t,r)},Formula.NORMINV=function(n,t,r){return i.normal.inv(n,t,r)},Formula.NORMSDIST=function(n,t){return t?i.normal.cdf(n,0,1):i.normal.pdf(n,0,1)},Formula.NORMSINV=function(n){return i.normal.inv(n,0,1)},Formula.PEARSON=function(n,t){for(var u=i.mean(n),f=i.mean(t),h=n.length,e=0,o=0,s=0,r=0;r<h;r++)e+=(n[r]-u)*(t[r]-f),o+=Math.pow(n[r]-u,2),s+=Math.pow(t[r]-f,2);return e/Math.sqrt(o*s)},Formula.PERCENTILEEXC=function(n,t){var u,r,i;return(n=n.sort(function(n,t){return n-t}),u=n.length,t<1/(u+1)||t>1-1/(u+1))?"#NUM!":(r=t*(u+1)-1,i=Math.floor(r),Formula.CLEANFLOAT(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i])))},Formula.PERCENTILEINC=function(n,t){n=n.sort(function(n,t){return n-t});var u=n.length,r=t*(u-1),i=Math.floor(r);return Formula.CLEANFLOAT(r===i?n[r]:n[i]+(r-i)*(n[i+1]-n[i]))},Formula.PERCENTRANKEXC=function(n,t,i){n=n.sort(function(n,t){return n-t});var u=_.uniq(n),o=n.length,s=u.length;i=typeof i=="undefined"?3:i;for(var h=Math.pow(10,i),f=0,e=!1,r=0;!e&&r<s;)t===u[r]?(f=(n.indexOf(u[r])+1)/(o+1),e=!0):t>=u[r]&&(t<u[r+1]||r===s-1)&&(f=(n.indexOf(u[r])+1+(t-u[r])/(u[r+1]-u[r]))/(o+1),e=!0),r++;return Math.floor(f*h)/h},Formula.PERCENTRANKINC=function(n,t,i){n=n.sort(function(n,t){return n-t});var u=_.uniq(n),o=n.length,s=u.length;i=typeof i=="undefined"?3:i;for(var h=Math.pow(10,i),f=0,e=!1,r=0;!e&&r<s;)t===u[r]?(f=n.indexOf(u[r])/(o-1),e=!0):t>=u[r]&&(t<u[r+1]||r===s-1)&&(f=(n.indexOf(u[r])+(t-u[r])/(u[r+1]-u[r]))/(o-1),e=!0),r++;return Math.floor(f*h)/h},Formula.PERMUT=function(n,t){return Formula.FACT(n)/Formula.FACT(n-t)},Formula.PERMUTATIONA=function(n,t){return Math.pow(n,t)},Formula.PHI=function(n){return Math.exp(-.5*n*n)/s},Formula.POISSONDIST=function(n,t,r){return r?i.poisson.cdf(n,t):i.poisson.pdf(n,t)},Formula.PROB=function(n,t,i,r){var u;if(typeof i=="undefined")return 0;if(r=typeof r=="undefined"?i:r,i===r)return n.indexOf(i)>=0?t[n.indexOf(i)]:0;var f=n.sort(function(n,t){return n-t}),o=f.length,e=0;for(u=0;u<o;u++)f[u]>=i&&f[u]<=r&&(e+=t[n.indexOf(f[u])]);return e},Formula.QUARTILEEXC=function(n,t){switch(t){case 1:return Formula.PERCENTILEEXC(n,.25);case 2:return Formula.PERCENTILEEXC(n,.5);case 3:return Formula.PERCENTILEEXC(n,.75);default:return"#NUM!"}},Formula.QUARTILEINC=function(n,t){switch(t){case 1:return Formula.PERCENTILEINC(n,.25);case 2:return Formula.PERCENTILEINC(n,.5);case 3:return Formula.PERCENTILEINC(n,.75);default:return"#NUM!"}},Formula.RANKAVG=function(n,t,i){var u,r;return i=typeof i=="undefined"?!1:i,u=i?function(n,t){return n-t}:function(n,t){return t-n},t=t.sort(u),r=Formula.COUNTIN(t,n),r>1?(2*t.indexOf(n)+r+1)/2:t.indexOf(n)+1},Formula.RANKEQ=function(n,t,i){i=typeof i=="undefined"?!1:i;var r=i?function(n,t){return n-t}:function(n,t){return t-n};return t=t.sort(r),t.indexOf(n)+1},Formula.RSQ=function(n,t){return Math.pow(Formula.PEARSON(n,t),2)},Formula.SKEW=function(){for(var n=Formula.ARGSCONCAT(arguments),f=i.mean(n),t=n.length,u=0,r=0;r<t;r++)u+=Math.pow(n[r]-f,3);return t*u/((t-1)*(t-2)*Math.pow(i.stdev(n,!0),3))},Formula.SKEWP=function(){for(var n=Formula.ARGSCONCAT(arguments),e=i.mean(n),f=n.length,t=0,r=0,u=0;u<f;u++)r+=Math.pow(n[u]-e,3),t+=Math.pow(n[u]-e,2);return r=r/f,t=t/f,r/Math.pow(t,3/2)},Formula.SLOPE=function(n,t){for(var u=i.mean(t),o=i.mean(n),s=t.length,f=0,e=0,r=0;r<s;r++)f+=(t[r]-u)*(n[r]-o),e+=Math.pow(t[r]-u,2);return f/e},Formula.SMALL=function(n,t){return n.sort(function(n,t){return n-t})[t-1]},Formula.STANDARDIZE=function(n,t,i){return(n-t)/i},Formula.STDEVA=function(){for(var n=Formula.FLATTEN(arguments),r=n.length,u=0,f=i.mean(n),t=0;t<r;t++)u+=Math.pow(n[t]-f,2);return Math.sqrt(u/(r-1))},Formula.STDEVP=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return Math.sqrt(i/r)},Formula.STDEVPA=function(){for(var n=Formula.ARGSCONCAT(arguments),r=n.length,u=0,f=i.mean(n),t=0;t<r;t++)u+=Math.pow(n[t]-f,2);return Math.sqrt(u/r)},Formula.STDEVS=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return Math.sqrt(i/(r-1))},Formula.STEYX=function(n,t){for(var f=i.mean(t),e=i.mean(n),o=t.length,s=0,u=0,h=0,r=0;r<o;r++)s+=Math.pow(n[r]-e,2),u+=(t[r]-f)*(n[r]-e),h+=Math.pow(t[r]-f,2);return Math.sqrt((s-u*u/h)/(o-2))},Formula.TDIST=function(n,t,r){return r?i.studentt.cdf(n,t):i.studentt.pdf(n,t)},Formula.TDIST2T=function(){return},Formula.TDISTRT=function(){return},Formula.TINV=function(n,t){return i.studentt.inv(n,t)},Formula.TINV2T=function(){return},Formula.TTEST=function(){return},Formula.TREND=function(){return},Formula.TRIMMEAN=function(n,t){n=Formula.FLATTEN(n);var r=Formula.FLOOR(n.length*t,2)/2;return i.mean(_.initial(_.rest(n.sort(function(n,t){return n-t}),r),r))},Formula.VARA=function(){for(var n,t=Formula.FLATTEN(arguments),e=t.length,u=0,f=0,i=Formula.AVERAGEA(t),r=0;r<e;r++)n=t[r],u+=typeof n=="number"?Math.pow(n-i,2):n===!0?Math.pow(1-i,2):Math.pow(0-i,2),n!==null&&f++;return u/(f-1)},Formula.VARP=function(){for(var n=Formula.NUMBERS(Formula.FLATTEN(arguments)),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)i+=Math.pow(n[t]-f,2),r++;return i/r},Formula.VARPA=function(){for(var n,t=Formula.FLATTEN(arguments),e=t.length,u=0,f=0,i=Formula.AVERAGEA(t),r=0;r<e;r++)n=t[r],u+=typeof n=="number"?Math.pow(n-i,2):n===!0?Math.pow(1-i,2):Math.pow(0-i,2),n!==null&&f++;return u/f},Formula.VARS=function(){for(var n=Formula.FLATTEN(arguments),u=n.length,i=0,r=0,f=Formula.AVERAGE(n),t=0;t<u;t++)n[t]!==!0&&n[t]!==!1&&(i+=Math.pow(n[t]-f,2),r++);return i/(r-1)},Formula.WEIBULLDIST=function(n,t,i,r){return r?1-Math.exp(-Math.pow(n/i,t)):Math.pow(n,t-1)*Math.exp(-Math.pow(n/i,t))*t/Math.pow(i,t)},Formula.ZTEST=function(n,t,i){var r=n.length,u=typeof i=="undefined"?Formula.STDEVS(n):i;return 1-Formula.NORMSDIST((Formula.AVERAGE(n)-t)/(u/Math.sqrt(r)),Formula.TRUE)},Formula.CHAR=function(n){return String.fromCharCode(n)},Formula.CLEAN=function(n){return n.replace(/[\0-\x1F]/g,"")},Formula.CODE=function(n){return n.charCodeAt(0)},Formula.CONCATENATE=function(){for(var t="",n=0;n<arguments.length;n++)arguments[n]!==null&&arguments[n]!==undefined&&(t+=arguments[n]);return t},Formula.DOLLAR=function(n,i){i=typeof i=="undefined"?2:i;var r="";return i<=0?(n=Math.round(n*Math.pow(10,i))/Math.pow(10,i),r="($0,0)"):i>0&&(r="($0,0."+new Array(i+1).join("0")+")"),t(n).format(r)},Formula.EXACT=function(n,t){return n===t},Formula.FIND=function(n,t,i){return i=typeof i=="undefined"?0:i,t?t.indexOf(n,i-1)+1:null},Formula.FIXED=function(n,i,r){i=typeof i=="undefined"?2:i;r=typeof r=="undefined"?!1:r;var u=r?"0":"0,0";return i<=0?n=Math.round(n*Math.pow(10,i))/Math.pow(10,i):i>0&&(u+="."+new Array(i+1).join("0")),t(n).format(u)},Formula.HTML2TEXT=function(n){var t="";return n&&(n instanceof Array?n.forEach(function(n){t!==""&&(t+="\n");t+=n.replace(/<(?:.|\n)*?>/gm,"")}):t=n.replace(/<(?:.|\n)*?>/gm,"")),t},Formula.HUMANIZE=function(n){if(n instanceof Date){var t=r(n);return t.hours()||t.minutes()||t.seconds()?t.format("dddd, MMMM Do YYYY, h:mm:ss"):t.format("dddd, MMMM Do YYYY")}return n},Formula.JOIN=function(n,t){return n.join(t)},Formula.LEFT=function(n,t){return t=typeof t=="undefined"?1:t,n?n.substring(0,t):null},Formula.LEN=function(n){return n?n.length:0},Formula.LOWER=function(n){return n?n.toLowerCase():n},Formula.MID=function(n,t,i){return n.substring(t-1,i)},Formula.NUMBERVALUE=function(n,t,i){return t=typeof t=="undefined"?".":t,i=typeof i=="undefined"?",":i,Number(n.replace(t,".").replace(i,""))},Formula.NUMBERS=function(){var n=Formula.FLATTEN(arguments);return n.filter(function(n){return typeof n=="number"})},Formula.PROPER=function(n){if(n)return n.replace(/\w\S*/g,function(n){return n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()})},Formula.REGEXEXTRACT=function(n,t){var i=n.match(new RegExp(t));return i?i[i.length>1?i.length-1:0]:null},Formula.REGEXMATCH=function(n,t,i){var r=n.match(new RegExp(t));return i?r:!!r},Formula.REGEXREPLACE=function(n,t,i){return n.replace(new RegExp(t),i)},Formula.REPLACE=function(n,t,i,r){return n.substr(0,t-1)+r+n.substr(t-1+i)},Formula.REPT=function(n,t){return new Array(t+1).join(n)},Formula.RIGHT=function(n,t){return t=typeof t=="undefined"?1:t,n?n.substring(n.length-t):null},Formula.ROMAN=function(n){for(var i=String(n).split(""),u=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],t="",r=3;r--;)t=(u[+i.pop()+r*10]||"")+t;return new Array(+i.join("")+1).join("M")+t},Formula.SEARCH=function(n,t,i){return i=typeof i=="undefined"?0:i,t.toLowerCase().indexOf(n.toLowerCase(),i-1)+1},Formula.SPLIT=function(n,t){return u.words(n,t)},Formula.SUBSTITUTE=function(n,t,i,r){if(n&&t&&i){if(typeof r=="undefined")return n.replace(new RegExp(t,"g"),i);for(var u=0,f=0;n.indexOf(t,u)>0;)if(u=n.indexOf(t,u+1),f++,f===r)return n.substring(0,u)+i+n.substring(u+t.length)}else return n},Formula.T=function(n){return typeof n=="string"?n:null},Formula.TEXT=function(n,i){if(!n)return"";if(n instanceof Object)try{return JSON.stringify(n)}catch(u){return""}return typeof n=="string"?i?i.indexOf("0")>=0?t(n).format(i):r(new Date(n)).format(i):n:n.toString&&typeof n.toString=="function"?n.toString():""},Formula.TRIM=function(n){return u.clean(n)},Formula.UNICHAR=Formula.CHAR,Formula.UNICODE=Formula.CODE,Formula.UPPER=function(n){return n.toUpperCase()},Formula.VALUE=function(n){return t().unformat(n)},Formula.MD5=function(n,t,i){return f(n,t,i)},Formula.NUMERAL=function(n,i){return t(n).format(i)},Formula.ISERR=function(n){return["#DIV/0!","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(n)>=0?!0:!1},Formula.ISERROR=function(n){return Formula.ISERR(n)||n==="#N/A"},Formula.IFERROR=function(n,t){return Formula.ISERROR(n)?t:n},Formula}var n=this,Formula=n.Formula={},i=n._,r=n.numeric,u=n.numeral,f=n.jStat,e=n.moment,o=i,s=n.md5,h=i.str;if(typeof exports!="undefined")module.exports=t(require("numeric"),require("numeral"),require("jStat"),require("moment"),require("lodash"),require("underscore.string"),require("blueimp-md5"));else if(typeof define=="function"&&define.amd)define("formula",["numeric","numeral","jstat","moment","lodash","underscore.string","md5"],t);else return Formula=t(r,u,f,e,o,h,s)}).call(this);