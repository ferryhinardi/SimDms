(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("vbscript",function(n,t){function i(n){return new RegExp("^(("+n.join(")|(")+"))\\b","i")}function l(n,t){t.currentIndent++}function e(n,t){t.currentIndent--}function o(n,t){var u,r,i;if(n.eatSpace())return"space";if((u=n.peek(),u==="'")||n.match(et))return n.skipToEnd(),"comment";if(n.match(/^((&H)|(&O))?[0-9\.]/i,!1)&&!n.match(/^((&H)|(&O))?[0-9\.]+[a-z_]/i,!1)){if(r=!1,n.match(/^\d*\.\d+/i)?r=!0:n.match(/^\d+\.\d*/)?r=!0:n.match(/^\.\d+/)&&(r=!0),r)return n.eat(/J/i),"number";if(i=!1,n.match(/^&H[0-9a-f]+/i)?i=!0:n.match(/^&O[0-7]+/i)?i=!0:n.match(/^[1-9]\d*F?/)?(n.eat(/J/i),i=!0):n.match(/^0(?![\dx])/i)&&(i=!0),i)return n.eat(/L/i),"number"}return n.match(it)?(t.tokenize=ot(n.current()),t.tokenize(n,t)):n.match(v)||n.match(a)||n.match(b)?"operator":n.match(y)?null:n.match(p)?"bracket":n.match(ft)?(t.doInCurrentLine=!0,"keyword"):n.match(ut)?(l(n,t),t.doInCurrentLine=!0,"keyword"):n.match(rt)?(t.doInCurrentLine?t.doInCurrentLine=!1:l(n,t),"keyword"):n.match(s)?"keyword":n.match(c)?(e(n,t),e(n,t),"keyword"):n.match(h)?(t.doInCurrentLine?t.doInCurrentLine=!1:e(n,t),"keyword"):n.match(k)?"keyword":n.match(d)?"atom":n.match(tt)?"variable-2":n.match(g)?"builtin":n.match(nt)?"variable-2":n.match(w)?"variable":(n.next(),f)}function ot(n){var r=n.length==1,i="string";return function(u,e){while(!u.eol()){if(u.eatWhile(/[^'"]/),u.match(n))return e.tokenize=o,i;u.eat(/['"]/)}if(r){if(t.singleLineStringErrors)return f;e.tokenize=o}return i}}function st(n,t){var i=t.tokenize(n,t),r=n.current();return r==="."?(i=t.tokenize(n,t),r=n.current(),i&&(i.substr(0,8)==="variable"||i==="builtin"||i==="keyword")?((i==="builtin"||i==="keyword")&&(i="variable"),u.indexOf(r.substr(1))>-1&&(i="variable-2"),i):f):i}var f="error",a=new RegExp("^[\\+\\-\\*/&\\\\\\^<>=]"),v=new RegExp("^((<>)|(<=)|(>=))"),y=new RegExp("^[\\.,]"),p=new RegExp("^[\\(\\)]"),w=new RegExp("^[A-Za-z][_A-Za-z0-9]*"),b=i(["and","or","not","xor","is","mod","eqv","imp"]),r=["WScript","err","debug","RegExp"],u=["clear","execute","raise","replace","test","write","writeline","close","open","state","eof","update","addnew","end","createobject","quit"].concat(["description","firstindex","global","helpcontext","helpfile","ignorecase","length","number","pattern","source","value","count"]);r=r.concat(["vbBlack","vbRed","vbGreen","vbYellow","vbBlue","vbMagenta","vbCyan","vbWhite","vbBinaryCompare","vbTextCompare","vbSunday","vbMonday","vbTuesday","vbWednesday","vbThursday","vbFriday","vbSaturday","vbUseSystemDayOfWeek","vbFirstJan1","vbFirstFourDays","vbFirstFullWeek","vbGeneralDate","vbLongDate","vbShortDate","vbLongTime","vbShortTime","vbObjectError","vbOKOnly","vbOKCancel","vbAbortRetryIgnore","vbYesNoCancel","vbYesNo","vbRetryCancel","vbCritical","vbQuestion","vbExclamation","vbInformation","vbDefaultButton1","vbDefaultButton2","vbDefaultButton3","vbDefaultButton4","vbApplicationModal","vbSystemModal","vbOK","vbCancel","vbAbort","vbRetry","vbIgnore","vbYes","vbNo","vbCr","VbCrLf","vbFormFeed","vbLf","vbNewLine","vbNullChar","vbNullString","vbTab","vbVerticalTab","vbUseDefault","vbTrue","vbFalse","vbEmpty","vbNull","vbInteger","vbLong","vbSingle","vbDouble","vbCurrency","vbDate","vbString","vbObject","vbError","vbBoolean","vbVariant","vbDataObject","vbDecimal","vbByte","vbArray"]);n.isASP&&(r=r.concat(["server","response","request","session","application"]),u=u.concat(["addheader","appendtolog","binarywrite","end","flush","redirect","binaryread","remove","removeall","lock","unlock","abandon","getlasterror","htmlencode","mappath","transfer","urlencode"],["buffer","cachecontrol","charset","contenttype","expires","expiresabsolute","isclientconnected","pics","status","clientcertificate","cookies","form","querystring","servervariables","totalbytes","contents","staticobjects","codepage","lcid","sessionid","timeout","scripttimeout"]));var k=i(["dim","redim","then","until","randomize","byval","byref","new","property","exit","in","const","private","public","get","set","let","stop","on error resume next","on error goto 0","option explicit","call","me"]),d=i(["true","false","nothing","empty","null"]),g=i(["abs","array","asc","atn","cbool","cbyte","ccur","cdate","cdbl","chr","cint","clng","cos","csng","cstr","date","dateadd","datediff","datepart","dateserial","datevalue","day","escape","eval","execute","exp","filter","formatcurrency","formatdatetime","formatnumber","formatpercent","getlocale","getobject","getref","hex","hour","inputbox","instr","instrrev","int","fix","isarray","isdate","isempty","isnull","isnumeric","isobject","join","lbound","lcase","left","len","loadpicture","log","ltrim","rtrim","trim","maths","mid","minute","month","monthname","msgbox","now","oct","replace","rgb","right","rnd","round","scriptengine","scriptenginebuildversion","scriptenginemajorversion","scriptengineminorversion","second","setlocale","sgn","sin","space","split","sqr","strcomp","string","strreverse","tan","time","timer","timeserial","timevalue","typename","ubound","ucase","unescape","vartype","weekday","weekdayname","year"]),nt=i(r),tt=i(u),it='"',rt=i(["class","sub","select","while","if","function","property","with","for"]),s=i(["else","elseif","case"]),h=i(["next","loop","wend"]),c=i(["end"]),ut=i(["do"]),ft=i(["on error resume next","exit"]),et=i(["rem"]);return{electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:o,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:!1,ignoreKeyword:!1}},token:function(n,t){n.sol()&&(t.currentIndent+=t.nextLineIndent,t.nextLineIndent=0,t.doInCurrentLine=0);var i=st(n,t);return t.lastToken={style:i,content:n.current()},i==="space"&&(i=null),i},indent:function(t,i){var r=i.replace(/^\s+|\s+$/g,"");return r.match(h)||r.match(c)||r.match(s)?n.indentUnit*(t.currentIndent-1):t.currentIndent<0?0:t.currentIndent*n.indentUnit}}});n.defineMIME("text/vbscript","vbscript")});