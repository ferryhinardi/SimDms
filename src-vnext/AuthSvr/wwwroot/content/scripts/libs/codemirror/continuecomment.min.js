(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){function r(t){var o,i,v,h,s,f,y,r,l,c,p,a,e;if(t.getOption("disableInput"))return n.Pass;for(o=t.listSelections(),v=[],h=0;h<o.length;h++){if(s=o[h].head,f=t.getTokenAt(s),f.type!="comment")return n.Pass;if(y=n.innerMode(t.getMode(),f.state).mode,i){if(i!=y)return n.Pass}else i=y;if(r=null,i.blockCommentStart&&i.blockCommentContinue){if(l=f.string.indexOf(i.blockCommentEnd),c=t.getRange(n.Pos(s.line,0),n.Pos(s.line,f.end)),l==-1||l!=f.string.length-i.blockCommentEnd.length||!(s.ch>=l))if(f.string.indexOf(i.blockCommentStart)==0){if(r=c.slice(0,f.start),!/^\s*$/.test(r))for(r="",p=0;p<f.start;++p)r+=" "}else(e=c.indexOf(i.blockCommentContinue))!=-1&&e+i.blockCommentContinue.length>f.start&&/^\s*$/.test(c.slice(0,e))&&(r=c.slice(0,e));r!=null&&(r+=i.blockCommentContinue)}if(r==null&&i.lineComment&&u(t)&&(a=t.getLine(s.line),e=a.indexOf(i.lineComment),e>-1&&(r=a.slice(0,e),/\S/.test(r)?r=null:r+=i.lineComment+a.slice(e+i.lineComment.length).match(/^\s*/)[0])),r==null)return n.Pass;v[h]="\n"+r}t.operation(function(){for(var n=o.length-1;n>=0;n--)t.replaceRange(v[n],o[n].from(),o[n].to(),"+insert")})}function u(n){var t=n.getOption("continueComments");return t&&typeof t=="object"?t.continueLineComment!==!1:!0}for(var i=["clike","css","javascript"],t=0;t<i.length;++t)n.extendMode(i[t],{blockCommentContinue:" * "});n.defineOption("continueComments",null,function(t,i,u){var f,e;u&&u!=n.Init&&t.removeKeyMap("continueComment");i&&(f="Enter",typeof i=="string"?f=i:typeof i=="object"&&i.key&&(f=i.key),e={name:"continueComment"},e[f]=r,t.addKeyMap(e))})});