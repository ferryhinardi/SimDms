(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../../mode/sql/sql")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],n):n(CodeMirror)})(function(n){"use strict";function y(t){var i=t.doc.modeOption;return i==="sql"&&(i="text/x-sql"),n.resolveMode(i).keywords}function s(n){return typeof n=="string"?n:n.text}function f(n,t){if(!n.slice)return n[t];for(var i=n.length-1;i>=0;i--)if(s(n[i])==t)return n[i]}function c(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function p(n,t){var i=n.length,r=s(t).substr(0,i);return n.toUpperCase()===r.toUpperCase()}function u(n,t,i,r){for(var u in i)i.hasOwnProperty(u)&&(i.slice&&(u=i[u]),p(t,u)&&n.push(r(u)))}function w(n){return n.charAt(0)=="."&&(n=n.substr(1)),n.replace(/`/g,"")}function h(n){for(var r,t=s(n).split("."),i=0;i<t.length;i++)t[i]="`"+t[i]+"`";return(r=t.join("."),typeof n=="string")?r:(n=c(n),n.text=r,n)}function b(n,e,o,s){for(var y=!1,b=[],d=e.start,k=!0,p,nt,a;k;)k=e.string.charAt(0)==".",y=y||e.string.charAt(0)=="`",d=e.start,b.unshift(w(e.string)),e=s.getTokenAt(i(n.line,e.start)),e.string=="."&&(k=!0,e=s.getTokenAt(i(n.line,e.start)));p=b.join(".");u(o,p,r,function(n){return y?h(n):n});u(o,p,t,function(n){return y?h(n):n});p=b.pop();var l=b.join("."),g=!1,tt=l;return f(r,l)||(nt=l,l=v(l,s),l!==nt&&(g=!0)),a=f(r,l),a&&a.columns&&(a=a.columns),a&&u(o,p,a,function(n){var t=l;return g==!0&&(t=tt),typeof n=="string"?n=t+"."+n:(n=c(n),n.text=t+"."+n.text),y?h(n):n}),d}function k(n,t){var u,r,i;if(n)for(u=/[,;]/g,r=n.split(" "),i=0;i<r.length;i++)t(r[i]?r[i].replace(u,""):"")}function l(n){return n.line+n.ch/Math.pow(10,6)}function a(n){return i(Math.floor(n),+n.toString().split(".").pop())}function v(n,t){for(var v=t.doc,g=v.getValue(),tt=n.toUpperCase(),y="",p="",e=[],w={start:i(0,0),end:i(t.lastLine(),t.getLineHandle(t.lastLine()).length)},s=g.indexOf(o.QUERY_DIV),h,b,c,d,u,nt;s!=-1;)e.push(v.posFromIndex(s)),s=g.indexOf(o.QUERY_DIV,s+1);for(e.unshift(i(0,0)),e.push(i(t.lastLine(),t.getLineHandle(t.lastLine()).text.length)),h=0,b=l(t.getCursor()),u=0;u<e.length;u++){if(c=l(e[u]),b>h&&b<=c){w={start:a(h),end:a(c)};break}h=c}for(d=v.getRange(w.start,w.end,!1),u=0;u<d.length;u++)if(nt=d[u],k(nt,function(n){var t=n.toUpperCase();t===tt&&f(r,y)&&(p=y);t!==o.ALIAS_KEYWORD&&(y=n)}),p)break;return p}var r,t,e,o={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},i=n.Pos;n.registerHelper("hint","sql",function(n,o){var l,k;r=o&&o.tables||{};l=o&&o.defaultTable;k=o&&o.disableKeywords;t=l&&f(r,l);e=e||y(n);l&&!t&&(t=v(l,n));t=t||[];t.columns&&(t=t.columns);var h=n.getCursor(),a=[],s=n.getTokenAt(h),p,w,c;return s.end>h.ch&&(s.end=h.ch,s.string=s.string.slice(0,h.ch-s.start)),s.string.match(/^[.`\w@]\w*$/)?(c=s.string,p=s.start,w=s.end):(p=w=h.ch,c=""),c.charAt(0)=="."||c.charAt(0)=="`"?p=b(h,s,a,n):(u(a,c,r,function(n){return n}),u(a,c,t,function(n){return n}),k||u(a,c,e,function(n){return n.toUpperCase()})),{list:a,from:i(h.line,p),to:i(h.line,w)}})});
//# sourceMappingURL=sql-hint.min.js.map
